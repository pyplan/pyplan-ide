/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1854:function(e,t,i){var n=i(670);function r(e){return e&&(e.__esModule?e.default:e)}e.exports=(n.default||n).template({1:function(e,t,i,n,r){return' style="width: 40px;" '},3:function(e,t,i,n,r){return' style="width: 12px;"\n              '},5:function(e,t,i,n,r){return'                <i class="fa fa-plus-square dashAddRow" title="Add row" style="display: none;"></i>\n                <i class="fas fa-info-circle knowledge-arrow"></i>\n\n                <i class="fas fa-dot-circle dataStatus green"></i>\n'},7:function(e,t,n,s,a){return'                <i class="toggle-mode fa fa-pencil toolbar-area" style="margin-right:4px;" title="'+e.escapeExpression(r(i(668)).call(null!=t?t:e.nullContext||{},"edit",{name:"L",hash:{},data:a,loc:{start:{line:21,column:98},end:{line:21,column:110}}}))+'"></i>\n'},9:function(e,t,i,n,r){return'              <div class="changes-area" style="width: 100%; height: 28px; z-index: 999; \n                        position: absolute; top: 0; left: -5px;\n                        padding-top: 3px; padding-left: 5px; background: rgb(0, 0, 0); background: fff;">\n                <button class="btn btn-mini btn-lime applyChanges">Accept</button>\n                <button class="btn btn-mini btn-lightred cancelChanges">Cancel</button>\n              </div>\n'},11:function(e,t,i,n,r){return' style="padding-left: 5px;"\n              '},compiler:[8,">= 4.3.0"],main:function(e,t,n,s,a){var l,o=e.lambda,u=e.escapeExpression,d=null!=t?t:e.nullContext||{},c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div id="'+u(o(null!=t?c(t,"id"):t,t))+'-fullscreenHelper"\n  style="display: none; position: absolute;width: 100%;height: 100%;background-color: #fff;z-index: 9998;"></div>\n<div id="'+u(o(null!=t?c(t,"id"):t,t))+'" data-gs-id="'+u(o(null!=t?c(t,"id"):t,t))+'" data-gs-x="'+u(o(null!=(l=null!=t?c(t,"widget"):t)?c(l,"x"):l,t))+'" data-gs-y="'+u(o(null!=(l=null!=t?c(t,"widget"):t)?c(l,"y"):l,t))+'" data-gs-width="'+u(o(null!=(l=null!=t?c(t,"widget"):t)?c(l,"width"):l,t))+'"\n  data-gs-height="'+u(o(null!=(l=null!=t?c(t,"widget"):t)?c(l,"height"):l,t))+'">\n  <div class="grid-stack-item-content noline">\n    <div class="widgetHeader">\n      <table class="blockHeaderTable">\n        <tbody>\n          <tr>\n            <td '+(null!=(l=r(i(669)).call(d,null!=(l=null!=t?c(t,"widget"):t)?c(l,"objectType"):l,"==","inputform",{name:"ifCond",hash:{},fn:e.program(1,a,0),inverse:e.program(3,a,0),data:a,loc:{start:{line:10,column:16},end:{line:11,column:25}}}))?l:"")+'>\n              <span class="commonOptsWrapper btnMenu" style="color: #cccccc; display: inline-block;">\n                <i class="fa fa-ellipsis-v" style="top: 1px; position: relative; font-size: 15px; width: 12px;"></i>\n'+(null!=(l=r(i(669)).call(d,null!=(l=null!=t?c(t,"widget"):t)?c(l,"objectType"):l,"==","inputform",{name:"ifCond",hash:{},fn:e.program(5,a,0),inverse:e.noop,data:a,loc:{start:{line:14,column:16},end:{line:19,column:27}}}))?l:"")+(null!=(l=r(i(669)).call(d,null!=(l=null!=t?c(t,"widget"):t)?c(l,"itemType"):l,"==","nodetable",{name:"ifCond",hash:{},fn:e.program(7,a,0),inverse:e.noop,data:a,loc:{start:{line:20,column:16},end:{line:22,column:27}}}))?l:"")+"\n              </span>\n\n"+(null!=(l=r(i(669)).call(d,null!=(l=null!=t?c(t,"widget"):t)?c(l,"itemType"):l,"==","nodetable",{name:"ifCond",hash:{},fn:e.program(9,a,0),inverse:e.noop,data:a,loc:{start:{line:26,column:14},end:{line:33,column:25}}}))?l:"")+'\n            </td>\n            <td class="widgetTitle" '+(null!=(l=r(i(669)).call(d,null!=(l=null!=t?c(t,"widget"):t)?c(l,"objectType"):l,"==","inputform",{name:"ifCond",hash:{},fn:e.program(11,a,0),inverse:e.noop,data:a,loc:{start:{line:36,column:36},end:{line:37,column:25}}}))?l:"")+'>\n              <h5 class="item-title" data-title="'+u(o(null!=(l=null!=(l=null!=(l=null!=t?c(t,"widget"):t)?c(l,"itemProperties"):l)?c(l,"title"):l)?c(l,"text"):l,t))+" "+u(o(null!=(l=null!=(l=null!=t?c(t,"widget"):t)?c(l,"itemProperties"):l)?c(l,"unit"):l,t))+'">\n                '+u(o(null!=(l=null!=(l=null!=(l=null!=t?c(t,"widget"):t)?c(l,"itemProperties"):l)?c(l,"title"):l)?c(l,"text"):l,t))+" "+u(o(null!=(l=null!=(l=null!=t?c(t,"widget"):t)?c(l,"itemProperties"):l)?c(l,"unit"):l,t))+'</h5>\n            </td>\n            <td>\n              <span class="optButtonsWrapper" style="color: #cccccc;">\n                <i class="fa fa-cog openPropertiesWindow" data-placement="bottom" rel="tooltip"\n                  data-title="Properties"></i>\n                <i class="fa fa-caret-square-o-right splitWidgetRight" data-placement="bottom" rel="tooltip"\n                  data-title="Split vertically"></i>\n                <i class="fa fa-caret-square-o-down splitWidgetBottom" data-placement="bottom" rel="tooltip"\n                  data-title="Split horizontally"></i>\n                <i class="fa fa-eraser clearWidget" data-placement="bottom" rel="tooltip" data-title="Clean"></i>\n                <i class="fa fa-times removeWidget" data-placement="left" rel="tooltip" data-title="Remove"></i>\n              </span>\n\n              <i class="fa fa-minus-square restoreWidget"\n                style="position: absolute; top: 5px; right: 10px; font-size: 18px;"></i>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n\n    <div class="chartArea item-area">\n      <div class="chartTypeSelector">\n        <p>\n          <button class="btn btn-mini btn-info" data-key="table">\n            <i class="fa fa-table"></i>\n          </button>\n          <button class="btn btn-mini btn-info" data-key="nodetable">\n            <i class="fa fa-cube"></i>\n          </button>\n          <button class="btn btn-mini btn-info" data-key="columnchart">\n            <i class="fa fa-bar-chart"></i>\n          </button>\n        </p>\n        <p>\n          <button class="btn btn-mini btn-info" data-key="diagramviewer">\n            <i class="fa fa-sitemap"></i>\n          </button>\n          <button class="btn btn-mini btn-info" data-key="wizard" title="'+u(r(i(668)).call(d,"wizard",{name:"L",hash:{},data:a,loc:{start:{line:78,column:73},end:{line:78,column:87}}}))+'">\n            <i class="fa fa-magic"></i>\n          </button>\n          <button class="btn btn-mini btn-warning moreChartTypes">\n            <i class="fa fa-angle-down"></i>\n          </button>\n        </p>\n      </div>\n\n\n\n    </div>\n\n    <div class="drop-area">\n      <div class="drop-item for-row"><span>'+u(r(i(668)).call(d,"drop_here",{name:"L",hash:{},data:a,loc:{start:{line:92,column:43},end:{line:92,column:60}}}))+'</span>\n        \x3c!--<ul></ul>--\x3e\n      </div>\n      <div class="drop-item for-column"><span>'+u(r(i(668)).call(d,"drop_here",{name:"L",hash:{},data:a,loc:{start:{line:95,column:46},end:{line:95,column:63}}}))+'</span>\n        \x3c!--<ul></ul>--\x3e\n      </div>\n    </div>\n    <div class="detail-area">\n      <ul></ul>\n    </div>\n    <div class="info-area">\n    </div>\n    <div class="item-selector"></div>\n\n  </div>\n</div>'},useData:!0})},1855:function(e,t,i){var n=i(670);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,r){return'<div class="pane-container"></div>'},useData:!0})},1856:function(e,t,i){var n=i(670);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,r){var s,a=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,o=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="editor">\n  <div class="col-xs-12 nopadding">\n    <div class="input-group">\n      <input type="text" value="'+o("function"==typeof(s=null!=(s=u(i,"name")||(null!=t?u(t,"name"):t))?s:l)?s.call(a,{name:"name",hash:{},data:r,loc:{start:{line:4,column:32},end:{line:4,column:40}}}):s)+'" class="form-control input-sm" autofocus>\n      <div class="input-group-btn">\n        <button data-rel="'+o("function"==typeof(s=null!=(s=u(i,"id")||(null!=t?u(t,"id"):t))?s:l)?s.call(a,{name:"id",hash:{},data:r,loc:{start:{line:6,column:26},end:{line:6,column:32}}}):s)+'" class="btn btn-blue btn-small" type="button" style="height: 30px;"><i class="fa fa-check"></i></button>\n      </div>\n    </div>\n  </div>\n</div>\n'},useData:!0})},1857:function(e,t,i){var n=i(670);e.exports=(n.default||n).template({1:function(e,t,i,n,r){var s,a,l=null!=t?t:e.nullContext||{},o=e.hooks.helperMissing,u="function",d=e.escapeExpression,c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<li data-field="'+d(typeof(a=null!=(a=c(i,"field")||(null!=t?c(t,"field"):t))?a:o)===u?a.call(l,{name:"field",hash:{},data:r,loc:{start:{line:2,column:16},end:{line:2,column:25}}}):a)+'" title="'+d(typeof(a=null!=(a=c(i,"field")||(null!=t?c(t,"field"):t))?a:o)===u?a.call(l,{name:"field",hash:{},data:r,loc:{start:{line:2,column:34},end:{line:2,column:43}}}):a)+'" data-type="'+d(typeof(a=null!=(a=c(i,"dimType")||(null!=t?c(t,"dimType"):t))?a:o)===u?a.call(l,{name:"dimType",hash:{},data:r,loc:{start:{line:2,column:56},end:{line:2,column:67}}}):a)+'">\n'+(null!=(s=c(i,"if").call(l,null!=t?c(t,"isFirst"):t,{name:"if",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r,loc:{start:{line:3,column:4},end:{line:5,column:11}}}))?s:"")+"    "+(null!=(s=c(i,"if").call(l,null!=t?c(t,"hasLevels"):t,{name:"if",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r,loc:{start:{line:6,column:4},end:{line:7,column:11}}}))?s:"")+"    "+(null!=(s=c(i,"if").call(l,null!=t?c(t,"unlinked"):t,{name:"if",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r,loc:{start:{line:8,column:4},end:{line:8,column:60}}}))?s:"")+' <span class="name">'+d(typeof(a=null!=(a=c(i,"name")||(null!=t?c(t,"name"):t))?a:o)===u?a.call(l,{name:"name",hash:{},data:r,loc:{start:{line:8,column:80},end:{line:8,column:88}}}):a)+':</span><a href="#"\n        class="text filterselector" title="'+d(typeof(a=null!=(a=c(i,"filterValues")||(null!=t?c(t,"filterValues"):t))?a:o)===u?a.call(l,{name:"filterValues",hash:{},data:r,loc:{start:{line:9,column:43},end:{line:9,column:59}}}):a)+'">('+d(typeof(a=null!=(a=c(i,"values")||(null!=t?c(t,"values"):t))?a:o)===u?a.call(l,{name:"values",hash:{},data:r,loc:{start:{line:9,column:62},end:{line:9,column:72}}}):a)+")</a>\n</li>\n"},2:function(e,t,i,n,r){return'    <span class="removeDim">X</span>\n'},4:function(e,t,i,n,r){return'<a href="#" class="text hierarchy"><i class="fa fa-sitemap" /></a>\n'},6:function(e,t,i,n,r){return'<i class="fa fa-chain-broken" /> '},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,r){var s;return null!=(s=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(i,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r,loc:{start:{line:1,column:0},end:{line:11,column:9}}}))?s:""},useData:!0})},1858:function(e,t,i){var n=i(670);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,s){return'<div class="loading-pane" >\n    <span>'+e.escapeExpression((a=i(668),a&&(a.__esModule?a.default:a)).call(null!=t?t:e.nullContext||{},"loading",{name:"L",hash:{},data:s,loc:{start:{line:2,column:10},end:{line:2,column:25}}}))+"</span>\n</div>";var a},useData:!0})},1859:function(e,t,i){var n=i(670);function r(e){return e&&(e.__esModule?e.default:e)}e.exports=(n.default||n).template({1:function(e,t,n,s,a){var l=null!=t?t:e.nullContext||{},o=e.escapeExpression;return"        "+o(r(i(668)).call(l,"reset_view_text_1",{name:"L",hash:{},data:a,loc:{start:{line:4,column:8},end:{line:4,column:33}}}))+'\n        <a href="#" class="light-reset-view"> '+o(r(i(668)).call(l,"reseting_indexes",{name:"L",hash:{},data:a,loc:{start:{line:5,column:46},end:{line:5,column:70}}}))+" </a>"+o(r(i(668)).call(l,"reset_view_text_2",{name:"L",hash:{},data:a,loc:{start:{line:5,column:75},end:{line:5,column:100}}}))+'\n        <a href="#" class="hard-reset-view"> '+o(r(i(668)).call(l,"full_reset",{name:"L",hash:{},data:a,loc:{start:{line:6,column:45},end:{line:6,column:63}}}))+" </a>\n"},3:function(e,t,n,s,a){var l=null!=t?t:e.nullContext||{},o=e.escapeExpression;return"        "+o(r(i(668)).call(l,"reset_view_text_3",{name:"L",hash:{},data:a,loc:{start:{line:8,column:8},end:{line:8,column:33}}}))+'\n        <a href="#" class="hard-reset-view"> '+o(r(i(668)).call(l,"full_reset",{name:"L",hash:{},data:a,loc:{start:{line:9,column:45},end:{line:9,column:63}}}))+" </a>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,r){var s,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="reset-view-container">\n    <span>\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"hasLightReset"):t,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.program(3,r,0),data:r,loc:{start:{line:3,column:8},end:{line:10,column:15}}}))?s:"")+"    </span>\n</div>"},useData:!0})},717:function(e,t,i){"use strict";(function(n,r,s,a){var l,o,u=i(18);function d(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){c(e,t,i[t])}))}return e}function c(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}l=[i(687),i(1854),i(1855),i(1856),i(1857),i(1858),i(1859),i(767)],void 0===(o=function(e,t,l,o,h,m,p,f){var g;return n.View.extend((c(g={el:r("#n_o_n_e"),tagId:"",itemID:"",currentNodeId:"",toolbarInitialized:!1,editMode:!1,splitter:void 0,currentResult:void 0,currentNodeProperties:void 0,menuEnabled:!0,menuInitiated:!1,detailDragInitiated:!1,detailDraggable:!0,loadingTimeOut:-1,pageSize:-1,currentPage:-1,scaleFactorW:1,scaleFactorH:1,maxScaleFactorW:1,maxScaleFactorH:1,oldPopover:null,numberFormat:"",numberFormatter:void 0,originalRow:void 0,originalCol:void 0,filterChangeTimeout:-1,forceReloadMenu:!0,rowFormatter:void 0,columnFormatter:void 0,hasLightReset:!1,isReady:!1,sizeDic:{1:{w:220,h:200,hideDetail:!0},99:{w:9999,h:9999}},sizeTransition:{"1-99":{reload:!0},"99-1":{reload:!0}},lastSizeKey:void 0,fromEmbedded:!1,loadingDashboard:!1,baseRender:function(e,i){void 0!==__currentSession.fromEmbedded&&(this.fromEmbedded=__currentSession.fromEmbedded);var n={id:r.uuid(),skipContainer:e?1:0,widget:this.currentResult};this.currentResult;this.tagId="#"+n.id;var s=t(n);this.grid.container.append(s),this.grid.makeWidget(r("#"+n.id)),this.grid.update(r("#"+n.id),n.widget.x,n.widget.y,n.widget.width,n.widget.height),this.$el=r(this.tagId),this.addDraggable(),this.addDroppable(),this.addSelectable(),this.addEvents(),this.baseStyles(),this.baseUpdateSize()},baseUpdateSize:function(){this.checkSizeDic()},updateSize:function(){},updateValues:function(e){},exportItem:function(){},onRemoveItemView:function(){},onSaveDashboard:function(){},onEndFullScreenAnimation:function(){},onEndNormalScreenAnimation:function(){},getRelatedNoQuery:function(){},updateStyleLibraries:function(e){},setPositionForDropDetails:function(){},applyNumberFormat:function(){},getOptionsMenu:function(){return null},getColumnLimits:function(){return{1:1e3,5:500,10:400}},getStylesUsed:function(){},preEvaluateNode:function(e,t,i,n){},toolbarCreated:function(){},syncDrilldown:function(e,t,i){},syncDrillup:function(e,t){},syncShowHideLegend:function(e,t,i){},lightReset:function(e){this.currentResult&&(this.currentResult.dims=[],this.currentResult.rows=[],this.currentResult.columns=[],this.originalRow=void 0,this.originalCol=void 0,this.fromLightReset=!0,this.refreshItemDash())},refreshItemDash:function(){r(this.tagId).trigger("evaluateNodeFromCurrentResult")},recreateItemDash:function(){r(this.tagId).trigger("evaluateNodeFromCurrentResult")},getPropertyWindowTitle:function(){var e="";return this.currentNodeId?e=this.currentNodeId:this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.nodeId&&(e=this.currentResult.itemProperties.nodeId),e},showOptionsMenu:function(){if(!this.editMode){var e=this.tagId+" .btnMenu";if(!this.menuInitiated||this.forceReloadMenu){var t=this.getOptionsMenu();if(t&&(this.menuInitiated&&r.contextMenu("destroy",e),r(".main-fullscreen").is(":visible")&&(t.items._splitBy?t.items._splitBy.disabled=!0:t.items._splitBy=!1),!r.isEmptyObject(t.items))){var i=this;this.menuInitiated=!0,r.contextMenu({selector:e,callback:function(e,n){t.callback(e),t.items&&t.items[e]&&t.items[e].persist&&setTimeout((function(){i.showOptionsMenu()}),100)},items:t.items})}}this.menuInitiated&&r(e).contextMenu()}},removeItemView:function(){this.onRemoveItemView(),this.columnFormatter=null,this.rowFormatter=null,this.currentResult=null,r.contextMenu("destroy",this.tagId+" .btnMenu"),r(this.tagId).draggable("destroy"),this.detailDragInitiated&&(r(this.tagId).find("div.detail-area ul").sortable("destroy"),r(this.tagId).find(".drop-area .drop-item").droppable("destroy"))},_evaluateNode:function(e,t,i,n,s,a){var l=this;if(e){this.showLoading();var o,d,c=!1,h="A",m="FLO",p="CAL";i&&0!=i.length||!this.originalRow||0===Object.entries(this.originalRow).length&&this.originalRow.constructor===Object||(i=[this.originalRow],c=!0),n&&0!=n.length||!this.originalCol||0===Object.entries(this.originalCol).length&&this.originalCol.constructor===Object||(n=[this.originalCol],c=!0),this.currentResult&&this.currentResult.itemProperties&&(o=this.currentResult.itemProperties.bottomTotal,d=this.currentResult.itemProperties.rightTotal,this.currentResult.itemProperties.timeFormat&&(h=this.currentResult.itemProperties.timeFormat),this.currentResult.itemProperties.timeFormatType&&(m=this.currentResult.itemProperties.timeFormatType),this.currentResult.itemProperties.calendarType&&(p=this.currentResult.itemProperties.calendarType)),this.preEvaluateNode(e,t,i,n);var f=["linechart","columnchart","columnchartstacked","columnchartpercent","barchart","barchartstacked","barchartpercent","areachart","areachartstacked","areachartpercent","piechart","gaugechart","waterfallchart","scatterchart","pyramidchart","funnelchart","complexchart"];"table"===this.currentResult.itemType&&this.currentResult.itemProperties.table.styles.find((function(e){var t=e.index,i=e.value,n=e.style;return"_alltable_"===t&&-1===i&&0==n.pagination}))?(this.pageSize=1e5,this.currentPage=1):"indicator"===this.currentResult.itemType?(-1==this.pageSize&&(this.pageSize=1e3),-1==this.currentPage&&(this.currentPage=1)):f.includes(this.currentResult.itemType)&&(-1==this.pageSize&&(this.pageSize=300),-1==this.currentPage&&(this.currentPage=1)),this.model.evaluateNode(e,t,i,n,(function(e){"table"===l.currentResult.itemType&&l.currentResult.itemProperties.table.styles.find((function(e){var t=e.index,i=e.value,n=e.style;return"_alltable_"===t&&-1===i&&0==n.pagination}))?1e5===e.series.length&&(0,u.showMessage)("".concat((0,u.translate)("_results_limited_to")," 100.000"),(0,u.translate)("_result_limit"),"info",!0):"indicator"===l.currentResult.itemType?1e3===e.series.length&&(0,u.showMessage)("".concat((0,u.translate)("_results_limited_to")," 1.000"),(0,u.translate)("_result_limit"),"info",!0):f.includes(l.currentResult.itemType)&&300===e.series.length&&(0,u.showMessage)("".concat((0,u.translate)("_results_limited_to")," 300"),(0,u.translate)("_result_limit"),"info",!0),l.applyColumnLimits(e),l.hideLoading(),l.updatePropertiesOnEvaluate(e),l.currentResult&&e.indexValues&&(l.currentResult.indexValues=e.indexValues),l.updateIndexes(t,i,n,e.newDims,c),l.currentResult&&(t.length>0||i.length>0||n.length>0)&&(l.currentResult.dims=t,l.currentResult.rows=i,l.currentResult.columns=n),l.updateValues(e)}),!!(this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.defMode),(function(t){"Access denied"==t?(r(l.tagId).find(".item-area").empty(),r(l.tagId).find(".item-title").empty(),r(l.tagId).find(".loading-pane span").text(t)):(l.hideLoading(),l.showResetView(e)),l.isReady=!0}),a,this.pageSize,this.currentPage,o,d,h,m,p),this.currentResult&&(t.length>0||i.length>0||n.length>0)&&(this.currentResult.dims=t,this.currentResult.rows=i,this.currentResult.columns=n)}},checkForDefaultFormat:function(e){e&&e.nodeProperties&&e.nodeProperties.numberFormat&&(this.numberFormat=e.nodeProperties.numberFormat,this.numberFormatter=null),e&&e.newDims&&(this.rowFormatter=null,e.series&&e.series.length>0&&(this.rowFormatter=this.getIndexFormatter(e.indexOnRow,e.newDims)),e.columns&&e.columns.categories&&e.columns.categories.length>0&&(this.columnFormatter=this.getIndexFormatter(e.indexOnColumn,e.newDims)))},updatePropertiesOnEvaluate:function(e){if(this.checkForDefaultFormat(e),e.itemProperties){if(this.currentNodeProperties=e.nodeResult,this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.title&&this.currentResult.itemProperties.title.isCustom||r(this.tagId).find(".item-title").text(e.itemProperties.title.text),e.itemProperties.unit&&r(this.tagId).find(".item-title").text(e.itemProperties.title.text+" "+e.itemProperties.unit),e.nodeProperties.scenario){var t=r(this.tagId).find(".item-title .from-scenario").show(),i=(0,u.translate)("datasource_scenario");t.attr("title",i),t=null}else r(this.tagId).find(".item-title .from-scenario").hide();if(r(this.tagId).find(".item-title .time-frame").hide(),e&&e.newDims&&e.newDims.length>0)for(var n=0;n<e.newDims.length;n++)if(e.newDims[n]&&e.newDims[n].isTime){if(r(this.tagId).find(".item-title .time-frame").show(),this.currentResult){if(this.currentResult.columns&&this.currentResult.columns.length>0)for(var s=0;s<this.currentResult.columns.length;s++)if(this.currentResult.columns[s].isTime){this.currentResult.columns[s].field!=e.newDims[n].field&&this.currentResult.columns.splice(s,1,e.newDims[n]);break}if(this.currentResult.rows&&this.currentResult.rows.length>0)for(s=0;s<this.currentResult.rows.length;s++)if(this.currentResult.rows[s].isTime){this.currentResult.rows[s].field!=e.newDims[n].field&&this.currentResult.rows.splice(s,1,e.newDims[n]);break}}break}this.currentResult&&this.currentResult.itemType&&r.inArray(this.currentResult.itemType,["table","columnchart","columnchartstacked","columnchartpercent","barchart","barchartstacked","barchartpercent","linechart","scatterchart","piechart"])<0&&r(this.tagId).find(".time-frame").remove()}},updateIndexes:function(e,t,i,n,s){var a=function(e,t,i){var n=!1;return e&&r.each(e,(function(e,r){if(r&&r.field==t.field)return n=!0,i&&(r.levels=t.levels,r.values=t.values,r.name=t.name,r.numberFormat=t.numberFormat),!1})),n},l=!1;r.each(n,(function(n,r){a(e,r,!0)||a(t,r,!0)||a(i,r,!0)||e&&(l=!0,e.push(r))}));var o=function(e){e&&r.each(e,(function(t,i){i&&(a(n,i)||(e.splice(t,1),l=!0))}))};o(e),o(t),o(i),(l||s)&&(r(this.$el).closest(".mainTask").find(".left-menu[data-rel='"+this.tagId+"']").trigger("removeToolbar"),this.toolbarInitialized=!1,this.editMode&&this.addProperties(!0)),this.updateDetail(e,t,i)},getKnowledgeBaseData:function(e,t,i,n,r){var s=new f,a=__currentSession.documentationTab.toString();s.getPost(e,(function(s){var l,o=s,d=s.description?s.description.trim():"",c=s.content?s.content.trim():"",h="";h=("1"===a||"2"===a)&&""!==d&&d.length>0?d:c.substr(0,350)+"...",i.hasDescription?(l=h=h.replace(/<img[^>]*>/g,""),n.fromEmbedded||(l=h+'<br><a class="readMore" href="#" data-rel="'+s.nodeId+'">Read more</a>')):(l="There is no info for this module. ",n.fromEmbedded||(l=l+'<a class="readMore" href="#" data-rel="'+e+'">Add documentation</a>'));var m={title:o.nodeTitle,content:l,left:r.clientX,top:r.clientY,className:"popover_workflow",workflowEnabled:!0,fromEmbedded:n.fromEmbedded};(0,u.haveAnyAccess)("LISTASSIGNEDWORKFLOWTASKS,LISTALLWORKFLOWTASKS")?n.getWorkflowData(e,t,i,n,m):(m.workflowEnabled=!1,n.showPopoverContent(m,n,e))}))},getWorkflowData:function(e,t,i,n,r){},showPopoverContent:function(e,t,n){i.e(14).then((function(){var s=[i(733)];(function(s){(new s).show(e,(function(e){t.oldPopover=e.options.id,r(".openWorkflow").on("click",(function(){e.removePopover(),Promise.resolve().then((function(){var e=[i(664)];(function(e){(new e).addTask("workflow","Workflow")}).apply(null,e)})).catch(i.oe)})),r(".addTaskForNode").on("click",(function(){return event.preventDefault(),i.e(11).then((function(){var t=[i(722)];(function(t){(new t).showAddTaskForNode(n),e.removePopover()}).apply(null,t)})).catch(i.oe),!1})),r(".readMore").on("click",(function(){return event.preventDefault(),i.e(16).then((function(){var t=[i(766)];(function(t){(new t).show(n),e.removePopover()}).apply(null,t)})).catch(i.oe),!1}))}))}).apply(null,s)})).catch(i.oe)},addEvents:function(){var t=this;r(this.tagId).find(".openPropertiesWindow").on("click",(function(){t.addProperties(!0,event)})),r(this.tagId).find(".btnMenu .fa-ellipsis-v").on("click",(function(){t.showOptionsMenu()})),r(this.tagId).on("removeItemView",(function(){t.removeItemView()})),r(this.tagId).find(".item-title .from-scenario").on("click",(function(e){r(this).closest(".dashboardTask").find("div.toolbar button.btnScenarios").trigger("click")})),r(this.tagId).on("loadThisPageResult",(function(e,i){var n;(t.currentPage=i,t.currentResult)&&(t.currentResult.itemProperties&&(n=t.currentResult.itemProperties.summaryBy),t._evaluateNode(t.currentNodeId,t.currentResult.dims,t.currentResult.rows,t.currentResult.columns,void 0,n))})),r(this.tagId).on("evaluateNodeFromCurrentResult",(function(e,i){var n;(t.currentPage=1,t.currentResult)&&(t.currentResult.itemProperties&&(n=t.currentResult.itemProperties.summaryBy),t.baseStyles(),t._evaluateNode(t.currentNodeId,t.currentResult.dims,t.currentResult.rows,t.currentResult.columns,i,n))})),r(this.tagId).on("refreshItemDash",(function(){t.refreshItemDash()})),r(this.tagId).on("click",".removeDim",(function(e){var i,n;"column"==r(e.target).closest("li").attr("data-type")?(n=null,i=r(t.tagId).find('li[data-type="row"]').attr("data-field")):(i=null,n=r(t.tagId).find('li[data-type="column"]').attr("data-field")),r(t.tagId).trigger("updateOriginalRowCol",[i,n]),r(t.tagId).trigger("evaluateNode",[i,n,!0])})),r(this.tagId).on("updateOriginalRowCol",(function(e,i,n){t.originalRow=t.getIndexByField(i),t.originalCol=t.getIndexByField(n)})),r(this.tagId).on("evaluateNode",(function(e,i,n,s){if(t.currentResult&&(i||n||s)){var a=[],l=[],o=[];i&&l.push(t.getIndexByField(i)),n&&o.push(t.getIndexByField(n)),r.each(t.getIndexes(),(function(e,t){0!=l.length&&t==l[0]||0!=o.length&&t==o[0]||a.push(t)})),t.currentResult.dims=a,t.currentResult.columns=o,t.currentResult.rows=l}r(t.tagId).trigger("evaluateNodeFromCurrentResult")})),this.addCreateItemHandlers(),r(this.tagId).on("changeType",(function(e,i,n){if(t.currentResult){t.currentResult.itemProperties&&t.clearItemProperties(t.currentResult.itemProperties),t.currentResult.nodeResult=null,t.currentResult.itemType=i,n&&(t.currentResult.objectType=n),"complexchart"===i&&(t.currentResult.nodeName=t.currentNodeProperties.title),t.model.removeItemModel(t.tagId);var s=r(t.tagId).closest(".grid-stack-item");t.grid.remove_widget(s),t.createNewView(t.currentResult)}})),r(this.tagId).on("changeSeriesType",(function(e,i,n){t.currentResult&&(t.currentResult.itemProperties&&t.clearItemProperties(t.currentResult.itemProperties),t.currentResult.nodeResult=null,t.currentResult.itemProperties.nodesArray[n].itemSubType=i,t.currentResult.objectType="complexchart",t.createNewView(t.currentResult))})),r(this.tagId).find(".item-title .title").on("click",(function(){t.editMode&&"inputform"!==t.currentResult.objectType&&t.editTitle()})),r(this.tagId).find(".detail-area ul").on("click","li a.filterselector",(function(){var e=r(this).closest("li").attr("data-field"),n=t.getIndexByField(e),s=n.name,a=t.tagId;return Promise.resolve().then((function(){var r=[i(687)];(function(i){(new i).getFilterView((function(i){var r=new i;r.setElement(),r.render(e,s,a,t,n.currentLevel,n.numberFormat)}))}).apply(null,r)})).catch(i.oe),!1})),r(this.tagId).find(".detail-area ul").on("click","li a.hierarchy",(function(){var e=r(this).closest("li").attr("data-field"),i=t.getIndexByField(e);if(i&&i.levels&&i.levels.length>0){var n=i.levels.slice(0);n.reverse();for(var s={},a=0;a<n.length;a++){var l=n[a];s[l.field]={type:"icon_text",name:l.name}}s[i.currentLevel]&&(s[i.currentLevel].disabled=!0);var o=t.tagId+" .detail-area ul li[data-field='"+e+"'] a.hierarchy";r.contextMenu("destroy",o),r.contextMenu({selector:o,callback:function(n,r){i.currentLevel=n,i.values=[],t.refreshItemDash(),t.model.synchronizeLevel(e,n,t.tagId)},events:{hide:function(){r.contextMenu("destroy",o)}},items:s}),r(o).contextMenu()}return!1}));var n=!1;r(this.tagId).find(".detail-area ul").on("mousewheel","li a",(function(e){if(!n){var i;n=!0;var s=r(this).closest("li").attr("data-field"),a=t.getIndexByField(s),l=0;r.each(a.values,(function(e,t){t.selected&&(i=t.value,l++,e)})),1==l&&t.model.getIndexValues({id:s},(function(a){var l=a.results,o=0;if(r.each(l,(function(e,t){t.value==i&&(o=e)})),e.deltaY>0?o++:o--,o>=0&&o<l.length){var u=[{value:l[o].value,selected:!0}];r(this).text(u.value),t.model.onFilterChange(s,u,void 0,void 0,t.tagId);setTimeout((function(){n=!1}),500)}else n=!1}),t.getTimeFrame())}})),r(this.tagId).find(".item-title .time-frame i").on("click",(function(i){var n=new e,s={e:i,itemProperties:t.getTimeFrame(),callback:function(e){t.currentResult&&(t.currentResult.itemProperties=r.extend(t.currentResult.itemProperties,e),t.refreshItemDash())}};n.showTimeFrameSetting(s)}))},baseStyles:function(){if(this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.title){var e=this.currentResult.itemProperties.title.style.color,t=this.currentResult.itemProperties.title.enabled,i=this.currentResult.itemProperties.subtitle.style.color,n=this.currentResult.itemProperties.title.style.backgroundColor,s=r(this.tagId).find(".item-title"),a=r(this.tagId).find(".item-subtitle"),l=r(this.tagId).find(".widgetHeader"),o=r(this.tagId).find(".optButtonsWrapper"),u=r(this.tagId).find(".commonOptsWrapper");l.css("background-color",n),s.css("color",e),o.css("color",e),u.css("color",e),t?s.css("display",""):s.css("display","none"),a.css("color",i)}this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.generalBackgroundColor&&r(this.tagId).find(".grid-stack-item-content").css("background-color",this.currentResult.itemProperties.generalBackgroundColor)},fullScreen:function(){var e=this,t=r(this.tagId),i=t.find("div.item-area").parent(),n=i.parent();r.wrapper=n;var s=40;this.fromEmbedded&&(s=0);var a=t.offset();i.attr("data-parent",t.attr("id")),i.attr("data-orignal-w",t.width()),i.attr("data-orignal-h",t.height()-s),i.attr("data-orignal-x",a.left),i.attr("data-orignal-y",a.top-s),t.css("z-index",9999),t.animate({position:"absolute",width:"100%",left:0,height:r(window).height()-90,top:10},{complete:function(){e.updateSize(t.width(),r(window).height()-90,!1),r(document).scrollTop(t.offset().top),r(this).find(".restoreWidget").show(),r("body").css("overflow-y","hidden"),r(e.tagId+"-fullscreenHelper").show()}})},addDraggable:function(){r(this.tagId).find("div.item-toolbar span.dragger").draggable({helper:function(){return r("<div class='dashboard-dragger-helper'>"+(0,u.translate)("dragme_to_panel")+"</div>").appendTo("body").css({zIndex:999}).show()},opacity:.8,revert:"invalid",cursor:"move"})},addDroppable:function(){var e=this;r(this.tagId).droppable({accept:".ui-draggable",activeClass:"pane-drag-active",hoverClass:"pane-drag-hover",greedy:!0,drop:function(t,i){if(!r(i.draggable).hasClass("grid-stack-item")&&!(r(i.draggable).hasClass("dock")||r(i.draggable).parent().hasClass("dim-sort")||r(i.draggable).parent().hasClass("slimScrollDiv")||r(i.draggable).parent().hasClass("ui-sortable")))if(r(i.draggable).hasClass("btnDragComment"))r(i.draggable).closest(".dashboard-comments").trigger("addReferencedComment",e.itemId);else if(r(i.draggable).hasClass("nodeGhost")){if(e.checkNodeOwner())return;if(r(i.draggable).attr("data-source")!=e.tagId){var n=r(i.draggable).attr("data-nodeId"),s=r(i.draggable).attr("data-nodeClass"),a=e.model.getItemModel(e.tagId),l=r(e.tagId).closest(".grid-stack-item");e.grid.remove_widget(l),a.currentResult.itemType="objectItem",a.currentResult.objectType="diagramviewer",a.currentResult.itemProperties={diagramOptions:{currentModule:n}},"module"==s?e.createNewView(a.currentResult):e.initializeWithNode(n)}}else{var o=r(i.draggable).closest("div.pane"),u=this;if(t.ctrlKey){var d=e.model.getItemModel("#"+r(o).attr("id")),c=e.model.getItemModel("#"+r(u).attr("id"));d&&d.currentResult&&d.currentResult.itemProperties&&c&&c.currentResult&&c.currentResult.itemProperties&&(c.currentResult.itemProperties.showTitle=d.currentResult.itemProperties.showTitle,c.currentResult.itemProperties.detail=d.currentResult.itemProperties.detail,c.currentResult.itemProperties.drilldown=d.currentResult.itemProperties.drilldown,c.currentResult.itemProperties.emptyTotal=d.currentResult.itemProperties.emptyTotal,c.currentResult.itemProperties.table=r.extend({},d.currentResult.itemProperties.table),c.currentResult.itemProperties.generalBackgroundColor=d.currentResult.itemProperties.generalBackgroundColor,c.refreshItemDash())}else{var h=r(o).parent(),m=r(u).parent();o=r(o).detach(),u=r(u).detach(),o.appendTo(m),u.appendTo(h),e.model.updateSizes(!0,!0)}}}})},addSelectable:function(){var e=this;r(this.tagId).on("selectPane",(function(){if(e.editMode){r(this).closest("div.main-pane").find("div.pane").addClass("noedit");var t=r(this).attr("id");r(".dashboardTask.editing").attr("last-edited",t),r(this).closest("div.main-pane").find("div.pane[id='"+t+"']").removeClass("noedit")}})),r(this.tagId).on("click",(function(){r(this).trigger("selectPane")}))},checkNodeOwner:function(){return!!(this.model&&this.currentNodeId&&this.model.getNodeOwner()&&this.model.getNodeOwner().toLowerCase()==this.currentNodeId.toLowerCase()&&1==this.model.countItemsModelByNodeId(this.currentNodeId))&&((0,u.showMessage)((0,u.translate)("cannot_remove_node_owner"),void 0,"error",!0),!0)},remove:function(){if(!this.checkNodeOwner()){var e=r(this.tagId).parent(),t=r(e).parent();if(1!=r(e).closest("div.main-pane").find("div.pane").length){this.model.removeItemModel(this),r(e).remove();this.model.updateSizes(!0,!0),this.onRemoveItemView(),r(t).closest("div.mainTask").find("div.menu-container").find(".left-menu[data-rel='"+this.tagId+"']").remove(),r(t).find("div.pane").first().trigger("selectPane")}}},setEditMode:function(e){this.editMode=e,this.editMode?""==r(this.tagId).find(".item-title .title").text()&&r(this.tagId).find(".item-title .title").text("("+(0,u.translate)("click_to_add_title")+")").attr("data-emptyTitle","1"):r(this.tagId).find(".item-title .title[data-emptyTitle='1']").text("").removeAttr("data-emptyTitle"),this.editModeChanged()},editModeChanged:function(){},refreshSplitter:function(){this.splitter&&this.splitter.refreshAll(r(this.tagId).closest("div.main-pane"))},addProperties:function(e,t){var n=this.currentResult;if(this.editMode){r(this.tagId).attr("id");if(n){this.toolbarInitialized=!0;var s=this;Promise.resolve().then((function(){var e=[i(687)];(function(e){(new e).getChartToolbar(n.itemType,n.objectType,s.model,(function(e){e.setElement(r(s.tagId).closest("div.mainTask")),e.render(n,s.tagId),e.$el.find(".popover").popover(),r(s.tagId).css("z-index",1e4),r(".dash-overlay").show(),s.toolbarCreated()}))}).apply(null,e)})).catch(i.oe)}}},showNumberFormat:function(){var e=this,t=this.currentResult;t&&Promise.resolve().then((function(){var n=[i(687)];(function(i){(new i).getChartToolbar(t.itemType,t.objectType,e.model,(function(i){t.nodeName=t.nodeId,i.currentData=t,i.showNumberFormatPopup((function(t){e.setNumberFormat(t)}))}))}).apply(null,n)})).catch(i.oe)},initializeWithNode:function(e,t){var i=this;if(e){r(this.tagId).find(".item-area").html(""),this.showLoading();var n=t&&"table"!=t?void 0:100;this.model&&this.model.getNodeFullData(e,n,(function(e){if(i.hideLoading(),e){t&&"indexlist"!=e.itemType&&"selector"!=e.itemType&&"formnode"!=e.itemType&&(e.itemType=t);var n=i.model.getItemModel(i.tagId).currentResult;e.x=n.x,e.y=n.y,e.width=n.width,e.height=n.height,i.model.removeItemModel(i.tagId);var s=r(i.tagId).closest(".grid-stack-item");s.length>0&&i.grid.remove_widget(s),i.createNewView(e)}}),(function(t){i.hideLoading(),i.showResetView(e)}))}},createNewView:function(t,i){this.editMode&&(this.onRemoveItemView(),r(this.$el).closest(".mainTask").find(".left-menu[data-rel='"+this.tagId+"']").trigger("removeToolbar")),t.itemType&&r(this.tagId).find(".item-area").empty();var n=this;"objectItem"==t.itemType?(new e).getObjectItemViewFromType(t.objectType,(function(e){n._createNewObjectItem(e,t),n.loadingDashboard=!1})):(new e).getChartItemViewFromType(t.itemType,(function(e){n._createNewView(e,t,i),n.loadingDashboard=!1}))},_applyItemId:function(e,t){t?this.itemId=t:e.itemId?this.itemId=e.itemId:this.itemId=r.uuid(),r(this.tagId).attr("data-itemId",this.itemId)},_createNewObjectItem:function(e,t){var i=r("div.grid-stack"),n=new e({model:this.model});n.grid=this.grid,n.setElement(i),n.currentNodeId="",n.currentResult=t,n.render(!0),n.setEditMode(this.editMode),this.model.changeItemModel(this,n),n._applyItemId(t,this.itemId),this.clearAll()},_createNewView:function(e,t,n){var a,l=this,o=r(this.tagId).parent(),u=new e({model:this.model,grid:this.grid});if(u.grid=this.grid,u.setElement(o),u.currentNodeId=t.nodeId,u.currentResult=t,u.currentResult.x=t.x,u.currentResult.y=t.y,u.currentResult.width=t.width,u.currentResult.height=t.height,u.currentResult.id=t.id,"complexchart"==t.itemType){var d=s.extend({},t.itemProperties);u.currentResult.itemProperties.nodesArray||(u.currentResult.itemProperties.nodesArray=[],u.currentResult.itemProperties.nodesArray.push({nodeId:t.nodeId,nodeName:t.nodeName,itemSubType:"column",lineStyle:"",itemProperties:d,columns:t.columns,dims:t.dims,rows:t.rows,nodeIndex:0}));t.nodeResult&&u.checkForDefaultFormat(t.nodeResult,0)}else t.nodeResult&&u.checkForDefaultFormat(t.nodeResult);(u.render(!0),t.nodeResult&&u.updatePropertiesOnEvaluate(t.nodeResult),u.setEditMode(this.editMode),this.model.changeItemModel(this,u),u._applyItemId(t,this.itemId),this.clearAll(),t.nodeResult)?(l.checkTimeIndex(t,!0,void 0),u.updateDetail(t.dims,t.rows,t.columns)):!n&&t.nodeId&&(t.itemProperties&&(a=t.itemProperties.summaryBy),t.itemProperties&&(a=t.itemProperties.summaryBy),u.updateOriginalRowCol(t.rows,t.columns),u._evaluateNode(t.nodeId,t.dims,t.rows,t.columns,void 0,a));if(this.editMode&&!this.loadingDashboard){this.toolbarInitialized=!0;l=this;Promise.resolve().then((function(){var e=[i(687)];(function(e){(new e).getChartToolbar(u.currentResult.itemType,u.currentResult.objectType,l.options.model,(function(e){e.setElement(r(u.tagId).closest("div.mainTask")),e.render(u.currentResult,u.tagId),e.$el.find(".popover").popover(),r(u.tagId).css("z-index",100001),r(".dash-overlay").show(),l.toolbarCreated()}))}).apply(null,e)})).catch(i.oe)}},checkTimeIndex:function(e,t,i){if(t){for(var n=0;n<e.columns.length;n++)if(e.columns[n].isTime)return void(e.itemProperties.timeChart.possible=!0);for(n=0;n<e.rows.length;n++)if(e.rows[n].isTime)return void(e.itemProperties.timeChart.possible=!0)}else for(n=0;n<i.length;n++)if(i[n].isTime)return void(e.itemProperties.timeChart.possible=!0);e.itemProperties.timeChart.possible=!1},clearAll:function(){this.splitter=null,this.currentResult=null,this.model=null},ensureProp:function(e,t,i){return e&&e.hasOwnProperty(t)?e[t]:i},getRowIndexField:function(){return this.currentResult&&this.currentResult.rows.length>0?this.currentResult.rows[0].field:""},getRowIndex:function(){if(this.currentResult&&this.currentResult.rows.length>0)return this.currentResult.rows[0]},getColumnIndex:function(){if(this.currentResult&&this.currentResult.columns.length>0)return this.currentResult.columns[0]},getColumnIndexField:function(){if(this.currentResult&&this.currentResult.columns.length>0)return this.currentResult.columns[0].field},getIndexes:function(){var e=[];return this.currentResult&&(this.currentResult.dims=a.filter(this.currentResult.dims,(function(e){return!a.isEmpty(e)})),this.currentResult.columns=a.filter(this.currentResult.columns,(function(e){return!a.isEmpty(e)})),this.currentResult.rows=a.filter(this.currentResult.rows,(function(e){return!a.isEmpty(e)})),this.currentResult.dims&&this.currentResult.dims.length>0&&(e=e.concat(this.currentResult.dims)),this.currentResult.columns&&this.currentResult.columns.length>0&&(e=e.concat(this.currentResult.columns)),this.currentResult.rows&&this.currentResult.rows.length>0&&(e=e.concat(this.currentResult.rows))),e},getIndexByField:function(e){e&&(e=e.split(".")[0].toLowerCase());var t=this.getIndexes();if(t&&t.length>0)for(var i=0;i<t.length;i++)if(String(t[i].field).split(".")[0].toLowerCase()==e)return t[i]},isValueEmpty:function(e){return null==e||!(e instanceof String)&&0==e},filterEmptyData:function(e,t){if(e){for(var i=e.series.length-1;i>=0;i--){for(var n=e.series[i],r=!0,s=0;s<n.data.length&&r;s++)r=r&&this.isValueEmpty(n.data[s]);r&&e.series.splice(i,1)}for(var a=e.columns.categories.length-1;a>=0;a--){for(r=!0,i=0;i<e.series.length&&r;i++)r=r&&this.isValueEmpty(e.series[i].data[a]);if(r){var l=e.columns.categories[a];if(!t||-1==t.indexOf(l)){e.columns.categories.splice(a,1);for(i=0;i<e.series.length;i++)e.series[i].data.splice(a,1)}}}}},updateChoiceDefinition:function(e,t,i,n,r){var s=i.split(","),a=s[0]+","+(parseInt(n)+1);s.length>2?a+=","+s[2]:a+=")";var l={node:e,changes:[{filterList:t,definition:a}]},o=this;this.model.setNodeValueChanges(l,(function(e){e&&(null==r?o.model.reevaluateNodesNeeded(o.tagId):r())}))},updateNodeDefinition:function(e,t,i,n){null==n&&(n=[]);var s={node:e,changes:[{filterList:n,definition:t}]},a=this;this.model.setNodeValueChanges(s,(function(e){e?null==i?(a.model.reevaluateNodesNeeded(a.tagId),r("#nodePropertiesDock").trigger("refreshNodeDefinition",[a.currentResult.nodeId])):i():(0,u.showMessage)((0,u.translate)("set_definition_error"),void 0,"error")}))},editTitle:function(){var e=r(this.tagId).find(".item-title").parent(),t=e.find("span.title"),i=r(this.tagId).find(".item-toolbar"),n={name:"1"==t.attr("data-emptyTitle")?"":t.text()},s=o(n);e.prepend(s),e.find("div.editor input").focus();var a=this,l=function(s){var l=r(s).val();l!=n.name&&(t.html(l),t.attr("title",l),a.setTitle(l)),e.find("div.editor").remove(),t.show(),""==t.text()?t.text("("+(0,u.translate)("click_to_add_title")+")").attr("data-emptyTitle","1"):t.removeAttr("data-emptyTitle"),i.css("display",""),a=null};e.find("div.editor input").focusout((function(){l(r(this))})),e.find("div.editor input").keypress((function(e){13==e.keyCode&&l(r(this))})),e.find("div.editor").click((function(e){e.stopPropagation()})),t.hide(),i.css("display","none")},setTitle:function(e){this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.title&&(this.currentResult.itemProperties.title.text=e,this.currentResult.itemProperties.title.isCustom=!0)},setViewDetail:function(e){this.currentResult&&this.currentResult.itemProperties&&(this.currentResult.itemProperties.detail=e),this.currentResult&&this.updateDetail(this.currentResult.dims,this.currentResult.rows,this.currentResult.columns)},toggleViewDetail:function(){this.currentResult&&this.currentResult.itemProperties&&this.setViewDetail(!this.currentResult.itemProperties.detail)},updateDetail:function(e,t,i){var n=this.currentResult.itemProperties.detail;this.getItemSize();if(n&&this.lastSizeKey&&this.sizeDic[this.lastSizeKey]&&this.sizeDic[this.lastSizeKey].hideDetail&&(n=!1),this.currentResult&&this.currentResult.itemProperties&&n){this.initializeDetailDrag();var s=[],a=this,l=function(e,t,i){r.each(e,(function(e,n){var l,o={field:n.field,name:n.name,values:(0,u.translate)("all"),unlinked:a.isUnlinkedIndex(n.field),hasLevels:n.levels&&n.levels.length>0,levels:n.levels},d=0,c="";n.numberFormat&&(l=new u.NovixFormatter(n.numberFormat)),r.each(n.values,(function(e,t){if(t.selected){var i=t.value;l&&"N"==t.type&&(i=l.format(i)),d++,""!=c&&(c+=", "),c+=i}})),0==d&&t?(o.isFirst=!0,o.dimType=i):1==d?o.values=c:d>0&&(o.values=(0,u.translate)("multiple"),o.filterValues=c),s.push(o)}))};l(t,!0,"row"),l(i,!0,"column"),l(e,!1);var o=h(s);r(this.tagId).find(".detail-area ul").html(o),r(this.tagId).find(".detail-area ul li a").tooltip(),a=null}else r(this.tagId).find(".detail-area ul").empty();this.baseUpdateSize(),this.updateSize()},showLoading:function(){this.hideLoading(),this.hideResetView(),r(this.tagId).append(m())},hideLoading:function(){clearTimeout(this.loadingTimeOut),this.loadingTimeOut=-1,r(this.tagId).find(".loading-pane").remove()},showResetView:function(e){var t=this;this.model.isResultComputed([e],(function(i){if(!i){var n=r(t.tagId);n.find(".reset-view-container").remove(),n.append(p({hasLightReset:t.hasLightReset}));var s=r(t.tagId).find(".light-reset-view");s.attr("data-node",e),s.one("click",(function(e){t.hideResetView();var i=r(e.currentTarget).attr("data-node");t.lightReset(i)}));var a=r(t.tagId).find(".hard-reset-view");a.attr("data-node",e),a.one("click",(function(e){t.hideResetView();var i=r(e.currentTarget).attr("data-node");t.initializeWithNode(i)}))}}))},hideResetView:function(){r(this.tagId).find(".reset-view-container").remove()},initializeDetailDrag:function(){if(!this.detailDragInitiated&&this.detailDraggable){this.detailDragInitiated=!0;var e=this;r(this.tagId).find("div.detail-area ul").sortable({helper:"clone",opacity:.8,cursor:"move",start:function(t,i){e.setPositionForDropDetails(),r(e.tagId).find(".drop-area").show()},stop:function(t,i){r(e.tagId).find(".drop-area").hide()}}),r(this.tagId).find(".drop-area .drop-item").droppable({accept:"div.detail-area ul li",hoverClass:"ui-state-active",drop:function(t,i){if(i&&i.draggable&&i.draggable.length>0&&e.currentResult&&e.currentResult.dims){var n=r(i.draggable[0]).attr("data-field"),s="column";r(this).hasClass("for-row")&&(s="row");var a=e.getRowIndex(),l=e.getColumnIndex();if("column"==s&&"complexchart"===e.currentResult.itemType)for(var o=!1,u=0;u<e.currentResult.itemProperties.nodesArray.length;u++){for(var d=0;d<e.currentResult.itemProperties.nodesArray[u].newDims.length;d++)e.currentResult.itemProperties.nodesArray[u].newDims[d].field==n&&(o=!0);if(!o)return}if("column"==s&&l&&l.field==n)return;if("row"==s&&a&&a.field==n)return;var c=[],h=[],m=[];"row"==s?(h.push(e.getIndexByField(n)),l&&l.field==n&&a?m.push(a):l&&l.field!=n&&m.push(l)):"column"==s&&(m.push(e.getIndexByField(n)),a&&a.field==n&&l?h.push(l):a&&a.field!=n&&h.push(a)),r.each(e.getIndexes(),(function(e,t){0!=h.length&&t==h[0]||0!=m.length&&t==m[0]||c.push(t)}));var p=e.getRowIndexField(),f=e.getColumnIndexField();e.updateOriginalRowCol(h,m,!0),e._evaluateNode(e.currentNodeId,c,h,m,"dropFilter"),e.synchronizeDrop(e.currentNodeId,p,f,c,h,m)}}})}},updateOriginalRowCol:function(e,t,i){e&&(i||e.length>0)&&(this.originalRow=r.extend({},e[0])),t&&(i||t.length>0)&&(this.originalCol=r.extend({},t[0]))},setBackgroundColor:function(e){this.currentResult&&(this.currentResult.itemProperties||(this.currentResult.itemProperties={})),this.currentResult.itemProperties.generalBackgroundColor=e,this.baseStyles()},setTitleBackgroundColor:function(e){if(!this.currentResult.itemProperties.title)return this.currentResult.itemProperties.title={text:"",enabled:!1,style:{color:null,backgroundColor:e}},this.currentResult.itemProperties.subtitle={text:"",style:{color:null,backgroundColor:null}},void this.baseStyles();this.currentResult.itemProperties.title.style.backgroundColor=e,this.baseStyles()},setSummaryBy:function(e){this.currentResult&&this.currentResult.itemProperties&&(this.currentResult.itemProperties.summaryBy=e,this.refreshItemDash())},onFilterChange:function(e,t,i,n,s,a){var l=this.getIndexByField(e);if(l&&(s||!this.isUnlinkedIndex(e))){if((i||n)&&(!this.model.isReadyForEvaluate(e,this.currentNodeId)||n))return;if(l.values=t,a){clearTimeout(this.filterChangeTimeout);var o=this;this.filterChangeTimeout=setTimeout((function(){r(o.tagId).trigger("evaluateNodeFromCurrentResult"),o=null}),a)}else r(this.tagId).trigger("evaluateNodeFromCurrentResult")}},onFiltersChange:function(e){for(var t=!1,i=0;i<e.length;i++){var n=e[i].field,s=e[i].values,a=this.getIndexByField(n);a&&(this.isUnlinkedIndex(n)||(a.values=s,t=!0))}t&&r(this.tagId).trigger("evaluateNodeFromCurrentResult")},isUnlinkedIndex:function(e){return this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.indexEvents&&(this.currentResult.itemProperties.indexEvents[e]||this.currentResult.itemProperties.indexEvents[e+"."+this.currentNodeId]||this.currentResult.itemProperties.indexEvents[String(e).split(".")[0]]||this.currentResult.itemProperties.indexEvents["".concat(String(e).split(".")[0],".").concat(this.currentNodeId)])},isDiagramView:function(){return!1},needRefresh:function(e){return!1},getNodesOfView:function(){if(this.currentNodeId)return[this.currentNodeId]},changeTitleColor:function(e){this.currentResult.itemProperties.title.style.color=e,this.baseStyles()},setNumberFormat:function(e){this.currentNodeId;this.currentResult.itemProperties.numberFormat=e,this.createFormatter(!0),this.applyNumberFormat()},copyWidgetFormat:function(){var e=r.extend(!0,{},this.currentResult.itemProperties);return e.title&&delete e.title.text,e.unit="",e},applyFormat:function(){var e=this;this.currentResult.itemProperties=r.extend(!0,{},this.currentResult.itemProperties,this.model.copiedWidgetFormat),"table"==this.currentResult.itemType&&r.each(this.currentResult.itemProperties.table.styles,(function(t,i){"_alltable_"!=i.index&&(i.index=e.model.copiedWidgetFormat.table.styles[t].index.split(".")[0]+"."+e.currentResult.nodeId)})),this.currentResult.itemType.indexOf("chart")>=0&&(this.chart.update(this.currentResult.itemProperties.axes,!0),this.chart.update(this.currentResult.itemProperties.labels,!0),this.chart.update(this.currentResult.itemProperties.legend,!0),this.chart.redraw(!0)),this.refreshItemDash()}},"setTitle",(function(e){var t=this.currentResult.itemProperties.unit?this.currentResult.itemProperties.unit:"";if(!this.currentResult.itemProperties.title)return this.currentResult.itemProperties.title={text:e,enabled:!1,style:{color:null,backgroundColor:null}},this.currentResult.itemProperties.subtitle={text:"",style:{color:null,backgroundColor:null}},r(this.tagId).find(".widgetTitle .item-title").text(this.currentResult.itemProperties.title.text+t),void this.baseStyles();this.currentResult.itemProperties.title.text=e,r(this.tagId).find(".widgetTitle .item-title").text(this.currentResult.itemProperties.title.text+t),this.baseStyles()})),c(g,"setTitleEnabled",(function(e){if(!this.currentResult.itemProperties.title)return this.currentResult.itemProperties.title={text:"",enabled:e,style:{color:null,backgroundColor:null}},this.currentResult.itemProperties.subtitle={text:"",style:{color:null,backgroundColor:null}},void this.baseStyles();this.currentResult.itemProperties.title.enabled=e,this.baseStyles()})),c(g,"changeSubtitleColor",(function(e){this.currentResult.itemProperties.subtitle.style.color=e,this.baseStyles()})),c(g,"addCreateItemHandlers",(function(){var e=this;r(this.tagId).on("click",".item-area .chartTypeSelector button",(function(t){if(!e.checkNodeOwner()){var n,s,a=r(this).attr("data-key");switch(a){case"columnchart":case"complexchart":case"table":case"nodetable":case"wizard":case"filter":var l=["variable","inputtable"];"wizard"==a&&(l=null,a=void 0),"filter"==a&&(l=["index","decision","inputnode"],a=void 0),function(e,t,n){i.e(31).then((function(){var r=[i(979)];(function(i){(new i).show(e,{callback:n,filteredClasses:t})}).apply(null,r)})).catch(i.oe)}(t,l,(function(t){var i=t.nodeId;"module"==t.nodeClass?e.createNewView({itemType:"objectItem",objectType:"diagramviewer",itemProperties:{diagramOptions:{currentModule:i}}}):e.initializeWithNode(i,a)}));break;case"inputform":n=t,s=function(t){var i=t.templateId,n=t.name;e.createNewView({itemType:"objectItem",objectType:"inputform",itemProperties:{templateId:i,inputForm:{templateId:i},title:{text:n,style:{color:"#000"},enabled:!0},subtitle:{style:{color:"#000"}}}})},i.e(49).then((function(){var e=[i(1172)];(function(e){(new e).show(n,{callback:s})}).apply(null,e)})).catch(i.oe);break;case"texteditor":case"diagramviewer":case"mapviewer":case"dashboardcontainer":var o=e.model.getItemModel(e.tagId),u=r(e.tagId).closest(".grid-stack-item");e.grid.remove_widget(u),o.grid=e.grid,o.currentResult.itemProperties={},o.currentResult.itemType="objectItem",o.currentResult.objectType=a,o.model=e.model,e.createNewView(o.currentResult)}}}))})),c(g,"resetView",(function(){this.checkNodeOwner()||this.createNewView({itemType:"empty"})})),c(g,"ensureOnlyDims",(function(e,t,i){e||(e=[]),t||(t=[]),i||(i=[]),t.length>0&&e.push(t.pop()),i.length>0&&e.push(i.pop()),r(this.tagId).trigger("updateOriginalRowCol")})),c(g,"ensureOneColumn",(function(e,t,i){e||(e=[]),t||(t=[]),i||(i=[]),t.length>0&&e.push(t.pop()),0==i.length&&e.length>0&&i.push(e.pop()),r(this.tagId).trigger("updateOriginalRowCol")})),c(g,"ensureOneRow",(function(e,t,i){e||(e=[]),t||(t=[]),i||(i=[]),i.length>0&&e.push(i.pop()),0==t.length&&e.length>0&&t.push(e.pop()),r(this.tagId).trigger("updateOriginalRowCol")})),c(g,"createFormatter",(function(e){this.currentResult.itemProperties.numberFormat&&(this.numberFormat=this.currentResult.itemProperties.numberFormat),this.numberFormatter&&!e||(this.numberFormatter=new u.NovixFormatter(this.numberFormat))})),c(g,"getIndexFormatter",(function(e,t){if(t&&e)for(var i=0;i<t.length;i++)if(String(t[i].field).split(".")[0].toLowerCase()==e.toLowerCase()||String(t[i].name).split(".")[0].toLowerCase()==e.toLowerCase())return t[i].numberFormat?new u.NovixFormatter(t[i].numberFormat):null;return null})),c(g,"secureFormatValue",(function(e){return this.numberFormatter||this.createFormatter(),this.numberFormatter.formatNumber(e)})),c(g,"clearItemProperties",(function(e){e&&(delete e.bottomTotal,delete e.rightTotal,delete e.defMode,delete e.timeFormat,delete e.timeFormatType,delete e.calendarType)})),c(g,"calculateScaleFactor",(function(e,t){var i=r(this.tagId).closest(".dashboard-area").width(),n=r(this.tagId).closest(".dashboard-area").height();this.scaleFactorW=1,e&&(this.scaleFactorW=i/e),this.scaleFactorH=1,t&&(this.scaleFactorH=n/t),this.maxScaleFactorW=this.scaleFactorW,this.maxScaleFactorW<.8?this.maxScaleFactorW=.8:this.maxScaleFactorW>1&&(this.maxScaleFactorW=1),this.maxScaleFactorH=this.scaleFactorH,this.maxScaleFactorH<.8?this.maxScaleFactorH=.8:this.maxScaleFactorH>1&&(this.maxScaleFactorH=1),r(this.tagId).closest(".main-fullscreen").length>0&&(this.maxScaleFactorH*=1.25,this.maxScaleFactorW*=1.25)})),c(g,"getItemSize",(function(){var e=r(this.tagId),t={w:e.width(),h:e.height()};return e=null,t})),c(g,"checkSizeDic",(function(){var e,t=this.getItemSize();for(var i in this.sizeDic){var n=this.sizeDic[i];if(t.w<n.w||t.h<n.h){e=i;break}}if(this.lastSizeKey&&this.lastSizeKey!=e){var s=this.lastSizeKey+"-"+e;this.lastSizeKey=e,this.sizeTransition[s]&&this.sizeTransition[s].reload?(r(this.tagId).trigger("evaluateNodeFromCurrentResult"),this.recreateItemDash()):this.sizeTransition.default&&this.sizeTransition.default.reload&&this.recreateItemDash()}this.lastSizeKey=e})),c(g,"viewInDiagram",(function(){var e=this.currentNodeId;e&&Promise.all([i.e(12),i.e(17),i.e(21)]).then((function(){var t=[i(698)];(function(t){(new t).showInDiagram(e)}).apply(null,t)})).catch(i.oe)})),c(g,"getTimeFrame",(function(){var e={};return this.currentResult&&this.currentResult.itemProperties&&(e.timeFormat=this.currentResult.itemProperties.timeFormat,e.timeFormatType=this.currentResult.itemProperties.timeFormatType,e.calendarType=this.currentResult.itemProperties.calendarType),e.timeFormat||(e.timeFormat="A"),e.timeFormatType||(e.timeFormatType="FLO"),e.calendarType||(e.calendarType="CAL"),e})),c(g,"synchronizeDrop",(function(e,t,i,n,r,s){this.model&&this.model.synchronizeDrop(e,t,i,n,r,s,this.tagId)})),c(g,"onSynchronizeDrop",(function(e,t,i,n,r,s){var a=this;if(this.currentNodeId==e&&!((t||this.getRowIndexField())&&this.getRowIndexField()!=t||(i||this.getColumnIndexField())&&this.getColumnIndexField()!=i)){var l=n.slice(0).map((function(e){return d({},e,{values:a.isUnlinkedIndex(e.field)?a.getIndexByField(e.field).values:e.values})})),o=r.slice(0).map((function(e){return d({},e,{values:a.isUnlinkedIndex(e.field)?a.getIndexByField(e.field).values:e.values})})),u=s.slice(0).map((function(e){return d({},e,{values:a.isUnlinkedIndex(e.field)?a.getIndexByField(e.field).values:e.values})}));this.updateOriginalRowCol(o,u,!0),this._evaluateNode(e,l,o,u)}})),c(g,"onSynchronizeLevel",(function(e,t){if(!this.isUnlinkedIndex(e)){var i=this.getIndexByField(e);i&&(i.currentLevel=t,i.values=[],this.refreshItemDash())}})),c(g,"openDocumentationModal",(function(){var e=this;Promise.resolve().then((function(){var t=[i(220)];(function(t){(new t).getNodeProperties(e.currentNodeId,[{name:"title"},{name:"description"}],(function(e){e&&i.e(6).then((function(){var t=[i(682)];(function(t){var i={id:e.node};for(var n in e.properties)"title"===e.properties[n].name&&(i.title=e.properties[n].value),"description"===e.properties[n].name&&(i.description=e.properties[n].value);(new t).openDocumentationModal({nodeData:i})}).apply(null,t)})).catch(i.oe)}))}).apply(null,t)})).catch(i.oe)})),c(g,"applyColumnLimits",(function(e){var t=this.getColumnLimits();if(e){var i=e.series.length,n=e.columns.categories.length,r=300;for(var s in t)if(i<=parseInt(s)){r=t[s];break}n>r&&(e.columns.categories=e.columns.categories.slice(0,r),e.series.forEach((function(e){e.data=e.data.slice(0,r)})),(0,u.showMessage)((0,u.translate)("truncated_columns").replace("##columns##",String(r)),void 0,"info",-1))}})),c(g,"isFromDiagram",(function(){if(this.model&&this.model.attributes){var e=this.model.attributes;return e.node&&""!==e.node&&null!==e.node}return!1})),g))}.apply(t,l))||(e.exports=o)}).call(this,i(219),i(1),i(1),i(221))},767:function(e,t,i){"use strict";(function(n){var r,s=i(679);void 0===(r=function(){return n.Model.extend({url:"knowledgeBase",getPost:function(e,t){(0,s.send)("KnowledgeBase/getPost?nodeId="+e,null,{type:"GET"},t)},search:function(e,t){(0,s.send)("KnowledgeBase/search",e,{type:"POST"},t)},generatePost:function(e,t){(0,s.send)("KnowledgeBase/generatePost?nodeId="+e,null,{type:"POST"},t)},updatePost:function(e,t){(0,s.send)("KnowledgeBase/updatePost",e,{type:"PUT"},t)},deleteAttachedFile:function(e,t){(0,s.send)("KnowledgeBase/deleteDocument?url="+e,null,{type:"DELETE"},t)}})}.apply(t,[]))||(e.exports=r)}).call(this,i(219))}}]);