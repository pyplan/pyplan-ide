/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[104,4],{683:function(n,t,e){"use strict";(function(i){var a;void 0===(a=function(){return i.Controller.extend({name:"showModal",show:function(n){Promise.all([e.e(2),e.e(116)]).then(function(){var t=[e(701)];(function(t){(new t).render(n)}).apply(null,t)}).catch(e.oe)}})}.apply(t,[]))||(n.exports=a)}).call(this,e(694))},688:function(n,t,e){"use strict";var i=e(18);n.exports=function(n){return(0,i.translate)(n)}},693:function(n,t,e){"use strict";e.r(t),function(n){e.d(t,"ajaxSetup",function(){return a}),e.d(t,"send",function(){return o});var i=e(18);function a(t=null){n.ajaxSetup({...{dataType:"json",crossDomain:!0,headers:{Authorization:`Token ${__currentToken}`,"session-key":__currentSession?__currentSession.session_key:""}},...()=>t||{}})}function o(t,a,o,s,r,c,l){o||(o=new Object),c||n("#secondLoading").show(),o.hasOwnProperty("success")||(o.success=function(t,i,a){if("object"!=typeof t&&null!=t&&""!=t)try{t=n.parseJSON(t)}catch(n){}c||(n("#mainLoading").hide(),n("#secondLoading").hide());var o=function(n,t,i,a,o){n&&n.hasOwnProperty("hasError")?(i||Promise.all([e.e(2),e.e(18)]).then(function(){var t=[e(685)];(function(t){(new t).show({title:"WARNING!",text:n.error,notifyType:"error"})}).apply(null,t)}).catch(e.oe),void 0!=o&&o(n.error)):void 0!=a&&a(n,t)};t&&t.hasOwnProperty("isCompressed")&&t.hasOwnProperty("obj")?e.e(103).then(function(){var i=[e(859)];(function(e){t=n.parseJSON(e.inflate(atob(t.obj),{to:"string"})),o(t,a,l,s,r)}).apply(null,i)}).catch(e.oe):o(t,a,l,s,r)}),o.hasOwnProperty("type")||(o.type="GET"),a&&(o.data=a),o.error=function(a,s,u){if(c||(n("#mainLoading").hide(),n("#secondLoading").hide()),a){let n="";const s=`[${o.type}] ${t}`;if(a.responseJSON)for(const t in a.responseJSON)n+="non_field_errors"==t?`${a.responseJSON[t]}\n`:`[${t}]: ${a.responseJSON[t]}\n`;else n=`${a.responseText}\n`;let c="info",u=void 0,d=void 0,f="WARNING!";const p=[];switch(a.status){case 401:c="info",d=15e3,u=(()=>{location.reload()}),p.push({css:"warning",code:"401",title:Object(i.translate)("relog")});break;case 403:c="info",d=1e4,f=Object(i.translate)("access_denied")}void 0!=l&&0!=l||Promise.all([e.e(2),e.e(18)]).then(function(){var t=[e(685)];(function(t){(new t).show({title:f,text:n,endpoint:s,notifyType:c,timeOut:d,buttons:p,callback:u})}).apply(null,t)}).catch(e.oe),void 0!=r&&r(n,a)}},n.ajax({url:`${__apiURL}/${t}`,contentType:o.contentType,data:a,dataType:o.dataType?o.dataType:"json",method:o.type,success:o.success,error:o.error})}}.call(this,e(1))},720:function(n,t,e){"use strict";n.exports=function(){return __apiURL}},801:function(n,t,e){"use strict";var i=e(18);n.exports=function(n){return(0,i.timeAgo)(n)}},858:function(n,t,e){"use strict";(function(i,a){var o,s=e(693);void 0===(o=function(){var n;return i.Model.extend({start:function(){n=setTimeout(function t(){(0,s.send)("notification/KeepAlive",null,null,function(e){if(e){var i=e.unread;a("#navigation .unreadNotifications").length>0&&(a("#navigation .unreadNotifications").text(i).hide(),i>0&&a("#navigation .unreadNotifications").show())}n=setTimeout(t,4e4)},void 0,!0)},1e3)},stop:function(){clearTimeout(n)},getNotifications:function(n){(0,s.send)("notification/",null,null,n)},markAsRead:function(n,t){(0,s.send)("notification/".concat(n,"/"),null,{type:"PATCH",dataType:"text"},t)}})}.apply(t,[]))||(n.exports=o)}).call(this,e(218),e(1))},883:function(n,t,e){"use strict";(function(i,a){var o,s,r=e(18);o=[e(858),e(986),e(683)],void 0===(s=function(n,t,e){return i.Controller.extend({name:"notificationManager",start:function(){var e=new n;e.start(),a("#navigation .btnNotification").on("click",function(){a("#navigation .notificationsList").empty(),a("#navigation .notificationsList").append("<li><a><div class='message'>"+(0,r.translate)("loading_notifications")+"</div></a></li>"),e.getNotifications(function(n){if(a("#navigation .notificationsList").empty(),n&&0!=n.length){var e=t(n);a("#navigation .notificationsList").append(e)}else a("#navigation .notificationsList").append("<li><a><div class='message'>"+(0,r.translate)("no_new_notifications")+"</div></a></li>")})}),a("#navigation .notificationsList").on("click","li a, li a .btnMarkAsRead",function(n){if(a(this).closest("li").hasClass("notificationItem")&&!a(this).closest("li.notificationItem").find("a").hasClass("read")){var t=a(this).closest("li").attr("data-id");e.markAsRead(t),a(this).closest("li").find("a").addClass("read");var i=parseInt(a("#navigation .unreadNotifications").text())-1;a("#navigation .unreadNotifications").text(i).show(),i<=0&&a("#navigation .unreadNotifications").hide()}if(a(this).hasClass("btnMarkAsRead"))return!1})},notify:function(n){(0,r.showMessage)(n.textMessage,(0,r.translate)("new_notification"),"info"),a("#navigation .unreadNotifications").text(parseInt(a("#navigation .unreadNotifications").text())+1).show()},showNotifications:function(){var t=new n,i=new e;t.getNotifications(function(n){n&&n.length>0&&i.show({title:"".concat((0,r.translate)("new_notification"),"!"),html:n[0].message,okOnEnter:!1,keyboard:!1,backdrop:"static",buttons:[{title:(0,r.translate)("accept"),css:"primary",code:"yes"}],callback:function(e){if("yes"!==e)return!1;t.markAsRead(n[0].id)}})})}})}.apply(t,o))||(n.exports=s)}).call(this,e(694),e(1))},986:function(n,t,e){var i=e(690);function a(n){return n&&(n.__esModule?n.default:n)}n.exports=(i.default||i).template({1:function(n,t,i,o,s){var r,c=n.lambda,l=n.escapeExpression,u=null!=t?t:n.nullContext||{};return'<li class="notificationItem" data-id="'+l(c(null!=t?t.notificationId:t,t))+'" data-messageType="'+l(c(null!=t?t.messageType:t,t))+'">\n    <a href="#" '+(null!=(r=i.if.call(u,null!=t?t.read:t,{name:"if",hash:{},fn:n.program(2,s,0),inverse:n.noop,data:s,loc:{start:{line:3,column:16},end:{line:3,column:49}}}))?r:"")+'>\n        \x3c!--img src="'+l(a(e(720)).call(u,{name:"baseURL",hash:{},data:s,loc:{start:{line:4,column:21},end:{line:4,column:32}}}))+"thumbs/view.ashx?img=users-"+l(c(null!=t?t.fromUserImageUrl:t,t))+'&w=43&h=43&t=cropt" alt="'+l(c(null!=t?t.fromUser:t,t))+'" title="'+l(c(null!=t?t.fromUser:t,t))+'" /--\x3e\n        <div class="details">\n            <div class="message">\n                <p>'+(null!=(r=c(null!=t?t.textMessage:t,t))?r:"")+'</p>\n                <span class="time">'+l(a(e(801)).call(u,null!=t?t.createdDate:t,{name:"timeAgo",hash:{},data:s,loc:{start:{line:8,column:35},end:{line:8,column:58}}}))+'</span>\n            </div>\n        </div>\n        <i class="far fa-circle btnMarkAsRead" title="'+l(a(e(688)).call(u,"mark_as_read",{name:"L",hash:{},data:s,loc:{start:{line:11,column:54},end:{line:11,column:74}}}))+'"></i>\n    </a>\n</li>\n'},2:function(n,t,e,i,a){return' class="read" '},compiler:[8,">= 4.3.0"],main:function(n,t,e,i,a){var o;return null!=(o=e.each.call(null!=t?t:n.nullContext||{},t,{name:"each",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:1,column:0},end:{line:14,column:9}}}))?o:""},useData:!0})}}]);