/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[130,6,280],{1036:function(e,t,n){"use strict";(function(a,i){var l,o,r=n(18);function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){d(e,t,n[t])}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}l=[n(725),n(220),n(662),n(1160),n(1161)],void 0===(o=function(e,t,n,l,o){return a.View.extend({el:i("#n_o_n_e"),field:"",tagId:"",currentLevel:"",currentView:void 0,currentPage:1,maxPage:1,dataSet:[],selectedItems:[],$modal:null,indexFormatter:null,render:function(e,a,i,o,s,d){this.currentLevel=s,this.field=e,this.tagId=i,this.currentView=o,d&&(this.indexFormatter=new r.NovixFormatter(d)),this.currentLevel||(this.currentLevel=this.field);var c=this,u=l();(new n).show({title:a,html:u,modalClass:"filterviewModal",buttons:[{title:(0,r.translate)("cancel"),code:"cancel"},{title:(0,r.translate)("_apply"),css:"primary",code:"ok"}],callback:function(e,t){"ok"==e&&c.applyFilters()},onClose:function(e){c.removeView()},onLoad:function(e){c.$modal=e,(0,r.postRender)(e),c.addHandlers(e),(new t).getNodeProperties(String(c.currentLevel).split(",")[0],[{name:"numberFormat",value:""}],(function(e){if(e&&e.properties&&e.properties.length>0){var t=e.properties[0].value;t&&!c.indexFormatter&&(c.indexFormatter=new r.NovixFormatter(t))}c.currentView&&(c.initializeSelectedFilters(),c.getData())}))}})},getData:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.filter,l=void 0===a?null:a,r=n.text1,d=void 0===r?null:r,c=n.text2,u=void 0===c?null:c,f=this,v=this.currentPage,m=i("p.loadingItems"),h=i("u.items");h.hide(),m.show();var p=new e;p.getIndexValues(s({id:this.currentLevel},v?{page:v}:null,l?{filter:l}:null,d?{text1:d}:null,u?{text2:u}:null),(function(e){t.maxPage=e.count/e.results.length,t.$modal.find(".info").toggle(e.count>1e3),e.results.forEach((function(e){f.indexFormatter?e.formattedValue=f.indexFormatter.format(e.value):e.formattedValue=e.value}));var n=t.selectedItems.map((function(e){return e.value}));t.dataSet=e.results.filter((function(e){return!n.includes(e.value)})).sort((function(e,t){var n=e.value,a=t.value;return parseInt(n)&&parseInt(a)?n-a:n.localeCompare("".concat(a))}));var a=i("div.filterlist ul");a.find("li").remove(),a.append(o({items:t.dataSet})),a.perfectScrollbar();var l=t.$modal.find("div.selectedList ul");l.find("li").remove(),l.append(o({items:t.selectedItems})),l.perfectScrollbar(),m.hide(),h.show(),setTimeout((function(){t.$modal.find("input.filterText1").focus()}),500)}),this.currentView.getTimeFrame())},removeView:function(){this.currentView=null,this.$modal.find("div.filterlist ul li").off("click"),this.$modal.find("div.selectedList ul li").off("click")},addHandlers:function(e){var t=this,n=this.$modal.find("div.selectedList ul"),a=i("div.filterlist ul"),l=e.find(".actionselected");e.find(".actionselector li a").on("click",(function(e){e.preventDefault();var n=e.currentTarget.getAttribute("data-rel"),a=i(e.currentTarget).text();l.html(a).attr("title",a).attr("data-action",n),t.filterItems(n)}));var r=null;e.find(".filterText1").on("keyup",(function(){clearTimeout(r),r=setTimeout((function(){t.filterItems(l.attr("data-action"))}),700)})),e.find(".selectAll").on("click",(function(){return t.selectedItems=t.selectedItems.concat(t.dataSet),t.selectedItems.sort((function(e,t){return parseInt(e.value)&&parseInt(t.value)?e.value-t.value:e.value.localeCompare("".concat(t.value))})),n.find("li").remove(),n.append(o({items:t.selectedItems})),t.dataSet=[],a.find("li").remove(),!1})),e.find(".selectNone").on("click",(function(){return t.dataSet=t.dataSet.concat(t.selectedItems),t.dataSet.sort((function(e,t){return parseInt(e.value)&&parseInt(t.value)?e.value-t.value:e.value.localeCompare("".concat(t.value))})),a.find("li").remove(),a.append(o({items:t.dataSet})),t.selectedItems=[],n.find("li").remove(),!1})),e.find("button.prev-page,.next-page").on("click",(function(e){switch(e.preventDefault(),e.currentTarget.getAttribute("data-action")){case"prev":t.currentPage>1&&(t.currentPage-=1);break;case"next":t.currentPage<t.maxPage&&(t.currentPage+=1)}t.getData()})),a.on("click","li",(function(e){e.preventDefault();var a=i(e.currentTarget),l=a.find("span")[0].getAttribute("data-value");a.remove();var r=t.dataSet.find((function(e){return e.value===l}));t.dataSet=t.dataSet.filter((function(e){return e.value!==l})),t.selectedItems.push(r),t.selectedItems.sort((function(e,t){return parseInt(e.value)&&parseInt(t.value)?e.value-t.value:e.value.localeCompare("".concat(t.value))})),n.find("li").remove(),n.append(o({items:t.selectedItems}))})),n.on("click","li",(function(e){e.preventDefault();var n=i(e.currentTarget),l=n.find("span")[0].getAttribute("data-value");n.remove();var r=t.selectedItems.find((function(e){return e.value===l}));t.selectedItems=t.selectedItems.filter((function(e){return e.value!==l})),t.dataSet.push(r),t.dataSet.sort((function(e,t){return parseInt(e.value)&&parseInt(t.value)?e.value-t.value:e.value.localeCompare("".concat(t.value))})),a.find("li").remove(),a.append(o({items:t.dataSet}))}))},filterItems:function(e){var t=this.$modal.find("input.filterText1").val().toLowerCase();this.currentPage=1,this.getData({filter:e,text1:t})},initializeSelectedFilters:function(){var e=this,t=i(this.el).data("filters");if(this.currentView){var n=this.currentView.getIndexByField(this.field);n&&(t=n.values)}this.selectedItems=t.map((function(t){return s({},t,{formattedValue:e.indexFormatter?e.indexFormatter.format(t.value):t.value})})).sort((function(e,t){return parseInt(e.value)&&parseInt(t.value)?e.value-t.value:e.value.localeCompare("".concat(t.value))}))},applyFilters:function(){this.selectedItems=this.selectedItems.map((function(e){return s({},e,{selected:!0})})),this.currentView.model.onFilterChange(this.field,this.selectedItems,void 0,void 0,this.tagId)}})}.apply(t,l))||(e.exports=o)}).call(this,n(219),n(1))},1160:function(e,t,n){var a=n(669);function i(e){return e&&(e.__esModule?e.default:e)}e.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(e,t,a,l,o){var r=null!=t?t:e.nullContext||{},s=e.escapeExpression;return'<div class="filterview unselectable">\n  <div class="row filterRow">\n    <div class="col-xs-12">\n      <div class="input-group">\n        <div class="input-group-btn">\n          <button class="btn dropdown-toggle" data-toggle="dropdown">\n            <span class="actionselected" data-action="contains">'+s(i(n(667)).call(r,"contains",{name:"L",hash:{},data:o,loc:{start:{line:7,column:64},end:{line:7,column:80}}}))+'</span>\n            <span class="caret"></span>\n          </button>\n          <ul class="dropdown-menu actionselector">\n            <li>\n              <a href="#" data-rel="contains">'+s(i(n(667)).call(r,"contains",{name:"L",hash:{},data:o,loc:{start:{line:12,column:46},end:{line:12,column:62}}}))+'</a>\n            </li>\n            <li>\n              <a href="#" data-rel="notcontains">'+s(i(n(667)).call(r,"not_contain",{name:"L",hash:{},data:o,loc:{start:{line:15,column:49},end:{line:15,column:68}}}))+'</a>\n            </li>\n          </ul>\n        </div>\n        <input class="form-control filterText1" type="text" autofocus="true" />\n      </div>\n    </div>\n  </div>\n  <div class="row nomargin">\n    <div class="col-xs-6">\n      <div class="row">\n        <div class="col-xs-8">\n          <p class="listTitle">Available Items</p>\n        </div>\n        <div class="col-xs-4" style="text-align: right;">\n          <a href="#" class="btn btn-mini btn-lime selectAll">'+s(i(n(667)).call(r,"_all",{name:"L",hash:{},data:o,loc:{start:{line:30,column:62},end:{line:30,column:74}}}))+'</a>\n        </div>\n      </div>\n      <div class="filterlist">\n        <p class="loadingItems">'+s(i(n(667)).call(r,"loading",{name:"L",hash:{},data:o,loc:{start:{line:34,column:32},end:{line:34,column:47}}}))+'</p>\n        <ul class="items"></ul>\n      </div>\n    </div>\n    <div class="col-xs-6">\n      <div class="row">\n        <div class="col-xs-8">\n          <p class="listTitle">Selected Items</p>\n        </div>\n        <div class="col-xs-4" style="text-align: right;">\n          <a href="#" class="btn btn-mini btn-lime selectNone">'+s(i(n(667)).call(r,"_none",{name:"L",hash:{},data:o,loc:{start:{line:44,column:63},end:{line:44,column:76}}}))+'</a>\n        </div>\n      </div>\n      <div class="selectedList">\n        <p class="loadingItems">'+s(i(n(667)).call(r,"loading",{name:"L",hash:{},data:o,loc:{start:{line:48,column:32},end:{line:48,column:47}}}))+'</p>\n        <ul class="items"></ul>\n      </div>\n    </div>\n  </div>\n  <div class="row info form-group" style="display: none;">\n    <div class="col-xs-12">\n      <div class="alert alert-warning">\n        <span class="truncated">'+s(i(n(667)).call(r,"truncated_list_to_the_first_1000_elements",{name:"L",hash:{},data:o,loc:{start:{line:64,column:32},end:{line:64,column:81}}}))+"</span>\n      </div>\n    </div>\n  </div>\n</div>"},useData:!0})},1161:function(e,t,n){var a=n(669);e.exports=(a.default||a).template({1:function(e,t,n,a,i){var l,o=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,s=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<li>\n    <span data-value="'+s("function"==typeof(l=null!=(l=d(n,"value")||(null!=t?d(t,"value"):t))?l:r)?l.call(o,{name:"value",hash:{},data:i,loc:{start:{line:3,column:22},end:{line:3,column:31}}}):l)+'">'+s("function"==typeof(l=null!=(l=d(n,"formattedValue")||(null!=t?d(t,"formattedValue"):t))?l:r)?l.call(o,{name:"formattedValue",hash:{},data:i,loc:{start:{line:3,column:33},end:{line:3,column:51}}}):l)+"</span>\n</li>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,a,i){var l,o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(l=o(n,"each").call(null!=t?t:e.nullContext||{},null!=t?o(t,"items"):t,{name:"each",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i,loc:{start:{line:1,column:0},end:{line:5,column:9}}}))?l:""},useData:!0})},662:function(e,t,n){"use strict";(function(a){var i;void 0===(i=function(){return a.Controller.extend({name:"showModal",show:function(e){Promise.all([n.e(2),n.e(229)]).then((function(){var t=[n(685)];(function(t){(new t).render(e)}).apply(null,t)})).catch(n.oe)}})}.apply(t,[]))||(e.exports=i)}).call(this,n(676))},725:function(e,t,n){"use strict";(function(a,i){var l,o=n(678);void 0===(l=function(){return a.Model.extend({defaults:{dashId:null,dashboardViewList:[],modifiedDash:!1,noQuery:[],styleLibraries:[],nodeOwner:"",extraOptions:void 0},resizeTimeOut:0,getDashboard:function(e,t){(0,o.send)("dashboardManager/by_id/".concat(e,"/"),null,null,(function(e){e&&(t(e),i("#summary").trigger("refresh"))}))},getNavigator:function(e,t){var n=e.reportId,a=void 0===n?null:n,i=e.dashboardId,l=void 0===i?null:i,r="";a?(r="?report_id=".concat(a),l&&(r+="&dashboard_id=".concat(l))):l&&(r="?dashboard_id=".concat(l)),(0,o.send)("reportManager/getNavigator/".concat(r),null,null,t)},calculateScaleFactor:function(e,t){if(this.getItemsModel().length>0)for(var n=this.getItemsModel(),a=0;a<n.length;a++)n[a].calculateScaleFactor(e,t)},updateSizes:function(e,t){if(this.getItemsModel().length>0){var n=300;t&&(n=1),clearTimeout(this.resizeTimeOut);var a=this.getItemsModel();this.resizeTimeOut=setTimeout((function(){var e;for(e=0;e<a.length;e++)a[e].baseUpdateSize(),a[e].updateSize()}),n)}},setStateModified:function(e){this.set({modifiedDash:e})},getStateModified:function(){return this.get("modifiedDash")},addItemToModel:function(e){this.get("dashboardViewList").push(e)},getItemsModel:function(){return this.get("dashboardViewList")},getItemModel:function(e){var t,n=this.getItemsModel();for(t=0;t<n.length;t++)if(n[t].tagId==e)return n[t]},countItemsModelByNodeId:function(e){for(var t=0,n=this.getItemsModel(),a=0;a<n.length;a++)n[a].currentNodeId&&e&&n[a].currentNodeId.toLowerCase()==e.toLowerCase()&&t++;return t},removeItemModel:function(e){var t,n=this.getItemsModel();for(t=0;t<n.length;t++)if(n[t].tagId==e.tagId){n.splice(t,1);break}this.set({dashboardViewList:n})},removeAllItemsModel:function(){this.set("dashboardViewList",[])},changeItemModel:function(e,t){this.removeItemModel(e),this.addItemToModel(t)},setNodeOwner:function(e){this.set("node",e)},getNodeOwner:function(){return this.get("node")},onFilterChange:function(e,t,n,a,i,l){if(i){var o=this.getItemModel(i);if(o&&o.isUnlinkedIndex(e))return void o.onFilterChange(e,t,n,a,!0)}var r=this.getItemsModel();if(r)for(var s=0;s<r.length;s++)r[s].onFilterChange(e,t,n,a,!1,l)},onFiltersChange:function(e){var t=this.getItemsModel();if(t)for(var n=0;n<t.length;n++)t[n].onFiltersChange(e)},synchronizeDrop:function(e,t,n,a,i,l,o){if(o){var r=this.getItemsModel();if(r)for(var s=0;s<r.length;s++)r[s].tagId&&r[s].tagId!=o&&r[s].onSynchronizeDrop(e,t,n,a,i,l)}},synchronizeLevel:function(e,t,n){if(n){var a=this.getItemsModel();if(a)for(var i=0;i<a.length;i++)a[i].tagId&&a[i].tagId!=n&&a[i].onSynchronizeLevel(e,t)}},getNodeFullData:function(e,t,n,a){var i={node:e};t&&(i.fromRow=1,i.toRow=t),(0,o.send)("dashboardManager/getNodeFullData/",i,{type:"GET"},n,a)},getNodeIndexes:function(e,t){(0,o.send)("dashboardManager/getNodeIndexes/",{node:e},null,(function(e){e&&t(e)}))},getIndexValues:function(e,t){(0,o.send)("dashboardManager/getIndexValues/",e,null,(function(e){e&&t(e)}))},getGeoDef:function(e,t){(0,o.send)("Dashboard/GetGeoDef/"+e,null,null,(function(e){e&&t(e)}))},evaluateNode:function(e,t,n,a,i,l,r,s,d,c,u,f,v,m,h,p){s||(s="sum");var g={node:e,dims:t,rows:n,columns:a,summaryBy:s,bottomTotal:u,rightTotal:f,timeFormat:v,timeFormatType:m,calendarType:h,resultType:p},I="evaluateNode";l&&(I="evaluateNodeDef"),d&&d>0&&c&&c>0&&(g.fromRow=d*(c-1)+1,g.toRow=d*c),(0,o.send)("dashboardManager/".concat(I,"/"),JSON.stringify(g),{type:"POST",contentType:"application/json;charset=utf-8"},i,r)},evaluateNodeForPivot:function(e,t,n,a){(0,o.send)("Dashboard/EvaluateNodeForPivot/",{node:e},{type:"GET"},(function(e){var l=e.value,o={success:function(e,n,a){t(e)},complete:function(){i("#mainLoading").hide(),i("#secondLoading").hide(),n()},dataType:"json",progress:function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;a(t)}else try{var n=this.getResponseHeader("X-Content-Length");t=e.loaded/n*100;a(t)}catch(e){}}};i("#secondLoading").show(),i.ajax("".concat(__apiURL,"/scripts/download.aspx?name=").concat(l),o)}),n)},updateDefinition:function(e,t,n,a){var l=[];n&&i.each(n,(function(e,t){l.push({id:t})}));var r={dashboardId:e,definition:t,styles:n};(0,o.send)("dashboardManager/".concat(e,"/"),JSON.stringify(r),{type:"PATCH",contentType:"application/json;charset=utf-8",dataType:"text"},(function(e){null!=a&&a(e)}))},updateDashboardImage:function(e,t,n){var a={id:e,fileData:t};(0,o.send)("Dashboard/UpdateImage/",a,{type:"PUT"},(function(t){i("#summary").trigger("refresh"),i("#model-summary").trigger("refresh",{id:e}),t&&n&&n(t)}))},validateIndexes:function(e,t){var n=function(t){var n;for(n=0;n<e.length;n++)if(e[n].field==t)return e[n]},a=function(e){var t,a;for(t=0;t<e.length;t++)null!=(a=n(e[t].field))&&(e[t].name=a.name)};a(t.dims),a(t.rows),a(t.columns)},initializeDashboardQuery:function(e){this.set("noQuery",e),this._initNoQuery()},_initNoQuery:function(){var e=this.get("noQuery");e&&e.length>0&&i.each(e,(function(e,t){t.started=!1}))},isReadyForEvaluate:function(e,t){var n=!0,a=this.get("noQuery");return a&&a.length>0&&i.each(a,(function(a,i){i.node==e?i.started=!0:0==i.started&&i.rel&&i.rel.indexOf(t)>=0&&(n=!1)})),n},setNodeValueChanges:function(e,t){(0,o.send)("dashboardManager/pivotGrid/setCubeChanges/",JSON.stringify(e),{type:"POST",contentType:"application/json;charset=utf-8"},(function(e){t(e),i("body").trigger("pendingChanges",[!0])}))},isResultComputed:function(e,t){(0,o.send)("dashboardManager/isResultComputed/",JSON.stringify({nodes:e}),{type:"POST",contentType:"application/json;charset=utf-8"},(function(e){t(e)}))},reevaluateNodesNeeded:function(e){i(".dashboardTask").trigger("reevaluateNodesNeeded",[e])},reevaluateNodesNeededInThisDashboard:function(e){for(var t=[],n=this.getItemsModel(),a=0;a<n.length;a++){var l=n[a].getNodesOfView();l&&(t=t.concat(l))}t.length>0&&this.isResultComputed(t,(function(t){if(t&&t.length>0)for(var a=0;a<n.length;a++)e&&n[a].tagId==e||(t.indexOf(n[a].currentNodeId)>=0&&i(n[a].tagId).trigger("evaluateNodeFromCurrentResult"),n[a].needRefresh(t)&&n[a].refreshItemDash())}))},applyNumberFormat:function(e){for(var t=this.getItemsModel(),n=0;n<t.length;n++)t[n].currentNodeId==e&&t[n].applyNumberFormat()},getStyleLibrary:function(e){var t=this.get("styleLibraries");if(t)for(var n=0;n<t.length;n++)if(t[n].id==e)return t[n].definition;return[]},getStyleLibraries:function(){return this.get("styleLibraries")},setStyleLibraries:function(e){return this.set("styleLibraries",e)},refreshStyleLibraries:function(e){var t=this;n.e(87).then((function(){var a=[n(748)];(function(n){(new n).list(null,(function(n){t.set("styleLibraries",n),e(n)}))}).apply(null,a)})).catch(n.oe)},syncDrilldown:function(e,t,n){var a=this.getItemsModel();if(a)for(var i=0;i<a.length;i++)a[i].tagId!=n&&a[i].syncDrilldown(e,t,n)},syncDrillUp:function(e,t){var n=this.getItemsModel();if(n)for(var a=0;a<n.length;a++)n[a].tagId!=t&&n[a].syncDrillup(e,t)},syncShowHideLegend:function(e,t,n){},viewAsChart:function(e,t){(0,o.send)("Dashboard/viewAsChart/",e,{type:"POST"},t)}})}.apply(t,[]))||(e.exports=l)}).call(this,n(219),n(1))}}]);