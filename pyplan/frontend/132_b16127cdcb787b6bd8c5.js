/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[132,6],{2376:function(e,n,t){"use strict";(function(l,o){var i,a,c=t(18);i=[t(707),t(662),t(2377),t(2378)],void 0===(a=function(e,n,t,i){return l.View.extend({el:o("#n_o_n_e"),field:"",tagId:"",fileManagerModel:new e,currentView:void 0,render:function(e,l){var a=this;a.path=e;var r=t();(new n).show({title:(0,c.translate)("denied_departments"),html:r,modalClass:"filterviewModal",buttons:[{title:(0,c.translate)("cancel"),code:"cancel"},{title:(0,c.translate)("deny"),css:"red",code:"red"}],callback:function(e,n){"ok"==e&&a.applyFilters(n,l)},onClose:function(e){a.removeView(e)},onLoad:function(n){(0,c.postRender)(n),a.addHandlers(n),a.fileManagerModel.getDepartments((function(t){var l=i(t={items:t}),r=o("div.filterlist ul");r.selectonic({multi:!0,keyboard:!0,keyboardMode:"toggle",mouseMode:"toggle",focusOnHover:!0,selectionBlur:!1,focusBlur:!1,select:function(e,n){},unselectAll:function(e,n){}}),n.find("div.filterlist ul").append(l),r.perfectScrollbar(),a.initializeSelectedFilters(e,n),(0,c.postRender)(n.find("div.filterlist ul")),setTimeout((function(){n.find("input[name='filterText1']").focus()}),500)}))}})},removeView:function(e){this.currentView=null},addHandlers:function(e){e.find(".selectAll").on("click",(function(){e.find("div.filterlist ul li:visible").each((function(e,n){o(n).addClass("j-selected")}))})),e.find(".selectNone").on("click",(function(){e.find(".filterlist ul li").each((function(e,n){o("div.filterlist ul").selectonic("unselect",n)}))}))},initializeSelectedFilters:function(e,n){this.fileManagerModel.getDeniedDepartments(e,(function(e){e&&e.forEach((function(e){n.find(".filterlist ul li").each((function(n,t){parseInt(o(t).find("span").attr("data-rel"))===e.id&&o("div.filterlist ul").selectonic("select",t)}))}))}))},applyFilters:function(e,n){var t=this,l=[];e.find(".filterlist ul li.j-selected").each((function(e,n){l.push(o(n).find("span").attr("data-rel"))}));var i={folder:this.path,departments:l};this.fileManagerModel.setDeniedPath(i,(function(e){n(t.path,e)}))}})}.apply(n,i))||(e.exports=a)}).call(this,t(219),t(1))},2377:function(e,n,t){var l=t(669);function o(e){return e&&(e.__esModule?e.default:e)}e.exports=(l.default||l).template({compiler:[8,">= 4.3.0"],main:function(e,n,l,i,a){var c=null!=n?n:e.nullContext||{},r=e.escapeExpression;return'<div class="filterview unselectable">\n  <div class="row" style="padding: 10px 0;">\n    <div class="col-sm-12">\n      <div class="form-group">\n        <label for="textfield" class="control-label col-sm-1" style="padding-top: 4px;">Select:</label>\n        <div class="col-sm-11">\n          <a href="#" class="btn btn-small btn-lime selectAll">'+r(o(t(667)).call(c,"_all",{name:"L",hash:{},data:a,loc:{start:{line:7,column:63},end:{line:7,column:75}}}))+'</a>\n\n          <a href="#" class="btn btn-small btn-lime selectNone">'+r(o(t(667)).call(c,"_none",{name:"L",hash:{},data:a,loc:{start:{line:9,column:64},end:{line:9,column:77}}}))+'</a>\n        </div>\n      </div>\n\n\n    </div>\n  </div>\n  <div class="filterlist">\n      <ul></ul>\n  </div>\n</div>\n'},useData:!0})},2378:function(e,n,t){var l=t(669);e.exports=(l.default||l).template({1:function(e,n,t,l,o){var i,a=null!=n?n:e.nullContext||{},c=e.hooks.helperMissing,r=e.escapeExpression,s=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<li>\n  <span data-rel="'+r("function"==typeof(i=null!=(i=s(t,"id")||(null!=n?s(n,"id"):n))?i:c)?i.call(a,{name:"id",hash:{},data:o,loc:{start:{line:3,column:18},end:{line:3,column:24}}}):i)+'">'+r("function"==typeof(i=null!=(i=s(t,"name")||(null!=n?s(n,"name"):n))?i:c)?i.call(a,{name:"name",hash:{},data:o,loc:{start:{line:3,column:26},end:{line:3,column:34}}}):i)+"</span>\n</li>\n"},compiler:[8,">= 4.3.0"],main:function(e,n,t,l,o){var i,a=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return null!=(i=a(t,"each").call(null!=n?n:e.nullContext||{},null!=n?a(n,"items"):n,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:0},end:{line:5,column:9}}}))?i:""},useData:!0})},662:function(e,n,t){"use strict";(function(l){var o;void 0===(o=function(){return l.Controller.extend({name:"showModal",show:function(e){Promise.all([t.e(2),t.e(229)]).then((function(){var n=[t(685)];(function(n){(new n).render(e)}).apply(null,n)})).catch(t.oe)}})}.apply(n,[]))||(e.exports=o)}).call(this,t(676))},707:function(e,n,t){"use strict";(function(l){var o,i=t(678);void 0===(o=function(){return l.Model.extend({url:"myFileManager",getMainFolders:function(e){(0,i.send)("fileManager/getMainFolders/",null,{type:"GET"},e)},getFiles:function(e,n){(0,i.send)("fileManager/getFiles/?folder=".concat(encodeURIComponent(e)),null,{type:"GET"},n)},createFolder:function(e,n,t){(0,i.send)("fileManager/createFolder/",{folder_path:e,folder_name:n},{type:"POST"},t)},deleteFiles:function(e,n){(0,i.send)("fileManager/deleteFiles/",JSON.stringify({sources:e}),{type:"DELETE",contentType:"application/json",dataType:"text"},n)},renameFiles:function(e,n,t){(0,i.send)("fileManager/renameFile/?source=".concat(encodeURIComponent(e),"&newName=").concat(n),null,{type:"GET"},t)},unzipFile:function(e,n,t){(0,i.send)("fileManager/unzipFile/?source=".concat(e,"&targetFolder=").concat(encodeURIComponent(n)),null,{type:"GET",dataType:"text"},t)},moveFiles:function(e,n,t){var l=e.map((function(e){return"sources=".concat(e)})).join("&");(0,i.send)("fileManager/moveFiles/?".concat(l,"&target=").concat(encodeURIComponent(n)),null,{type:"GET",dataType:"text"},t)},copyToMyWorkspace:function(e,n){(0,i.send)("fileManager/copyToMyWorkspace/?source="+encodeURIComponent(e),null,{type:"GET",dataType:"text"},n)},copyFiles:function(e,n,t){var l=e.map((function(e){return"sources=".concat(e)})).join("&");(0,i.send)("fileManager/copyFiles/?".concat(l,"&target=").concat(encodeURIComponent(n)),null,{type:"GET",dataType:"text"},t)},duplicateFiles:function(e,n){var t=e.map((function(e){return"sources=".concat(e)})).join("&");(0,i.send)("fileManager/duplicateFiles/?".concat(t),null,{type:"GET"},n)},zipFiles:function(e,n){var t=e.map((function(e){return"sources=".concat(e)})).join("&");(0,i.send)("fileManager/zipFiles/?".concat(t),null,{type:"GET",dataType:"text"},n)},downloadFiles:function(e,n){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){},c=e.map((function(e){return"sources=".concat(e)})).join("&"),r=new XMLHttpRequest;r.responseType="arraybuffer",r.open("GET","".concat(__apiURL,"/fileManager/download/?").concat(c),!0),r.setRequestHeader("Authorization","Token ".concat(__currentToken)),r.setRequestHeader("session-key",__currentSession?__currentSession.session_key:""),r.onloadstart=l,r.onreadystatechange=function(e){var l=e.currentTarget;l.onprogress=o,l.onerror=a,l.onloadend=i,l.readyState==l.DONE&&(200==l.status?n(l):t.e(18).then((function(){var e=[t(664)];(function(e){(new e).show({title:"ERROR!",text:l.response,notifyType:"error"})}).apply(null,e)})).catch(t.oe))},r.send()},getDepartments:function(e){(0,i.send)("departments/by_current_company/",null,{type:"GET"},e)},getDeniedDepartments:function(e,n){(0,i.send)("departments/denied/?folder=".concat(encodeURIComponent(e)),null,{type:"GET"},n)},setDeniedPath:function(e,n){(0,i.send)("departments/deny_items/",JSON.stringify(e),{type:"POST",contentType:"application/json;charset=utf-8"},n)},optimzeTemplates:function(e,n,t){var l=e.map((function(e){return"sources=".concat(e)})).join("&");(0,i.send)("fileManager/optimizeTemplates/?".concat(l),null,{type:"GET",dataType:"text"},n,t)}})}.apply(n,[]))||(e.exports=o)}).call(this,t(219))}}]);