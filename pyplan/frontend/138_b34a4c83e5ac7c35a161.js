/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[138,26,27],{2358:function(e,t,n){"use strict";(function(a,i,s){var o,l,r,c=n(18),d=(r=n(223))&&r.__esModule?r:{default:r};function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}o=[n(663),n(1380),n(707),n(712),n(720),n(2359)],void 0===(l=function(e,t,o,l,r,u){return a.View.extend({el:i("#main"),myFileManager:new t,userManagerModel:new l,companyManagerModel:new r,currentPath:"",selectedFiles:[],selectedItems:[],currentNodeId:null,disableDragAndDrop:!1,myWorkspaceId:"",showHiddenFiles:!1,initialize:function(){},render:function(){var t=new e,a=u({showHiddenFiles:this.showHiddenFiles,notDesktop:!1});this.$el.append(a);var s=this;s.optimizableTemplates=[],t.hideAllTasks(),t.selectTask("file-manager2");var l=i("#tree-container"),r=i("#file-list"),c=i("#file-manager-wrapper .box-content"),d=i("#right-column");l.resizable({minWidth:100,maxWidth:450,handles:"e",resize:function(e,t){var n=i("#file-manager-wrapper");i("#right-column").css({width:n.width()-(t.size.width+20)})}}),l.perfectScrollbar(),r.perfectScrollbar();var p=function(){var e=i(window).height()-95,t=i(".page-header").height();l.height(e-t),r.height(e-(t+120)),c.height(e-t),d.height(e+20),l.perfectScrollbar("update"),r.perfectScrollbar("update")};i(window).resize(p),p(),this.getThis().on("removeView",(function(){s.onRemoveView()})),this.getThis().on("beforeRemoveView",(function(e,t){s.onBeforeRemoveView(e,t)})),this.disableAllActionsButtons();var f=new o;i("#tree").jstree({plugins:["wholerow","types"],types:{default:{icon:"fa fa-folder"},folder:{icon:"fa fa-folder"},shared:{icon:"fa fa-users"},recent:{icon:"fa fa-clock"},favs:{icon:"fa fa-star"},trash:{icon:"fa fa-trash"},file:{icon:"fa fa-file"},myfolder:{icon:"fa fa-user"},public:{icon:"fa fa-globe"},teams:{icon:"fa fa-group"},zip:{icon:"fa-file-archive-o"},modelsPath:{icon:"fa fa-cubes"},model:{icon:"fa fa-cube"}},core:{check_callback:!0,themes:{name:"proton",responsive:!0},data:function(e,t){"#"===e.id?f.getMainFolders((function(e){for(var n=0;n<e.length;n++)e[n].id="anchor_".concat(e[n].data.fullPath),0===n&&(s.currentNodeId=e[n].id);null!==e&&(e=s.optimizeStructureForTree(e,"tree"),t.call(this,e),s.openRootNodes(e))})):f.getFiles(e.data.fullPath,(function(e){if(null!==e){var n=s.optimizeStructureForTree(e,"tree");t.call(this,n)}}))}},sort:function(e,t){var n=this.get_node(e),a=this.get_node(t);return["public","folder"].includes(n.type)&&"#"!==n.parent&&"public"===n.text.toLowerCase()?-1:["public","folder"].includes(a.type)&&"#"!==a.parent&&"public"===a.text.toLowerCase()?1:n.icon==a.icon?n.text>a.text?1:-1:n.icon>a.icon?1:-1}}).on("changed.jstree",(function(e,t){if(t.node){var n=t.node.data.fullPath;s.updateBreadcrumb(n),s.normalizeSelection(),f.getFiles(n,(function(e){null!==e&&(e=s.optimizeStructureForTree(e,"list"),s.getFolders(e))})),s.disableAllActionsButtons()}})).on("create_node.jstree",(function(e,t){})),this.createUploader(),n.e(267).then((function(){var e=[n(2661)];(function(e){e.initialize()}).apply(null,e)})).catch(n.oe),this.addHandlers(),this.getViewModePreference()},addHandlers:function(){var e=this,t=this,n=this.getThis();n.find("#btnNewFolder").on("click",(function(){return t.newFolder(t),!1})),n.find(".rename").on("click",(function(){return t.rename(t),!1})),n.find(".download").on("click",(function(){return t.download(t),!1})),n.find(".delete-file").on("click",(function(){return t.deleteFile(t),!1})),n.find(".unzip").on("click",(function(){return t.unzip(t),!1})),n.find(".zip").on("click",(function(){return t.zip(t),!1})),n.find(".move").on("click",(function(){return t.moveTo(t),!1})),n.find(".copyFilesTo").on("click",(function(){return t.copyFiles(t),!1})),i(".duplicate").on("click",(function(){return t.duplicateFiles(t),!1})),n.find(".copyIntoMyWorkspace").on("click",(function(){return t.copyIntoMyWorkspace(t),!1})),n.find(".btn.permissions").on("click",(function(){return t.setPermissions(t),!1})),n.find(".btn.btnSetDefaultCompanyModel").on("click",(function(){return t.setDefaultcompanyModel(t),!1})),n.find(".btn.toggleHiddenFiles").on("click",(function(t){var n=t.currentTarget,a="false"===n.getAttribute("data-value");return e.showHiddenFiles=a,e.refreshFileManager(e.currentPath),i("#tree").jstree("refresh_node",e.myWorkspaceId),n.setAttribute("data-value",a),n.style.color=a?"green":"",!1})),n.find(".header-name").on("click",(function(){var e=i(this).attr("data-rel");return t.orderList(t,e),"true"===e?i(this).attr("data-rel","false"):i(this).attr("data-rel","true"),!1}))},getViewModePreference:function(){this.userManagerModel.GetUserPreference("fileManagerViewMode",(function(e){i(".btn.".concat(e,"-view")).addClass("active"),"grid"===e&&(i("#cbp-vm").removeClass("cbp-vm-view-list"),i("#cbp-vm").addClass("cbp-vm-view-".concat(e)))}))},setPermissions:function(){var e=this,t=this.selectedFiles[0];t&&(t=t.substring(t.lastIndexOf("/")+1)),this.myFileManager.showPermissionsModal(t,(function(t,n){e.refreshFileManager(e.currentPath)}))},setDefaultcompanyModel:function(){var e=this;n.e(6).then((function(){var t=[n(662)];(function(t){(new t).show({title:"Set Default Company Model",text:(0,c.translate)("sure_request_set_as_default_company_model"),buttons:[{title:(0,c.translate)("cancel"),code:"no"},{title:(0,c.translate)("set_as_default"),css:"primary",code:"yes"}],callback:function(t){if("yes"==t){var n=e.selectedFiles[0];e.companyManagerModel.UpdateCompanyPreference("autoload_model",{value:n},(function(){(0,c.showMessage)((0,c.translate)("model_successfully_set_as_default"),(0,c.translate)("_set_as_default"),"success")}))}}})}).apply(null,t)})).catch(n.oe)},refreshFileManager:function(e){var t=this,n=new o,a=e;"anchor_"===e.substring(0,7)&&(a=e.substring(7,e.length)),this.updateBreadcrumb(e),n.getFiles(a,(function(e){null!==e&&(e=t.optimizeStructureForTree(e,"list"),t.getFolders(e),i("#tree").jstree("refresh_node",t.currentNodeId))}))},goToPath:function(){var e=this,t=i(event.currentTarget).attr("data-rel"),n=new o;this.updateBreadcrumb(t),this.currentNodeId=t.substr(0,t.length-1),i("#tree").jstree("deselect_all"),i("#tree").jstree("open_node",this.currentNodeId),i("#tree").jstree("select_node",this.currentNodeId),n.getFiles(t,(function(t){null!==t&&(t=e.optimizeStructureForTree(t,"list"),e.getFolders(t))}))},openModel:function(e){var t=this,n=i(e.currentTarget).attr("data-rel"),a=i(e.currentTarget).attr("data-type");if("folder"===a){var s=new o;this.updateBreadcrumb(n),i("#tree").jstree("deselect_all"),i("#tree").jstree("open_node",this.currentNodeId),i("#tree").jstree("select_node",this.currentNodeId),s.getFiles(n,(function(e){null!==e&&(e=t.optimizeStructureForTree(e,"list"),t.getFolders(e))}))}else"model"===a?(0,c.checkBeforeCloseModel)((function(){t.tryOpenModel(n)})):"file"===a&&(n.toLowerCase().endsWith(".xlsx")||n.toLowerCase().endsWith(".xlsm")||n.toLowerCase().endsWith(".xls")||n.toLowerCase().endsWith(".xlsb"))&&this.optimzeTemplates([n])},deleteFile:function(e){var t=this;(0,c.haveAccess)("delete_files")?this.myFileManager.showConfirmationModal(this.selectedFiles,(function(){(0,c.haveAccess)("delete_file_public")&&t.selectedFiles.some((function(e){return t.isInPublic(e)}))||!t.selectedFiles.some((function(e){return t.isInPublic(e)}))?t.selectedItems.forEach((function(e){var t=e.attr("data-type"),n=e.attr("data-rel");if("folder"===t){var a=i("#tree").jstree("get_parent",n);i("#tree").jstree("select_node",a[0]),i("#tree").jstree("delete_node",n)}e.remove()})):(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": delete_files_public"),(0,c.translate)("_delete_files"),"error")})):(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": delete_files"),(0,c.translate)("_delete_files"),"error")},download:function(e){if((0,c.haveAccess)("download_files")){var t=this.selectedFiles[0].substring(this.selectedFiles[0].lastIndexOf("/")+1),n=this.selectedFiles.map((function(e){return"sources=".concat(e)}));n.push("auth_token=".concat(__currentToken)),n.push("session_key=".concat(__currentSession.session_key));var a="".concat(__apiURL,"/fileManager/download/?").concat(n.join("&")),i=document.createElement("a");document.body.appendChild(i),i.style="display: none",i.href=a,i.download=t,i.click(),window.URL.revokeObjectURL(a),(0,c.showMessage)(this.selectedFiles.join("\n"),(0,c.translate)("starting_download"),"success")}else(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": download_files"),(0,c.translate)("_download_files"),"error")},rename:function(e){var t=this,n=this.selectedFiles[0],a="/"===n.slice(-1)?n.split("/")[n.split("/").length-2]:n.split("/")[n.split("/").length-1];(0,c.haveAccess)("copy_file_or_folder")?(0,c.haveAccess)("change_file_name_public")&&this.isInPublic(n)||!this.isInPublic(n)?this.myFileManager.showRenameModal(n,a,(function(){t.refreshFileManager(t.currentPath)})):(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": change_file_name_public"),(0,c.translate)("_rename_files"),"error"):(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": copy_file_or_folder"),(0,c.translate)("_rename_files"),"error")},unzip:function(e){var t=this,n=this.selectedFiles[0];(0,c.haveAccess)("copy_file_or_folder")?(0,c.haveAccess)("add_file_public")&&this.isInPublic(n)||!this.isInPublic(n)?this.myFileManager.showUnzipModal(n,this.currentPath,(function(){t.refreshFileManager(t.currentPath)})):(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": add_file_public"),(0,c.translate)("_unzip_files"),"error"):(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": copy_file_or_folder"),(0,c.translate)("_unzip_files"),"error")},moveTo:function(e){var t=this;(0,c.haveAccess)("copy_file_or_folder")?(i(".moveAndCopyTo").removeClass("open"),this.normalizeSelection(),this.myFileManager.showMoveToModal(this.selectedFiles,!0,(function(e){t.refreshFileManager(t.currentPath),i("#tree").jstree("refresh_node",e)}))):(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": copy_file_or_folder"),(0,c.translate)("_move_files"),"error")},copyFiles:function(e){var t=this;(0,c.haveAccess)("copy_file_or_folder")?(i(".moveAndCopyTo").removeClass("open"),this.normalizeSelection(),this.myFileManager.showMoveToModal(this.selectedFiles,!1,(function(e){t.refreshFileManager(t.currentPath),t.refreshFileManager(t.myWorkspaceId),i("#tree").jstree("refresh_node",e)}))):(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": copy_file_or_folder"),(0,c.translate)("_copy_files"),"error")},copyIntoMyWorkspace:function(e){var t=this;if((0,c.haveAccess)("copy_model_to_my_workspace")){this.normalizeSelection();var n=this.selectedFiles[0];this.myFileManager.showCopyToMyWorkspaceModal(n,(function(){t.refreshFileManager(t.currentPath),i("#tree").jstree("refresh_node",t.myWorkspaceId)}))}else(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": copy_model_to_my_workspace"),(0,c.translate)("_copy_into_my_workspace"),"error")},duplicateFiles:function(e){var t=this;(0,c.haveAccess)("copy_file_or_folder")?(i(".moveAndCopyTo").removeClass("open"),this.normalizeSelection(),this.myFileManager.showDuplicateModal(this.selectedFiles,(function(e){t.refreshFileManager(t.currentNodeId),i("#tree").jstree("refresh_node",e),t.selectFirstItem()}))):(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": copy_file_or_folder"),(0,c.translate)("_duplicate_files"),"error")},zip:function(e){var t=this;if((0,c.haveAccess)("copy_file_or_folder"))if((0,c.haveAccess)("add_file_public")&&this.selectedFiles.some((function(e){return t.isInPublic(e)}))||!this.selectedFiles.some((function(e){return t.isInPublic(e)}))){this.normalizeSelection();var n=JSON.stringify(this.selectedFiles);this.myFileManager.showZipModal(n,(function(e,n){t.refreshFileManager(t.currentPath)}))}else(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": add_file_public"),(0,c.translate)("_zip_files"),"error");else(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": copy_file_or_folder"),(0,c.translate)("_zip_files"),"error")},getFiles:function(e,t){(new o).getFiles(e,(function(e){t.call(this,e)}))},getFolders:function(e){var t=this,n=i("#file-list");n.html("");for(var a=0;a<e.length;a++){var o="",l=e[a].data.lastUpdateTime;if(l="0001-01-01T00:00:00"!==l?(0,d.default)(l.toString()).format("YYYY-MM-DD HH:mm:ss"):" ",e[a].data.fileSize){var r=e[a].data.fileSize;o=r<1024?"".concat(e[a].data.fileSize," b"):r>1048576?"".concat(parseFloat(e[a].data.fileSize/1024/1024).toFixed(2)," Mb"):"".concat(parseFloat(e[a].data.fileSize/1024).toFixed(2)," Kb")}var c=i("#item_template");if(c){var p={name:e[a].name,type:e[a].type,size:o,updateDate:l,hasDenied:e[a].data.hasDenied},u=s.template(c.html(),{item:p}),f=i(u);f.attr("data-type",e[a].type),f.attr("read-only",e[a].readOnly),n.append(f.attr("data-rel",e[a].data.fullPath))}}n.perfectScrollbar("update"),this.selectFirstItem(n),i("#file-list").selectable({unselecting:function(){},stop:function(){t.normalizeSelection()}}),i("#file-list li").mousedown((function(e){if(1==e.which){if(1==i(e.currentTarget).data("oneclck"))return t.openModel(e),!1;i(this).data("oneclck",1),setTimeout((function(){i(e.currentTarget).data("oneclck",0)}),250)}}))},normalizeSelection:function(){var e=this;this.selectedFiles=[],this.selectedItems=[];var t=i("li.ui-selectee.ui-selected");s.each(t,(function(t){var n=i(t).attr("data-rel");e.selectedFiles.push(n),e.selectedItems.push(i(t))})),this.manageActionsButton(t.length)},selectFirstItem:function(e){var t=(e||i("#file-list")).find("li").first();t.addClass("ui-selectee ui-selected"),this.selectedFiles=[],this.selectedItems=[],t.length>0&&(this.selectedFiles.push(t.attr("data-rel")),this.selectedItems.push(t),this.manageActionsButton(1))},manageActionsButton:function(e){var t=this.getThis(),n=this.selectedItems.length>0&&"true"===this.selectedItems[0].attr("read-only");0===e?(t.find(".rename").attr("disabled",!0),t.find(".download").attr("disabled",!0),t.find(".delete-file").attr("disabled",!0),t.find(".unzip").attr("disabled",!0),t.find(".moveAndCopyTo a").attr("disabled",!0),t.find(".copyIntoMyWorkspace").attr("disabled",!0),t.find(".zip").attr("disabled",!0),t.find(".permissions").attr("disabled",!0),t.find(".btnSetDefaultCompanyModel").attr("disabled",!0)):1===e?(t.find(".rename").attr("disabled",n),t.find(".download").attr("disabled",!1),t.find(".delete-file").attr("disabled",n),this.enableUnzipButton(),t.find(".moveAndCopyTo a").attr("disabled",n),this.enableCopyToMyWorkspaceButton(),this.enableZipButton(),this.enablePermissionsButton(),this.enableSetDefaultCompanyModelButton()):(t.find(".rename").attr("disabled",!0),t.find(".download").attr("disabled",!1),t.find(".delete-file").attr("disabled",n),t.find(".unzip").attr("disabled",!0),t.find(".moveAndCopyTo a").attr("disabled",n),t.find(".copyIntoMyWorkspace").attr("disabled",!0),t.find(".zip").attr("disabled",n),t.find(".permissions").attr("disabled",!0),t.find(".btnSetDefaultCompanyModel").attr("disabled",!0)),this.currentNodeId.indexOf(this.myWorkspaceId)>=0&&t.find(".copyIntoMyWorkspace").attr("disabled",!0),-1!==this.currentNodeId.toLowerCase().indexOf("/public")?((0,c.haveAccess)("add_file_public")||(t.find("#btnNewFolder").attr("disabled",!0),t.find(".zip").attr("disabled",!0),t.find(".unzip").attr("disabled",!0),t.find(".move").hide(),t.find(".duplicate").hide()),(0,c.haveAccess)("delete_file_public")||t.find(".delete-file").attr("disabled",!0),(0,c.haveAccess)("change_file_name_public")||t.find(".rename").attr("disabled",!0),(0,c.haveAccess)("upload_file_public")||(t.find("#plupload_browse").attr("disabled",!0),this.disableDragAndDrop=!0)):(t.find("#btnNewFolder").attr("disabled",n),t.find("#plupload_browse").attr("disabled",n),t.find(".move").show(),t.find(".duplicate").show(),this.disableDragAndDrop=n)},disableAllActionsButtons:function(){var e=this.getThis();e.find(".rename").attr("disabled",!0),e.find(".download").attr("disabled",!0),e.find(".delete-file").attr("disabled",!0),e.find(".unzip").attr("disabled",!0),e.find(".moveAndCopyTo a").attr("disabled",!0),e.find(".copyIntoMyWorkspace").attr("disabled",!0),e.find(".zip").attr("disabled",!0),e.find(".permissions").attr("disabled",!0)},enableUnzipButton:function(){var e="true"===this.selectedItems[0].attr("read-only"),t="zip"===this.selectedItems[0].attr("data-type");this.getThis().find(".unzip").attr("disabled",e||!t)},enableZipButton:function(){var e="true"===this.selectedItems[0].attr("read-only"),t="zip"===this.selectedItems[0].attr("data-type");this.getThis().find(".zip").attr("disabled",e||t)},enableCopyToMyWorkspaceButton:function(){var e="folder"===this.selectedItems[0].attr("data-type");if(!(0,c.haveAccess)("copy_model_to_my_workspace"))return this.getThis().find(".copyIntoMyWorkspace").attr("disabled",!0),!1;this.getThis().find(".copyIntoMyWorkspace").attr("disabled",!e),"".concat(this.myWorkspaceId.split("_")[1],"/")===i(".cbp-vm-switcher ol li.active span").attr("data-rel")&&i(".copyIntoMyWorkspace").attr("disabled",!0)},enablePermissionsButton:function(){var e="true"===this.selectedItems[0].attr("read-only"),t="folder"===this.selectedItems[0].attr("data-type");this.getThis().find(".permissions").attr("disabled",e||!t)},enableSetDefaultCompanyModelButton:function(){var e="true"===this.selectedItems[0].attr("read-only"),t="model"===this.selectedItems[0].attr("data-type");this.getThis().find(".btnSetDefaultCompanyModel").attr("disabled",e||!t)},orderList:function(e,t){var n=i("#file-list"),a=n.children("li");a.sort((function(e,n){var a=i(e).find(".item-name").html().toUpperCase(),s=i(n).find(".item-name").html().toUpperCase();return"true"===t?a>s?1:a<s?-1:0:a<s?1:a>s?-1:0})),a.detach().appendTo(n)},newFolder:function(){var e=this;this.myFileManager.showCreateFolderModal(this.currentPath,"Folder name...",(function(t,n,a){var o=i("#tree").jstree("get_selected");0==o[0].indexOf("anchor_")?i("#tree").jstree("refresh_node",o):i("#tree").jstree("refresh_node",e.currentNodeId);var l=i("#file-list"),r={name:n,type:"folder",size:"",updateDate:""},c=s.template(i("#item_template").html(),{item:r}),d=i(c);d.attr("data-type","folder"),d.attr("data-rel","".concat(a,"/")),l.prepend(d),i("#file-list li").mousedown((function(t){if(1==t.which){if(1==i(t.currentTarget).data("oneclck"))return e.openModel(t),!1;i(this).data("oneclck",1),setTimeout((function(){i(t.currentTarget).data("oneclck",0)}),200)}}))}))},updateBreadcrumb:function(e){var t=this;this.currentPath=e,this.currentNodeId=this.currentPath;var n=i("#breadcrumb");n.empty();for(var a=e.split("/"),s="",o=0;o<a.length;o++)if(s+="".concat(a[o],"/"),o>0){var l=o===a.length-1?'class="active"':"",r=o===(a.length-1||0)?i("<span>".concat(a[o],"</span>")):i('<a href="">'.concat(a[o],"</a>"));r.attr("data-rel",s);var c=i("<li ".concat(l," />"));c.append(r),n.append(c)}i("#breadcrumb li a").on("click",(function(e){return e.preventDefault(),t.goToPath(),!1}))},sortByName:function(e,t){for(var n=[{prop:"isFolder",direction:-1},{prop:"text",direction:1}],a=0,i=0;a<n.length&&0===i;)i=n[a].direction*(e[n[a].prop].toString()<t[n[a].prop].toString()?-1:e[n[a].prop].toString()>t[n[a].prop].toString()?1:0),a++;return i},optimizeStructureForTree:function(e,t){for(var n=this,a=[],i="",s=e.filter((function(e){return e.show||n.showHiddenFiles})).map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){p(e,t,n[t])}))}return e}({id:e.data.fullPath},e)})),o=0;o<s.length;o++){if(i=s[o].text,s[o].name=i,s[o].data.hasDenied&&(s[o].text="<i class='fa fa-lock'></i>".concat(i)),1===s[o].type||0===s[o].type?(s[o].children=!0,s[o].type="folder",s[o].isFolder=1):"tree"===t?(a.push(o),s[o].isFolder=0):s[o].isFolder=0,0!==s[o].data.specialFolderType)switch(s[o].children=!0,s[o].data.specialFolderType){case 0:s[o].type="folder";break;case 1:s[o].type="myfolder",this.myWorkspaceId=e[o].id;break;case 2:s[o].type="public";break;case 3:s[o].type="company";break;case 4:s[o].type="modelsPath";break;case 5:s[o].type="shared";break;case 6:s[o].type="teams";break;default:s[o].type="folder"}if(["public","folder","teams"].includes(s[o].type)&&["public","teams"].includes(s[o].text.toLowerCase())&&(s[o].text='<span class="text-bold">'.concat(i,"</span>")),0===s[o].type||2===s[o].type)switch(s[o].data.specialFileType){case 0:s[o].type="file";break;case 1:s[o].type="model";break;case 2:s[o].type="zip";break;default:s[o].type="file"}}if("tree"===t)for(o=0;o<a.length;o++)s.splice(a[a.length-(o+1)],1);return s.sort(this.sortByName),s},openRootNodes:function(e){var t=i("#tree"),n=setInterval((function(){var a=t.find(".jstree-container-ul li");a.length===e.length&&t.jstree().is_parent(a[0])&&(clearInterval(n),a.each((function(e,n){0===e&&t.jstree("select_node",n,!1,!0),t.jstree("open_node",n)})))}),10)},showUploader:function(){i("#plupload").css("display","block");var e=i("#cbp-vm").height();i(".plupload_content").height(e),i(".plupload_filelist").height(e)},hideUploader:function(){i("#plupload").css("display","none")},createUploader:function(){var e=this,t=i("#plupload");t.css("position","absolute"),t.css("display","none"),t.css("z-index","1000"),t.css("width","100%"),t.css("height","100%"),t.pluploadQueue({runtimes:"html5",url:"".concat(__apiURL,"/fileManager/upload/"),headers:{Authorization:"Token ".concat(__currentToken),"session-key":__currentSession.session_key},file_data_name:"files",max_file_size:"0",chunk_size:"10mb",unique_names:!1,resize:{width:320,height:240,quality:90},flash_swf_url:"js/plupload/plupload.flash.swf",silverlight_xap_url:"js/plupload/plupload.silverlight.xap",multipart_params:{folder_path:"Novix/Public"},init:{FilesAdded:function(t,n){this.setOption({multipart_params:{folder_path:e.currentPath}}),t.start(),i("#plupload_browse").prop("disabled",!0),i("#plupload_browse").hide(),i("#uploading").show(),e.showUploader()},UploadComplete:function(t,n){e.hideUploader(),e.refreshFileManager(e.currentPath),t.splice(),t.refresh(),t.destroy(),e.createUploader(),i("#plupload_browse").prop("disabled",!1),i("#plupload_browse").show(),i("#uploading").hide()},FileUploaded:function(t,n,a){if(200==a.status){(0,c.showMessage)("".concat(n.name," ").concat((0,c.translate)("uploaded"),"!"),(0,c.translate)("_file_uploader"),"success");var i=/[.]/.exec(n.name)?/[^.]+$/.exec(n.name)[0]:"";["xls","xlsx","xlsm","xlsb"].includes(i)&&e.optimizableTemplates.push(""!=e.currentPath?"".concat(e.currentPath,"/").concat(n.name):n.name),0==t.total.queued&&e.optimizableTemplates.length>0&&setTimeout((function(){e.optimzeTemplates(e.optimizableTemplates)}),500)}else(0,c.showMessage)(a.response,(0,c.translate)("_file_uploader"),"error")},Error:function(e,t){var n=t.message;(0,c.showMessage)(n,"File Uploader","error",null,!0)}}}),i(".plupload_header").remove(),i(".plupload_progress_container").addClass("progress").addClass("progress-striped"),i(".plupload_progress_bar").addClass("bar"),i(".plupload_button").each((function(){i(this).hasClass("plupload_add")?i(this).attr("class","btn plupload_add btn-primary").html("<i class='fa fa-plus-circle'></i> "+i(this).html()):i(this).attr("class","btn plupload_start btn-success").html("<i class='fa fa-cloud-upload'></i> "+i(this).html())})),i("#cbp-vm").bind("dragover",(function(t){return e.disableDragAndDrop||e.showUploader(),!1})),i("#plupload_filelist").bind("drop",(function(n){var a=t.pluploadQueue();a.splice(),a.refresh(),a.settings.multipart_params.folder_path=e.currentPath})).bind("dragleave",(function(t){return e.hideUploader(),!1}))},getThis:function(){return this.$el.find(".mainTask[data-rel='file-manager2']")},onRemoveView:function(){this.el=i("#main"),this.events={}},onBeforeRemoveView:function(e,t){},tryOpenModel:function(e){n.e(10).then((function(){var t=[n(681)];(function(t){(new t).open(e,!0)}).apply(null,t)})).catch(n.oe)},optimzeTemplates:function(e){var t=this;t.optimizableTemplates=[];var a=new o;n.e(184).then((function(){var i=[n(760)];(function(n){var i=new n({title:"Optimizing templates. Please wait...",text:"",notifyClass:"ademsg",progressBar:50,timeOut:-1}).render();a.optimzeTemplates(e,(function(e){i.find(".toast-close-button").click(),t.refreshFileManager(t.currentPath)}),(function(e){i.find(".toast-close-button").click()}))}).apply(null,i)})).catch(n.oe)},isInPublic:function(e){return e.toLowerCase().indexOf("/public/")>=0||e.toLowerCase().endsWith("/public")}})}.apply(t,o))||(e.exports=l)}).call(this,n(219),n(1),n(221))},2359:function(e,t,n){var a=n(669);function i(e){return e&&(e.__esModule?e.default:e)}e.exports=(a.default||a).template({1:function(e,t,n,a,i){return'                    <div class="btn-group">\n                      <a href="#" class="btn download" rel="tooltip" data-placement="bottom" title=""\n                        data-original-title="Download">\n                        <i class="fa fa-download"></i>\n                      </a>\n                    </div>\n'},3:function(e,t,n,a,i){return'                    <div class="btn-group">\n                      <a href="#" class="btn copyIntoMyWorkspace" rel="tooltip" data-placement="bottom" title=""\n                        data-original-title="Copy to my workspace">\n                        <i class="fas fa-paste"></i>\n                      </a>\n                    </div>\n'},5:function(e,t,a,s,o){var l,r=null!=t?t:e.nullContext||{};return'                    <div class="btn-group">\n'+(null!=(l=i(n(680)).call(r,"change_group_permissions",{name:"haveAccess",hash:{},fn:e.program(6,o,0),inverse:e.noop,data:o,loc:{start:{line:135,column:22},end:{line:140,column:37}}}))?l:"")+"                    </div>\n"+(null!=(l=i(n(680)).call(r,"change_default_company_model",{name:"haveAccess",hash:{},fn:e.program(8,o,0),inverse:e.noop,data:o,loc:{start:{line:142,column:20},end:{line:149,column:35}}}))?l:"")},6:function(e,t,n,a,i){return'                      <a href="#" class="btn permissions" rel="tooltip" data-placement="bottom" title=""\n                        data-original-title="Set restrictions">\n                        <i class="fa fa-lock"></i>\n                      </a>\n'},8:function(e,t,a,s,o){return'                    <div class="btn-group">\n                      <a href="#" class="btn btnSetDefaultCompanyModel" rel="tooltip" data-placement="bottom" title=""\n                        data-original-title="'+e.escapeExpression(i(n(667)).call(null!=t?t:e.nullContext||{},"set_as_default_company_model",{name:"L",hash:{},data:o,loc:{start:{line:145,column:45},end:{line:145,column:81}}}))+'">\n                        <i class="fa fa-magnet"></i>\n                      </a>\n                    </div>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,a,s,o){var l,r=null!=t?t:e.nullContext||{},c=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="container-fluid mainTask" data-rel="file-manager2" data-type="tab-content">\n  <script type="text/template" id="item_template">\n    <li>\n      <span class="icon-folder">\n        <% if(item.type == "folder") { %>\n        <i class="fas fa-folder"></i>\n        <% } else if(item.type == "file") { %>\n        <i class="far fa-file"></i>\n        <% } else if(item.type == "model") { %>\n        <i class="fa fa-cube"></i>\n        <% } else if(item.type == "zip") { %>\n        <i class="far fa-file-archive"></i>\n        <% } %>\n      </span>\n      <span class="item-name"><%= item.name %></span>\n      <div class="cbp-vm-access">\n        <% if(item.hasDenied == true) { %>\n        <i class="fa fa-lock"></i>\n        <% } %>\n      </div>\n      <div class="cbp-vm-type"><%= item.type %></div>\n      <div class="cbp-vm-filesize"><%= item.size %></div>\n      <div class="cbp-vm-date"><%= item.updateDate %></div>\n    </li>\n  <\/script>\n  <script type="text/template" id="actions_template">\n    <a href="#" class="btn btn-mini btn-satblue" rel="tooltip" title="Edit" data-original-title="Edit"\n      style="width:30px; height:28px; padding:4px 4px;">\n      <i class="fa fa-edit"></i>\n    </a>\n    <a href="#" class="btn btn-mini btn-satgreen" rel="tooltip" title="Download" data-original-title="Download"\n      style="width:30px; height:28px; padding:4px 4px;">\n      <i class="fa fa-download"></i>\n    </a>\n    <a href="#" class="btn btn-mini btn-lightred" rel="tooltip" title="Delete" data-original-title="Delete"\n      style="width:30px; height:28px; padding:4px 4px;">\n      <i class="fa fa-trash"></i>\n    </a>\n  <\/script>\n\n  <div class="page-header">\n  </div>\n\n  <div class="row">\n    <div class="col-sm-12">\n      <div id="file-manager-wrapper" class="box">\n        <div class="box-content nopadding-top">\n          <div class="row row__fix-margin">\n            \x3c!-- START: Left column --\x3e\n            <div id="tree-container" class="col-sm-3 nopadding">\n              <div id="tree"></div>\n            </div>\n            \x3c!-- END: Left column --\x3e\n            \x3c!-- START: Right column --\x3e\n            <div id="right-column" class="col-sm-9"\n              style="border-width: 0 0 0 1px; border-style: solid; border-color: #ccc;">\n              <div class="fm-highlight-toolbar">\n                <div class="pull-left">\n                  <div class="btn-toolbar">\n\n                    <div class="btn-group pullright">\n                      <button id="btnNewFolder" class="btn btn-lightgrey btn--icon">\n                        <i class="fa fa-plus-square"></i>New folder</button>\n                      <button id="plupload_browse" class="btn btn-success btn--icon">\n                        <i class="fa fa-upload"></i>Upload</button>\n\n                      <button id="uploading" class="btn btn-success btn--icon" style="display:none;" disabled="true">\n                        <i class="fa fa-spinner fa-pulse"></i>Uploading...</button>\n                    </div>\n\n                    <div class="btn-group">\n                      <a href="#" class="btn rename" rel="tooltip" data-placement="bottom" title=""\n                        data-original-title="Rename">\n                        <i class="fa fa-edit"></i>\n                      </a>\n                    </div>\n'+(null!=(l=i(n(680)).call(r,"download_files",{name:"haveAccess",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:77,column:20},end:{line:84,column:35}}}))?l:"")+'                    <div class="btn-group">\n                      <a href="#" class="btn delete-file" rel="tooltip" data-placement="bottom" title=""\n                        data-original-title="Delete">\n                        <i class="fa fa-trash"></i>\n                      </a>\n                    </div>\n                    <div class="btn-group">\n                      <a href="#" class="btn unzip" rel="tooltip" data-placement="bottom" title=""\n                        data-original-title="Unzip here">\n                        <i class="fa fa-archive"></i>\n                      </a>\n                    </div>\n                    <div class="btn-group">\n                      <a href="#" class="btn zip" rel="tooltip" data-placement="bottom" title=""\n                        data-original-title="Zip here">\n                        <i class="fa fa-file-archive-o"></i>\n                      </a>\n                    </div>\n                    \x3c!--div class="btn-group">\n                      <a href="#" class="btn move" rel="tooltip" data-placement="bottom" title="" data-original-title="Move to...">\n                        <i class="fa fa-folder"></i>\n                      </a>\n                    </div--\x3e\n'+(null!=(l=d(a,"if").call(r,null!=t?d(t,"notDesktop"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:108,column:20},end:{line:115,column:27}}}))?l:"")+'                    <div class="btn-group moveAndCopyTo">\n                      <a href="#" data-toggle="dropdown" class="btn dropdown-toggle">\n                        <i class="fa fa-folder"></i>\n                        <span class="caret"></span>\n                      </a>\n                      <ul class="dropdown-menu">\n                        <li>\n                          <a href="#" class="copyFilesTo">Copy in...</a>\n                        </li>\n                        <li>\n                          <a href="#" class="move">Move to...</a>\n                        </li>\n                        <li>\n                          <a href="#" class="duplicate">Duplicate</a>\n                        </li>\n                      </ul>\n                    </div>\n'+(null!=(l=d(a,"if").call(r,null!=t?d(t,"notDesktop"):t,{name:"if",hash:{},fn:e.program(5,o,0),inverse:e.noop,data:o,loc:{start:{line:133,column:20},end:{line:150,column:27}}}))?l:"")+'                    <div class="btn-group">\n                      <a href="#" class="btn toggleHiddenFiles" rel="tooltip" data-value='+c(e.lambda(null!=t?d(t,"showHiddenFiles"):t,t))+'\n                        data-placement="bottom" title="" data-original-title="'+c(i(n(667)).call(r,"show_hidden_files",{name:"L",hash:{},data:o,loc:{start:{line:153,column:78},end:{line:153,column:103}}}))+'">\n                        <i class="fa fa-eye"></i>\n                      </a>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              \x3c!-- START: File Uploader --\x3e\n              <div id="plupload">\n                <p>Your browser doesn\'t have Flash, Silverlight or HTML5 support.</p>\n              </div>\n              \x3c!-- END: File Uploader --\x3e\n              \x3c!-- START: File list --\x3e\n              <div id="cbp-vm" class="cbp-vm-switcher cbp-vm-view-list">\n                <ol id="breadcrumb" class="breadcrumb">\n                </ol>\n                <div class="file-list-header">\n                  <div class="header-name" data-rel="true">\n                    Name\n                    <i class="fa fa-sort"></i>\n                  </div>\n                  <div class="header-access">Access</div>\n                  <div class="header-type">Type</div>\n                  <div class="header-size">Size</div>\n                  <div class="header-updated">Date</div>\n                </div>\n                <ul id="file-list" class="always-visible" style="position: relative;"></ul>\n              </div>\n              \x3c!-- END: File list --\x3e\n            </div>\n            \x3c!-- END: Right column --\x3e\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'},useData:!0})},707:function(e,t,n){"use strict";(function(a){var i,s=n(678);void 0===(i=function(){return a.Model.extend({url:"myFileManager",getMainFolders:function(e){(0,s.send)("fileManager/getMainFolders/",null,{type:"GET"},e)},getFiles:function(e,t){(0,s.send)("fileManager/getFiles/?folder=".concat(encodeURIComponent(e)),null,{type:"GET"},t)},createFolder:function(e,t,n){(0,s.send)("fileManager/createFolder/",{folder_path:e,folder_name:t},{type:"POST"},n)},deleteFiles:function(e,t){(0,s.send)("fileManager/deleteFiles/",JSON.stringify({sources:e}),{type:"DELETE",contentType:"application/json",dataType:"text"},t)},renameFiles:function(e,t,n){(0,s.send)("fileManager/renameFile/?source=".concat(encodeURIComponent(e),"&newName=").concat(t),null,{type:"GET"},n)},unzipFile:function(e,t,n){(0,s.send)("fileManager/unzipFile/?source=".concat(e,"&targetFolder=").concat(encodeURIComponent(t)),null,{type:"GET",dataType:"text"},n)},moveFiles:function(e,t,n){var a=e.map((function(e){return"sources=".concat(e)})).join("&");(0,s.send)("fileManager/moveFiles/?".concat(a,"&target=").concat(encodeURIComponent(t)),null,{type:"GET",dataType:"text"},n)},copyToMyWorkspace:function(e,t){(0,s.send)("fileManager/copyToMyWorkspace/?source="+encodeURIComponent(e),null,{type:"GET",dataType:"text"},t)},copyFiles:function(e,t,n){var a=e.map((function(e){return"sources=".concat(e)})).join("&");(0,s.send)("fileManager/copyFiles/?".concat(a,"&target=").concat(encodeURIComponent(t)),null,{type:"GET",dataType:"text"},n)},duplicateFiles:function(e,t){var n=e.map((function(e){return"sources=".concat(e)})).join("&");(0,s.send)("fileManager/duplicateFiles/?".concat(n),null,{type:"GET"},t)},zipFiles:function(e,t){var n=e.map((function(e){return"sources=".concat(e)})).join("&");(0,s.send)("fileManager/zipFiles/?".concat(n),null,{type:"GET",dataType:"text"},t)},downloadFiles:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){},l=e.map((function(e){return"sources=".concat(e)})).join("&"),r=new XMLHttpRequest;r.responseType="arraybuffer",r.open("GET","".concat(__apiURL,"/fileManager/download/?").concat(l),!0),r.setRequestHeader("Authorization","Token ".concat(__currentToken)),r.setRequestHeader("session-key",__currentSession?__currentSession.session_key:""),r.onloadstart=a,r.onreadystatechange=function(e){var a=e.currentTarget;a.onprogress=i,a.onerror=o,a.onloadend=s,a.readyState==a.DONE&&(200==a.status?t(a):n.e(18).then((function(){var e=[n(664)];(function(e){(new e).show({title:"ERROR!",text:a.response,notifyType:"error"})}).apply(null,e)})).catch(n.oe))},r.send()},getDepartments:function(e){(0,s.send)("departments/by_current_company/",null,{type:"GET"},e)},getDeniedDepartments:function(e,t){(0,s.send)("departments/denied/?folder=".concat(encodeURIComponent(e)),null,{type:"GET"},t)},setDeniedPath:function(e,t){(0,s.send)("departments/deny_items/",JSON.stringify(e),{type:"POST",contentType:"application/json;charset=utf-8"},t)},optimzeTemplates:function(e,t,n){var a=e.map((function(e){return"sources=".concat(e)})).join("&");(0,s.send)("fileManager/optimizeTemplates/?".concat(a),null,{type:"GET",dataType:"text"},t,n)}})}.apply(t,[]))||(e.exports=i)}).call(this,n(219))},712:function(e,t,n){"use strict";(function(a){var i,s=n(678);void 0===(i=function(){return a.Model.extend({list:function(e,t){(0,s.send)("users/?page=1",null,{type:"GET",contentType:"application/json;charset=utf-8",dataType:"text"},t)},listByCompany:function(e){(0,s.send)("usercompanies/list_by_company_id/",null,{type:"GET",contentType:"application/json;charset=utf-8",dataType:"text"},e)},get:function(e,t){(0,s.send)("users/".concat(e,"/"),null,{type:"GET",contentType:"application/json;charset=utf-8",dataType:"text"},t)},update:function(e,t,n){(0,s.send)("users/".concat(e,"/"),t,{type:"PUT",contentType:"application/json;charset=utf-8",dataType:"text"},n)},partialUpdateUser:function(e,t,n){(0,s.send)("users/".concat(e,"/"),JSON.stringify(t),{type:"PATCH",contentType:"application/json;charset=utf-8",dataType:"text"},n)},EditProfile:function(e,t){(0,s.send)("users/".concat(e.id,"/"),JSON.stringify(e),{type:"PATCH",contentType:"application/json;charset=utf-8",dataType:"text"},t)},create:function(e,t){(0,s.send)("usercompanies/",JSON.stringify(e),{type:"POST",contentType:"application/json;charset=utf-8",dataType:"text"},t)},partialUpdate:function(e,t,n){(0,s.send)("usercompanies/".concat(e,"/"),JSON.stringify(t),{type:"PATCH",contentType:"application/json;charset=utf-8",dataType:"text"},n)},deleteUser:function(e,t){(0,s.send)("users/".concat(e,"/"),null,{type:"DELETE"},t)},deleteUserCompany:function(e,t){(0,s.send)("usercompanies/".concat(e,"/"),null,{type:"DELETE"},t)},getUserCompany:function(e,t){(0,s.send)("usercompanies/".concat(e,"/"),null,{type:"GET",contentType:"application/json;charset=utf-8",dataType:"text"},t)},UpdateUserPreference:function(e,t){var n={userCompanyId:__currentSession.userId,preferenceCode:e,value:t};(0,s.send)("user/UpdateUserPreference",n,{type:"PUT"})},GetUserPreference:function(e,t){(0,s.send)("usercompanies/preference_by_code/?code=".concat(e),null,{type:"GET"},t)},GetRelatedDashboard:function(e){(0,s.send)("user/GetRelatedDashboard",null,null,e)}})}.apply(t,[]))||(e.exports=i)}).call(this,n(219))},720:function(e,t,n){"use strict";(function(a){var i,s=n(678);void 0===(i=function(){return a.Model.extend({list:function(e){(0,s.send)("companies/?limit=1000&offset=0",null,null,e)},getCompany:function(e,t){(0,s.send)("companies/".concat(e,"/"),null,null,t)},update:function(e,t,n){(0,s.send)("companies/".concat(e,"/"),JSON.stringify(t),{type:"PUT",contentType:"application/json;charset=utf-8",dataType:"text"},n)},partialUpdate:function(e,t,n){(0,s.send)("companies/".concat(e,"/"),JSON.stringify(t),{type:"PATCH",contentType:"application/json;charset=utf-8",dataType:"text"},n)},create:function(e,t){(0,s.send)("companies/",e,{type:"POST"},t)},delete:function(e,t){(0,s.send)("companies/".concat(e,"/"),null,{type:"DELETE"},t)},preferences:function(e,t){(0,s.send)("companies/".concat(e,"/preferences/"),null,null,t)},saveCompanyPreference:function(e,t){var n=e.company,a=e.preference,i=e.definition;(0,s.send)("companyPreferences/",JSON.stringify({company:n,preference:a,definition:i}),{type:"POST",contentType:"application/json;charset=utf-8"},t)},updateCompanyPreference:function(e,t,n){var a=t.preference,i=t.definition;(0,s.send)("companyPreferences/".concat(e,"/"),JSON.stringify({id:e,preference:a,definition:i}),{type:"PUT",contentType:"application/json;charset=utf-8",dataType:"text"},n)},removeCompanyPreference:function(e,t){(0,s.send)("companyPreferences/".concat(e,"/"),null,{type:"DELETE"},t)},GetCompanyPreference:function(e,t){(0,s.send)("companies/preference_by_code/?code=".concat(e),null,{type:"GET"},t)},sendTestEmail:function(e,t){(0,s.send)("company/SendTestEmail",e,{type:"PUT"},t)},getLicenceKey:function(e,t){(0,s.send)("company/GetLK/"+e,null,null,t)},setLicenceKey:function(e,t){(0,s.send)("company/SetLK/",e,{type:"POST"},t)}})}.apply(t,[]))||(e.exports=i)}).call(this,n(219))}}]);