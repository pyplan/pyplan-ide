/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[139,26],{2305:function(n,e,t){"use strict";(function(a,l){var o,i,c=t(18);o=[t(720),t(702),t(772),t(2306)],void 0===(i=function(n,e,o,i){return a.View.extend({el:l("#main"),_uId:"",render:function(){l("#mainLoading").show(),l("div[data-rel='abm-company']").remove();var t=new n,a=this;this._uId=l.uuid(),t.list((function(n){var t={id:a._uId,dataRel:"abm-company",tmpClass:"company-manager",title:(0,c.translate)("_companyManager")},s={headers:[(0,c.translate)("_name"),(0,c.translate)("_code"),(0,c.translate)("_options")]},r={data:n.results},d=e(t),u=o(s),p=i(r);a.$el.append(d),l("div[data-id='".concat(a._uId,"']")).find("div.abm-content").append(u),l("div[data-id='".concat(a._uId,"']")).find("tbody").append(p),a.addTableHandlers(l("div[data-id='".concat(a._uId,"']")).find("table")),l("div[data-id='".concat(a._uId,"']")).find("table").cubeTable(null,null,"companyManager"),l("div[data-id='".concat(a._uId,"']")).find("div.data-table-options").append(l("<a href='#' class='btn btn-addcompany' rel='tooltip' data-title='".concat((0,c.translate)("_newCompany"),"'><i class='fa fa-plus' /></a>"))),a.addHandlers(),l("#mainLoading").hide(),(0,c.postRender)(a.$el.find("div[data-id='".concat(a._uId,"']")))}))},edit:function(n){var e=l(n.currentTarget).closest("tr").attr("data-id");Promise.resolve().then((function(){var n=[t(763)];(function(n){(new n).showEdit(e)}).apply(null,n)})).catch(t.oe)},editPreferences:function(n){var e=l(n.currentTarget).closest("tr").attr("data-id");Promise.resolve().then((function(){var n=[t(763)];(function(n){(new n).showEditPref(e)}).apply(null,n)})).catch(t.oe)},deleteCompany:function(e){var a=l(e.currentTarget).closest("tr").attr("data-id");t.e(6).then((function(){var e=[t(662)];(function(e){(new e).show({title:(0,c.translate)("_deleteCompany"),text:(0,c.translate)("_sure_delete_company"),buttons:[{title:(0,c.translate)("cancel"),code:"no"},{title:(0,c.translate)("delete"),css:"red",code:"yes"}],callback:function(e){if("yes"==e){var o=new n;l("#mainLoading").show(),o.delete(a,(function(){l("#mainLoading").hide(),Promise.resolve().then((function(){var n=[t(763)];(function(n){(new n).show()}).apply(null,n)})).catch(t.oe)}))}}})}).apply(null,e)})).catch(t.oe)},changeState:function(e){var t=l(this).closest("tr").attr("data-id"),a=new n;a.getCompany(t,(function(n){n.active=!n.active,a.partialUpdate(t,n,(function(){}))}))},sendTestEmail:function(e,a){var l=e.closest("tr").attr("data-id"),o=new n;o.GetCompany(l,(function(n){n.contact=a,o.sendTestEmail(n,(function(n){t.e(18).then((function(){var n=[t(664)];(function(n){(new n).show({title:"info",text:(0,c.translate)("_sendedTestEmail"),notifyType:"info"})}).apply(null,n)})).catch(t.oe)}))}))},addCompany:function(){Promise.resolve().then((function(){var n=[t(763)];(function(n){(new n).addCompany()}).apply(null,n)})).catch(t.oe)},close:function(){var n=l("#currentTask").attr("data-rel");Promise.resolve().then((function(){var e=[t(663)];(function(e){(new e).removeTask(n)}).apply(null,e)})).catch(t.oe)},addTableHandlers:function(n){var e=this;l(n).find("button.btn-edit").on("click",this.edit),l(n).find("button.btn-preference").on("click",this.editPreferences),l(n).find("input.company-state").on("ifToggled",this.changeState),l(n).find("button.btn-delete").on("click",this.deleteCompany),l(n).find("button.btn-testmail").on("click",(function(n){var a=l(this);Promise.resolve().then((function(){var n=[t(763)];(function(n){(new n).showEmailModal(a,e.sendTestEmail)}).apply(null,n)})).catch(t.oe)}))},addHandlers:function(){l("div[data-id='".concat(this._uId,"']")).find("div.data-table-options a.btn-addcompany").on("click",this.addCompany),l("div[data-id='".concat(this._uId,"']")).find("div.abm-top-options a.btn-close").on("click",this.close),l(".iCheck-helper").attr("title",(0,c.translate)("_changeState")).tooltip()}})}.apply(e,o))||(n.exports=i)}).call(this,t(219),t(1))},2306:function(n,e,t){var a=t(669);function l(n){return n&&(n.__esModule?n.default:n)}n.exports=(a.default||a).template({1:function(n,e,a,o,i){var c,s=n.lambda,r=n.escapeExpression,d=null!=e?e:n.nullContext||{},u=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<tr data-id="'+r(s(null!=e?u(e,"id"):e,e))+'">\n  <td class="companyName">'+r(s(null!=e?u(e,"name"):e,e))+"</td>\n  <td>"+r(s(null!=e?u(e,"code"):e,e))+"</td>\n  <td>\n"+(null!=(c=l(t(680)).call(d,"change_company",{name:"haveAccess",hash:{},fn:n.program(2,i,0),inverse:n.noop,data:i,loc:{start:{line:6,column:4},end:{line:9,column:19}}}))?c:"")+'    <button class="btn btn-mini btn-blue btn-preference" rel="tooltip" data-title=\''+r(l(t(667)).call(d,"_editCompanyPreferences",{name:"L",hash:{},data:i,loc:{start:{line:10,column:83},end:{line:10,column:114}}}))+'\'>\n      <i class="fa fa-list-ol" />\n    </button>\n'+(null!=(c=l(t(668)).call(d,null!=e?u(e,"active"):e,"==",!0,{name:"ifCond",hash:{},fn:n.program(4,i,0),inverse:n.program(6,i,0),data:i,loc:{start:{line:13,column:4},end:{line:17,column:15}}}))?c:"")+(null!=(c=l(t(680)).call(d,"delete_company",{name:"haveAccess",hash:{},fn:n.program(8,i,0),inverse:n.noop,data:i,loc:{start:{line:18,column:4},end:{line:21,column:19}}}))?c:"")+'    \x3c!--button class="btn btn-mini btn-blue btn-testmail" rel="tooltip" data-title=\''+r(l(t(667)).call(d,"_sendTestEmail",{name:"L",hash:{},data:i,loc:{start:{line:22,column:84},end:{line:22,column:106}}}))+'\'><i class="fa fa-envelope"></i></button--\x3e\n  </td>\n</tr>\n'},2:function(n,e,a,o,i){return'    <button class="btn btn-mini btn-green btn-edit" rel="tooltip" data-title=\''+n.escapeExpression(l(t(667)).call(null!=e?e:n.nullContext||{},"_editCompany",{name:"L",hash:{},data:i,loc:{start:{line:7,column:78},end:{line:7,column:98}}}))+'\'><i\n        class="fa fa-pencil-square-o"></i></button>\n'},4:function(n,e,t,a,l){return'    <input type="checkbox" name="remember" class="icheck-me company-state" data-skin="square" data-color="blue" checked>\n'},6:function(n,e,t,a,l){return'    <input type="checkbox" name="remember" class="icheck-me company-state" data-skin="square" data-color="blue">\n'},8:function(n,e,a,o,i){return'    \x3c!--button class="btn btn-mini btn-red btn-delete" rel="tooltip" data-title=\''+n.escapeExpression(l(t(667)).call(null!=e?e:n.nullContext||{},"_deleteCompany",{name:"L",hash:{},data:i,loc:{start:{line:19,column:81},end:{line:19,column:103}}}))+'\'><i\n                                class="fa fa-trash"></i></button---\x3e\n'},compiler:[8,">= 4.3.0"],main:function(n,e,t,a,l){var o,i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return null!=(o=i(t,"each").call(null!=e?e:n.nullContext||{},null!=e?i(e,"data"):e,{name:"each",hash:{},fn:n.program(1,l,0),inverse:n.noop,data:l,loc:{start:{line:1,column:0},end:{line:25,column:9}}}))?o:""},useData:!0})},702:function(n,e,t){var a=t(669);n.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(n,e,t,a,l){var o,i=null!=e?e:n.nullContext||{},c=n.hooks.helperMissing,s=n.escapeExpression,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div class="abm-base-tmp '+s("function"==typeof(o=null!=(o=r(t,"tmpClass")||(null!=e?r(e,"tmpClass"):e))?o:c)?o.call(i,{name:"tmpClass",hash:{},data:l,loc:{start:{line:1,column:25},end:{line:1,column:37}}}):o)+' container-fluid mainTask" data-id="'+s("function"==typeof(o=null!=(o=r(t,"id")||(null!=e?r(e,"id"):e))?o:c)?o.call(i,{name:"id",hash:{},data:l,loc:{start:{line:1,column:73},end:{line:1,column:79}}}):o)+'" data-rel="'+s("function"==typeof(o=null!=(o=r(t,"dataRel")||(null!=e?r(e,"dataRel"):e))?o:c)?o.call(i,{name:"dataRel",hash:{},data:l,loc:{start:{line:1,column:91},end:{line:1,column:102}}}):o)+'" data-type="tab-content">\n    <div class="row">\n        <div class="col-sm-12">\n            <div class="box">\n                <div class="box-title">\n                    <h3><i class="fa fa-th-list"></i>'+s("function"==typeof(o=null!=(o=r(t,"title")||(null!=e?r(e,"title"):e))?o:c)?o.call(i,{name:"title",hash:{},data:l,loc:{start:{line:6,column:53},end:{line:6,column:62}}}):o)+'</h3>\n                    <div class="actions abm-top-options">\n                        <a href="#" class="btn btn-close"><i class="fa fa-times"></i></a>\n                    </div>\n                </div>\n        <div class="box-content nopadding abm-content">\n\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'},useData:!0})},720:function(n,e,t){"use strict";(function(a){var l,o=t(678);void 0===(l=function(){return a.Model.extend({list:function(n){(0,o.send)("companies/?limit=1000&offset=0",null,null,n)},getCompany:function(n,e){(0,o.send)("companies/".concat(n,"/"),null,null,e)},update:function(n,e,t){(0,o.send)("companies/".concat(n,"/"),JSON.stringify(e),{type:"PUT",contentType:"application/json;charset=utf-8",dataType:"text"},t)},partialUpdate:function(n,e,t){(0,o.send)("companies/".concat(n,"/"),JSON.stringify(e),{type:"PATCH",contentType:"application/json;charset=utf-8",dataType:"text"},t)},create:function(n,e){(0,o.send)("companies/",n,{type:"POST"},e)},delete:function(n,e){(0,o.send)("companies/".concat(n,"/"),null,{type:"DELETE"},e)},preferences:function(n,e){(0,o.send)("companies/".concat(n,"/preferences/"),null,null,e)},saveCompanyPreference:function(n,e){var t=n.company,a=n.preference,l=n.definition;(0,o.send)("companyPreferences/",JSON.stringify({company:t,preference:a,definition:l}),{type:"POST",contentType:"application/json;charset=utf-8"},e)},updateCompanyPreference:function(n,e,t){var a=e.preference,l=e.definition;(0,o.send)("companyPreferences/".concat(n,"/"),JSON.stringify({id:n,preference:a,definition:l}),{type:"PUT",contentType:"application/json;charset=utf-8",dataType:"text"},t)},removeCompanyPreference:function(n,e){(0,o.send)("companyPreferences/".concat(n,"/"),null,{type:"DELETE"},e)},GetCompanyPreference:function(n,e){(0,o.send)("companies/preference_by_code/?code=".concat(n),null,{type:"GET"},e)},sendTestEmail:function(n,e){(0,o.send)("company/SendTestEmail",n,{type:"PUT"},e)},getLicenceKey:function(n,e){(0,o.send)("company/GetLK/"+n,null,null,e)},setLicenceKey:function(n,e){(0,o.send)("company/SetLK/",n,{type:"POST"},e)}})}.apply(e,[]))||(n.exports=l)}).call(this,t(219))},772:function(n,e,t){var a=t(669);n.exports=(a.default||a).template({1:function(n,e,t,a,l){return"      <th>"+n.escapeExpression(n.lambda(e,e))+"</th>\n"},compiler:[8,">= 4.3.0"],main:function(n,e,t,a,l){var o,i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<table class="table table-hover table-nomargin table-bordered">\n  <thead>\n    <tr>\n'+(null!=(o=i(t,"each").call(null!=e?e:n.nullContext||{},null!=e?i(e,"headers"):e,{name:"each",hash:{},fn:n.program(1,l,0),inverse:n.noop,data:l,loc:{start:{line:4,column:6},end:{line:6,column:15}}}))?o:"")+"    </tr>\n  </thead>\n  <tbody>\n\n  </tbody>\n</table>"},useData:!0})}}]);