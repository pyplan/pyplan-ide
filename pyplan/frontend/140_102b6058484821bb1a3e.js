/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[140],{819:function(e,t,r){"use strict";(function(i,s,o){var n,a,l=r(18);n=[r(729),r(699)],void 0===(a=function(e,t){return e.extend({numberFormat:[],numberFormatter:[],blackLabels:!1,arrRows:[],arrDims:[],drawChart:function(e){var t,r,n=this,a=this.currentResult,l=[],u=!1;if(i(this.tagId).find(".item-title .knowledge-arrow").addClass("off"),this.currentResult.itemProperties.nodesArray.length>0)for(var m=0;m<this.currentResult.itemProperties.nodesArray.length;m++){this.currentResult.itemProperties.nodesArray[m].itemProperties&&!i.isEmptyObject(this.currentResult.itemProperties.nodesArray[m].itemProperties)||(this.currentResult.itemProperties.nodesArray[m].itemProperties={},this.currentResult.itemProperties.nodesArray[m].itemProperties.title={},this.currentResult.itemProperties.nodesArray[m].itemProperties.axes=this.initEmptyAxis(),this.currentResult.itemProperties.nodesArray[m].itemProperties.title.text=this.currentResult.itemProperties.nodesArray[m].nodeName);var c="#000000";this.currentResult.nodeResult&&1===this.currentResult.nodeResult.series.length&&(c=s.getOptions().colors[m]),this.currentResult.nodeResult&&(this.currentResult.itemProperties.nodesArray[m].itemProperties.axes.yAxis.title.style={},this.currentResult.itemProperties.nodesArray[m].itemProperties.axes.yAxis.labels.style={},this.currentResult.itemProperties.nodesArray[m].itemProperties.axes.yAxis.title.style.color=c,this.currentResult.itemProperties.nodesArray[m].itemProperties.axes.yAxis.labels.style.color=c),t=this.currentResult.itemProperties.nodesArray[m].itemProperties.axes.yAxis.min,r=this.currentResult.itemProperties.nodesArray[m].itemProperties.axes.yAxis.max,""===t&&delete this.currentResult.itemProperties.nodesArray[m].itemProperties.axes.yAxis.min,""===r&&delete this.currentResult.itemProperties.nodesArray[m].itemProperties.axes.yAxis.max,delete this.currentResult.itemProperties.nodesArray[m].itemProperties.axes.yAxis.labels.align,l.push(this.currentResult.itemProperties.nodesArray[m].itemProperties.axes.yAxis),"bar"===this.currentResult.itemProperties.nodesArray[m].itemSubType&&(u=!0)}else l=[this.currentResult.itemProperties.axes.yAxis],"bar"===this.currentResult.itemProperties.nodesArray[0].itemSubType&&(u=!0);this.applyDefaultProperties(a.itemProperties),a.nodeResult&&this.applyStyleSeries(a.nodeResult);var h=a.itemProperties.axes.xAxis,d=l,p=o.extend({},h),y=o.extend([],d);p=this.setAxesRange(p),y.length>1&&(y[1].min=y[0].min,y[1].max=y[0].max),y=this.setArrayYAxesRange(y),p.type="category",p.categories=null,p.title=this.getXTitle(),p.labels.style=this.getLabelsStyle();for(m=0;m<y.length;m++)y[m].labels.formatter=function(){return n.createFormatter(this.axis.options.index),n.numberFormatter[this.axis.options.index].format(this.value)};p.labels.formatter=function(){return n.columnFormatter?n.columnFormatter.format(this.value):this.value};var x=i.extend(a.itemProperties.tooltip,{formatter:function(){return n.formatTooltip(this)}}),P={chart:{type:u?"bar":null,zoomType:a.itemProperties.hasOwnProperty("zoom")&&a.itemProperties.zoom?"x":"none",reflow:!1,spacingBottom:2,events:{drillup:function(e){n.drillup(e)},drilldown:function(e){}}},plotOptions:{series:{dataLabels:{enabled:this.ensureProp(a.itemProperties.labels,"enabled",!1),inside:a.itemProperties.labels.inside,style:this.getLabelStyle(),formatter:function(){return n.formatLabel(this)}}}},title:{floating:!0,text:""},subtitle:{text:a.itemProperties.subtitle.text},credits:{enabled:!1},navigation:{buttonOptions:{enabled:!1}},xAxis:p,yAxis:y,tooltip:x,legend:this.getChartLegend(a.itemProperties.legend),series:a.nodeResult?a.nodeResult.series:null,drilldown:{activeAxisLabelStyle:{textDecoration:"none",fontWeight:"normal"},activeDataLabelStyle:{textDecoration:"none",fontWeight:"normal"}}};P=i.extend({},P,this.getExtraChartOptions(P)),i(e).highcharts(P)},applyDefaultProperties:function(e){e.labels||(e.labels={enabled:!1,inside:!1})},setArrayYAxesRange:function(e){for(var t=e,r=0;r<e.length;r++)void 0!=t[r].categories&&("string"==typeof t[r].min&&(t[r].min=-1!=t[r].categories.indexOf(t[r].min)?t[r].categories.indexOf(t[r].min):null),"string"==typeof t[r].max&&(t[r].max=-1!=t[r].categories.indexOf(t[r].max)?t[r].categories.indexOf(t[r].max):null));return t},checkNodeCompatibility:function(e,t,r,i){this.addLayerNode(e,t,r,i)},addLayerNode:function(e,t,r,s){var o=this;if(e){i(this.tagId).find(".item-area").html(" "+(0,l.translate)("loading")+"..."),this.showLoading();var n=void 0;t&&"table"!=t||(n=100),this.model&&this.model.getNodeFullData(e,n,function(e){o.hideLoading(),e&&(t&&"indexlist"!=e.itemType&&"selector"!=e.itemType&&"formnode"!=e.itemType&&(e.itemType=t,e.itemSubType=r,e.lineStyle=s),o.createNewLayer(e))},function(){o.hideLoading()})}},createNewLayer:function(e,r){this.editMode&&(this.onRemoveItemView(),i(this.$el).closest(".mainTask").find(".left-menu[data-rel='"+this.tagId+"']").trigger("removeToolbar")),e.itemType&&i(this.tagId).find(".item-area").empty();var s=this;"objectItem"==e.itemType||(new t).getChartItemViewFromType(e.itemType,function(t){s._createNewLayer(t,e,r)})},_createNewLayer:function(e,t,r){var s=i(this.tagId).parent();s.find("div.pane").remove();var o=new e({model:this.model});o.setElement(s),o.currentNodeId=t.nodeId,o.currentResult=t,o.currentResult.itemProperties.nodesArray||(o.currentResult.itemProperties.nodesArray=this.currentResult.itemProperties.nodesArray),o.currentResult.itemProperties.nodesArray.push({nodeId:t.nodeId,nodeName:t.nodeName,itemSubType:t.itemSubType,itemProperties:{},lineStyle:t.lineStyle,columns:t.columns,dims:t.dims,rows:t.rows,nodeIndex:o.currentResult.itemProperties.nodesArray.length});var n,a=o.currentResult.itemProperties.nodesArray.length;o.scaleFactorW=this.scaleFactorW,o.scaleFactorH=this.scaleFactorH,o.maxScaleFactorW=this.maxScaleFactorW,o.maxScaleFactorH=this.maxScaleFactorH,t.nodeResult&&o.checkForDefaultFormat(t.nodeResult,a),o.render(!0),t.nodeResult&&o.updatePropertiesOnEvaluate(t.nodeResult,a),o.splitter=this.splitter,o.splitter&&o.splitter.setOptions("onDragEnd",function(e){o.model&&o.model.updateSizes(!0,!0)}),o.setEditMode(this.editMode),this.model.changeItemModel(this,o),i(o.tagId).trigger("selectPane"),o._applyItemId(t,this.itemId),this.clearAll(),t.itemProperties&&(n=t.itemProperties.summaryBy);var l=t.dims,u=t.rows,m=t.columns;t.itemProperties.nodesArray.length>1&&t.itemProperties.nodesArray[0].dims>0&&(l=t.itemProperties.nodesArray[0].dims,u=t.itemProperties.nodesArray[0].rows),o._evaluateNode(t.nodeId,l,u,m,void 0,n)},_evaluateNode:function(e,t,r,s,o,n){if(e){var a=this;a.showLoading();var l,u,m=!1,c="A",h="FLO",d="CAL";r&&0!=r.length||!this.originalRow||(r=[a.originalRow],m=!0),s&&0!=s.length||!this.originalCol||(s=[a.originalCol],m=!0),a.currentResult&&a.currentResult.itemProperties&&(l=a.currentResult.itemProperties.bottomTotal,u=a.currentResult.itemProperties.rightTotal,a.currentResult.itemProperties.timeFormat&&(c=a.currentResult.itemProperties.timeFormat),a.currentResult.itemProperties.timeFormatType&&(h=a.currentResult.itemProperties.timeFormatType),a.currentResult.itemProperties.calendarType&&(d=a.currentResult.itemProperties.calendarType));var p=[],y=0;a.currentResult.dims=[],a.currentResult.rows=[];for(var x=0;x<a.currentResult.itemProperties.nodesArray.length;x++)a.updateDimsAndRows(a.currentResult.itemProperties.nodesArray[x].dims,a.currentResult.itemProperties.nodesArray[x].rows),a.preEvaluateNode(a.currentResult.itemProperties.nodesArray[x].nodeId,t,r,s),a.model.evaluateNode(a.currentResult.itemProperties.nodesArray[x].nodeId,t,r,s,function(e){a.updateNewDims(e.newDims);for(var n=0;n<a.currentResult.itemProperties.nodesArray.length;n++)if(e.nodeProperties.nodeId===a.currentResult.itemProperties.nodesArray[n].nodeId){a.currentResult.itemProperties.nodesArray[n].newDims=e.newDims;for(var l=0;l<e.series.length;l++)e.series[l].nodeId=a.currentResult.itemProperties.nodesArray[n].nodeId,e.series[l].type=a.currentResult.itemProperties.nodesArray[n].itemSubType,e.series[l].dashStyle=a.currentResult.itemProperties.nodesArray[n].lineStyle?"shortdot":"solid",e.series[l].yAxis=n,1===e.series.length&&(e.series[l].name=a.currentResult.itemProperties.nodesArray[n].itemProperties.title.text),a.currentResult.itemProperties.nodesArray[n].itemProperties.hasOwnProperty("labels")&&(e.series[l].dataLabels=a.currentResult.itemProperties.nodesArray[n].itemProperties.labels);a.currentResult.itemProperties.nodesArray[n].itemProperties.numberFormat&&""!==a.currentResult.itemProperties.nodesArray[n].itemProperties.numberFormat||a.setDashNumberFormat(n,e.nodeProperties.numberFormat),a.applyColorSeries(e.series,n),p.push(e.series)}if(++y===a.currentResult.itemProperties.nodesArray.length){var u=null,c=null,h=null,d=null,x=0;i.each(p,function(e,t){for(var r=0;r<t.length;r++)0===r&&0===x&&(u=Math.min.apply(null,t[r].data),c=Math.max.apply(null,t[r].data)),h=Math.min.apply(null,t[r].data),d=Math.max.apply(null,t[r].data),h<u&&(u=h),d>c&&(c=d);x++}),a.currentResult.itemProperties.alignMin=u,a.currentResult.itemProperties.alignMax=c,a.hideLoading(),a.currentResult&&e.indexValues&&(a.currentResult.indexValues=e.indexValues),a.currentResult&&(t.length>0||r.length>0||s.length),a.currentResult.columns.categories=e.columns.categories,a.checkForDefaultFormat(e);var P=[];i.each(a.currentResult.itemProperties.nodesArray,function(e){for(var i=0;i<p.length;i++)if(p[i][0].nodeId===this.nodeId)for(var n=0;n<p[i].length;n++)P.push(p[i][n]);e===a.currentResult.itemProperties.nodesArray.length-1&&(a.currentResult.series=P,"dropFilter"===o&&(a.currentResult.dims=t,a.currentResult.rows=r,a.currentResult.columns[0]=s[0]),a.updateIndexes(a.currentResult.dims,a.currentResult.rows,s,a.currentResult.newDims,m),a.updateValues(a.currentResult))})}},!!(a.currentResult&&a.currentResult.itemProperties&&a.currentResult.itemProperties.defMode),function(e){"Access denied"==e?(i(a.tagId).find(".item-area").empty(),i(a.tagId).find(".item-title").empty(),i(a.tagId).find(".loading-pane span").text(e)):a.hideLoading(),a.isReady=!0},n,a.pageSize,a.currentPage,l,u,c,h,d)}},updateNewDims:function(e){var t=!1;this.currentResult.newDims||(this.currentResult.newDims=[]);for(var r=0;r<e.length;r++){t=!1;for(var i=0;i<this.currentResult.newDims.length;i++)this.currentResult.newDims[i].field===e[r].field&&(this.currentResult.newDims[i].values=e[r].values,t=!0);e[r]&&!t&&this.currentResult.newDims.push(e[r])}},updateDimsAndRows:function(e,t){for(var r=!1,i=0;i<t.length;i++){r=!1;for(var s=0;s<this.currentResult.rows.length;s++)this.currentResult.rows[s].field===t[i].field&&(r=!0);for(var o=0;o<this.currentResult.dims.length;o++)this.currentResult.dims[o].field===t[i].field&&(r=!0);for(var n=0;n<this.currentResult.columns.length;n++)this.currentResult.columns[n].field===t[i].field&&(r=!0);t[i]&&!r&&this.currentResult.rows.push(t[i])}for(i=0;i<e.length;i++){r=!1;for(s=0;s<this.currentResult.dims.length;s++)this.currentResult.dims[s].field===e[i].field&&(r=!0);for(o=0;o<this.currentResult.rows.length;o++)this.currentResult.rows[o].field===e[i].field&&(r=!0);for(n=0;n<this.currentResult.columns.length;n++)this.currentResult.columns[n].field===e[i].field&&(r=!0);e[i]&&!r&&this.currentResult.dims.push(e[i])}},applyNumberFormat:function(){this.recreateChart()},checkForDefaultFormat:function(e,t){e&&e.nodeProperties&&e.nodeProperties.numberFormat&&(this.numberFormat=e.nodeProperties.numberFormat,this.numberFormatter=[]),e&&e.newDims&&(this.rowFormatter=null,e.series&&e.series.length>0&&"number"==typeof e.series[0].name&&(this.rowFormatter=this.getIndexFormatter(e.indexOnRow,e.newDims)),e.columns&&e.columns.categories&&e.columns.categories.length>0&&"number"==typeof e.columns.categories[0]&&(this.columnFormatter=this.getIndexFormatter(e.indexOnColumn,e.newDims)))},initEmptyAxis:function(){var e={yAxis:{}};return e.yAxis.min="",e.yAxis.max="",e.yAxis.title={},e.yAxis.showTitle=!0,e.yAxis.title.text="",e.yAxis.labels={},e.yAxis.labels.enabled=!0,e.yAxis.labels.rotation=0,e.yAxis.labels.align="left",e},updateValues:function(e){this.resetDrilldown();var t=this;for(this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.emptyTotal&&this.filterEmptyData(e);this.chart.series.length;)this.chart.series[0].remove(!1);this.chart.hasOwnProperty("counters")?(this.chart.counters.color=0,this.chart.counters.symbol=0):this.chart.hasOwnProperty("colorCounter")&&(this.chart.colorCounter=0,this.chart.symbolCounter=0),this.applyStyleSeries(e),null!==this.currentResult.itemProperties.alignMax&&this.currentResult.itemProperties.alignThreshold&&i.each(this.chart.yAxis,function(e,r){r.setExtremes(t.currentResult.itemProperties.alignMin,t.currentResult.itemProperties.alignMax,!0)});for(var r=0;r<e.series.length;r++)this.chart.addSeries(e.series[r],!1,!1);this.chart.xAxis[0].names=e.columns.categories,this.applyAxisTitles(),this.chart.redraw(),this.addHideAllButton(),this.isReady=!0},setAxisLabelsAngle:function(e,t,r,i){var s,o,n,a=this.chart.options,l=this.currentResult.itemProperties.nodesArray[i].itemProperties.axes;"x"==r?(s=a.xAxis[0].labels,o=l.xAxis.labels,e?(n="center",t=0):n=t>0?"left":"right"):(s=a.yAxis[i].labels,o=l.yAxis.labels,n="right",e&&(t=0)),s.align=n,s.rotation=t,o.align=n,o.rotation=t,this.recreateChart()},setAxisRange:function(e,t){var r,s,o,n;r=i(e).find("input.axis-xmin").val(),s=i(e).find("input.axis-xmax").val(),o=i(e).find("input.axis-ymin").val(),n=i(e).find("input.axis-ymax").val(),r=r||null,s=s||null,o=o||null,n=n||null;var a=!!(r||s||o||n);this.currentResult.itemProperties.axes.enabled=a,this.currentResult.itemProperties.axes.xAxis.min=r,this.currentResult.itemProperties.axes.xAxis.max=s,this.currentResult.itemProperties.axes.yAxis.min=o,this.currentResult.itemProperties.axes.yAxis.max=n,this.chart.options.xAxis[0].min=r,this.chart.options.xAxis[0].max=s,this.currentResult.itemProperties.nodesArray.forEach(function(e){e.itemProperties.axes.enabled=a,"xAxis"in e.itemProperties.axes&&(e.itemProperties.axes.xAxis.min=r,e.itemProperties.axes.xAxis.max=s),"yAxis"in e.itemProperties.axes&&(e.itemProperties.axes.yAxis.min=o,e.itemProperties.axes.yAxis.max=n)}),this.recreateChart()},setAxisLabelsVisibility:function(e,t,r){var i,s,o=this.chart.options,n=this.currentResult.itemProperties.axes;"x"==e?(i=o.xAxis[0].labels,s=n.xAxis.labels,o.xAxis[0].labels.enabled=t):(i=o.yAxis[r].labels,s=n.yAxis.labels,o.yAxis[r].labels.enabled=t),i.enabled=t,s.enabled=t,this.recreateChart()},setAxisTitleVisibility:function(e,t,r){var i=this.chart.options,s=this.currentResult.itemProperties.axes;"x"==e?s.xAxis.showTitle=t:(i.yAxis[r].title,s.yAxis.title,i.yAxis[r].title.enabled=t),this.recreateChart()},setAxisOpposite:function(e,t){this.chart.options.yAxis[t].opposite=e,this.recreateChart()},setDashedStyle:function(e,t){this.chart.options;this.currentResult.itemProperties.nodesArray[t].lineStyle=e,this.recreateChart()},setCustomColorSerie:function(e,t){this.currentResult.itemProperties.nodesArray[t].itemProperties.colorSerie=e,this.recreateChart()},alignThreshold:function(e){if(this.currentResult.itemProperties.alignThreshold=e,e)for(var t=0;t<this.currentResult.itemProperties.nodesArray.length;t++)this.currentResult.itemProperties.nodesArray[t].itemProperties.axes.yAxis.min=this.currentResult.itemProperties.alignMin,this.currentResult.itemProperties.nodesArray[t].itemProperties.axes.yAxis.max=this.currentResult.itemProperties.alignMax;else for(t=0;t<this.currentResult.itemProperties.nodesArray.length;t++)this.currentResult.itemProperties.nodesArray[t].itemProperties.axes.yAxis.min=null,this.currentResult.itemProperties.nodesArray[t].itemProperties.axes.yAxis.max=null;this.recreateChart()},changeYAxisColor:function(e,t){var r,i,s=this.chart.options,o=this.currentResult.itemProperties.axes;r=s.yAxis[t].labels.style={},i=o.yAxis.labels.style={};var n=s.yAxis[t].title.style={},a=o.yAxis.title.style={};s.yAxis[t].labels.style.color=e,s.yAxis[t].title.style.color=e,r.color=e,i.color=e,n.color=e,a.color=e,this.recreateChart()},formatLabel:function(e){var t;return t=e.point.series.options.yAxis?e.point.series.options.yAxis:0,this.createFormatter(t),this.numberFormatter[t].format(e.point.y)},formatTooltip:function(e){var t;t=e.point.series.options.yAxis?e.point.series.options.yAxis:0,this.createFormatter(t);var r=10;this.maxScaleFactorW>1&&(r*=this.maxScaleFactorW);var i=e.key;this.columnFormatter&&(i=this.columnFormatter.format(i));var s="";return e&&e.series&&(s=e.series.name),s&&this.rowFormatter&&(s=this.rowFormatter.format(s)),'<span style="font-size:'+r+'px">'+i+'</span><br/><span style="color:'+e.point.color+'">●</span> '+s+": <b>"+this.numberFormatter[t].format(e.point.y)+"</b><br/>"},setNumberFormat:function(e,t){this.currentNodeId;this.currentResult.itemProperties.nodesArray[e].itemProperties.numberFormat=t,this.createFormatter(e,!0),this.applyNumberFormat()},setDashNumberFormat:function(e,t){this.currentNodeId;this.currentResult.itemProperties.nodesArray[e].itemProperties.numberFormat=t,this.createFormatter(e,!0)},createFormatter:function(e,t){if(this.numberFormatter=[],!this.numberFormatter)for(var r=0;r<this.currentResult.itemProperties.nodesArray.length;r++)this.numberFormatter.push({});this.currentResult.itemProperties.nodesArray[e].itemProperties.numberFormat?this.numberFormat=this.currentResult.itemProperties.nodesArray[e].itemProperties.numberFormat:this.numberFormat="",(i.isEmptyObject(this.numberFormatter[e])||t)&&(this.numberFormatter[e]=new l.NovixFormatter(this.numberFormat))},getOptionsMenu:function(){var e=this;return{callback:function(t){switch(t){case"_full":e.fullScreen();break;case"_view_detail":e.toggleViewDetail(!0)}},items:{_full:{type:"icon_text",name:(0,l.translate)("fullscreen"),iconClass:"fa fa-expand"},_view_detail:{type:"icon_text",name:(0,l.translate)("toggle_index_detail"),iconClass:"fa fa-info-circle"}}}},setChartSeriesLabel:function(e,t,r){var i;"none"!==r?(i="inside"==r,this.currentResult.itemProperties.nodesArray[e].itemProperties.hasOwnProperty("labels")?this.currentResult.itemProperties.nodesArray[e].itemProperties.labels.enabled=t:this.currentResult.itemProperties.nodesArray[e].itemProperties.labels={enabled:t},void 0!=i&&(this.currentResult.itemProperties.nodesArray[e].itemProperties.labels.inside=i)):delete this.currentResult.itemProperties.nodesArray[e].itemProperties.labels,this.recreateChart()},setChartLegendPosition:function(e,t){this.currentResult.itemProperties.hasOwnProperty("legend")?this.currentResult.itemProperties.legend.enabled=e:this.currentResult.itemProperties.legend={enabled:e},this.chart.options.legend.enabled=e;var r="vertical",i="right",s="middle";switch(t){case"top":r="horizontal",i="center",s="top";break;case"bottom":r="horizontal",i="center",s="bottom";break;case"left":i="left"}this.chart.options.legend.layout=r,this.chart.options.legend.align=i,this.chart.options.legend.verticalAlign=s,this.chart.options.legend.y=0,this.currentResult.itemProperties.legend.layout=r,this.currentResult.itemProperties.legend.align=i,this.currentResult.itemProperties.legend.verticalAlign=s,this.currentResult.itemProperties.legend.y=0,this.recreateChart()},updatePropertiesOnEvaluate:function(e,t){e.nodeProperties&&(this.currentNodeProperties=e.nodeProperties,this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.title&&this.currentResult.itemProperties.title.isCustom||i(this.tagId).find(".item-title .title").text(e.nodeProperties.title),e.nodeProperties.unit&&i(this.tagId).find(".item-title .unit").text("("+e.nodeProperties.unit+")"),this.checkForDefaultFormat(e,t))},applyColorSeries:function(e,t){if(this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.nodesArray[t].itemProperties.colorSerie&&"-1"!=this.currentResult.itemProperties.nodesArray[t].itemProperties.colorSerie){var r=this.model.getStyleLibrary(this.currentResult.itemProperties.nodesArray[t].itemProperties.colorSerie);if(r){var s={};i.each(r,function(e,t){s[t.value.toLowerCase()]=t.color});for(var o=0;o<e.length;o++){var n=e[o].name.toLowerCase();s[n]?e[o].color=s[n]:delete e[o].color}}}}})}.apply(t,n))||(e.exports=a)}).call(this,r(1),r(26),r(1))}}]);