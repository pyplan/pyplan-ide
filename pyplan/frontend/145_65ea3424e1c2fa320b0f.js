/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[145,27],{2311:function(e,n,t){"use strict";(function(a,l){var o,r,s=t(18);o=[t(712),t(702),t(772),t(2312)],void 0===(r=function(e,n,o,r){return a.View.extend({el:l("#main"),_uId:"",render:function(){l("#mainLoading").show(),l('div[data-rel="abm-user"]').remove();var t=new e,a=this;this._uId=l.uuid(),t.list(void 0,(function(e){var t={id:a._uId,dataRel:"abm-user",tmpClass:"user-manager",title:(0,s.translate)("_userManager")},i={headers:[(0,s.translate)("_name"),(0,s.translate)("_login"),(0,s.translate)("_email"),(0,s.translate)("_companies"),(0,s.translate)("_groups"),(0,s.translate)("_departments"),(0,s.translate)("_options")]},c={data:e,token:__currentSession.token,userIsStaff:__currentSession.userIsSuperUser||__currentSession.userIsStaff},u=n(t),d=o(i),p=r(c);a.$el.append(u);var f=l("div[data-id='".concat(a._uId,"']"));f.find("div.abm-content").append(d),f.find("tbody").append(p),(0,s.postRender)(a.$el.find("div[data-id='".concat(a._uId,"']"))),a.addTableHandlers(f.find("table")),f.find("table").cubeTable(null,null,"userManagerSuper"),f.find("div.data-table-options").append(l('<a href="#" class="btn btn-adduser" rel="tooltip" data-title="'.concat((0,s.translate)("_newUser"),'"><i class="fa fa-plus"></i></a>'))),a.addHandlers(),l("#mainLoading").hide()}))},edit:function(e){var n=l(e.currentTarget).closest("tr").attr("data-id");Promise.resolve().then((function(){var e=[t(781)];(function(e){(new e).showEdit(n)}).apply(null,e)})).catch(t.oe)},editPreferences:function(e){var n=l(e.currentTarget).closest("tr").attr("data-id");Promise.resolve().then((function(){var e=[t(781)];(function(e){(new e).showEditPref(n)}).apply(null,e)})).catch(t.oe)},deleteUser:function(n){var a=l(n.currentTarget).closest("tr").attr("data-id");t.e(6).then((function(){var n=[t(662)];(function(n){(new n).show({title:(0,s.translate)("_deleteUser"),text:(0,s.translate)("_sure_delete_user"),buttons:[{title:(0,s.translate)("cancel"),code:"no"},{title:(0,s.translate)("delete"),css:"red",code:"yes"}],callback:function(n){if("yes"==n){var o=new e;l("#mainLoading").show(),o.deleteUser(a,(function(){l("#mainLoading").hide(),Promise.resolve().then((function(){var e=[t(781)];(function(e){(new e).show()}).apply(null,e)})).catch(t.oe)}))}}})}).apply(null,n)})).catch(t.oe)},changeState:function(n){var t=l(this).closest("tr").attr("data-id"),a={user:{id:t,active:this.checked}};(new e).partialUpdate(t,a,(function(){}))},addUser:function(){Promise.resolve().then((function(){var e=[t(781)];(function(e){(new e).addUser()}).apply(null,e)})).catch(t.oe)},close:function(){var e=l("#currentTask").attr("data-rel");Promise.resolve().then((function(){var n=[t(663)];(function(n){(new n).removeTask(e)}).apply(null,n)})).catch(t.oe)},addTableHandlers:function(e){l(e).find("button.btn-edit").on("click",this.edit),l(e).find("button.btn-preference").on("click",this.editPreferences),l(e).find("input.user-state").on("ifToggled",this.changeState),l(e).find("button.btn-delete").on("click",this.deleteUser)},addHandlers:function(){var e=l("div[data-id='".concat(this._uId,"']"));e.find("div.data-table-options a.btn-adduser").on("click",this.addUser),e.find("div.abm-top-options a.btn-close").on("click",this.close),l(".iCheck-helper").attr("title",(0,s.translate)("_changeState")).tooltip()}})}.apply(n,o))||(e.exports=r)}).call(this,t(219),t(1))},2312:function(e,n,t){var a=t(669);function l(e){return e&&(e.__esModule?e.default:e)}e.exports=(a.default||a).template({1:function(e,n,a,o,r,s,i){var c,u=e.lambda,d=e.escapeExpression,p=null!=n?n:e.nullContext||{},f=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<tr data-id="'+d(u(null!=n?f(n,"id"):n,n))+'">\n  <td class="userName">'+d(u(null!=n?f(n,"first_name"):n,n))+" "+d(u(null!=n?f(n,"last_name"):n,n))+"</td>\n  <td>"+d(u(null!=n?f(n,"username"):n,n))+"</td>\n  <td>"+d(u(null!=n?f(n,"email"):n,n))+"</td>\n  <td>\n"+(null!=(c=f(a,"each").call(p,null!=n?f(n,"companies"):n,{name:"each",hash:{},fn:e.program(2,r,0,s,i),inverse:e.noop,data:r,loc:{start:{line:7,column:4},end:{line:9,column:13}}}))?c:"")+"  </td>\n  <td>\n"+(null!=(c=f(a,"each").call(p,null!=n?f(n,"groups"):n,{name:"each",hash:{},fn:e.program(4,r,0,s,i),inverse:e.noop,data:r,loc:{start:{line:12,column:4},end:{line:14,column:13}}}))?c:"")+"  </td>\n  <td>\n"+(null!=(c=f(a,"each").call(p,null!=n?f(n,"departments"):n,{name:"each",hash:{},fn:e.program(4,r,0,s,i),inverse:e.noop,data:r,loc:{start:{line:17,column:4},end:{line:19,column:13}}}))?c:"")+'  </td>\n  <td>\n    <div class="options">\n'+(null!=(c=l(t(680)).call(p,"change_user",{name:"haveAccess",hash:{},fn:e.program(7,r,0,s,i),inverse:e.noop,data:r,loc:{start:{line:23,column:6},end:{line:26,column:21}}}))?c:"")+'      \x3c!--button class="btn btn-mini btn-blue btn-preference" data-original-title=\''+d(l(t(667)).call(p,"_editUserPreferences",{name:"L",hash:{},data:r,loc:{start:{line:27,column:83},end:{line:27,column:111}}}))+"'\n        rel=\"tooltip\" data-title='"+d(l(t(667)).call(p,"_editUserPreferences",{name:"L",hash:{},data:r,loc:{start:{line:28,column:34},end:{line:28,column:62}}}))+'\'><i class="fa fa-list-ol"></i></button--\x3e\n'+(null!=(c=l(t(668)).call(p,null!=n?f(n,"active"):n,"==",!0,{name:"ifCond",hash:{},fn:e.program(9,r,0,s,i),inverse:e.program(11,r,0,s,i),data:r,loc:{start:{line:29,column:6},end:{line:33,column:17}}}))?c:"")+(null!=(c=l(t(680)).call(p,"delete_user",{name:"haveAccess",hash:{},fn:e.program(13,r,0,s,i),inverse:e.noop,data:r,loc:{start:{line:34,column:6},end:{line:37,column:21}}}))?c:"")+"    </div>\n  </td>\n</tr>\n"},2:function(e,n,t,a,l){var o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return"    <li>"+e.escapeExpression(e.lambda(null!=n?o(n,"name"):n,n))+"</li>\n"},4:function(e,n,t,a,l,o,r){var s,i=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return"    <li>"+(null!=(s=i(t,"if").call(null!=n?n:e.nullContext||{},null!=r[2]?i(r[2],"userIsStaff"):r[2],{name:"if",hash:{},fn:e.program(5,l,0,o,r),inverse:e.noop,data:l,loc:{start:{line:13,column:8},end:{line:13,column:59}}}))?s:"")+e.escapeExpression(e.lambda(null!=n?i(n,"name"):n,n))+"</li>\n"},5:function(e,n,t,a,l){var o,r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return"["+e.escapeExpression(e.lambda(null!=(o=null!=n?r(n,"company"):n)?r(o,"name"):o,n))+"] "},7:function(e,n,a,o,r){var s=null!=n?n:e.nullContext||{},i=e.escapeExpression;return'      <button class="btn btn-mini btn-green btn-edit" data-original-title=\''+i(l(t(667)).call(s,"_editUser",{name:"L",hash:{},data:r,loc:{start:{line:24,column:75},end:{line:24,column:92}}}))+"' rel=\"tooltip\"\n        data-title='"+i(l(t(667)).call(s,"_editUser",{name:"L",hash:{},data:r,loc:{start:{line:25,column:20},end:{line:25,column:37}}}))+'\'><i class="fa fa-pencil-square-o"></i></button>\n'},9:function(e,n,t,a,l){return'      <input type="checkbox" name="remember" class="icheck-me user-state" data-skin="square" data-color="blue" checked>\n'},11:function(e,n,t,a,l){return'      <input type="checkbox" name="remember" class="icheck-me user-state" data-skin="square" data-color="blue">\n'},13:function(e,n,a,o,r){var s=null!=n?n:e.nullContext||{},i=e.escapeExpression;return'      \x3c!--button class="btn btn-mini btn-red btn-delete" data-original-title=\''+i(l(t(667)).call(s,"_deleteUser",{name:"L",hash:{},data:r,loc:{start:{line:35,column:78},end:{line:35,column:97}}}))+"' rel=\"tooltip\"\n        data-title='"+i(l(t(667)).call(s,"_deleteUser",{name:"L",hash:{},data:r,loc:{start:{line:36,column:20},end:{line:36,column:39}}}))+'\'><i class="fa fa-trash"></i></button--\x3e\n'},compiler:[8,">= 4.3.0"],main:function(e,n,t,a,l,o,r){var s,i=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return null!=(s=i(t,"each").call(null!=n?n:e.nullContext||{},null!=n?i(n,"data"):n,{name:"each",hash:{},fn:e.program(1,l,0,o,r),inverse:e.noop,data:l,loc:{start:{line:1,column:0},end:{line:41,column:9}}}))?s:""},useData:!0,useDepths:!0})},702:function(e,n,t){var a=t(669);e.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(e,n,t,a,l){var o,r=null!=n?n:e.nullContext||{},s=e.hooks.helperMissing,i=e.escapeExpression,c=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="abm-base-tmp '+i("function"==typeof(o=null!=(o=c(t,"tmpClass")||(null!=n?c(n,"tmpClass"):n))?o:s)?o.call(r,{name:"tmpClass",hash:{},data:l,loc:{start:{line:1,column:25},end:{line:1,column:37}}}):o)+' container-fluid mainTask" data-id="'+i("function"==typeof(o=null!=(o=c(t,"id")||(null!=n?c(n,"id"):n))?o:s)?o.call(r,{name:"id",hash:{},data:l,loc:{start:{line:1,column:73},end:{line:1,column:79}}}):o)+'" data-rel="'+i("function"==typeof(o=null!=(o=c(t,"dataRel")||(null!=n?c(n,"dataRel"):n))?o:s)?o.call(r,{name:"dataRel",hash:{},data:l,loc:{start:{line:1,column:91},end:{line:1,column:102}}}):o)+'" data-type="tab-content">\n    <div class="row">\n        <div class="col-sm-12">\n            <div class="box">\n                <div class="box-title">\n                    <h3><i class="fa fa-th-list"></i>'+i("function"==typeof(o=null!=(o=c(t,"title")||(null!=n?c(n,"title"):n))?o:s)?o.call(r,{name:"title",hash:{},data:l,loc:{start:{line:6,column:53},end:{line:6,column:62}}}):o)+'</h3>\n                    <div class="actions abm-top-options">\n                        <a href="#" class="btn btn-close"><i class="fa fa-times"></i></a>\n                    </div>\n                </div>\n        <div class="box-content nopadding abm-content">\n\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'},useData:!0})},712:function(e,n,t){"use strict";(function(a){var l,o=t(678);void 0===(l=function(){return a.Model.extend({list:function(e,n){(0,o.send)("users/?page=1",null,{type:"GET",contentType:"application/json;charset=utf-8",dataType:"text"},n)},listByCompany:function(e){(0,o.send)("usercompanies/list_by_company_id/",null,{type:"GET",contentType:"application/json;charset=utf-8",dataType:"text"},e)},get:function(e,n){(0,o.send)("users/".concat(e,"/"),null,{type:"GET",contentType:"application/json;charset=utf-8",dataType:"text"},n)},update:function(e,n,t){(0,o.send)("users/".concat(e,"/"),n,{type:"PUT",contentType:"application/json;charset=utf-8",dataType:"text"},t)},partialUpdateUser:function(e,n,t){(0,o.send)("users/".concat(e,"/"),JSON.stringify(n),{type:"PATCH",contentType:"application/json;charset=utf-8",dataType:"text"},t)},EditProfile:function(e,n){(0,o.send)("users/".concat(e.id,"/"),JSON.stringify(e),{type:"PATCH",contentType:"application/json;charset=utf-8",dataType:"text"},n)},create:function(e,n){(0,o.send)("usercompanies/",JSON.stringify(e),{type:"POST",contentType:"application/json;charset=utf-8",dataType:"text"},n)},partialUpdate:function(e,n,t){(0,o.send)("usercompanies/".concat(e,"/"),JSON.stringify(n),{type:"PATCH",contentType:"application/json;charset=utf-8",dataType:"text"},t)},deleteUser:function(e,n){(0,o.send)("users/".concat(e,"/"),null,{type:"DELETE"},n)},deleteUserCompany:function(e,n){(0,o.send)("usercompanies/".concat(e,"/"),null,{type:"DELETE"},n)},getUserCompany:function(e,n){(0,o.send)("usercompanies/".concat(e,"/"),null,{type:"GET",contentType:"application/json;charset=utf-8",dataType:"text"},n)},UpdateUserPreference:function(e,n){var t={userCompanyId:__currentSession.userId,preferenceCode:e,value:n};(0,o.send)("user/UpdateUserPreference",t,{type:"PUT"})},GetUserPreference:function(e,n){(0,o.send)("usercompanies/preference_by_code/?code=".concat(e),null,{type:"GET"},n)},GetRelatedDashboard:function(e){(0,o.send)("user/GetRelatedDashboard",null,null,e)}})}.apply(n,[]))||(e.exports=l)}).call(this,t(219))},772:function(e,n,t){var a=t(669);e.exports=(a.default||a).template({1:function(e,n,t,a,l){return"      <th>"+e.escapeExpression(e.lambda(n,n))+"</th>\n"},compiler:[8,">= 4.3.0"],main:function(e,n,t,a,l){var o,r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<table class="table table-hover table-nomargin table-bordered">\n  <thead>\n    <tr>\n'+(null!=(o=r(t,"each").call(null!=n?n:e.nullContext||{},null!=n?r(n,"headers"):n,{name:"each",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l,loc:{start:{line:4,column:6},end:{line:6,column:15}}}))?o:"")+"    </tr>\n  </thead>\n  <tbody>\n\n  </tbody>\n</table>"},useData:!0})}}]);