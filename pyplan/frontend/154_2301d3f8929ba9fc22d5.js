/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[154],{832:function(e,t,i){"use strict";(function(a){var l,o,n=i(18),s=function(e){return e&&e.__esModule?e:{default:e}}(i(925));i(1181),i(1182),l=[i(730),i(708),i(1183),i(1184),i(1185)],void 0===(o=function(e,t,l,o,r){return e.extend({el:a("#n_o_n_e"),editorInitiated:void 0,render:function(e){this.baseRender(e),this.drawItem()},drawItem:function(){var e=t();a(this.tagId).find(".item-area").html(e),a(this.tagId).find(".btnMenu").hide(),a(this.tagId).find(".item-area").addClass("fullSize"),a(this.tagId).find(".item-title").remove(),this.drawTextEditor(a(this.tagId).find(".item-area").first())},onRemoveItemView:function(){a(this.tagId).find(".item-area .colorpick").spectrum("destroy")},updateValues:function(e){},_evaluateNode:function(e,t,i,a,l){},baseUpdateSize:function(){a(this.tagId).find(".item-area").height(a(this.tagId).parent().height()-10)},updateSize:function(){var e=a(this.tagId).find(".item-area").height()-5;a(this.tagId).find(".item-area .text-editor-wraper .wysiwyg_editor").height(e),a(this.tagId).find(".item-area .text-editor-content").height(e)},drawTextEditor:function(e){var t="";this.currentResult&&this.currentResult.itemProperties&&(t=this.currentResult.itemProperties.htmlcontent);var i={key:"editor_"+this.tagId.substring(1)},a=l(i);e.html(a),e.find(".wysiwyg_editor").html(t),this.setVisibleItem(),this.isReady=!0},editModeChanged:function(){this.setVisibleItem();var e=a(this.tagId).find(".item-area .text-editor-wraper .wysiwyg_editor"),t=a(this.tagId).find(".item-area .text-editor-content");if(!this.editMode){var i=e.html();t.html(i),this.currentResult.itemProperties.htmlcontent=i}this.ensureLinks()},setVisibleItem:function(){if(this.editMode){if(a(this.tagId).find(".item-area .text-editor-content").hide(),a(this.tagId).find(".item-area .text-editor-wraper").show(),!this.editorInitiated){this.editorInitiated=!0;var e=this,t=(this.tagId.substring(1),a(this.tagId).find(".item-area .text-editor-wraper .wysiwyg_editor"));t.wysiwyg({toolbar:"selection",hijackcontextmenu:!1,placeholder:"Type your text here...",dropfileclick:"Click or drop image",placeholderUrl:"www.example.com",buttons:{attachImage:{title:"Insert image",image:"",popup:function(i,l){var o=r(),n=a("<div/>").addClass("wysiwyg-toolbar-linktodashboard").attr("unselectable","on");n.append(o),i.append(n),e.initUploader(),n.find("button.wysiwyg-toolbar-icon").on("click",function(){var e="<img src='"+n.find("input.imgUrl").val()+"' />";t.wysiwyg("shell").insertHTML(e).closePopup()})}},insertlink:{title:"Insert link",image:""},linktodashboard:{title:(0,n.translate)("link_to_dashboard"),image:"",popup:function(e,l){var o=t.wysiwyg("shell").getSelectedHTML();if(o){var s=a("<div/>").addClass("wysiwyg-toolbar-linktodashboard").attr("unselectable","on"),r="<select class='dashboard_selector'><option>"+(0,n.translate)("loading")+"</option></select>",d="<select class='target_selector'><option value='_self'>"+(0,n.translate)("close_current")+"</option><option value='_blank'>"+(0,n.translate)("open_new")+"</option></select>";s.append(r),s.append(d),s.append("<a class='wysiwyg-toolbar-icon' href='#' title='Ok' unselectable='on'><i class='fa fa-check'></i></a>"),e.append(s),s.find("a.wysiwyg-toolbar-icon").on("click",function(){var e=s.find("select.dashboard_selector"),i=s.find("select.target_selector"),a=e.val(),l=(e.select2("data").text,"<span class='link-to-dashboard' data-dashboard-id='"+a+"' "+("data-target='"+i.val()+"'")+">"+o+"</span>");t.wysiwyg("shell").insertHTML(l).closePopup()}),setTimeout(function(){var e=s.find("select.dashboard_selector"),t=a("<div></div>").html(o).find("span.link-to-dashboard").attr("data-dashboard-id");t&&e.val(t),e.select2({width:210,minimumResultsForSearch:1,escapeMarkup:function(e){return e}}),i.e(12).then(function(){var t=[i(744)];(function(t){(new t).show(e)}).apply(null,t)}).catch(i.oe),s.find(".select2-chosen").html((0,n.translate)("select_dashboard"))},100)}}},linktomodule:{title:(0,n.translate)("link_to_module"),image:"",popup:function(e,l){var o=t.wysiwyg("shell").getSelectedHTML();if(o){var n=a("<div/>").addClass("wysiwyg-toolbar-linktodashboard").attr("unselectable","on");n.append("<select class='module_selector'></select>"),n.append("<a class='wysiwyg-toolbar-icon' href='#' title='Ok' unselectable='on'><i class='fa fa-check'></i></a>"),e.append(n),n.find("a.wysiwyg-toolbar-icon").on("click",function(){var e=n.find("select.module_selector"),i=e.val(),a=e.find("option:selected").text(),l="<span class='cubeplan-module' data-module='"+i+"' data-title='"+(a=a.replace("'",""))+"'>"+o+"</span>";t.wysiwyg("shell").insertHTML(l).closePopup()}),setTimeout(function(){var e=n.find("select.module_selector");Promise.resolve().then(function(){var t=[i(684)];(function(t){var i=(new t).getModuleList();a.each(i,function(t,i){a("<option/>").val(i.key).text(i.name).appendTo(e)})}).apply(null,t)}).catch(i.oe)},100)}}},fontsize:{title:"Size",image:"",popup:function(e,i){var l=a("<div/>").addClass("wysiwyg-toolbar-list").attr("unselectable","on");a.each({Huge:7,Larger:6,Large:5,Normal:4,Small:3,Smaller:2,Tiny:1},function(e,i){var o=a("<a/>").attr("href","#").css("font-size",8+3*i+"px").html(e).click(function(e){s.default.init();var l="rangyTemp_"+ +new Date;return s.default.createCssClassApplier(l,!0).applyToSelection(),a("."+l).css("font-size",i+"vmin").removeClass(l),t.wysiwyg("shell").closePopup(),e.stopPropagation(),e.preventDefault(),!1});l.append(o)}),e.append(l)}},bold:{title:"Bold (Ctrl+B)",image:"",hotkey:"b"},italic:{title:"Italic (Ctrl+I)",image:"",hotkey:"i"},underline:{title:"Underline (Ctrl+U)",image:"",hotkey:"u"},strikethrough:{title:"Strikethrough (Ctrl+S)",image:"",hotkey:"s"},forecolor:{title:"Text color",image:""},highlight:{title:"Background color",image:""},alignleft:{title:"Left",image:""},aligncenter:{title:"Center",image:""},alignright:{title:"Right",image:""},alignjustify:{title:"Justify",image:""},indent:!1,outdent:!1,orderedList:{title:"Ordered list",image:""},unorderedList:{title:"Unordered list",image:""},removeformat:{title:"Remove format",image:""},viewhtml:{title:"View html",image:"",click:function(e){t.wysiwyg("shell").closePopup();var a={html:t.html()},l=o(a);i.e(5).then(function(){var e=[i(683)];(function(e){(new e).show({title:(0,n.translate)("edit_html"),html:l,okOnEnter:!1,buttons:[{title:(0,n.translate)("ok"),css:"primary",code:"ok"},{title:(0,n.translate)("cancel"),code:"cancel"}],callback:function(e,i){"ok"==e&&t.wysiwyg("shell").setHTML(i.find(".pureHtmlEditor").val())},onLoad:function(e){e.find(".pureHtmlEditor").focus()}})}).apply(null,e)}).catch(i.oe)}}},submit:{title:"Submit",image:""}})}}else a(this.tagId).find(".item-area .text-editor-content").show(),a(this.tagId).find(".item-area .text-editor-wraper").hide();this.updateSize()},ensureLinks:function(){a(this.tagId).find(".item-area .text-editor-content").find("a").each(function(e,t){var i=a(this).attr("href");i&&0!=i.toLowerCase().indexOf("http")&&a(this).attr("href","http://"+a(this).attr("href")),a(this).attr("target")&&"_blank"==a(this).attr("target")||a(this).attr("target","_blank")})},initUploader:function(){var e=this,t=a("#uploader");a("#uploader").css("z-index","1000"),a("#uploader").css("width","100%"),a("#uploader").css("height","190px"),a("#uploader").css("margin-bottom","10px"),t.pluploadQueue({runtimes:"html5, html4",url:"".concat(__apiURL,"/scripts/uploader.ashx"),max_file_size:"0",chunk_size:"10mb",multi_selection:!1,browse_button:"uploader_filelist",unique_names:!1,resize:{width:2048,height:2048,quality:80},filters:[{title:"Image files",extensions:"jpg,gif,png"}],flash_swf_url:"js/plupload/plupload.flash.swf",silverlight_xap_url:"js/plupload/plupload.silverlight.xap",init:{FilesAdded:function(t,i){e.name=a.uuid()+".png",e.name=e.name.replace(/-/g,"_"),this.setOption({multipart_params:{targetPath:"",action:"dashboard",token:__currentToken,name:e.name}}),t.start()},FileUploaded:function(t,i,l){l&&""!=l.response&&"ok"!=l.response?(0,n.showMessage)(l.response,void 0,"error"):a(e.tagId).find(".item-area .text-editor-wraper .wysiwyg_editor").wysiwyg("shell").closePopup()}}});(t=a("#uploader")).pluploadQueue();a(".plupload_header").remove(),a(".plupload_filelist_header").remove(),a(".plupload_progress_container").addClass("progress").addClass("progress-striped"),a(".plupload_progress_bar").addClass("bar"),a(".plupload_file_action").hide(),a(".plupload_file_status").hide(),a(".plupload_total_status").hide(),a(".plupload_file_size").hide(),a(".plupload_filelist_footer").css("height","32px").css("padding","0"),a(".plupload_filelist").css("height","160px"),a(".plupload_button").each(function(){a(this).hide()}),a("#attached-docs").bind("dragover",function(t){return a("#attached-docs.edit-mode").length>0&&e.showUploader(),!1}),a(".plupload_filelist").bind("drop",function(e){var i=(t=a("#uploader")).pluploadQueue();i.splice(),i.refresh()}).bind("dragleave",function(t){return e.hideUploader(),!1})},hideUploader:function(){a("#uploader").css("display","none")}})}.apply(t,l))||(e.exports=o)}).call(this,i(1))}}]);