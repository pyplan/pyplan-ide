/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[158,6],{2368:function(e,t,n){"use strict";(function(o,a){var i,r,c=n(18);i=[n(662),n(2369),n(707)],void 0===(r=function(e,t,n){return o.View.extend({el:a("#main"),render:function(o,i,r){var l=t({source:o}),s=new n,d=this,u=i?(0,c.translate)("move_to"):(0,c.translate)("copy_in");a("#tree-container").perfectScrollbar(),(new e).show({title:u,html:l,modalClass:"shortModal",buttons:[{title:(0,c.translate)("cancel"),code:"close"},{title:i?(0,c.translate)("move"):(0,c.translate)("copy"),css:"primary",code:"yes"}],callback:function(e,t){if("yes"==e){t.modal("hide");var l=a("#right-column > div.fm-highlight-toolbar > div.pull-left a").not('[disabled="disabled"]');l.attr("disabled","disabled");var s=new n;return i?(0,c.haveAccess)("add_file_public")&&d.isInPublic(d.moveToPath)||!d.isInPublic(d.moveToPath)?s.moveFiles(o,d.moveToPath,(function(){r(d.moveToPath),l.removeAttr("disabled")})):(l.removeAttr("disabled"),(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": add_file_public"),(0,c.translate)("_move_files"),"error")):(0,c.haveAccess)("add_file_public")&&d.isInPublic(d.moveToPath)||!d.isInPublic(d.moveToPath)?s.copyFiles(o,d.moveToPath,(function(){r(d.moveToPath),l.removeAttr("disabled")})):(l.removeAttr("disabled"),(0,c.showMessage)("".concat((0,c.translate)("no_permission_to_perform_action")," - ").concat((0,c.translate)("permission"),": add_file_public"),(0,c.translate)("_copy_files"),"error")),!1}},onLoad:function(){setTimeout((function(){a("#main-modal button.btn-primary").focus()}),500),a("#treeMoveTo").jstree({plugins:["wholerow","types","contextmenu","dnd"],types:{default:{icon:"fa fa-folder"},folder:{icon:"fa fa-folder"},shared:{icon:"fa fa-users"},recent:{icon:"fa fa-clock"},favs:{icon:"fa fa-star"},trash:{icon:"fa fa-trash"},file:{icon:"fa fa-file"},myfolder:{icon:"fa fa-user"},public:{icon:"fa fa-globe"},zip:{icon:"fa-file-archive-o"},modelsPath:{icon:"fa fa-cubes"},model:{icon:"fa fa-cube"}},core:{check_callback:!0,themes:{name:"proton",responsive:!0},data:function(e,t){if("#"===e.id)s.getMainFolders((function(e){null!==e&&(e=d.optimizeStructureForTree(e,"tree"),t.call(this,e)),d.openRootNodes(e)}));else{var n=""===e.data.fullPath?"/":e.data.fullPath;s.getFiles(n,(function(e){null!==e&&(e=d.optimizeStructureForTree(e,"tree"),t.call(this,e))}))}}}}).on("changed.jstree",(function(e,t){if(t.node){var n=""===t.node.data.fullPath?"/":t.node.data.fullPath;d.moveToPath=n,s.getFiles(n,(function(e){null!==e&&(e=d.optimizeStructureForTree(e,"list"))}))}}))}})},openRootNodes:function(e){var t=setInterval((function(){if(a("#treeMoveTo .jstree-container-ul li").length===e.length){clearInterval(t);var n=0;a("#treeMoveTo .jstree-container-ul li").each((function(){0===n&&a("#treeMoveTo").jstree("select_node",a(this),!1,!0),a("#treeMoveTo").jstree("open_node",a(this)),n++}))}}),5)},optimizeStructureForTree:function(e,t){var n=[];(0,c.haveAccess)("copy_model_to_my_workspace")||0!==e[0].type||e.splice(0,1);for(var o=0;o<e.length;o++){if(1===e[o].type||0===e[o].type?(e[o].children=!0,e[o].type="folder"):"tree"===t&&n.push(o),0!==e[o].data.specialFolderType)switch(e[o].children=!0,e[o].data.specialFolderType){case 0:e[o].type="folder";break;case 1:e[o].type="myfolder";break;case 2:e[o].type="public";break;case 3:e[o].type="company";break;case 4:e[o].type="modelsPath";break;case 5:e[o].type="shared";break;default:e[o].type="folder"}if(0===e[o].type||2===e[o].type)switch(e[o].data.specialFileType){case 0:e[o].type="file";break;case 1:e[o].type="model";break;case 2:e[o].type="zip";break;default:e[o].type="file"}}if("tree"===t)for(var a=0;a<n.length;a++)e.splice(n[n.length-(a+1)],1);return e},isInPublic:function(e){return e.toLowerCase().indexOf("/public/")>=0||e.toLowerCase().endsWith("/public")}})}.apply(t,i))||(e.exports=r)}).call(this,n(219),n(1))},2369:function(e,t,n){var o=n(669);e.exports=(o.default||o).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,o,a){return'<div class="box">\n    <span>Choose destination for selected element(s)</span>\n\n    <div class="box-content">\n      <div class="row">\n        <div class="col-sm-12">\n\n          \x3c!-- START: Left column --\x3e\n          <div id="tree-container" class="col-sm-12 nopadding" style="overflow: scroll; height: 350px;">\n\n            <div id="treeMoveTo"></div>\n\n          </div>\n          \x3c!-- END: Left column --\x3e\n        </div>\n      </div>\n\n    </div>\n</div>\n'},useData:!0})},662:function(e,t,n){"use strict";(function(o){var a;void 0===(a=function(){return o.Controller.extend({name:"showModal",show:function(e){Promise.all([n.e(2),n.e(229)]).then((function(){var t=[n(685)];(function(t){(new t).render(e)}).apply(null,t)})).catch(n.oe)}})}.apply(t,[]))||(e.exports=a)}).call(this,n(676))},707:function(e,t,n){"use strict";(function(o){var a,i=n(678);void 0===(a=function(){return o.Model.extend({url:"myFileManager",getMainFolders:function(e){(0,i.send)("fileManager/getMainFolders/",null,{type:"GET"},e)},getFiles:function(e,t){(0,i.send)("fileManager/getFiles/?folder=".concat(encodeURIComponent(e)),null,{type:"GET"},t)},createFolder:function(e,t,n){(0,i.send)("fileManager/createFolder/",{folder_path:e,folder_name:t},{type:"POST"},n)},deleteFiles:function(e,t){(0,i.send)("fileManager/deleteFiles/",JSON.stringify({sources:e}),{type:"DELETE",contentType:"application/json",dataType:"text"},t)},renameFiles:function(e,t,n){(0,i.send)("fileManager/renameFile/?source=".concat(encodeURIComponent(e),"&newName=").concat(t),null,{type:"GET"},n)},unzipFile:function(e,t,n){(0,i.send)("fileManager/unzipFile/?source=".concat(e,"&targetFolder=").concat(encodeURIComponent(t)),null,{type:"GET",dataType:"text"},n)},moveFiles:function(e,t,n){var o=e.map((function(e){return"sources=".concat(e)})).join("&");(0,i.send)("fileManager/moveFiles/?".concat(o,"&target=").concat(encodeURIComponent(t)),null,{type:"GET",dataType:"text"},n)},copyToMyWorkspace:function(e,t){(0,i.send)("fileManager/copyToMyWorkspace/?source="+encodeURIComponent(e),null,{type:"GET",dataType:"text"},t)},copyFiles:function(e,t,n){var o=e.map((function(e){return"sources=".concat(e)})).join("&");(0,i.send)("fileManager/copyFiles/?".concat(o,"&target=").concat(encodeURIComponent(t)),null,{type:"GET",dataType:"text"},n)},duplicateFiles:function(e,t){var n=e.map((function(e){return"sources=".concat(e)})).join("&");(0,i.send)("fileManager/duplicateFiles/?".concat(n),null,{type:"GET"},t)},zipFiles:function(e,t){var n=e.map((function(e){return"sources=".concat(e)})).join("&");(0,i.send)("fileManager/zipFiles/?".concat(n),null,{type:"GET",dataType:"text"},t)},downloadFiles:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){},c=e.map((function(e){return"sources=".concat(e)})).join("&"),l=new XMLHttpRequest;l.responseType="arraybuffer",l.open("GET","".concat(__apiURL,"/fileManager/download/?").concat(c),!0),l.setRequestHeader("Authorization","Token ".concat(__currentToken)),l.setRequestHeader("session-key",__currentSession?__currentSession.session_key:""),l.onloadstart=o,l.onreadystatechange=function(e){var o=e.currentTarget;o.onprogress=a,o.onerror=r,o.onloadend=i,o.readyState==o.DONE&&(200==o.status?t(o):n.e(18).then((function(){var e=[n(664)];(function(e){(new e).show({title:"ERROR!",text:o.response,notifyType:"error"})}).apply(null,e)})).catch(n.oe))},l.send()},getDepartments:function(e){(0,i.send)("departments/by_current_company/",null,{type:"GET"},e)},getDeniedDepartments:function(e,t){(0,i.send)("departments/denied/?folder=".concat(encodeURIComponent(e)),null,{type:"GET"},t)},setDeniedPath:function(e,t){(0,i.send)("departments/deny_items/",JSON.stringify(e),{type:"POST",contentType:"application/json;charset=utf-8"},t)},optimzeTemplates:function(e,t,n){var o=e.map((function(e){return"sources=".concat(e)})).join("&");(0,i.send)("fileManager/optimizeTemplates/?".concat(o),null,{type:"GET",dataType:"text"},t,n)}})}.apply(t,[]))||(e.exports=a)}).call(this,n(219))}}]);