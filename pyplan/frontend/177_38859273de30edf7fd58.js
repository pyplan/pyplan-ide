/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[177],{2345:function(n,e,a){"use strict";(function(t,l){var o,i,r=a(18);o=[a(220),a(2346),a(2347),a(2348)],void 0===(i=function(n,e,o,i){return t.View.extend({el:l("#main"),render:function(n){if(!(this.$el.find(".manageLibsModal").length>0)){this.isRefreshing=!1,n.notDesktop=!1,n.canSaveModel=this.canSaveModel(),n.cantSaveModel=!n.canSaveModel,n.buttons=[{title:(0,r.translate)("close"),code:"cancel"}];var a=e(n);this.$el.append(a);var t=l(".manageLibsModal");this.getData(),t.find(".modal-footer button").click((function(e){e.preventDefault();var a=!0,o=l(this).attr("data-code");return n.callback&&!1===n.callback.call(this,o,t)&&(a=!1),a&&(t.off("shown"),t.modal("hide")),!1})),t.on("show.bs.modal",(function(){if(0===l(".manageLibsModal:visible").length){var e=100014+10*l(".modal:visible").length;l(this).css("z-index",e),setTimeout((function(){l(".modal-backdrop").not(".modal-stack").css("z-index",e-10).addClass("modal-stack")}),0),n.hasOwnProperty("onLoad")&&n.onLoad(t),!0!==n.okOnEnter&&void 0!==n.okOnEnter||t.keyup((function(n){13==n.keyCode&&t.find("button.btn-primary").click()}))}})),t.on("hidden.bs.modal",(function(){t.off("hidden"),n.hasOwnProperty("onClose")&&n.onClose(t),t.remove()})),t.modal(n.backdrop?{backdrop:"static",keyboard:!1}:null),this.addHandlers(t)}},getData:function(){var e=this;if(!this.isRefreshing){this.isRefreshing=!0;var a=new n,t=["pip","setuptools"];//!IMPORTANT libs that are installed in /data/models/<companyname>/<username>/.venv/ but are system libraries
a.listInstalledLibraries((function(n){var a={libraries:n.map((function(n){return n.isSystem=!0,"/usr"==n.location.substring(0,4)||t.includes(n.name)||(n.isSystem=!1),n}))};e.instantiateTable(e,a)}))}},instantiateTable:function(n,e){var t=l(".manageLibsModal"),s=t.find(".manageLibsTable"),c=s.find(".thName"),d=s.find(".thVersion"),u=(s.find(".thSystem"),s.find(".thActions")),m=null;l.fn.dataTable.isDataTable(s)&&s.DataTable().clear().destroy(),c.width("34%"),d.width("33%"),u.width("33%"),m=[{data:"name"},{data:null,render:function(n,e,a){var t=null;return n?(t=l('<div><span class="badge">'.concat(n.version,"</span></div>"))).prop("outerHTML"):t}},{data:null,render:function(e,a,t){var o=null;return e&&!e.isSystem&&n.canSaveModel()?(o=l(i())).prop("outerHTML"):o}}];var b=s.DataTable({pageLength:5,lengthChange:!1,data:e.libraries,order:[[2,"desc"]],columns:m,initComplete:function(){l(".manageLibsTable tbody").off("click",".btnRemoveLibrary"),l(".manageLibsTable tbody").on("click",".btnRemoveLibrary",(function(e){e.preventDefault();var i=b.row(l(this).closest("tr")).data(),s={title:(0,r.translate)("remove_library"),content:o({name:i.name}),left:e.clientX,top:e.clientY};a.e(14).then((function(){var e=[a(732)];(function(e){(new e).show(s,(function(e){var o=l("#".concat(e.options.id));o.find(".cancelRemoveLib").on("click",(function(n){o.trigger("hide")})),o.find(".confirmRemoveLib").on("click",(function(e){o.trigger("hide"),n.toggleButtons(t,!0),Promise.resolve().then((function(){var e=[a(220)];(function(e){(new e).uninstallLibrary(i.name,i.location,(function(e){(0,r.showMessage)((0,r.translate)("library_successfully_removed"),(0,r.translate)("_successfully_removed"),"success",!0),n.toggleButtons(t),n.getData()}))}).apply(null,e)})).catch(a.oe)}))}))}).apply(null,e)})).catch(a.oe)}))}});n.isRefreshing=!1},addHandlers:function(n){var e=this;n.find(".btnAddLibrary").on("click",(function(n){n.preventDefault(),Promise.resolve().then((function(){var n=[a(698)];(function(n){(new n).installLibsModal({title:(0,r.translate)("install_libraries"),okOnEnter:!0,modalClass:"mediumModal",buttons:[{title:(0,r.translate)("close"),code:"cancel"}],onLoad:function(n){n.find(".pureHtmlEditor").focus()}})}).apply(null,n)})).catch(a.oe)})),l(".manageLibsModal").on("refreshData",(function(n){e.getData()}))},toggleButtons:function(n){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.find(".btnAddLibrary").attr("disabled",e),n.find(".modal-footer button").attr("disabled",e),n.find(".btnRemoveLibrary").attr("disabled",e)},canSaveModel:function(){var n=!1,e=__currentSession.autoopenUri&&__currentSession.autoopenUri.toLowerCase().indexOf("/public/")>=0;return((0,r.haveAccess)("change_model")&&!e||(0,r.haveAccess)("change_public_model")&&e)&&(n=!0,__currentSession.modelInfo&&__currentSession.modelInfo.readonly&&(n=!1)),n}})}.apply(e,o))||(n.exports=i)}).call(this,a(219),a(1))},2346:function(n,e,a){var t=a(669);function l(n){return n&&(n.__esModule?n.default:n)}n.exports=(t.default||t).template({1:function(n,e,t,o,i){return'            <button class="btn btn-primary btnAddLibrary"><i class="fad fa-plus-circle"></i>\n              '+n.escapeExpression(l(a(667)).call(null!=e?e:n.nullContext||{},"install_libraries",{name:"L",hash:{},data:i,loc:{start:{line:14,column:14},end:{line:14,column:39}}}))+"</button>\n"},3:function(n,e,a,t,l){return'                  <th class="thSystem">System</th>\n'},5:function(n,e,t,o,i){var r=null!=e?e:n.nullContext||{},s=n.escapeExpression;return'            <div class="alert alert-warning alertCantSaveModel" role="alert">\n              <b>'+s(l(a(667)).call(r,"not_perm_to_save_model",{name:"L",hash:{},data:i,loc:{start:{line:34,column:17},end:{line:34,column:47}}}))+"</b><br />\n              "+s(l(a(667)).call(r,"can_list_libs_but_not_change",{name:"L",hash:{},data:i,loc:{start:{line:35,column:14},end:{line:35,column:50}}}))+"\n            </div>\n"},7:function(n,e,a,t,l){var o,i=n.lambda,r=n.escapeExpression,s=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'        <button class="btn btn-'+r(i(null!=e?s(e,"css"):e,e))+'" data-code="'+r(i(null!=e?s(e,"code"):e,e))+'" data-dismiss="modal"\n          aria-hidden="true">'+(null!=(o=s(a,"if").call(null!=e?e:n.nullContext||{},null!=e?s(e,"icon"):e,{name:"if",hash:{},fn:n.program(8,l,0),inverse:n.noop,data:l,loc:{start:{line:47,column:29},end:{line:47,column:58}}}))?o:"")+" "+r(i(null!=e?s(e,"title"):e,e))+"</button>\n"},8:function(n,e,a,t,l){var o,i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return null!=(o=n.lambda(null!=e?i(e,"icon"):e,e))?o:""},compiler:[8,">= 4.3.0"],main:function(n,e,a,t,l){var o,i=n.lambda,r=n.escapeExpression,s=null!=e?e:n.nullContext||{},c=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div id="main-modal" class="modal fade manageLibsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"\n  aria-hidden="true" data-backdrop="static" data-keyboard="false" style="display: none;">\n  <div class="modal-dialog '+r(i(null!=e?c(e,"modalClass"):e,e))+'">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h4 class="modal-title" id="myModalLabel">'+r(i(null!=e?c(e,"title"):e,e))+'</h4>\n      </div>\n\n      <div class="modal-body" style="overflow-y:auto; overflow-x: hidden;">\n        <div class="container-fluid">\n          <div class="row manageLibsActions">\n'+(null!=(o=c(a,"if").call(s,null!=e?c(e,"canSaveModel"):e,{name:"if",hash:{},fn:n.program(1,l,0),inverse:n.noop,data:l,loc:{start:{line:12,column:12},end:{line:15,column:19}}}))?o:"")+'          </div>\n          <div class="row manageLibsList">\n            <table class="table table-stripped table-hover manageLibsTable">\n              <thead class="thead-light">\n                <tr>\n                  <th class="thName">Name</th>\n                  <th class="thVersion">Version</th>\n'+(null!=(o=c(a,"if").call(s,null!=e?c(e,"notDesktop"):e,{name:"if",hash:{},fn:n.program(3,l,0),inverse:n.noop,data:l,loc:{start:{line:23,column:18},end:{line:25,column:25}}}))?o:"")+'                  <th class="thActions">Actions</th>\n                </tr>\n              </thead>\n            </table>\n          </div>\n          <div class="row manageLibsBottomActions">\n'+(null!=(o=c(a,"if").call(s,null!=e?c(e,"cantSaveModel"):e,{name:"if",hash:{},fn:n.program(5,l,0),inverse:n.noop,data:l,loc:{start:{line:32,column:12},end:{line:37,column:19}}}))?o:"")+'\n          </div>\n        </div>\n\n      </div>\n\n      <div class="modal-footer">\n'+(null!=(o=c(a,"each").call(s,null!=e?c(e,"buttons"):e,{name:"each",hash:{},fn:n.program(7,l,0),inverse:n.noop,data:l,loc:{start:{line:45,column:8},end:{line:48,column:17}}}))?o:"")+"      </div>\n    </div>\n  </div>\n</div>"},useData:!0})},2347:function(n,e,a){var t=a(669);function l(n){return n&&(n.__esModule?n.default:n)}n.exports=(t.default||t).template({compiler:[8,">= 4.3.0"],main:function(n,e,t,o,i){var r=null!=e?e:n.nullContext||{},s=n.escapeExpression,c=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div class="removeLibraryPopoverContent">\n  <div class="sureRemoveLib">'+s(l(a(667)).call(r,"sure_delete_library",{name:"L",hash:{},data:i,loc:{start:{line:2,column:29},end:{line:2,column:56}}}))+" "+s(n.lambda(null!=e?c(e,"name"):e,e))+' ?</div>\n  <div class="removeLibActions">\n    <button class="btn btn-mini btn-primary confirmRemoveLib">'+s(l(a(667)).call(r,"confirm_delete_library",{name:"L",hash:{},data:i,loc:{start:{line:4,column:62},end:{line:4,column:92}}}))+'</button>\n    <button class="btn btn-mini cancelRemoveLib">'+s(l(a(667)).call(r,"cancel",{name:"L",hash:{},data:i,loc:{start:{line:5,column:49},end:{line:5,column:63}}}))+"</button>\n  </div>\n</div>"},useData:!0})},2348:function(n,e,a){var t=a(669);n.exports=(t.default||t).template({compiler:[8,">= 4.3.0"],main:function(n,e,t,l,o){var i,r=n.escapeExpression,s=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div>\n  <button class="btn btn-mini btn-red btnRemoveLibrary" data-original-title="'+r((i=a(667),i&&(i.__esModule?i.default:i)).call(null!=e?e:n.nullContext||{},"remove_library",{name:"L",hash:{},data:o,loc:{start:{line:2,column:77},end:{line:2,column:99}}}))+'" rel="tooltip"\n    data-title="'+r(n.lambda(null!=e?s(e,"remove_library"):e,e))+'">\n    <i class="fas fa-trash"></i>\n  </button>\n</div>'},useData:!0})}}]);