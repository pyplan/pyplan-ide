/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{1367:function(e,t,a){var n=a(690);function o(e){return e&&(e.__esModule?e.default:e)}e.exports=(n.default||n).template({1:function(e,t,a,n,o){return" from-external "},3:function(e,t,n,i,r){return'      <button class="btn btnEdit" title="'+e.escapeExpression(o(a(688)).call(null!=t?t:e.nullContext||{},"edit_dashboard",{name:"L",hash:{},data:r,loc:{start:{line:9,column:41},end:{line:9,column:63}}}))+'">\n        <i class="fa fa-pencil-square-o"></i>\n      </button>\n      <button class="btn btnShow nodisplay">\n        <i class="fa fa-check"></i>\n      </button>\n      <button class="btn btnCancel nodisplay">\n        <i class="fa fa-times"></i>\n      </button>\n'},5:function(e,t,n,i,r){return'      <button class="btn btnMore" title="'+e.escapeExpression(o(a(688)).call(null!=t?t:e.nullContext||{},"more_dashboards",{name:"L",hash:{},data:r,loc:{start:{line:24,column:41},end:{line:24,column:64}}}))+'">\n        <i class="fa fa-bars"></i>\n      </button>\n'},7:function(e,t,n,i,r){var s;return null!=(s=o(a(695)).call(null!=t?t:e.nullContext||{},"share_dashboard",{name:"haveAccess",hash:{},fn:e.program(8,r,0),inverse:e.noop,data:r,loc:{start:{line:29,column:6},end:{line:33,column:21}}}))?s:""},8:function(e,t,n,i,r){return'      <button class="btn btnShare" title="'+e.escapeExpression(o(a(688)).call(null!=t?t:e.nullContext||{},"share",{name:"L",hash:{},data:r,loc:{start:{line:30,column:42},end:{line:30,column:55}}}))+'">\n        <i class="fa fa-share-square"></i>\n      </button>\n'},10:function(e,t,n,i,r){return'      <button class="btn btnScenarios" title="'+e.escapeExpression(o(a(688)).call(null!=t?t:e.nullContext||{},"scenario_manager",{name:"L",hash:{},data:r,loc:{start:{line:36,column:46},end:{line:36,column:70}}}))+'">\n        <i class="fa fa-database"></i>\n      </button>\n'},12:function(e,t,n,i,r){return'      <button class="btn btnDataSnapshot" title="'+e.escapeExpression(o(a(688)).call(null!=t?t:e.nullContext||{},"data_snapshot",{name:"L",hash:{},data:r,loc:{start:{line:41,column:49},end:{line:41,column:70}}}))+'">\n        <i class="fa fa-camera"></i>\n      </button>\n      '},14:function(e,t,n,i,r){return'\n      <button class="btn btnCopy" title="'+e.escapeExpression(o(a(688)).call(null!=t?t:e.nullContext||{},"copy_dashboard",{name:"L",hash:{},data:r,loc:{start:{line:45,column:41},end:{line:45,column:63}}}))+'">\n        <i class="fa fa-files"></i>\n      </button>\n'},16:function(e,t,a,n,o){return""},compiler:[8,">= 4.3.0"],main:function(e,t,n,i,r){var s,d=null!=t?t:e.nullContext||{},l=e.escapeExpression;return'<div\n  class="container-fluid mainTask full-horizontal dashboardTask hideClose '+(null!=(s=n.if.call(d,null!=(s=null!=t?t.extraOptions:t)?s.external:s,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r,loc:{start:{line:2,column:74},end:{line:2,column:125}}}))?s:"")+'"\n  data-rel="dashboard-'+l(e.lambda(null!=t?t.id:t,t))+'" data-type="tab-content">\n\n  <div class="breadcrumbs nodisplay">\n\n    <div class="toolbar">\n'+(null!=(s=o(a(695)).call(d,"add_dashboard",{name:"haveAccess",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r,loc:{start:{line:8,column:6},end:{line:18,column:21}}}))?s:"")+'      <button class="btn btnRefresh" title="'+l(o(a(688)).call(d,"refresh_dashboard",{name:"L",hash:{},data:r,loc:{start:{line:19,column:44},end:{line:19,column:69}}}))+'">\n        <i class="fa fa-refresh"></i>\n      </button>\n\n'+(null!=(s=o(a(695)).call(d,"view_report",{name:"haveAccess",hash:{},fn:e.program(5,r,0),inverse:e.noop,data:r,loc:{start:{line:23,column:6},end:{line:27,column:21}}}))?s:"")+(null!=(s=n.if.call(d,null!=t?t.notDesktop:t,{name:"if",hash:{},fn:e.program(7,r,0),inverse:e.noop,data:r,loc:{start:{line:28,column:6},end:{line:34,column:13}}}))?s:"")+(null!=(s=o(a(695)).call(d,"MANAGESCENARIOS",{name:"haveAccess",hash:{},fn:e.program(10,r,0),inverse:e.noop,data:r,loc:{start:{line:35,column:6},end:{line:39,column:21}}}))?s:"")+(null!=(s=o(a(695)).call(d,"change_data_snapshots",{name:"haveAccess",hash:{},fn:e.program(12,r,0),inverse:e.noop,data:r,loc:{start:{line:40,column:6},end:{line:44,column:21}}}))?s:"")+" "+(null!=(s=o(a(695)).call(d,"add_dashboard",{name:"haveAccess",hash:{},fn:e.program(14,r,0),inverse:e.noop,data:r,loc:{start:{line:44,column:22},end:{line:48,column:21}}}))?s:"")+'\n      <button class="btn btnPrint" title="'+l(o(a(688)).call(d,"print_dashboard",{name:"L",hash:{},data:r,loc:{start:{line:50,column:42},end:{line:50,column:65}}}))+'">\n        <i class="fa fa-print"></i>\n      </button>\n\n'+(null!=(s=o(a(695)).call(d,"list_dashboardcomments",{name:"haveAccess",hash:{},fn:e.program(16,r,0),inverse:e.noop,data:r,loc:{start:{line:54,column:6},end:{line:58,column:21}}}))?s:"")+'\n      <div class="sure_cancel_dashboard nodisplay">\n        <span>'+l(o(a(688)).call(d,"sure_cancel_save_dashboard",{name:"L",hash:{},data:r,loc:{start:{line:61,column:14},end:{line:61,column:48}}}))+'</span>\n        <button class="btn btn-small btn-red btnGoCancel">'+l(o(a(688)).call(d,"yes",{name:"L",hash:{},data:r,loc:{start:{line:62,column:58},end:{line:62,column:69}}}))+'</button>\n        <button class="btn btn-small btn-grey btnCancelCancel">'+l(o(a(688)).call(d,"no",{name:"L",hash:{},data:r,loc:{start:{line:63,column:63},end:{line:63,column:73}}}))+'</button>\n      </div>\n\n      <span class="shared-message"></span>\n    </div>\n\n    <ul class="pagination pagination-sm report-navigator">\n      <li class="disabled">\n        <a href="#" class="btnNavigatorPrior">\n          <i class="fa fa-chevron-left"></i>\n        </a>\n      </li>\n      <li class="disabled">\n        <a href="#" class="btnNavigatorNext">\n          <i class="fa fa-chevron-right"></i>\n        </a>\n      </li>\n    </ul>\n\n    <ul class="nav nav-tabs dashboard-tabs nodisplay" style="overflow-x: inherit;">\n    </ul>\n\n  </div>\n\n  <div class="row-fluid dashboard-area">\n    <div class="main-pane">\n\n    </div>\n\n    <div class="main-fullscreen">\n      <div class="item-toolbar-view">\n        <button class="btn btn-small" data-rel="close-screen">\n          <i class="fa fa-arrows-alt"></i>\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n'},useData:!0})},1368:function(e,t,a){var n=a(690);e.exports=(n.default||n).template({1:function(e,t,a,n,o){var i,r=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,d=e.escapeExpression;return'<li>\n  <a href="#" data-rel="'+d("function"==typeof(i=null!=(i=a.id||(null!=t?t.id:t))?i:s)?i.call(r,{name:"id",hash:{},data:o,loc:{start:{line:3,column:24},end:{line:3,column:30}}}):i)+'" data-key="'+d("function"==typeof(i=null!=(i=a.key||(null!=t?t.key:t))?i:s)?i.call(r,{name:"key",hash:{},data:o,loc:{start:{line:3,column:42},end:{line:3,column:49}}}):i)+'" title="'+d("function"==typeof(i=null!=(i=a.title||(null!=t?t.title:t))?i:s)?i.call(r,{name:"title",hash:{},data:o,loc:{start:{line:3,column:58},end:{line:3,column:67}}}):i)+'">'+d("function"==typeof(i=null!=(i=a.title||(null!=t?t.title:t))?i:s)?i.call(r,{name:"title",hash:{},data:o,loc:{start:{line:3,column:69},end:{line:3,column:78}}}):i)+'</a>\n  <i class="fa fa-close" />\n</li>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,a,n,o){var i;return null!=(i=a.each.call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:0},end:{line:6,column:9}}}))?i:""},useData:!0})},820:function(e,t,a){"use strict";(function(n,o){var i,r,s=a(18);i=[a(702),a(724),a(1367),a(1368)],void 0===(r=function(e,t,i,r){var d=n.View.extend({el:o("#main"),keyView:"",currentDashboardId:-1,currentDashboardName:void 0,dashboardModel:{},dashboardController:{},noQuery:void 0,lastSize:void 0,ownerWidth:void 0,ownerHeight:void 0,editionModeInitiated:!1,editMode:!1,initialSizeTimeOut:-1,dashboardName:"",fromExternal:!1,fromEmbedded:!1,render:function(a,n,r,d){this.currentDashboardId=a,this.keyView="div.mainTask[data-rel='dashboard-"+a+"']";var l={id:a,extraOptions:d};this.dashboardModel=new t({dashboardViewList:[],nodeOwner:"",extraOptions:d}),this.dashboardController=new e,d&&d.external&&(this.fromExternal=!0);var h=i(l);this.$el.append(h),this.reloadDashboard(a,r);var c=this;(0,s.registerResizeEvents)("dashboardViewResize",function(){c.updateSizes()}),this.getParent().on("removeView",function(){c.onRemoveView()}),o(this.keyView).on("getModel",function(e,t){return t.push(c.dashboardModel),t}),this.getParent().on("beforeRemoveView",function(e,t){c.onBeforeRemoveView(e,t)}),this.getParent().on("refreshView",function(){c.getParent().find("div.toolbar button.btnRefresh").trigger("click")}),this.getParent().on("changeNumberFormat",function(e,t){c&&c.dashboardModel&&c.dashboardModel.applyNumberFormat(t)}),this.getParent().on("reevaluateNodesNeeded",function(e,t){c&&c.dashboardModel&&c.dashboardModel.reevaluateNodesNeededInThisDashboard(t)}),this.getParent().on("selectView",function(){c.updateSizes()}),this.getParent().on("updateScaleFactor",function(){var e=c.getParent().find(".main-pane .pane-container").first();c._navigateInPane(e,{})}),this.getParent().on("onKeyDown",function(e,t,a){switch(a){case"ctrl+q":o(c.keyView).find(".dashboard-tabs li a[data-rel='"+c.currentDashboardId+"']").parent().find("i").trigger("click")}}),o(".dashboard-tabs").on("refreshNodeChanges",function(e,t){o('div[node-id="'.concat(t.nodeId,'"]')).length>0&&o(".dashboardTask .btnRefresh").click()}),this.addHandlers(),this.addGenericHandlers(),this.refreshDashboardTabs(),this.getNavigator(a)},addGenericHandlers:function(){var e=o(this.keyView),t=this;void 0!==__currentSession.fromEmbedded&&(this.fromEmbedded=__currentSession.fromEmbedded),this.fromEmbedded||e.on("click",".link-to-dashboard",function(){if(!t.editMode){var e=o(this).attr("data-dashboard-id"),n=(0,s.translate)("loading_dashboard"),i=!0;if("_self"===o(this).attr("data-target")&&(i=!1),t.dashboardController.showDashboard(e,-1,n),!i){var r=t.getParent().attr("data-rel");Promise.resolve().then(function(){var e=[a(684)];(function(e){(new e).removeTask(r,!0)}).apply(null,e)}).catch(a.oe)}}}),e.find(".dashboard-tabs").on("click","li a",function(){var e=o(this).attr("data-key");Promise.resolve().then(function(){var t=[a(684)];(function(t){(new t).selectTask(e)}).apply(null,t)}).catch(a.oe)}),e.find(".dashboard-tabs").on("click","li i",function(){var e=o(this).closest("li").find("a").attr("data-key");Promise.resolve().then(function(){var t=[a(684)];(function(t){(new t).removeTask(e)}).apply(null,t)}).catch(a.oe)}),o(document).off("contextmenu",".dashboard-tabs li a"),o(document).on("contextmenu",".dashboard-tabs li a",function(e){return t.showTabContextMenu(o(this),e),!1})},getDashboardModel:function(){return this.dashboardModel},reloadDashboard:function(e,t){var a=this.dashboardModel.getItemsModel();o.each(a,function(e,t){o(t.tagId).trigger("removeItemView")}),this.dashboardModel.removeAllItemsModel(),this.getParent().find(".main-pane").empty();var n=this;this.dashboardModel.getDashboard(e,function(e){n.refreshDashboardName(e),n.dashboardModel.setNodeOwner(e.nodeOwner),n.parseDashboard(e,t),n.getParent().find("div.breadcrumbs").show(),n.checkShared(e),n=null,window.location.href.indexOf("/#shared/")>0&&(o(".loader.embeddable").hide(),o("body").css("background-color","#FFF"))})},refreshDashboardName:function(e){if(e){var t=e.dashboardId,a=e.name;this.dashboardName=a,o("span[data-rel='dashboard-"+t+"']").text(a),o("#topMenuBar li a[rel='dashboard-"+t+"']").text(a),o(".dashboard-tabs li a[data-rel='"+t+"']").text(a)}},removeDashboard:function(e){Promise.resolve().then(function(){var t=[a(684)];(function(t){(new t).removeTask(e)}).apply(null,t)}).catch(a.oe)},onBeforeRemoveView:function(e,t){if(this.editMode){e.preventDefault();var n=this;a.e(5).then(function(){var e=[a(683)];(function(e){(new e).show({title:(0,s.translate)("_save")+": "+n.dashboardName,text:(0,s.translate)("save_pending_changes"),buttons:[{title:(0,s.translate)("yes"),css:"primary",code:"yes"},{title:(0,s.translate)("no"),code:"no"},{title:(0,s.translate)("cancel"),code:"cancel"}],callback:function(e){"yes"==e?(n.refreshMode(!1),n.saveDashboard(),setTimeout(function(){t()},1e3)):"no"==e&&(n.editMode=!1,setTimeout(function(){t(!0)},1e3))}})}).apply(null,e)}).catch(a.oe)}},onRemoveView:function(){(0,s.removeResizeEvent)("dashboardViewResize"),o(this.keyView).off(),this.dashboardController=null;var e=this.dashboardModel.getItemsModel();o.each(e,function(e,t){o(t.tagId).trigger("removeItemView")}),this.dashboardModel.removeAllItemsModel(),this.dashboardModel=null,this.noQuery=null;var t=this;setTimeout(function(){t.refreshDashboardTabs(),t=null},100)},updateSizes:function(e){if(this.getParent().find(".dashboard-area").length>0&&this.getParent().find(".dashboard-area").is(":visible")){this.getParent().find(".main-pane").height("100%");var t=85;0==o("#navigation").length&&(t=45);this.fromEmbedded&&(t=(t=o(".dashboard-titles.tabs").height())+35+20),this.getParent().find(".dashboard-area").height(o(window).height()-t);var a=o(document).width(),n=this.getParent().find(".dashboard-area").height();this.getParent().find(".dashboard-area  .pane-container.splitter_panel").each(function(e,t){var i=o(t).children(".pane-container").first(),r=o(t).children(".pane-container").last(),s=i.attr("data-factor"),d=r.attr("data-factor");if(s&&d){if(i.hasClass("left_panel")){o(t).width();var l=s*a,h=d*a;l<55&&(h=b-(l=55)-7),h<55&&(l=b-(h=55)-7),i.width(l),r.width(h),(f=o(t).data("splitter"))&&f.position(l+3,!0)}else{var c,u,f,b=o(t).height(),p=s*n,m=d*n,v=function e(t,a){var n=t.find("> .pane-container").first(),o=t.find("> .pane-container").last();if(n.hasClass("top_panel")&&(a+=1),o.hasClass("top_panel")&&(a+=1),n.hasClass("splitter_panel")){var i=e(n,a);a=Math.max(a,i)}return o.hasClass("splitter_panel")&&(i=e(o,a),a=Math.max(a,i)),a},g=1;c=55*(g=v(i,g)),m<(u=55*(g=v(r,g=1)))&&(p=b-(m=u)-7),p<c&&(m=b-(p=c)-7),i.height(p),r.height(m),(f=o(t).data("splitter"))&&f.position(p+3,!0)}return p+m}}),o(".main-pane").height("100%"),this.dashboardModel&&(this.dashboardModel.calculateScaleFactor(this.ownerWidth,this.ownerHeight),this.dashboardModel.updateSizes())}},getParent:function(){return o(this.keyView)},parseDashboard:function(e,t){this.currentDashboardName=e.name,this.dashboardModel.setStyleLibraries(e.styleLibraries);var a=this;this.dashboardController.getEmptyContent(this.dashboardModel,function(n){n.setElement(a.getParent().find("div.dashboard-area div.main-pane")),n.render(),a.dashboardModel.addItemToModel(n);var i=a.dashboardModel.get("extraOptions")&&a.dashboardModel.get("extraOptions").isInputNode;if(!e.definition||i)n.initializeWithNode(e.node,!!i&&"nodetable"),t&&a.getParent().find("div.toolbar button.btnEdit").click(),setTimeout(function(){a.updateSizes()},200);else{var r=e.definition,s=[],d=[];r.noQuery&&r.noQuery.length>0&&void 0!=r.noQuery[0].rel&&(s=r.noQuery,o.each(s,function(e,t){o.each(t.rel,function(e,t){d.push(t)})})),a.noQuery=s,a.ownerWidth=r.ownerWidth,a.ownerHeight=r.ownerHeight,a.dashboardModel.initializeDashboardQuery(a.noQuery),a._recursiveDashboardParser(r,n,d)}a.fromExternal&&setTimeout(function(){a.initPromiseWatcher()},1e3)})},_recursiveDashboardParser:function(e,t,a){var n=this;if("container"==e.type)o(t.tagId).parent().attr("data-factor",e.factor),t.splitPane("horizontal"==e.direction?"splith":"splitv",function(i){"horizontal"==e.direction?t.splitter.position((o(t.tagId).parent().parent().width()+7)*e.pane1.width,!0):t.splitter.position((o(t.tagId).parent().parent().height()+7)*e.pane1.height,!0),n._recursiveDashboardParser(e.pane1,t,a),n._recursiveDashboardParser(e.pane2,i,a),n.addSeparatos()});else{var i=a.indexOf(e.nodeId)>=0;t.calculateScaleFactor(this.ownerWidth,this.ownerHeight),t.createNewView(e,i),o(t.tagId).parent().attr("data-factor",e.factor),clearTimeout(this.initialSizeTimeOut),this.initialSizeTimeOut=setTimeout(function(){n.updateSizes()},200)}},addSliders:function(e){var t=this.getParent().find(".dashboard-area");this.dashboardController.drawDashboardBars(t,e)},addHandlers:function(){var e=this;this.getParent().find("div.toolbar button.btnEdit").on("click",o.proxy(function(){e.editionModeInitiated?e.refreshMode(!0):(e.editionModeInitiated=!0,e.addSliders(function(){e.refreshMode(!0)}))},this)),this.getParent().find("div.toolbar button.btnShow").on("click",o.proxy(function(){this.refreshMode(!1),setTimeout(function(){e.saveDashboard()},200)},this)),this.getParent().find("div.toolbar button.btnCancel").on("click",function(){e.getParent().find("div.toolbar button.btnShow").hide(),e.getParent().find("div.toolbar button.btnCancel").hide(),e.getParent().find("div.sure_cancel_dashboard").show(),e.getParent().find("div.toolbar button.btnGoCancel").show(),e.getParent().find("div.toolbar button.btnCancelCancel").show()}),this.getParent().find("div.toolbar button.btnGoCancel").on("click",function(){o(".dashboardTask.editing").removeAttr("last-edited"),e.getParent().find("div.sure_cancel_dashboard").hide(),e.refreshMode(!1),e.reloadDashboard(e.currentDashboardId,!1)}),this.getParent().find("div.toolbar button.btnCancelCancel").on("click",function(){e.getParent().find("div.sure_cancel_dashboard").hide(),e.getParent().find("div.toolbar button.btnShow").show(),e.getParent().find("div.toolbar button.btnCancel").show()}),this.getParent().find("div.toolbar button.btnShare").on("click",o.proxy(function(){(0,s.haveAccess)("share_dashboard")?a.e(125).then(function(){var t=[a(1420)];(function(t){(new t).showSharer(e.currentDashboardId)}).apply(null,t)}).catch(a.oe):a.e(18).then(function(){var e=[a(685)];(function(e){(new e).show({title:"WARNING!",text:(0,s.translate)("share_dashboard_access_denied"),notifyType:"error"})}).apply(null,e)}).catch(a.oe)},this)),this.getParent().find("div.toolbar button.btnScenarios").on("click",function(){a.e(29).then(function(){(function(t){var n=[a(881)];(function(a){var n={nodeList:[]},i=[];o.each(o(".dashboard-tabs li a"),function(t,a){var n=o(this).attr("data-rel");i=o('div.mainTask[data-rel="dashboard-'+n+'"]').triggerHandler("getModel",[i]),d=e.dashboardModel.getItemModel(n)});var r=[];o.each(i,function(e,t){o.each(t.getItemsModel(),function(e,t){r.push(t)})});var s=["indexlist","formnode","selector","button","objectItem","map"];o.each(r,function(e,a){if(a&&a.currentNodeId)if(a.currentResult&&-1!==t.inArray(a.currentResult.itemType,s));else{var i=a.currentNodeId;a.currentResult&&a.currentResult.nodeProperties&&a.currentResult.nodeProperties.originalId&&(i=a.currentResult.nodeProperties.originalId),a.pivotTable&&a.pivotTable.metadata&&a.pivotTable.metadata.nodeProperties&&a.pivotTable.metadata.nodeProperties.originalId&&(i=a.pivotTable.metadata.nodeProperties.originalId),0===o.grep(n.nodeList,function(e){return e.id===i}).length&&n.nodeList.push({id:i,name:a.currentResult&&a.currentResult.itemProperties&&a.currentResult.itemProperties.title?a.currentResult.itemProperties.title.text:a.currentNodeId})}}),(new a).show(n)}).apply(null,n)}).call(this,a(1))}).catch(a.oe)}),this.getParent().find("div.toolbar button.btnDataSnapshot").on("click",function(){a.e(29).then(function(){var e=[a(881)];(function(e){(new e).showDataSnapshot()}).apply(null,e)}).catch(a.oe)}),this.getParent().find("div.toolbar button.btnCopy").on("click",function(){e.dashboardController.showCopyDashboard(e.currentDashboardId,e.currentDashboardName,function(t,n){Promise.resolve().then(function(){var i=[a(702)];(function(a){o("#model-summary").trigger("fullRefresh"),e.dashboardController.showDashboard(t,-1,n)}).apply(null,i)}).catch(a.oe)})}),this.getParent().find("div.toolbar button.btnRefresh").on("click",o.proxy(function(){Promise.resolve().then(function(){var t=[a(219)];(function(t){(new t).executeForRefresh(function(t){var a=[];e.noQuery&&o.each(e.noQuery,function(e,t){o.each(t.rel,function(e,t){a.push(t)})}),e.dashboardModel.initializeDashboardQuery(e.noQuery);var n=e.dashboardModel.getItemsModel();o.each(n,function(e,t){a.indexOf(t.currentNodeId)>=0||o(t.tagId).trigger("refreshItemDash")})})}).apply(null,t)}).catch(a.oe)},this)),this.getParent().find("div.toolbar button.btnMore").on("click",o.proxy(function(){this.showMoreDashboards()},this)),this.getParent().find("div.toolbar button.btnComments").on("click",function(){Promise.resolve().then(function(){var t=[a(702)];(function(t){(new t).showDashboardComments({dashboardId:e.currentDashboardId,parent:e.getParent()})}).apply(null,t)}).catch(a.oe)}),this.getParent().find("div.toolbar button.btnPrint").on("click",function(){Promise.resolve().then(function(){var t=[a(749)];(function(t){(new t).printDashboard(e.currentDashboardId)}).apply(null,t)}).catch(a.oe)}),this.getParent().find(".main-fullscreen button[data-rel='close-screen']").on("click",function(){var t=o(this).closest(".main-fullscreen").find(".item-area").parent(),a="#"+t.attr("data-parent"),n=(t.attr("data-parent"),o(a)),i=o(this).closest(".main-fullscreen"),r=(n.offset(),t.attr("data-orignal-w")),s=t.attr("data-orignal-h"),d=t.attr("data-orignal-y"),l=t.attr("data-orignal-x"),h=o(this);i.animate({top:d+"px",left:l+"px",width:r,height:s},{done:function(){o.wrapper.append(t.detach()),i.hide(),h.show(),e.updateSizes(),e.dashboardModel.getItemModel(a).onEndNormalScreenAnimation()}}),e.dashboardModel.getItemModel(a).updateSize(r,s,!0)}),this.getParent().find(".report-navigator a").on("click",function(){var t=o(this).attr("data-id"),a=o(this).attr("title");t&&e.dashboardController.showDashboard(t,-1,a)})},saveDashboard:function(){var e={},t=this.getParent().find(".main-pane .pane-container").first();this._navigateInPane(t,e);var a=this.dashboardModel.getItemsModel(),n=[],i=[];o.each(a,function(e,t){var a=t.getRelatedNoQuery();a&&a.length>0&&n.push({node:t.currentNodeId,rel:a});var o=t.getStylesUsed();o&&(i=i.concat(o))}),e.noQuery=n,e.ownerWidth=this.getParent().find(".dashboard-area").width(),e.ownerHeight=this.getParent().find(".dashboard-area").height();var r=this;this.dashboardModel.updateDefinition(this.currentDashboardId,e,i,function(){r.ownerWidth=e.ownerWidth,r.ownerHeight=e.ownerHeight,o.each(a,function(e,t){t.onSaveDashboard()}),r=null}),this.updateSizes()},_navigateInPane:function(e,t){if(!o(e).parent().hasClass("main-pane")){var a=o(e).parent(),n=o(document).width(),i=this.getParent().find(".dashboard-area").height();o(e).hasClass("left_panel")||o(e).hasClass("right_panel")?(t.width=o(e).width()/(o(a).width()+7),t.factor=o(e).width()/n):(t.height=o(e).height()/(o(a).height()+7),t.factor=o(e).height()/i),o(e).attr("data-factor",t.factor)}if(o(e).hasClass("splitter_panel")){var r=o(e).find(".pane-container").first().hasClass("left_panel")?"horizontal":"vertical";t.type="container",t.direction=r,t.pane1={},t.pane2={},o(e).children(".pane-container").length>1&&(this._navigateInPane(o(e).children(".pane-container")[0],t.pane1),this._navigateInPane(o(e).children(".pane-container")[1],t.pane2))}else{t.type="pane";var s="#"+o(e).find(".pane").attr("id"),d=this.dashboardModel.getItemModel(s);d&&(t.nodeId=d.currentNodeId,t.itemId=d.itemId,d.currentResult&&(t.itemType=d.currentResult.itemType,"objectItem"==t.itemType&&(t.objectType=d.currentResult.objectType),"inputform"===d.currentResult.objectType&&d.form.$el.find(".formFilters .selectRemote.select2-offscreen").each(function(e,t){var a=o(t).attr("field"),n=(o(t).select2("val"),o(t).select2("data")),i=o(t).attr("filter-type");d.currentResult.itemProperties.savedFilters=[],"singleSelect"===i||"0"===i?(n.text=n.text.trim(),d.currentResult.itemProperties.savedFilters.push({field:a,val:n})):o.each(n,function(e,t){t.text=t.text.trim(),d.currentResult.itemProperties.savedFilters.push({field:a,val:n})})}),t.rows=d.currentResult.rows,t.columns=d.currentResult.columns,t.dims=d.currentResult.dims,t.itemProperties=d.currentResult.itemProperties))}},refreshMode:function(e){this.editMode=e,this.getParent().find("div.toolbar button").hide();var t=this.dashboardModel.getItemsModel();o.each(t,function(t,a){a.setEditMode(e)}),e?(this.getParent().find(".dashboard-tabs").hide(),this.getParent().closest(".mainTask").addClass("editing"),this.updateSizes(),this.getParent().find("div.toolbar button.btnShow").show(),this.getParent().find("div.toolbar button.btnCancel").show(),this.getParent().find("div.objectsToolbar").fadeIn(),this.getParent().find(".dockDashboardProperty").fadeIn(),this.editMode&&this.dashboardModel.getItemsModel().length>0&&this.dashboardModel.getItemsModel()[0].refreshSplitter(),this.ownerWidth=this.getParent().find(".dashboard-area").width(),this.ownerHeight=this.getParent().find(".dashboard-area").height(),this.dashboardModel&&(this.dashboardModel.calculateScaleFactor(this.ownerWidth,this.ownerHeight),this.dashboardModel.updateSizes()),this.getParent().find(".hseparator").remove(),this.getParent().find(".vseparator").remove(),this.getParent().find(".hsplitter").show(),this.getParent().find(".vsplitter").show(),this.selectPane()):(this.getParent().find(".dashboard-tabs").show(),this.getParent().closest(".mainTask").removeClass("editing"),this.getParent().find("div.toolbar button").show(),this.getParent().find("div.toolbar button.btnShow").hide(),this.getParent().find("div.toolbar button.btnCancel").hide(),this.getParent().find("div.objectsToolbar").fadeOut(),this.getParent().find(".dockDashboardProperty").fadeOut(),this.getParent().find(".hsplitter").hide(),this.getParent().find(".vsplitter").hide(),this.getParent().find("div.pane").removeClass("noedit"),this.addSeparatos())},addSeparatos:function(){this.getParent().find(".hseparator").remove(),this.getParent().find(".vseparator").remove(),this.getParent().find(".hsplitter, .vsplitter").each(function(e,t){var a="",n="";o(this).hasClass("hsplitter")?(a="hseparator",n="top:"+o(this).css("top")):(a="vseparator",n="left:"+o(this).css("left"));o(this).parent().append("<div class='"+a+"' style='"+n+"' />")})},selectPane:function(){if(this.getParent().find("div.pane").length>0){var e=o(".dashboardTask.editing").attr("last-edited");e?this.getParent().find("div.pane#"+e).trigger("selectPane"):this.getParent().find("div.pane").first().trigger("selectPane")}},showMoreDashboards:function(){this.dashboardController.drawMoreDashboard(this.keyView,this.currentDashboardId)},checkShared:function(e){if(e.sharedBy.length>0){this.getParent().find(".toolbar .btnEdit").remove(),this.getParent().find(".toolbar .btnShare").remove(),this.getParent().find(".toolbar .shared-message").html((0,s.translate)("full_shared_by")+": "+e.sharedBy);var t=this;this.getParent().on("refreshImageDashboard",function(e,a){t.reloadDashboard(a)})}},refreshDashboardTabs:function(){var e=[];if(o(".dashboardTask").each(function(t,a){var n=o(a).attr("data-rel"),i=n.split("-")[1],r=o("#topMenuBar ul li a[rel='"+n+"']").text();o(a).hasClass("new")||e.push({id:i,key:n,title:r,closeBtn:!0})}),o(".mainTask .dashboard-tabs").empty(),o(".mainTask .dashboard-tabs").hide(),e.length>0){var t=r(e);o(".mainTask .dashboard-tabs").html(t),o(".mainTask .dashboard-tabs").show()}o(".dashboardTask").each(function(e,t){var a=o(t).attr("data-rel");o(this).find(".dashboard-tabs li a[data-key='"+a+"']").closest("li").addClass("active")})},showTabContextMenu:function(e,t){var n={_me:{name:(0,s.translate)("close")},_all:{name:(0,s.translate)("close_all")},_others:{name:(0,s.translate)("close_all_but_this")}},i=".dashboard-tabs";o.contextMenu("destroy",i),o.contextMenu({selector:i,callback:function(t,n){switch(t){case"_me":e.closest("li").find("i").click();break;case"_all":case"_others":var i=e.attr("data-key");"_all"==t&&(i="_123123_"),Promise.resolve().then(function(){var n=[a(684)];(function(a){var n=new a,r=[];e.closest("ul.dashboard-tabs").find("li a").each(function(e,t){o(t).attr("data-key")!=i&&r.push(o(t).attr("data-key"))}),r.length>0&&o.each(r,function(e,a){"_all"==t?n.removeTask(a,!1):(n.selectTask(i),n.removeTask(a,!0))})}).apply(null,n)}).catch(a.oe)}},items:n,events:{hide:function(e){o.contextMenu("destroy",i)}},zIndex:0}),o(i).contextMenu({x:t.clientX,y:t.clientY})},getNavigator:function(e){var t=this;this.dashboardModel.getNavigator({dashboardId:e},function(e){e&&(e.priorId>0&&t.getParent().find(".btnNavigatorPrior").attr("data-id",e.priorId).attr("title",e.priorName).closest("li").removeClass("disabled"),e.nextId>0&&t.getParent().find(".btnNavigatorNext").attr("data-id",e.nextId).attr("title",e.nextName).closest("li").removeClass("disabled"))})},initPromiseWatcher:function(){if(this.dashboardModel){var e=this.dashboardModel.getItemsModel();if(e&&e.length>0){var t=!0;if(o.each(e,function(e,a){0==o(a.tagId).find(".item-class-selector").length&&(t=t&&a.isReady)}),!t&&this.getParent().find(".dashboard-area").length>0){var a=this;setTimeout(function(){a.initPromiseWatcher(),a=null},1e3)}}}}});return d}.apply(t,i))||(e.exports=r)}).call(this,a(218),a(1))}}]);