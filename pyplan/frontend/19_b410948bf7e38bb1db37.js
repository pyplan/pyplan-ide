/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{1397:function(t,e,a){var n=a(690);function r(t){return t&&(t.__esModule?t.default:t)}t.exports=(n.default||n).template({1:function(t,e,a,n,r){return" from-external "},3:function(t,e,n,i,o){return'      <button class="btn btnEdit" title="'+t.escapeExpression(r(a(688)).call(null!=e?e:t.nullContext||{},"edit_dashboard",{name:"L",hash:{},data:o}))+'">\n        <i class="fa fa-pencil-square-o"></i>\n      </button>\n      <button class="btn btnShow nodisplay">\n        <i class="fa fa-check"></i>\n      </button>\n      <button class="btn btnCancel nodisplay">\n        <i class="fa fa-times"></i>\n      </button>\n'},5:function(t,e,n,i,o){return'      <button class="btn btnMore" title="'+t.escapeExpression(r(a(688)).call(null!=e?e:t.nullContext||{},"more_dashboards",{name:"L",hash:{},data:o}))+'">\n        <i class="fa fa-bars"></i>\n      </button>\n'},7:function(t,e,n,i,o){var s;return null!=(s=r(a(695)).call(null!=e?e:t.nullContext||{},"share_dashboard",{name:"haveAccess",hash:{},fn:t.program(8,o,0),inverse:t.noop,data:o}))?s:""},8:function(t,e,n,i,o){return'      <button class="btn btnShare" title="'+t.escapeExpression(r(a(688)).call(null!=e?e:t.nullContext||{},"share",{name:"L",hash:{},data:o}))+'">\n        <i class="fa fa-share-square"></i>\n      </button>\n'},10:function(t,e,n,i,o){return'      <button class="btn btnScenarios" title="'+t.escapeExpression(r(a(688)).call(null!=e?e:t.nullContext||{},"scenario_manager",{name:"L",hash:{},data:o}))+'">\n        <i class="fa fa-database"></i>\n      </button>\n'},12:function(t,e,n,i,o){return'      <button class="btn btnDataSnapshot" title="'+t.escapeExpression(r(a(688)).call(null!=e?e:t.nullContext||{},"data_snapshot",{name:"L",hash:{},data:o}))+'">\n        <i class="fa fa-camera"></i>\n      </button>\n      '},14:function(t,e,n,i,o){return'\n      <button class="btn btnCopy" title="'+t.escapeExpression(r(a(688)).call(null!=e?e:t.nullContext||{},"copy_dashboard",{name:"L",hash:{},data:o}))+'">\n        <i class="fa fa-files"></i>\n      </button>\n'},16:function(t,e,a,n,r){return""},compiler:[7,">= 4.0.0"],main:function(t,e,n,i,o){var s,d=null!=e?e:t.nullContext||{},l=t.escapeExpression;return'<div\n  class="container-fluid mainTask full-horizontal dashboardTask hideClose '+(null!=(s=n.if.call(d,null!=(s=null!=e?e.extraOptions:e)?s.external:s,{name:"if",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o}))?s:"")+'"\n  data-rel="dashboard-'+l(t.lambda(null!=e?e.id:e,e))+'" data-type="tab-content">\n\n  <div class="breadcrumbs nodisplay">\n\n    <div class="toolbar">\n'+(null!=(s=r(a(695)).call(d,"add_dashboard",{name:"haveAccess",hash:{},fn:t.program(3,o,0),inverse:t.noop,data:o}))?s:"")+'      <button class="btn btnRefresh" title="'+l(r(a(688)).call(d,"refresh_dashboard",{name:"L",hash:{},data:o}))+'">\n        <i class="fa fa-refresh"></i>\n      </button>\n\n'+(null!=(s=r(a(695)).call(d,"view_report",{name:"haveAccess",hash:{},fn:t.program(5,o,0),inverse:t.noop,data:o}))?s:"")+(null!=(s=n.if.call(d,null!=e?e.notDesktop:e,{name:"if",hash:{},fn:t.program(7,o,0),inverse:t.noop,data:o}))?s:"")+(null!=(s=r(a(695)).call(d,"MANAGESCENARIOS",{name:"haveAccess",hash:{},fn:t.program(10,o,0),inverse:t.noop,data:o}))?s:"")+(null!=(s=r(a(695)).call(d,"change_data_snapshots",{name:"haveAccess",hash:{},fn:t.program(12,o,0),inverse:t.noop,data:o}))?s:"")+" "+(null!=(s=r(a(695)).call(d,"add_dashboard",{name:"haveAccess",hash:{},fn:t.program(14,o,0),inverse:t.noop,data:o}))?s:"")+'\n      <button class="btn btnPrint" title="'+l(r(a(688)).call(d,"print_dashboard",{name:"L",hash:{},data:o}))+'">\n        <i class="fa fa-print"></i>\n      </button>\n\n'+(null!=(s=r(a(695)).call(d,"list_dashboardcomments",{name:"haveAccess",hash:{},fn:t.program(16,o,0),inverse:t.noop,data:o}))?s:"")+'\n      <div class="sure_cancel_dashboard nodisplay">\n        <span>'+l(r(a(688)).call(d,"sure_cancel_save_dashboard",{name:"L",hash:{},data:o}))+'</span>\n        <button class="btn btn-small btn-red btnGoCancel">'+l(r(a(688)).call(d,"yes",{name:"L",hash:{},data:o}))+'</button>\n        <button class="btn btn-small btn-grey btnCancelCancel">'+l(r(a(688)).call(d,"no",{name:"L",hash:{},data:o}))+'</button>\n      </div>\n\n      <span class="shared-message"></span>\n    </div>\n\n    <ul class="pagination pagination-sm report-navigator">\n      <li class="disabled">\n        <a href="#" class="btnNavigatorPrior">\n          <i class="fa fa-chevron-left"></i>\n        </a>\n      </li>\n      <li class="disabled">\n        <a href="#" class="btnNavigatorNext">\n          <i class="fa fa-chevron-right"></i>\n        </a>\n      </li>\n    </ul>\n\n    <ul class="nav nav-tabs dashboard-tabs nodisplay" style="overflow-x: inherit;">\n    </ul>\n\n  </div>\n\n  <div class="row-fluid dashboard-area">\n    <div class="main-pane">\n\n    </div>\n\n    <div class="main-fullscreen">\n      <div class="item-toolbar-view">\n        <button class="btn btn-small" data-rel="close-screen">\n          <i class="fa fa-arrows-alt"></i>\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n'},useData:!0})},1398:function(t,e,a){var n=a(690);t.exports=(n.default||n).template({1:function(t,e,a,n,r){var i,o=null!=e?e:t.nullContext||{},s=a.helperMissing,d=t.escapeExpression;return'<li>\n  <a href="#" data-rel="'+d("function"==typeof(i=null!=(i=a.id||(null!=e?e.id:e))?i:s)?i.call(o,{name:"id",hash:{},data:r}):i)+'" data-key="'+d("function"==typeof(i=null!=(i=a.key||(null!=e?e.key:e))?i:s)?i.call(o,{name:"key",hash:{},data:r}):i)+'" title="'+d("function"==typeof(i=null!=(i=a.title||(null!=e?e.title:e))?i:s)?i.call(o,{name:"title",hash:{},data:r}):i)+'">'+d("function"==typeof(i=null!=(i=a.title||(null!=e?e.title:e))?i:s)?i.call(o,{name:"title",hash:{},data:r}):i)+'</a>\n  <i class="fa fa-close" />\n</li>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,a,n,r){var i;return null!=(i=a.each.call(null!=e?e:t.nullContext||{},e,{name:"each",hash:{},fn:t.program(1,r,0),inverse:t.noop,data:r}))?i:""},useData:!0})},748:function(t,e,a){"use strict";(function(n,r){var i,o,s=a(18);i=[a(701),a(706),a(1397),a(1398)],void 0===(o=function(t,e,i,o){var d=n.View.extend({el:r("#main"),keyView:"",currentDashboardId:-1,currentDashboardName:void 0,dashboardModel:{},dashboardController:{},noQuery:void 0,lastSize:void 0,ownerWidth:void 0,ownerHeight:void 0,editionModeInitiated:!1,editMode:!1,initialSizeTimeOut:-1,dashboardName:"",fromExternal:!1,fromEmbedded:!1,render:function(a,n,o,d){this.currentDashboardId=a,this.keyView="div.mainTask[data-rel='dashboard-"+a+"']";var l={id:a,extraOptions:d};this.dashboardModel=new e({dashboardViewList:[],nodeOwner:"",extraOptions:d}),this.dashboardController=new t,d&&d.external&&(this.fromExternal=!0);var h=i(l);this.$el.append(h),this.reloadDashboard(a,o);var c=this;(0,s.registerResizeEvents)("dashboardViewResize",function(){c.updateSizes()}),this.getParent().on("removeView",function(){c.onRemoveView()}),r(this.keyView).on("getModel",function(t,e){return e.push(c.dashboardModel),e}),this.getParent().on("beforeRemoveView",function(t,e){c.onBeforeRemoveView(t,e)}),this.getParent().on("refreshView",function(){c.getParent().find("div.toolbar button.btnRefresh").trigger("click")}),this.getParent().on("changeNumberFormat",function(t,e){c&&c.dashboardModel&&c.dashboardModel.applyNumberFormat(e)}),this.getParent().on("reevaluateNodesNeeded",function(t,e){c&&c.dashboardModel&&c.dashboardModel.reevaluateNodesNeededInThisDashboard(e)}),this.getParent().on("selectView",function(){c.updateSizes()}),this.getParent().on("updateScaleFactor",function(){var t=c.getParent().find(".main-pane .pane-container").first();c._navigateInPane(t,{})}),this.getParent().on("onKeyDown",function(t,e,a){switch(a){case"ctrl+q":r(c.keyView).find(".dashboard-tabs li a[data-rel='"+c.currentDashboardId+"']").parent().find("i").trigger("click")}}),r(".dashboard-tabs").on("refreshNodeChanges",function(t,e){r('div[node-id="'.concat(e.nodeId,'"]')).length>0&&r(".dashboardTask .btnRefresh").click()}),this.addHandlers(),this.addGenericHandlers(),this.refreshDashboardTabs(),this.getNavigator(a)},addGenericHandlers:function(){var t=r(this.keyView),e=this;void 0!==__currentSession.fromEmbedded&&(this.fromEmbedded=__currentSession.fromEmbedded),this.fromEmbedded||t.on("click",".link-to-dashboard",function(){if(!e.editMode){var t=r(this).attr("data-dashboard-id"),n=(0,s.translate)("loading_dashboard"),i=!0;if("_self"===r(this).attr("data-target")&&(i=!1),e.dashboardController.showDashboard(t,-1,n),!i){var o=e.getParent().attr("data-rel");Promise.resolve().then(function(){var t=[a(684)];(function(t){(new t).removeTask(o,!0)}).apply(null,t)}).catch(a.oe)}}}),t.find(".dashboard-tabs").on("click","li a",function(){var t=r(this).attr("data-key");Promise.resolve().then(function(){var e=[a(684)];(function(e){(new e).selectTask(t)}).apply(null,e)}).catch(a.oe)}),t.find(".dashboard-tabs").on("click","li i",function(){var t=r(this).closest("li").find("a").attr("data-key");Promise.resolve().then(function(){var e=[a(684)];(function(e){(new e).removeTask(t)}).apply(null,e)}).catch(a.oe)}),r(document).off("contextmenu",".dashboard-tabs li a"),r(document).on("contextmenu",".dashboard-tabs li a",function(t){return e.showTabContextMenu(r(this),t),!1})},getDashboardModel:function(){return this.dashboardModel},reloadDashboard:function(t,e){var a=this.dashboardModel.getItemsModel();r.each(a,function(t,e){r(e.tagId).trigger("removeItemView")}),this.dashboardModel.removeAllItemsModel(),this.getParent().find(".main-pane").empty();var n=this;this.dashboardModel.getDashboard(t,function(t){n.refreshDashboardName(t),n.dashboardModel.setNodeOwner(t.nodeOwner),n.parseDashboard(t,e),n.getParent().find("div.breadcrumbs").show(),n.checkShared(t),n=null,window.location.href.indexOf("/#shared/")>0&&(r(".loader.embeddable").hide(),r("body").css("background-color","#FFF"))})},refreshDashboardName:function(t){if(t){var e=t.dashboardId,a=t.name;this.dashboardName=a,r("span[data-rel='dashboard-"+e+"']").text(a),r("#topMenuBar li a[rel='dashboard-"+e+"']").text(a),r(".dashboard-tabs li a[data-rel='"+e+"']").text(a)}},removeDashboard:function(t){Promise.resolve().then(function(){var e=[a(684)];(function(e){(new e).removeTask(t)}).apply(null,e)}).catch(a.oe)},onBeforeRemoveView:function(t,e){if(this.editMode){t.preventDefault();var n=this;a.e(5).then(function(){var t=[a(683)];(function(t){(new t).show({title:(0,s.translate)("_save")+": "+n.dashboardName,text:(0,s.translate)("save_pending_changes"),buttons:[{title:(0,s.translate)("yes"),css:"primary",code:"yes"},{title:(0,s.translate)("no"),code:"no"},{title:(0,s.translate)("cancel"),code:"cancel"}],callback:function(t){"yes"==t?(n.refreshMode(!1),n.saveDashboard(),setTimeout(function(){e()},1e3)):"no"==t&&(n.editMode=!1,setTimeout(function(){e(!0)},1e3))}})}).apply(null,t)}).catch(a.oe)}},onRemoveView:function(){(0,s.removeResizeEvent)("dashboardViewResize"),r(this.keyView).off(),this.dashboardController=null;var t=this.dashboardModel.getItemsModel();r.each(t,function(t,e){r(e.tagId).trigger("removeItemView")}),this.dashboardModel.removeAllItemsModel(),this.dashboardModel=null,this.noQuery=null;var e=this;setTimeout(function(){e.refreshDashboardTabs(),e=null},100)},updateSizes:function(t){if(this.getParent().find(".dashboard-area").length>0&&this.getParent().find(".dashboard-area").is(":visible")){this.getParent().find(".main-pane").height("100%");var e=85;0==r("#navigation").length&&(e=45);this.fromEmbedded&&(e=(e=r(".dashboard-titles.tabs").height())+35+20),this.getParent().find(".dashboard-area").height(r(window).height()-e);var a=r(document).width(),n=this.getParent().find(".dashboard-area").height();this.getParent().find(".dashboard-area  .pane-container.splitter_panel").each(function(t,e){var i=r(e).children(".pane-container").first(),o=r(e).children(".pane-container").last(),s=i.attr("data-factor"),d=o.attr("data-factor");if(s&&d){if(i.hasClass("left_panel")){r(e).width();var l=s*a,h=d*a;l<55&&(h=b-(l=55)-7),h<55&&(l=b-(h=55)-7),i.width(l),o.width(h),(f=r(e).data("splitter"))&&f.position(l+3,!0)}else{var c,u,f,b=r(e).height(),p=s*n,v=d*n,m=function t(e,a){var n=e.find("> .pane-container").first(),r=e.find("> .pane-container").last();if(n.hasClass("top_panel")&&(a+=1),r.hasClass("top_panel")&&(a+=1),n.hasClass("splitter_panel")){var i=t(n,a);a=Math.max(a,i)}return r.hasClass("splitter_panel")&&(i=t(r,a),a=Math.max(a,i)),a},g=1;c=55*(g=m(i,g)),v<(u=55*(g=m(o,g=1)))&&(p=b-(v=u)-7),p<c&&(v=b-(p=c)-7),i.height(p),o.height(v),(f=r(e).data("splitter"))&&f.position(p+3,!0)}return p+v}}),r(".main-pane").height("100%"),this.dashboardModel&&(this.dashboardModel.calculateScaleFactor(this.ownerWidth,this.ownerHeight),this.dashboardModel.updateSizes())}},getParent:function(){return r(this.keyView)},parseDashboard:function(t,e){this.currentDashboardName=t.name,this.dashboardModel.setStyleLibraries(t.styleLibraries);var a=this;this.dashboardController.getEmptyContent(this.dashboardModel,function(n){n.setElement(a.getParent().find("div.dashboard-area div.main-pane")),n.render(),a.dashboardModel.addItemToModel(n);var i=a.dashboardModel.get("extraOptions")&&a.dashboardModel.get("extraOptions").isInputNode;if(!t.definition||i)n.initializeWithNode(t.node,!!i&&"nodetable"),e&&a.getParent().find("div.toolbar button.btnEdit").click(),setTimeout(function(){a.updateSizes()},200);else{var o=t.definition,s=[],d=[];o.noQuery&&o.noQuery.length>0&&void 0!=o.noQuery[0].rel&&(s=o.noQuery,r.each(s,function(t,e){r.each(e.rel,function(t,e){d.push(e)})})),a.noQuery=s,a.ownerWidth=o.ownerWidth,a.ownerHeight=o.ownerHeight,a.dashboardModel.initializeDashboardQuery(a.noQuery),a._recursiveDashboardParser(o,n,d)}a.fromExternal&&setTimeout(function(){a.initPromiseWatcher()},1e3)})},_recursiveDashboardParser:function(t,e,a){var n=this;if("container"==t.type)r(e.tagId).parent().attr("data-factor",t.factor),e.splitPane("horizontal"==t.direction?"splith":"splitv",function(i){"horizontal"==t.direction?e.splitter.position((r(e.tagId).parent().parent().width()+7)*t.pane1.width,!0):e.splitter.position((r(e.tagId).parent().parent().height()+7)*t.pane1.height,!0),n._recursiveDashboardParser(t.pane1,e,a),n._recursiveDashboardParser(t.pane2,i,a),n.addSeparatos()});else{var i=a.indexOf(t.nodeId)>=0;e.calculateScaleFactor(this.ownerWidth,this.ownerHeight),e.createNewView(t,i),r(e.tagId).parent().attr("data-factor",t.factor),clearTimeout(this.initialSizeTimeOut),this.initialSizeTimeOut=setTimeout(function(){n.updateSizes()},200)}},addSliders:function(t){var e=this.getParent().find(".dashboard-area");this.dashboardController.drawDashboardBars(e,t)},addHandlers:function(){var t=this;this.getParent().find("div.toolbar button.btnEdit").on("click",r.proxy(function(){t.editionModeInitiated?t.refreshMode(!0):(t.editionModeInitiated=!0,t.addSliders(function(){t.refreshMode(!0)}))},this)),this.getParent().find("div.toolbar button.btnShow").on("click",r.proxy(function(){this.refreshMode(!1),setTimeout(function(){t.saveDashboard()},200)},this)),this.getParent().find("div.toolbar button.btnCancel").on("click",function(){t.getParent().find("div.toolbar button.btnShow").hide(),t.getParent().find("div.toolbar button.btnCancel").hide(),t.getParent().find("div.sure_cancel_dashboard").show(),t.getParent().find("div.toolbar button.btnGoCancel").show(),t.getParent().find("div.toolbar button.btnCancelCancel").show()}),this.getParent().find("div.toolbar button.btnGoCancel").on("click",function(){r(".dashboardTask.editing").removeAttr("last-edited"),t.getParent().find("div.sure_cancel_dashboard").hide(),t.refreshMode(!1),t.reloadDashboard(t.currentDashboardId,!1)}),this.getParent().find("div.toolbar button.btnCancelCancel").on("click",function(){t.getParent().find("div.sure_cancel_dashboard").hide(),t.getParent().find("div.toolbar button.btnShow").show(),t.getParent().find("div.toolbar button.btnCancel").show()}),this.getParent().find("div.toolbar button.btnShare").on("click",r.proxy(function(){(0,s.haveAccess)("share_dashboard")?a.e(121).then(function(){var e=[a(1448)];(function(e){(new e).showSharer(t.currentDashboardId)}).apply(null,e)}).catch(a.oe):a.e(17).then(function(){var t=[a(685)];(function(t){(new t).show({title:"WARNING!",text:(0,s.translate)("share_dashboard_access_denied"),notifyType:"error"})}).apply(null,t)}).catch(a.oe)},this)),this.getParent().find("div.toolbar button.btnScenarios").on("click",function(){a.e(29).then(function(){(function(e){var n=[a(918)];(function(a){var n={nodeList:[]},i=[];r.each(r(".dashboard-tabs li a"),function(e,a){var n=r(this).attr("data-rel");i=r('div.mainTask[data-rel="dashboard-'+n+'"]').triggerHandler("getModel",[i]),d=t.dashboardModel.getItemModel(n)});var o=[];r.each(i,function(t,e){r.each(e.getItemsModel(),function(t,e){o.push(e)})});var s=["indexlist","formnode","selector","button","objectItem","map"];r.each(o,function(t,a){if(a&&a.currentNodeId)if(a.currentResult&&-1!==e.inArray(a.currentResult.itemType,s));else{var i=a.currentNodeId;a.currentResult&&a.currentResult.nodeProperties&&a.currentResult.nodeProperties.originalId&&(i=a.currentResult.nodeProperties.originalId),a.pivotTable&&a.pivotTable.metadata&&a.pivotTable.metadata.nodeProperties&&a.pivotTable.metadata.nodeProperties.originalId&&(i=a.pivotTable.metadata.nodeProperties.originalId),0===r.grep(n.nodeList,function(t){return t.id===i}).length&&n.nodeList.push({id:i,name:a.currentResult&&a.currentResult.itemProperties&&a.currentResult.itemProperties.title?a.currentResult.itemProperties.title.text:a.currentNodeId})}}),(new a).show(n)}).apply(null,n)}).call(this,a(1))}).catch(a.oe)}),this.getParent().find("div.toolbar button.btnDataSnapshot").on("click",function(){a.e(29).then(function(){var t=[a(918)];(function(t){(new t).showDataSnapshot()}).apply(null,t)}).catch(a.oe)}),this.getParent().find("div.toolbar button.btnCopy").on("click",function(){t.dashboardController.showCopyDashboard(t.currentDashboardId,t.currentDashboardName,function(e,n){Promise.resolve().then(function(){var i=[a(701)];(function(a){r("#model-summary").trigger("fullRefresh"),t.dashboardController.showDashboard(e,-1,n)}).apply(null,i)}).catch(a.oe)})}),this.getParent().find("div.toolbar button.btnRefresh").on("click",r.proxy(function(){Promise.resolve().then(function(){var e=[a(219)];(function(e){(new e).executeForRefresh(function(e){var a=[];t.noQuery&&r.each(t.noQuery,function(t,e){r.each(e.rel,function(t,e){a.push(e)})}),t.dashboardModel.initializeDashboardQuery(t.noQuery);var n=t.dashboardModel.getItemsModel();r.each(n,function(t,e){a.indexOf(e.currentNodeId)>=0||r(e.tagId).trigger("refreshItemDash")})})}).apply(null,e)}).catch(a.oe)},this)),this.getParent().find("div.toolbar button.btnMore").on("click",r.proxy(function(){this.showMoreDashboards()},this)),this.getParent().find("div.toolbar button.btnComments").on("click",function(){Promise.resolve().then(function(){var e=[a(701)];(function(e){(new e).showDashboardComments({dashboardId:t.currentDashboardId,parent:t.getParent()})}).apply(null,e)}).catch(a.oe)}),this.getParent().find("div.toolbar button.btnPrint").on("click",function(){Promise.resolve().then(function(){var e=[a(752)];(function(e){(new e).printDashboard(t.currentDashboardId)}).apply(null,e)}).catch(a.oe)}),this.getParent().find(".main-fullscreen button[data-rel='close-screen']").on("click",function(){var e=r(this).closest(".main-fullscreen").find(".item-area").parent(),a="#"+e.attr("data-parent"),n=(e.attr("data-parent"),r(a)),i=r(this).closest(".main-fullscreen"),o=(n.offset(),e.attr("data-orignal-w")),s=e.attr("data-orignal-h"),d=e.attr("data-orignal-y"),l=e.attr("data-orignal-x"),h=r(this);i.animate({top:d+"px",left:l+"px",width:o,height:s},{done:function(){r.wrapper.append(e.detach()),i.hide(),h.show(),t.updateSizes(),t.dashboardModel.getItemModel(a).onEndNormalScreenAnimation()}}),t.dashboardModel.getItemModel(a).updateSize(o,s,!0)}),this.getParent().find(".report-navigator a").on("click",function(){var e=r(this).attr("data-id"),a=r(this).attr("title");e&&t.dashboardController.showDashboard(e,-1,a)})},saveDashboard:function(){var t={},e=this.getParent().find(".main-pane .pane-container").first();this._navigateInPane(e,t);var a=this.dashboardModel.getItemsModel(),n=[],i=[];r.each(a,function(t,e){var a=e.getRelatedNoQuery();a&&a.length>0&&n.push({node:e.currentNodeId,rel:a});var r=e.getStylesUsed();r&&(i=i.concat(r))}),t.noQuery=n,t.ownerWidth=this.getParent().find(".dashboard-area").width(),t.ownerHeight=this.getParent().find(".dashboard-area").height();var o=this;this.dashboardModel.updateDefinition(this.currentDashboardId,t,i,function(){o.ownerWidth=t.ownerWidth,o.ownerHeight=t.ownerHeight,r.each(a,function(t,e){e.onSaveDashboard()}),o=null}),this.updateSizes()},_navigateInPane:function(t,e){if(!r(t).parent().hasClass("main-pane")){var a=r(t).parent(),n=r(document).width(),i=this.getParent().find(".dashboard-area").height();r(t).hasClass("left_panel")||r(t).hasClass("right_panel")?(e.width=r(t).width()/(r(a).width()+7),e.factor=r(t).width()/n):(e.height=r(t).height()/(r(a).height()+7),e.factor=r(t).height()/i),r(t).attr("data-factor",e.factor)}if(r(t).hasClass("splitter_panel")){var o=r(t).find(".pane-container").first().hasClass("left_panel")?"horizontal":"vertical";e.type="container",e.direction=o,e.pane1={},e.pane2={},r(t).children(".pane-container").length>1&&(this._navigateInPane(r(t).children(".pane-container")[0],e.pane1),this._navigateInPane(r(t).children(".pane-container")[1],e.pane2))}else{e.type="pane";var s="#"+r(t).find(".pane").attr("id"),d=this.dashboardModel.getItemModel(s);d&&(e.nodeId=d.currentNodeId,e.itemId=d.itemId,d.currentResult&&(e.itemType=d.currentResult.itemType,"objectItem"==e.itemType&&(e.objectType=d.currentResult.objectType),"inputform"===d.currentResult.objectType&&d.form.$el.find(".formFilters .selectRemote.select2-offscreen").each(function(t,e){var a=r(e).attr("field"),n=(r(e).select2("val"),r(e).select2("data")),i=r(e).attr("filter-type");d.currentResult.itemProperties.savedFilters=[],"singleSelect"===i||"0"===i?(n.text=n.text.trim(),d.currentResult.itemProperties.savedFilters.push({field:a,val:n})):r.each(n,function(t,e){e.text=e.text.trim(),d.currentResult.itemProperties.savedFilters.push({field:a,val:n})})}),e.rows=d.currentResult.rows,e.columns=d.currentResult.columns,e.dims=d.currentResult.dims,e.itemProperties=d.currentResult.itemProperties))}},refreshMode:function(t){this.editMode=t,this.getParent().find("div.toolbar button").hide();var e=this.dashboardModel.getItemsModel();r.each(e,function(e,a){a.setEditMode(t)}),t?(this.getParent().find(".dashboard-tabs").hide(),this.getParent().closest(".mainTask").addClass("editing"),this.updateSizes(),this.getParent().find("div.toolbar button.btnShow").show(),this.getParent().find("div.toolbar button.btnCancel").show(),this.getParent().find("div.objectsToolbar").fadeIn(),this.getParent().find(".dockDashboardProperty").fadeIn(),this.editMode&&this.dashboardModel.getItemsModel().length>0&&this.dashboardModel.getItemsModel()[0].refreshSplitter(),this.ownerWidth=this.getParent().find(".dashboard-area").width(),this.ownerHeight=this.getParent().find(".dashboard-area").height(),this.dashboardModel&&(this.dashboardModel.calculateScaleFactor(this.ownerWidth,this.ownerHeight),this.dashboardModel.updateSizes()),this.getParent().find(".hseparator").remove(),this.getParent().find(".vseparator").remove(),this.getParent().find(".hsplitter").show(),this.getParent().find(".vsplitter").show(),this.selectPane()):(this.getParent().find(".dashboard-tabs").show(),this.getParent().closest(".mainTask").removeClass("editing"),this.getParent().find("div.toolbar button").show(),this.getParent().find("div.toolbar button.btnShow").hide(),this.getParent().find("div.toolbar button.btnCancel").hide(),this.getParent().find("div.objectsToolbar").fadeOut(),this.getParent().find(".dockDashboardProperty").fadeOut(),this.getParent().find(".hsplitter").hide(),this.getParent().find(".vsplitter").hide(),this.getParent().find("div.pane").removeClass("noedit"),this.addSeparatos())},addSeparatos:function(){this.getParent().find(".hseparator").remove(),this.getParent().find(".vseparator").remove(),this.getParent().find(".hsplitter, .vsplitter").each(function(t,e){var a="",n="";r(this).hasClass("hsplitter")?(a="hseparator",n="top:"+r(this).css("top")):(a="vseparator",n="left:"+r(this).css("left"));r(this).parent().append("<div class='"+a+"' style='"+n+"' />")})},selectPane:function(){if(this.getParent().find("div.pane").length>0){var t=r(".dashboardTask.editing").attr("last-edited");t?this.getParent().find("div.pane#"+t).trigger("selectPane"):this.getParent().find("div.pane").first().trigger("selectPane")}},showMoreDashboards:function(){this.dashboardController.drawMoreDashboard(this.keyView,this.currentDashboardId)},checkShared:function(t){if(t.sharedBy.length>0){this.getParent().find(".toolbar .btnEdit").remove(),this.getParent().find(".toolbar .btnShare").remove(),this.getParent().find(".toolbar .shared-message").html((0,s.translate)("full_shared_by")+": "+t.sharedBy);var e=this;this.getParent().on("refreshImageDashboard",function(t,a){e.reloadDashboard(a)})}},refreshDashboardTabs:function(){var t=[];if(r(".dashboardTask").each(function(e,a){var n=r(a).attr("data-rel"),i=n.split("-")[1],o=r("#topMenuBar ul li a[rel='"+n+"']").text();r(a).hasClass("new")||t.push({id:i,key:n,title:o,closeBtn:!0})}),r(".mainTask .dashboard-tabs").empty(),r(".mainTask .dashboard-tabs").hide(),t.length>0){var e=o(t);r(".mainTask .dashboard-tabs").html(e),r(".mainTask .dashboard-tabs").show()}r(".dashboardTask").each(function(t,e){var a=r(e).attr("data-rel");r(this).find(".dashboard-tabs li a[data-key='"+a+"']").closest("li").addClass("active")})},showTabContextMenu:function(t,e){var n={_me:{name:(0,s.translate)("close")},_all:{name:(0,s.translate)("close_all")},_others:{name:(0,s.translate)("close_all_but_this")}},i=".dashboard-tabs";r.contextMenu("destroy",i),r.contextMenu({selector:i,callback:function(e,n){switch(e){case"_me":t.closest("li").find("i").click();break;case"_all":case"_others":var i=t.attr("data-key");"_all"==e&&(i="_123123_"),Promise.resolve().then(function(){var n=[a(684)];(function(a){var n=new a,o=[];t.closest("ul.dashboard-tabs").find("li a").each(function(t,e){r(e).attr("data-key")!=i&&o.push(r(e).attr("data-key"))}),o.length>0&&r.each(o,function(t,a){"_all"==e?n.removeTask(a,!1):(n.selectTask(i),n.removeTask(a,!0))})}).apply(null,n)}).catch(a.oe)}},items:n,events:{hide:function(t){r.contextMenu("destroy",i)}},zIndex:0}),r(i).contextMenu({x:e.clientX,y:e.clientY})},getNavigator:function(t){var e=this;this.dashboardModel.getNavigator({dashboardId:t},function(t){t&&(t.priorId>0&&e.getParent().find(".btnNavigatorPrior").attr("data-id",t.priorId).attr("title",t.priorName).closest("li").removeClass("disabled"),t.nextId>0&&e.getParent().find(".btnNavigatorNext").attr("data-id",t.nextId).attr("title",t.nextName).closest("li").removeClass("disabled"))})},initPromiseWatcher:function(){if(this.dashboardModel){var t=this.dashboardModel.getItemsModel();if(t&&t.length>0){var e=!0;if(r.each(t,function(t,a){0==r(a.tagId).find(".item-class-selector").length&&(e=e&&a.isReady)}),!e&&this.getParent().find(".dashboard-area").length>0){var a=this;setTimeout(function(){a.initPromiseWatcher(),a=null},1e3)}}}}});return d}.apply(e,i))||(t.exports=o)}).call(this,a(218),a(1))}}]);