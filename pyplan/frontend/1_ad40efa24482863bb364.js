/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1780:function(e,t,i){var n=i(670);function r(e){return e&&(e.__esModule?e.default:e)}e.exports=(n.default||n).template({1:function(e,t,i,n,r){return'<div class="pane-container">\n'},3:function(e,t,i,n,r){return'            <div class="changes-area" style="width: 100%; height: 28px; z-index: 999; \n            position: absolute; top: 0; left: -5px;\n            padding-top: 3px; padding-left: 5px; background: rgb(0, 0, 0); background: rgba(0, 0, 0, .8);">\n              <button class="btn btn-mini btn-lime applyChanges">Accept</button>\n              <button class="btn btn-mini btn-lightred cancelChanges">Cancel</button>\n            </div>\n'},5:function(e,t,n,a,l){var s,o=e.lambda,d=e.escapeExpression,u=null!=t?t:e.nullContext||{},c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\n            <div>\n                \x3c!--<i class="from-snapshot fa fa-camera nodisplay"></i>--\x3e\n                <i class="from-scenario fa fa-database nodisplay"></i>\n                <span class="title" title="'+d(o(null!=(s=null!=(s=null!=(s=null!=t?c(t,"data"):t)?c(s,"itemProperties"):s)?c(s,"title"):s)?c(s,"text"):s,t))+'">'+d(o(null!=(s=null!=(s=null!=(s=null!=t?c(t,"data"):t)?c(s,"itemProperties"):s)?c(s,"title"):s)?c(s,"text"):s,t))+'</span>\n                \x3c!--span class="knowledge-arrow"></span--\x3e\n\n                <i class="fa fa-info-circle knowledge-arrow" aria-hidden="true"></i>\n\n                <span class="unit">'+d(o(null!=(s=null!=(s=null!=t?c(t,"data"):t)?c(s,"itemProperties"):s)?c(s,"unit"):s,t))+"</span>\n\n"+(null!=(s=r(i(669)).call(u,null!=(s=null!=t?c(t,"data"):t)?c(s,"objectType"):s,"==","inputform",{name:"ifCond",hash:{},fn:e.program(6,l,0),inverse:e.noop,data:l,loc:{start:{line:39,column:16},end:{line:42,column:27}}}))?s:"")+'\n                <span class="infoOnHover">\n                    <span class="time-frame" style="display:none">\n                        <i class="fa fa-calendar infoOnHover" style="display:initial" title="'+d(r(i(668)).call(u,"time_frame",{name:"L",hash:{},data:l,loc:{start:{line:46,column:93},end:{line:46,column:111}}}))+'" ></i>\n                        <a href="#" class="infoOnHover"></a>\n                    </span>\n                </span>\n\n                <i class="btnMenu fa fa-cog infoOnHover" title="'+d(r(i(668)).call(u,"settings",{name:"L",hash:{},data:l,loc:{start:{line:51,column:64},end:{line:51,column:80}}}))+'" ></i>\n\n'+(null!=(s=r(i(669)).call(u,null!=(s=null!=t?c(t,"data"):t)?c(s,"itemType"):s,"==","nodetable",{name:"ifCond",hash:{},fn:e.program(8,l,0),inverse:e.noop,data:l,loc:{start:{line:53,column:16},end:{line:55,column:27}}}))?s:"")+"                \n            </div>\n"},6:function(e,t,i,n,r){return'                <div class="dataStatus green"></div>\n                <i class="fa fa-plus-square dashAddRow" title="Add row" style="display: none;"></i>\n'},8:function(e,t,n,a,l){return'                    <i class="toggle-mode fa fa-pencil toolbar-area" title="'+e.escapeExpression(r(i(668)).call(null!=t?t:e.nullContext||{},"edit",{name:"L",hash:{},data:l,loc:{start:{line:54,column:76},end:{line:54,column:88}}}))+'" ></i>\n'},10:function(e,t,n,a,l){return'                  <div class="item-line">\n                      <button class="btn btn-red" data-key="inputform" title="'+e.escapeExpression(r(i(668)).call(null!=t?t:e.nullContext||{},"Input Form",{name:"L",hash:{},data:l,loc:{start:{line:79,column:78},end:{line:79,column:96}}}))+'" ><i class="fa fa-database"></i></button>\n                  </div>\n'},12:function(e,t,i,n,r){return"</div>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,a,l){var s,o=null!=t?t:e.nullContext||{},d=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=r(i(669)).call(o,null!=t?u(t,"skipContainer"):t,"==",0,{name:"ifCond",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l,loc:{start:{line:1,column:0},end:{line:3,column:11}}}))?s:"")+'\n    <div class="pane" id="'+d(e.lambda(null!=t?u(t,"id"):t,t))+'">\n\n'+(null!=(s=r(i(669)).call(o,null!=(s=null!=t?u(t,"data"):t)?u(s,"itemType"):s,"==","nodetable",{name:"ifCond",hash:{},fn:e.program(3,l,0),inverse:e.noop,data:l,loc:{start:{line:7,column:8},end:{line:14,column:19}}}))?s:"")+'\n        <div class="item-toolbar btn-group nodisplay" >\n\n            \x3c!--<span class="btn" data-rel="select"><i class="fa fa-cog"></i></span>--\x3e\n            <button class="btn btn-small" data-rel="reset" rel="tooltip" data-placement="bottom" title="" data-original-title="'+d(r(i(668)).call(o,"remove",{name:"L",hash:{},data:l,loc:{start:{line:19,column:127},end:{line:19,column:141}}}))+'"><i class="fa fa-eraser"></i></button>\n            <span class="btn btn-small dragger" data-rel="drag" rel="tooltip" data-placement="bottom" title="" data-original-title="'+d(r(i(668)).call(o,"move",{name:"L",hash:{},data:l,loc:{start:{line:20,column:132},end:{line:20,column:144}}}))+'"><i class="fa fa-arrows"></i></span>\n            <button class="btn btn-small" data-rel="splitv" rel="tooltip" data-placement="bottom" title="" data-original-title="'+d(r(i(668)).call(o,"split_vertically",{name:"L",hash:{},data:l,loc:{start:{line:21,column:128},end:{line:21,column:152}}}))+'"><i class="fa fa-arrows-v"></i></button>\n            <button class="btn btn-small" data-rel="splith" rel="tooltip" data-placement="bottom" title="" data-original-title="'+d(r(i(668)).call(o,"split_horizontally",{name:"L",hash:{},data:l,loc:{start:{line:22,column:128},end:{line:22,column:154}}}))+'"><i class="fa fa-arrows-h"></i></button>\n            <button class="btn btn-small" data-rel="remove" rel="tooltip" data-placement="bottom" title="" data-original-title="'+d(r(i(668)).call(o,"close",{name:"L",hash:{},data:l,loc:{start:{line:23,column:128},end:{line:23,column:141}}}))+'"><i class="fa fa-close"></i></button>\n\n        </div>\n        <div class="col-sm-12 item-title">\n'+(null!=(s=u(n,"if").call(o,null!=(s=null!=(s=null!=t?u(t,"data"):t)?u(s,"itemProperties"):s)?u(s,"title"):s,{name:"if",hash:{},fn:e.program(5,l,0),inverse:e.noop,data:l,loc:{start:{line:27,column:10},end:{line:58,column:17}}}))?s:"")+'        \n        </div>\n\n          <div class="item-area">\n\n              <div class="item-class-selector">\n                  <div class="item-line">\n                      <button class="btn btn-green" data-key="table" title="'+d(r(i(668)).call(o,"_tableChart",{name:"L",hash:{},data:l,loc:{start:{line:66,column:76},end:{line:66,column:95}}}))+'" ><i class="fa fa-table"></i></button>\n                      <button class="btn btn-blue " data-key="columnchart" title="'+d(r(i(668)).call(o,"chart",{name:"L",hash:{},data:l,loc:{start:{line:67,column:82},end:{line:67,column:95}}}))+'" ><i class="fa fa-bar-chart"></i></button>\n                      <button class="btn btn-purple" data-key="diagramviewer"  title="'+d(r(i(668)).call(o,"diagram_viewer",{name:"L",hash:{},data:l,loc:{start:{line:68,column:86},end:{line:68,column:108}}}))+'"><i class="fa fa-sitemap"></i></button>\n                      <button class="btn btn-lime" data-key="texteditor"  title="'+d(r(i(668)).call(o,"text_editor",{name:"L",hash:{},data:l,loc:{start:{line:69,column:81},end:{line:69,column:100}}}))+'"><i class="fa fa-align-left"></i></button>\n                  </div>\n                  <div class="item-line">\n                      <button class="btn btn-pink" data-key="filter" title="'+d(r(i(668)).call(o,"filter",{name:"L",hash:{},data:l,loc:{start:{line:72,column:76},end:{line:72,column:90}}}))+'" ><i class="fa fa-filter"></i></button>\n                      <button class="btn btn-yellow" data-key="nodetable" title="'+d(r(i(668)).call(o,"_cubeChart",{name:"L",hash:{},data:l,loc:{start:{line:73,column:81},end:{line:73,column:99}}}))+'"><i class="fa fa-cube"></i></button>\n                      <button class="btn btn-lightgrey" data-key="mapviewer"  title="'+d(r(i(668)).call(o,"_gisMap",{name:"L",hash:{},data:l,loc:{start:{line:74,column:85},end:{line:74,column:100}}}))+'"><i class="fa fa-map-marker"></i></button>\n                      <button class="btn btn-magenta " data-key="wizard" title="'+d(r(i(668)).call(o,"wizard",{name:"L",hash:{},data:l,loc:{start:{line:75,column:80},end:{line:75,column:94}}}))+'" ><i class="fa fa-magic"></i></button>\n                  </div>\n'+(null!=(s=r(i(741)).call(o,"VIEWINPUTTEMPLATES,VIEWALLTEMPLATES,MANAGETEMPLATES",{name:"haveAnyAccess",hash:{},fn:e.program(10,l,0),inverse:e.noop,data:l,loc:{start:{line:77,column:18},end:{line:81,column:36}}}))?s:"")+'\n\n                  \x3c!--div class="item-line">\n                      <button class="btn btn-pink" data-key="complexchart" title="'+d(r(i(668)).call(o,"Complex chart",{name:"L",hash:{},data:l,loc:{start:{line:85,column:82},end:{line:85,column:103}}}))+'" ><i class="fa fa-eye"></i></button>\n                  </div--\x3e\n              </div>\n\n          </div>\n          <div class="drop-area">\n              <div class="drop-item for-row"><span>'+d(r(i(668)).call(o,"drop_here",{name:"L",hash:{},data:l,loc:{start:{line:91,column:51},end:{line:91,column:68}}}))+'</span>\n                  \x3c!--<ul></ul>--\x3e\n              </div>\n              <div class="drop-item for-column"><span>'+d(r(i(668)).call(o,"drop_here",{name:"L",hash:{},data:l,loc:{start:{line:94,column:54},end:{line:94,column:71}}}))+'</span>\n                  \x3c!--<ul></ul>--\x3e\n              </div>\n          </div>\n          <div class="detail-area">\n              <ul></ul>\n          </div>\n          <div class="info-area">\n          </div>\n          <div class="item-selector"></div>\n\n  </div>\n\n'+(null!=(s=r(i(669)).call(o,null!=t?u(t,"skipContainer"):t,"==",0,{name:"ifCond",hash:{},fn:e.program(12,l,0),inverse:e.noop,data:l,loc:{start:{line:107,column:0},end:{line:109,column:11}}}))?s:"")},useData:!0})},1781:function(e,t,i){var n=i(670);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,r){return'<div class="pane-container"></div>'},useData:!0})},1782:function(e,t,i){var n=i(670);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,r){var a,l=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,o=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="editor">\n  <div class="col-xs-12 nopadding">\n    <div class="input-group">\n      <input type="text" value="'+o("function"==typeof(a=null!=(a=d(i,"name")||(null!=t?d(t,"name"):t))?a:s)?a.call(l,{name:"name",hash:{},data:r,loc:{start:{line:4,column:32},end:{line:4,column:40}}}):a)+'" class="form-control input-sm" autofocus>\n      <div class="input-group-btn">\n        <button data-rel="'+o("function"==typeof(a=null!=(a=d(i,"id")||(null!=t?d(t,"id"):t))?a:s)?a.call(l,{name:"id",hash:{},data:r,loc:{start:{line:6,column:26},end:{line:6,column:32}}}):a)+'" class="btn btn-blue btn-small" type="button" style="height: 30px;"><i class="fa fa-check"></i></button>\n      </div>\n    </div>\n  </div>\n</div>\n'},useData:!0})},1783:function(e,t,i){var n=i(670);e.exports=(n.default||n).template({1:function(e,t,i,n,r){var a,l,s=null!=t?t:e.nullContext||{},o=e.hooks.helperMissing,d="function",u=e.escapeExpression,c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <li data-field="'+u(typeof(l=null!=(l=c(i,"field")||(null!=t?c(t,"field"):t))?l:o)===d?l.call(s,{name:"field",hash:{},data:r,loc:{start:{line:2,column:20},end:{line:2,column:29}}}):l)+'" title="'+u(typeof(l=null!=(l=c(i,"field")||(null!=t?c(t,"field"):t))?l:o)===d?l.call(s,{name:"field",hash:{},data:r,loc:{start:{line:2,column:38},end:{line:2,column:47}}}):l)+'" >'+(null!=(a=c(i,"if").call(s,null!=t?c(t,"hasLevels"):t,{name:"if",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r,loc:{start:{line:2,column:50},end:{line:2,column:139}}}))?a:"")+" "+(null!=(a=c(i,"if").call(s,null!=t?c(t,"unlinked"):t,{name:"if",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r,loc:{start:{line:2,column:140},end:{line:2,column:195}}}))?a:"")+' <span class="name">'+u(typeof(l=null!=(l=c(i,"name")||(null!=t?c(t,"name"):t))?l:o)===d?l.call(s,{name:"name",hash:{},data:r,loc:{start:{line:2,column:215},end:{line:2,column:223}}}):l)+':</span><a href="#" class="text filterselector"  title="'+u(typeof(l=null!=(l=c(i,"filterValues")||(null!=t?c(t,"filterValues"):t))?l:o)===d?l.call(s,{name:"filterValues",hash:{},data:r,loc:{start:{line:2,column:279},end:{line:2,column:295}}}):l)+'">('+u(typeof(l=null!=(l=c(i,"values")||(null!=t?c(t,"values"):t))?l:o)===d?l.call(s,{name:"values",hash:{},data:r,loc:{start:{line:2,column:298},end:{line:2,column:308}}}):l)+")</a></li>\n"},2:function(e,t,i,n,r){return'<a href="#" class="text hierarchy"><i class="fa fa-sitemap"/></a>'},4:function(e,t,i,n,r){return'<i class="fa fa-chain-broken"/> '},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,r){var a;return null!=(a=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(i,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r,loc:{start:{line:1,column:0},end:{line:3,column:9}}}))?a:""},useData:!0})},1784:function(e,t,i){var n=i(670);e.exports=(n.default||n).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,a){return'<div class="loading-pane" >\n    <span>'+e.escapeExpression((l=i(668),l&&(l.__esModule?l.default:l)).call(null!=t?t:e.nullContext||{},"loading",{name:"L",hash:{},data:a,loc:{start:{line:2,column:10},end:{line:2,column:25}}}))+"</span>\n</div>";var l},useData:!0})},728:function(e,t,i){"use strict";(function(n,r,a,l){var s,o,d=i(18);s=[i(691),i(1780),i(1781),i(1782),i(1783),i(1784),i(767)],void 0===(o=function(e,t,s,o,u,c,m){return n.View.extend({el:r("#n_o_n_e"),tagId:"",itemID:"",currentNodeId:"",toolbarInitialized:!1,editMode:!1,splitter:void 0,currentResult:void 0,currentNodeProperties:void 0,menuEnabled:!0,menuInitiated:!1,detailDragInitiated:!1,detailDraggable:!0,loadingTimeOut:-1,pageSize:-1,currentPage:-1,scaleFactorW:1,scaleFactorH:1,maxScaleFactorW:1,maxScaleFactorH:1,oldPopover:null,numberFormat:"",numberFormatter:void 0,originalRow:void 0,originalCol:void 0,filterChangeTimeout:-1,forceReloadMenu:!0,rowFormatter:void 0,columnFormatter:void 0,isReady:!1,sizeDic:{1:{w:220,h:220,hideDetail:!0},99:{w:9999,h:9999}},sizeTransition:{"1-99":{reload:!0},"99-1":{reload:!0}},lastSizeKey:void 0,fromEmbedded:!1,baseRender:function(e){void 0!==__currentSession.fromEmbedded&&(this.fromEmbedded=__currentSession.fromEmbedded);var i={id:r.uuid(),skipContainer:e?1:0,data:this.currentResult};this.tagId="#"+i.id;var n=t(i);this.$el.append(n),this.addToolbarHandlers(),this.addDraggable(),this.addDroppable(),this.addSelectable(),this.addEvents(),this.baseStyles(),this.baseUpdateSize(),this.addMouseOverTitleHandler(r(this.tagId))},baseUpdateSize:function(){var e=30;r(this.tagId).find(".detail-area").is(":visible")&&(e+=r(this.tagId).find(".detail-area").height(),r(this.tagId).find(".detail-area").css("font-size",11*this.maxScaleFactorW+"px")),r(this.tagId).find(".item-area").hasClass("fullSize")?e-=17:r(this.tagId).find(".item-area").hasClass("extrafullSize")&&(e-=32),r(this.tagId).find(".item-area").height(r(this.tagId).parent().height()-e);var t=Math.min(this.maxScaleFactorH,this.maxScaleFactorW);r(this.tagId).find(".item-title").css("font-size",15*t+"px"),r(this.tagId).find(".item-area").css("top",23*t+"px"),r(this.tagId).find(".time-frame .fa-calendar").css("font-size",12*t+"px"),r(this.tagId).find(".item-title .knowledge-arrow").css("line-height",21*t+"px"),this.checkSizeDic()},updateSize:function(){},updateValues:function(e){},exportItem:function(){},onRemoveItemView:function(){},onSaveDashboard:function(){},onEndFullScreenAnimation:function(){},onEndNormalScreenAnimation:function(){},getRelatedNoQuery:function(){},updateStyleLibraries:function(e){},setPositionForDropDetails:function(){},applyNumberFormat:function(){},getOptionsMenu:function(){return null},getStylesUsed:function(){},preEvaluateNode:function(e,t,i,n){},toolbarCreated:function(){},syncDrilldown:function(e,t,i){},syncDrillup:function(e,t){},syncShowHideLegend:function(e,t,i){},refreshItemDash:function(){r(this.tagId).trigger("evaluateNodeFromCurrentResult")},recreateItemDash:function(){r(this.tagId).trigger("evaluateNodeFromCurrentResult")},getPropertyWindowTitle:function(){var e="";return this.currentNodeId?e=this.currentNodeId:this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.nodeId&&(e=this.currentResult.itemProperties.nodeId),e},showOptionsMenu:function(){if(!this.editMode){var e=this.tagId+" .btnMenu";if(!this.menuInitiated||this.forceReloadMenu){var t=this.getOptionsMenu();if(t&&(this.menuInitiated&&r.contextMenu("destroy",e),r(".main-fullscreen").is(":visible")&&(t.items._splitBy?t.items._splitBy.disabled=!0:t.items._splitBy=!1),!r.isEmptyObject(t.items))){var i=this;this.menuInitiated=!0,r.contextMenu({selector:e,callback:function(e,n){t.callback(e),t.items&&t.items[e]&&t.items[e].persist&&setTimeout((function(){i.showOptionsMenu()}),100)},items:t.items})}}this.menuInitiated&&r(e).contextMenu()}},removeItemView:function(){this.onRemoveItemView(),this.columnFormatter=null,this.rowFormatter=null,this.splitter&&this.splitter.destroy(),this.splitter=null,this.currentResult=null,r(this.$el).closest(".mainTask").find(".left-menu[data-rel='"+this.tagId+"']").trigger("removeToolbar"),r.contextMenu("destroy",this.tagId+" .btnMenu"),r(this.tagId).find("div.item-toolbar span.dragger").draggable("destroy"),r(this.tagId).droppable("destroy"),this.detailDragInitiated&&(r(this.tagId).find("div.detail-area ul").sortable("destroy"),r(this.tagId).find(".drop-area .drop-item").droppable("destroy"))},_evaluateNode:function(e,t,i,n,a,l){if(e){var s=this;s.showLoading();var o,d,u=!1,c="A",m="FLO",h="CAL";i&&0!=i.length||!this.originalRow||(i=[s.originalRow],u=!0),n&&0!=n.length||!this.originalCol||(n=[s.originalCol],u=!0),s.currentResult&&s.currentResult.itemProperties&&(o=s.currentResult.itemProperties.bottomTotal,d=s.currentResult.itemProperties.rightTotal,s.currentResult.itemProperties.timeFormat&&(c=s.currentResult.itemProperties.timeFormat),s.currentResult.itemProperties.timeFormatType&&(m=s.currentResult.itemProperties.timeFormatType),s.currentResult.itemProperties.calendarType&&(h=s.currentResult.itemProperties.calendarType)),s.preEvaluateNode(e,t,i,n),s.model.evaluateNode(e,t,i,n,(function(e){s.hideLoading(),s.updatePropertiesOnEvaluate(e),s.currentResult&&e.indexValues&&(s.currentResult.indexValues=e.indexValues),s.updateIndexes(t,i,n,e.newDims,u),s.currentResult&&(t.length>0||i.length>0||n.length>0)&&(s.currentResult.dims=t,s.currentResult.rows=i,s.currentResult.columns=n),s.updateValues(e)}),!!(s.currentResult&&s.currentResult.itemProperties&&s.currentResult.itemProperties.defMode),(function(e){"Access denied"==e?(r(s.tagId).find(".item-area").empty(),r(s.tagId).find(".item-title").empty(),r(s.tagId).find(".loading-pane span").text(e)):s.hideLoading(),s.isReady=!0}),l,s.pageSize,s.currentPage,o,d,c,m,h),s.currentResult&&(t.length>0||i.length>0||n.length>0)&&(s.currentResult.dims=t,s.currentResult.rows=i,s.currentResult.columns=n)}},checkForDefaultFormat:function(e){e&&e.nodeProperties&&e.nodeProperties.numberFormat&&(this.numberFormat=e.nodeProperties.numberFormat,this.numberFormatter=null),e&&e.newDims&&(this.rowFormatter=null,e.series&&e.series.length>0&&"number"==typeof e.series[0].name&&(this.rowFormatter=this.getIndexFormatter(e.indexOnRow,e.newDims)),e.columns&&e.columns.categories&&e.columns.categories.length>0&&"number"==typeof e.columns.categories[0]&&(this.columnFormatter=this.getIndexFormatter(e.indexOnColumn,e.newDims)))},updatePropertiesOnEvaluate:function(e){if(e.nodeProperties){if(this.currentNodeProperties=e.nodeProperties,this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.title&&this.currentResult.itemProperties.title.isCustom||r(this.tagId).find(".item-title .title").text(e.nodeProperties.title),e.nodeProperties.unit&&r(this.tagId).find(".item-title .unit").text("("+e.nodeProperties.unit+")"),this.checkForDefaultFormat(e),e.nodeProperties.scenario){var t=r(this.tagId).find(".item-title .from-scenario").show(),i=(0,d.translate)("datasource_scenario");t.attr("title",i),t=null}else r(this.tagId).find(".item-title .from-scenario").hide();if(r(this.tagId).find(".item-title .time-frame").hide(),e&&e.newDims&&e.newDims.length>0)for(var n=0;n<e.newDims.length;n++)if(e.newDims[n]&&e.newDims[n].isTime){if(r(this.tagId).find(".item-title .time-frame").show(),this.currentResult){if(this.currentResult.columns&&this.currentResult.columns.length>0)for(var a=0;a<this.currentResult.columns.length;a++)if(this.currentResult.columns[a].isTime){this.currentResult.columns[a].field!=e.newDims[n].field&&this.currentResult.columns.splice(a,1,e.newDims[n]);break}if(this.currentResult.rows&&this.currentResult.rows.length>0)for(a=0;a<this.currentResult.rows.length;a++)if(this.currentResult.rows[a].isTime){this.currentResult.rows[a].field!=e.newDims[n].field&&this.currentResult.rows.splice(a,1,e.newDims[n]);break}}break}this.currentResult&&this.currentResult.itemType&&r.inArray(this.currentResult.itemType,["table","columnchart","columnchartstacked","columnchartpercent","barchart","barchartstacked","barchartpercent","linechart","scatterchart","piechart"])<0&&r(this.tagId).find(".time-frame").remove()}},updateIndexes:function(e,t,i,n,a){var l=function(e,t,i){var n=!1;return e&&r.each(e,(function(e,r){if(r&&r.field==t.field)return n=!0,i&&(r.levels=t.levels,r.values=t.values,r.name=t.name,r.numberFormat=t.numberFormat),!1})),n},s=!1;r.each(n,(function(n,r){l(e,r,!0)||l(t,r,!0)||l(i,r,!0)||e&&(s=!0,e.push(r))}));var o=function(e){e&&r.each(e,(function(t,i){i&&(l(n,i)||(e.splice(t,1),s=!0))}))};o(e),o(t),o(i),(s||a)&&(r(this.$el).closest(".mainTask").find(".left-menu[data-rel='"+this.tagId+"']").trigger("removeToolbar"),this.toolbarInitialized=!1,this.editMode&&this.addProperties(!0)),this.updateDetail(e,t,i)},addMouseOverTitleHandler:function(e){var t,i=this;e.find(".item-title .knowledge-arrow").hover((function(e){if(i.currentNodeProperties&&(i.currentNodeProperties.hasDescription||i.currentNodeProperties.hasWorkflowTask))return t=setTimeout((function(){r(".popover-title").parent().remove()}),1e3),!1}),(function(){clearTimeout(t)}))},getKnowledgeBaseData:function(e,t,i,n,r){var a=new m,l=__currentSession.documentationTab.toString();a.getPost(e,(function(a){var s,o=a,u=a.description?a.description.trim():"",c=a.content?a.content.trim():"",m="";m=("1"===l||"2"===l)&&""!==u&&u.length>0?u:c.substr(0,350)+"...",i.hasDescription?(s=m=m.replace(/<img[^>]*>/g,""),n.fromEmbedded||(s=m+'<br><a class="readMore" href="#" data-rel="'+a.nodeId+'">Read more</a>')):(s="There is no info for this module. ",n.fromEmbedded||(s=s+'<a class="readMore" href="#" data-rel="'+e+'">Add documentation</a>'));var h={title:o.nodeTitle,content:s,left:r.clientX,top:r.clientY,className:"popover_workflow",workflowEnabled:!0,fromEmbedded:n.fromEmbedded};(0,d.haveAnyAccess)("LISTASSIGNEDWORKFLOWTASKS,LISTALLWORKFLOWTASKS")?n.getWorkflowData(e,t,i,n,h):(h.workflowEnabled=!1,n.showPopoverContent(h,n,e))}))},getWorkflowData:function(e,t,i,n,r){},showPopoverContent:function(e,t,n){i.e(14).then((function(){var a=[i(733)];(function(a){(new a).show(e,(function(e){t.oldPopover=e.options.id,r(".openWorkflow").on("click",(function(){e.removePopover(),Promise.resolve().then((function(){var e=[i(664)];(function(e){(new e).addTask("workflow","Workflow")}).apply(null,e)})).catch(i.oe)})),r(".addTaskForNode").on("click",(function(){return event.preventDefault(),i.e(11).then((function(){var t=[i(722)];(function(t){(new t).showAddTaskForNode(n),e.removePopover()}).apply(null,t)})).catch(i.oe),!1})),r(".readMore").on("click",(function(){return event.preventDefault(),i.e(16).then((function(){var t=[i(766)];(function(t){(new t).show(n),e.removePopover()}).apply(null,t)})).catch(i.oe),!1}))}))}).apply(null,a)})).catch(i.oe)},addEvents:function(){var t=this;r(this.tagId).find(".btnMenu").on("click",(function(){t.showOptionsMenu()})),r(this.tagId).on("removeItemView",(function(){t.removeItemView()})),r(this.tagId).find(".item-title .from-scenario").on("click",(function(e){r(this).closest(".dashboardTask").find("div.toolbar button.btnScenarios").trigger("click")})),r(this.tagId).on("loadThisPageResult",(function(e,i){var n;(t.currentPage=i,t.currentResult)&&(t.currentResult.itemProperties&&(n=t.currentResult.itemProperties.summaryBy),t._evaluateNode(t.currentNodeId,t.currentResult.dims,t.currentResult.rows,t.currentResult.columns,void 0,n))})),r(this.tagId).on("evaluateNodeFromCurrentResult",(function(e,i){var n;(t.currentPage=1,t.currentResult)&&(t.currentResult.itemProperties&&(n=t.currentResult.itemProperties.summaryBy),t._evaluateNode(t.currentNodeId,t.currentResult.dims,t.currentResult.rows,t.currentResult.columns,i,n))})),r(this.tagId).on("refreshItemDash",(function(){t.refreshItemDash()})),r(this.tagId).on("updateOriginalRowCol",(function(e,i,n){t.originalRow=t.getIndexByField(i),t.originalCol=t.getIndexByField(n)})),r(this.tagId).on("evaluateNode",(function(e,i,n,a){if(t.currentResult&&(i||n||a)){var l=[],s=[],o=[];i&&s.push(t.getIndexByField(i)),n&&o.push(t.getIndexByField(n)),r.each(t.getIndexes(),(function(e,t){0!=s.length&&t==s[0]||0!=o.length&&t==o[0]||l.push(t)})),t.currentResult.dims=l,t.currentResult.columns=o,t.currentResult.rows=s}r(t.tagId).trigger("evaluateNodeFromCurrentResult")})),this.addCreateItemHandlers(),r(this.tagId).on("changeType",(function(e,i,n){t.currentResult&&(t.currentResult.itemProperties&&t.clearItemProperties(t.currentResult.itemProperties),t.currentResult.nodeResult=null,t.currentResult.itemType=i,n&&(t.currentResult.objectType=n),"complexchart"===i&&(t.currentResult.nodeName=t.currentNodeProperties.title),t.createNewView(t.currentResult))})),r(this.tagId).on("changeSeriesType",(function(e,i,n){t.currentResult&&(t.currentResult.itemProperties&&t.clearItemProperties(t.currentResult.itemProperties),t.currentResult.nodeResult=null,t.currentResult.itemProperties.nodesArray[n].itemSubType=i,t.currentResult.objectType="complexchart",t.createNewView(t.currentResult))})),r(this.tagId).find(".item-title .title").on("click",(function(){t.editMode&&"inputform"!==t.currentResult.objectType&&t.editTitle()})),r(this.tagId).find(".detail-area ul").on("click","li a.filterselector",(function(){var e=r(this).closest("li").attr("data-field"),n=t.getIndexByField(e),a=n.name,l=t.tagId;return t.editMode||Promise.resolve().then((function(){var r=[i(691)];(function(i){(new i).getFilterView((function(i){var r=new i;r.setElement(),r.render(e,a,l,t,n.currentLevel)}))}).apply(null,r)})).catch(i.oe),!1})),r(this.tagId).find(".detail-area ul").on("click","li a.hierarchy",(function(){var e=r(this).closest("li").attr("data-field"),i=t.getIndexByField(e);if(i&&i.levels&&i.levels.length>0){var n=i.levels.slice(0);n.reverse();for(var a={},l=0;l<n.length;l++){var s=n[l];a[s.field]={type:"icon_text",name:s.name}}a[i.currentLevel]&&(a[i.currentLevel].disabled=!0);var o=t.tagId+" .detail-area ul li[data-field='"+e+"'] a.hierarchy";r.contextMenu("destroy",o),r.contextMenu({selector:o,callback:function(n,r){i.currentLevel=n,i.values=[],t.refreshItemDash(),t.model.synchronizeLevel(e,n,t.tagId)},events:{hide:function(){r.contextMenu("destroy",o)}},items:a}),r(o).contextMenu()}return!1}));var n=!1;r(this.tagId).find(".detail-area ul").on("mousewheel","li a",(function(e){if(!n){var i;n=!0;var a=r(this).closest("li").attr("data-field"),l=t.getIndexByField(a),s=0;r.each(l.values,(function(e,t){t.selected&&(i=t.value,s++,e)})),1==s&&t.model.getIndexValues({id:a},(function(l){var s=l.results,o=0;if(r.each(s,(function(e,t){t.value==i&&(o=e)})),e.deltaY>0?o++:o--,o>=0&&o<s.length){var d=[{value:s[o].value,selected:!0}];r(this).text(d.value),t.model.onFilterChange(a,d,void 0,void 0,t.tagId),setTimeout((function(){n=!1}),500)}else n=!1}),t.getTimeFrame())}})),r(this.tagId).find(".item-title .time-frame i").on("click",(function(i){var n=new e,a={e:i,itemProperties:t.getTimeFrame(),callback:function(e){t.currentResult&&(t.currentResult.itemProperties=r.extend(t.currentResult.itemProperties,e),t.refreshItemDash())}};n.showTimeFrameSetting(a)}))},baseStyles:function(){if(this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.title){var e=this.currentResult.itemProperties.title.style.color,t=this.currentResult.itemProperties.title.enabled,i=this.currentResult.itemProperties.subtitle.style.color,n=r(this.tagId).find(".item-title"),a=r(this.tagId).find(".item-subtitle");n.css("color",e),t?n.css("display",""):n.css("display","none"),a.css("color",i)}this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.generalBackgroundColor&&r(this.tagId).css("background-color",this.currentResult.itemProperties.generalBackgroundColor)},addToolbarHandlers:function(){var e=this;r(this.tagId).find(".item-toolbar button").on("click",(function(){var t=r(this).attr("data-rel");switch(t){case"splitv":case"splith":e.splitPane(t);break;case"remove":e.remove();break;case"reset":e.resetView()}}))},fullScreen:function(){var e=this,t=r(this.tagId),i=t.closest("div.dashboard-area").find("div.main-fullscreen");if(r(".main-fullscreen").is(":visible"))return i.find("button[data-rel='close-screen']").click(),!1;t.find(".hide-minimize-button").length>0&&i.find("button[data-rel='close-screen']").hide();var n=t.find("div.item-area").parent(),a=n.parent();r.wrapper=a;var l=40;this.fromEmbedded&&(l=0);var s=t.offset();n.attr("data-parent",t.attr("id")),n.attr("data-orignal-w",t.width()),n.attr("data-orignal-h",t.height()-l),n.attr("data-orignal-x",s.left),n.attr("data-orignal-y",s.top-l),i.css("top",s.top-l+"px"),i.css("left",s.left+"px"),i.width(t.width()),i.height(t.height()),i.show(),i.append(n.detach());var o=r(window).width()-0,d=r(window).height()-l-5;i.animate({top:"0px",left:"0px",width:o,height:d},{complete:function(){e.calculateScaleFactor(o,d-35),e.updateSize(o,d-35,!1),e.onEndFullScreenAnimation()}}),e.updateSize(o,d-35,!0)},addDraggable:function(){r(this.tagId).find("div.item-toolbar span.dragger").draggable({helper:function(){return r("<div class='dashboard-dragger-helper'>"+(0,d.translate)("dragme_to_panel")+"</div>").appendTo("body").css({zIndex:999}).show()},opacity:.8,revert:"invalid",cursor:"move"})},addDroppable:function(){var e=this;r(this.tagId).droppable({accept:".ui-draggable",activeClass:"pane-drag-active",hoverClass:"pane-drag-hover",greedy:!0,drop:function(t,i){if(!(r(i.draggable).hasClass("dock")||r(i.draggable).parent().hasClass("dim-sort")||r(i.draggable).parent().hasClass("slimScrollDiv")||r(i.draggable).parent().hasClass("ui-sortable")))if(r(i.draggable).hasClass("swiper-slide")&&r(i.draggable).hasClass("node")){if(e.checkNodeOwner())return;var n=r(i.draggable).attr("data-id"),a=r(i.draggable).attr("data-class");r(o=this).trigger("selectPane"),"module"==a?e.createNewView({itemType:"objectItem",objectType:"diagramviewer",itemProperties:{diagramOptions:{currentModule:n}}}):e.initializeWithNode(n)}else if(r(i.draggable).hasClass("swiper-slide")&&r(i.draggable).hasClass("object")){if(e.checkNodeOwner())return;var l=r(i.draggable).attr("data-class");r(o=this).trigger("selectPane"),e.createNewView({itemType:"objectItem",objectType:l,itemProperties:{}})}else if(r(i.draggable).hasClass("btnDragComment"))r(i.draggable).closest(".dashboard-comments").trigger("addReferencedComment",e.itemId);else if(r(i.draggable).hasClass("nodeGhost")){if(e.checkNodeOwner())return;if(r(i.draggable).attr("data-source")!=e.tagId){n=r(i.draggable).attr("data-nodeId");"module"==(a=r(i.draggable).attr("data-nodeClass"))?e.createNewView({itemType:"objectItem",objectType:"diagramviewer",itemProperties:{diagramOptions:{currentModule:n}}}):e.initializeWithNode(n)}}else{var s=r(i.draggable).closest("div.pane"),o=this;if(t.ctrlKey){var d=e.model.getItemModel("#"+r(s).attr("id")),u=e.model.getItemModel("#"+r(o).attr("id"));d&&d.currentResult&&d.currentResult.itemProperties&&u&&u.currentResult&&u.currentResult.itemProperties&&(u.currentResult.itemProperties.showTitle=d.currentResult.itemProperties.showTitle,u.currentResult.itemProperties.detail=d.currentResult.itemProperties.detail,u.currentResult.itemProperties.drilldown=d.currentResult.itemProperties.drilldown,u.currentResult.itemProperties.emptyTotal=d.currentResult.itemProperties.emptyTotal,u.currentResult.itemProperties.table=r.extend({},d.currentResult.itemProperties.table),u.currentResult.itemProperties.generalBackgroundColor=d.currentResult.itemProperties.generalBackgroundColor,u.refreshItemDash())}else{var c=r(s).parent(),m=r(o).parent();s=r(s).detach(),o=r(o).detach(),s.appendTo(m),o.appendTo(c),e.model.updateSizes(!0,!0)}}}})},addSelectable:function(){var e=this;r(this.tagId).on("selectPane",(function(){if(e.editMode){r(this).closest("div.main-pane").find("div.pane").addClass("noedit");var t=r(this).attr("id");r(".dashboardTask.editing").attr("last-edited",t),r(this).closest("div.main-pane").find("div.pane[id='"+t+"']").removeClass("noedit"),e.addProperties()}})),r(this.tagId).on("click",(function(){r(this).trigger("selectPane")}))},splitPane:function(e,t){var n=s(),a=r(this.tagId).parent(),l=r(this.tagId).detach();r(n).appendTo(a),r(a).find("div.pane-container").append(l);var o=this;Promise.resolve().then((function(){var n=[i(691)];(function(i){(new i).getEmptyContent(o.model,(function(i){i.setElement(r(a)),i.render(),o.model.addItemToModel(i);var n=o.model;o.splitter=r(a).split({orientation:"splitv"==e?"horizontal":"vertical",position:"50%",onDragEnd:function(e){n&&n.updateSizes(!0,!0)}}),o.splitter.refresh(),o.splitter.refreshAll(r(a).closest("div.main-pane")),i.setEditMode(o.editMode),o.editMode?(o.model.updateSizes(!0,!0),r(i.tagId).trigger("selectPane")):(r(a).find(".hsplitter").hide(),r(a).find(".vsplitter").hide()),null!=t&&t(i)}))}).apply(null,n)})).catch(i.oe)},checkNodeOwner:function(){return!!(this.model&&this.currentNodeId&&this.model.getNodeOwner()&&this.model.getNodeOwner().toLowerCase()==this.currentNodeId.toLowerCase()&&1==this.model.countItemsModelByNodeId(this.currentNodeId))&&((0,d.showMessage)((0,d.translate)("cannot_remove_node_owner"),(0,d.translate)("_cant_remove"),"error",!0),!0)},remove:function(){if(!this.checkNodeOwner()){var e=r(this.tagId).parent(),t=r(e).parent();if(1!=r(e).closest("div.main-pane").find("div.pane").length){this.model.removeItemModel(this),r(t).split().destroy(),r(e).remove();var i=this;if(r(t).find(".splitter_panel").length>0){var n=r(t).find(".splitter_panel").split().orientation,a=r(t).find(".splitter_panel").split().position();r(t).find(".splitter_panel").split().destroy();var l=r(t).find(".pane-container").first().children().detach();r(t).find(".pane-container").first().remove(),r(t).append(l),r(t).split({orientation:n,position:a,onDragEnd:function(e){i.model.updateSizes(!0,!0)}}).refresh()}else{var s=r(t).find("div.pane").detach();r(t).find("div.pane-container").remove(),r(t).append(s)}i.model.updateSizes(!0,!0),this.onRemoveItemView(),r(t).closest("div.mainTask").find("div.menu-container").find(".left-menu[data-rel='"+i.tagId+"']").remove(),r(t).find("div.pane").first().trigger("selectPane")}}},setEditMode:function(e){this.editMode=e,this.editMode?""==r(this.tagId).find(".item-title .title").text()&&r(this.tagId).find(".item-title .title").text("("+(0,d.translate)("click_to_add_title")+")").attr("data-emptyTitle","1"):r(this.tagId).find(".item-title .title[data-emptyTitle='1']").text("").removeAttr("data-emptyTitle"),this.editModeChanged()},editModeChanged:function(){},refreshSplitter:function(){this.splitter&&this.splitter.refreshAll(r(this.tagId).closest("div.main-pane"))},addProperties:function(e){var t=this.currentResult;if(this.editMode){var n=r(this.tagId).attr("id"),a=r(this.tagId).closest("div.mainTask").find(".dock"),l=r(this.tagId).closest("div.mainTask").find(".dockDashboardProperty .dock-container"),s=l.find(".left-menu[data-rel='#"+n+"']");if(!s.is(":visible")&&(s.length>0?a.show():e||a.hide(),e||l.find(".left-menu").hide(),r(this.tagId).closest("div.mainTask").find(".dock").trigger("updateTitle",[""]),t))if(this.toolbarInitialized){s.show();var o=this.getPropertyWindowTitle();r(this.tagId).closest("div.mainTask").find(".dock").trigger("updateTitle",[o])}else{this.toolbarInitialized=!0;var d=this;Promise.resolve().then((function(){var a=[i(691)];(function(i){(new i).getChartToolbar(t.itemType,t.objectType,d.model,(function(i){i.setElement(r(d.tagId).closest("div.mainTask").find(".dockDashboardProperty .dock-container")),i.render(t,d.tagId),r(d.tagId).closest("div.mainTask").find(".dockDashboardProperty .dock-container").find(".left-menu[data-rel='#"+n+"']").show(),e||r(d.tagId).trigger("selectPane"),d.toolbarCreated()}))}).apply(null,a)})).catch(i.oe)}}},initializeWithNode:function(e,t){var i=this;if(e){r(this.tagId).find(".item-area").html(" "+(0,d.translate)("loading")+"..."),this.showLoading();var n=void 0;t&&"table"!=t||(n=100),this.model&&this.model.getNodeFullData(e,n,(function(e){i.hideLoading(),e&&(t&&"indexlist"!=e.itemType&&"selector"!=e.itemType&&"formnode"!=e.itemType&&(e.itemType=t),i.createNewView(e))}),(function(){i.hideLoading()}))}},createNewView:function(t,i){this.editMode&&(this.onRemoveItemView(),r(this.$el).closest(".mainTask").find(".left-menu[data-rel='"+this.tagId+"']").trigger("removeToolbar")),t.itemType&&r(this.tagId).find(".item-area").empty();var n=this;"objectItem"==t.itemType?(new e).getObjectItemViewFromType(t.objectType,(function(e){n._createNewObjectItem(e,t)})):(new e).getChartItemViewFromType(t.itemType,(function(e){n._createNewView(e,t,i)}))},_applyItemId:function(e,t){t?this.itemId=t:e.itemId?this.itemId=e.itemId:this.itemId=r.uuid(),r(this.tagId).attr("data-itemId",this.itemId)},_createNewObjectItem:function(e,t){var i=r(this.tagId).parent();i.find("div.pane").remove();var n=new e({model:this.model});n.setElement(i),n.currentNodeId="",n.currentResult=t,n.render(!0),n.splitter=this.splitter,n.splitter&&n.splitter.setOptions("onDragEnd",(function(e){n.model.updateSizes(!0,!0)})),n.setEditMode(this.editMode),this.model.changeItemModel(this,n),r(n.tagId).trigger("selectPane"),n._applyItemId(t,this.itemId),this.clearAll()},_createNewView:function(e,t,i){var n=r(this.tagId).parent();n.find("div.pane").remove();var l,s=new e({model:this.model});if(s.setElement(n),s.currentNodeId=t.nodeId,s.currentResult=t,s.scaleFactorW=this.scaleFactorW,s.scaleFactorH=this.scaleFactorH,s.maxScaleFactorW=this.maxScaleFactorW,s.maxScaleFactorH=this.maxScaleFactorH,"complexchart"==t.itemType){var o=a.extend({},t.itemProperties);s.currentResult.itemProperties.nodesArray||(s.currentResult.itemProperties.nodesArray=[],s.currentResult.itemProperties.nodesArray.push({nodeId:t.nodeId,nodeName:t.nodeName,itemSubType:"column",lineStyle:"",itemProperties:o,columns:t.columns,dims:t.dims,rows:t.rows,nodeIndex:0}));t.nodeResult&&s.checkForDefaultFormat(t.nodeResult,0)}else t.nodeResult&&s.checkForDefaultFormat(t.nodeResult);(s.render(!0),t.nodeResult&&s.updatePropertiesOnEvaluate(t.nodeResult),s.splitter=this.splitter,s.splitter&&s.splitter.setOptions("onDragEnd",(function(e){s.model&&s.model.updateSizes(!0,!0)})),s.setEditMode(this.editMode),this.model.changeItemModel(this,s),r(s.tagId).trigger("selectPane"),s._applyItemId(t,this.itemId),this.clearAll(),t.nodeResult)?(this.checkTimeIndex(t,!0,void 0),s.updateDetail(t.dims,t.rows,t.columns)):!i&&t.nodeId&&(t.itemProperties&&(l=t.itemProperties.summaryBy),t.itemProperties&&(l=t.itemProperties.summaryBy),s.updateOriginalRowCol(t.rows,t.columns),s._evaluateNode(t.nodeId,t.dims,t.rows,t.columns,void 0,l))},checkTimeIndex:function(e,t,i){if(t){for(var n=0;n<e.columns.length;n++)if(e.columns[n].isTime)return void(e.itemProperties.timeChart.possible=!0);for(n=0;n<e.rows.length;n++)if(e.rows[n].isTime)return void(e.itemProperties.timeChart.possible=!0)}else for(n=0;n<i.length;n++)if(i[n].isTime)return void(e.itemProperties.timeChart.possible=!0);e.itemProperties.timeChart.possible=!1},clearAll:function(){this.splitter=null,this.currentResult=null,this.model=null},ensureProp:function(e,t,i){return e&&e.hasOwnProperty(t)?e[t]:i},getRowIndexField:function(){return this.currentResult&&this.currentResult.rows.length>0?this.currentResult.rows[0].field:""},getRowIndex:function(){if(this.currentResult&&this.currentResult.rows.length>0)return this.currentResult.rows[0]},getColumnIndex:function(){if(this.currentResult&&this.currentResult.columns.length>0)return this.currentResult.columns[0]},getColumnIndexField:function(){if(this.currentResult&&this.currentResult.columns.length>0)return this.currentResult.columns[0].field},getIndexes:function(){var e=[];return this.currentResult&&(this.currentResult.dims=l.filter(this.currentResult.dims,(function(e){return!l.isEmpty(e)})),this.currentResult.columns=l.filter(this.currentResult.columns,(function(e){return!l.isEmpty(e)})),this.currentResult.rows=l.filter(this.currentResult.rows,(function(e){return!l.isEmpty(e)})),this.currentResult.dims&&this.currentResult.dims.length>0&&(e=e.concat(this.currentResult.dims)),this.currentResult.columns&&this.currentResult.columns.length>0&&(e=e.concat(this.currentResult.columns)),this.currentResult.rows&&this.currentResult.rows.length>0&&(e=e.concat(this.currentResult.rows))),e},getIndexByField:function(e){e&&(e=e.split(".")[0].toLowerCase());var t=this.getIndexes();if(t&&t.length>0)for(var i=0;i<t.length;i++)if(String(t[i].field).split(".")[0].toLowerCase()==e)return t[i]},isValueEmpty:function(e){return null==e||!(e instanceof String)&&0==e},filterEmptyData:function(e,t){if(e){for(var i=e.series.length-1;i>=0;i--){for(var n=e.series[i],r=!0,a=0;a<n.data.length&&r;a++)r=r&&this.isValueEmpty(n.data[a]);r&&e.series.splice(i,1)}for(var l=e.columns.categories.length-1;l>=0;l--){for(r=!0,i=0;i<e.series.length&&r;i++)r=r&&this.isValueEmpty(e.series[i].data[l]);if(r){var s=e.columns.categories[l];if(!t||-1==t.indexOf(s)){e.columns.categories.splice(l,1);for(i=0;i<e.series.length;i++)e.series[i].data.splice(l,1)}}}}},updateChoiceDefinition:function(e,t,i,n,r){var a=i.split(","),l=a[0]+","+(parseInt(n)+1);a.length>2?l+=","+a[2]:l+=")";var s={node:e,changes:[{filterList:t,definition:l}]},o=this;this.model.setNodeValueChanges(s,(function(e){e&&(null==r?o.model.reevaluateNodesNeeded(o.tagId):r())}))},updateNodeDefinition:function(e,t,i,n){null==n&&(n=[]);var r={node:e,changes:[{filterList:n,definition:t}]},a=this;this.model.setNodeValueChanges(r,(function(e){e?null==i?a.model.reevaluateNodesNeeded(a.tagId):i():(0,d.showMessage)((0,d.translate)("set_definition_error"),void 0,"error")}))},editTitle:function(){var e=r(this.tagId).find(".item-title").parent(),t=e.find("span.title"),i=r(this.tagId).find(".item-toolbar"),n={name:"1"==t.attr("data-emptyTitle")?"":t.text()},a=o(n);e.prepend(a),e.find("div.editor input").focus();var l=this,s=function(a){var s=r(a).val();s!=n.name&&(t.html(s),t.attr("title",s),l.setTitle(s)),e.find("div.editor").remove(),t.show(),""==t.text()?t.text("("+(0,d.translate)("click_to_add_title")+")").attr("data-emptyTitle","1"):t.removeAttr("data-emptyTitle"),i.css("display",""),l=null};e.find("div.editor input").focusout((function(){s(r(this))})),e.find("div.editor input").keypress((function(e){13==e.keyCode&&s(r(this))})),e.find("div.editor").click((function(e){e.stopPropagation()})),t.hide(),i.css("display","none")},setTitle:function(e){this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.title&&(this.currentResult.itemProperties.title.text=e,this.currentResult.itemProperties.title.isCustom=!0)},setViewDetail:function(e){this.currentResult&&this.currentResult.itemProperties&&(this.currentResult.itemProperties.detail=e),this.currentResult&&this.updateDetail(this.currentResult.dims,this.currentResult.rows,this.currentResult.columns)},toggleViewDetail:function(){this.currentResult&&this.currentResult.itemProperties&&this.setViewDetail(!this.currentResult.itemProperties.detail)},updateDetail:function(e,t,i){var n=this.currentResult.itemProperties.detail;this.getItemSize();if(n&&this.lastSizeKey&&this.sizeDic[this.lastSizeKey]&&this.sizeDic[this.lastSizeKey].hideDetail&&(n=!1),this.currentResult&&this.currentResult.itemProperties&&n){this.initializeDetailDrag();var a=[],l=this,s=function(e,t){r.each(e,(function(e,t){var i,n={field:t.field,name:t.name,values:(0,d.translate)("all"),unlinked:l.isUnlinkedIndex(t.field),hasLevels:t.levels&&t.levels.length>0,levels:t.levels},s=0,o="";t.numberFormat&&(i=new d.NovixFormatter(t.numberFormat)),r.each(t.values,(function(e,t){if(t.selected){var n=t.value;i&&"N"==t.type&&(n=i.format(n)),s++,""!=o&&(o+=", "),o+=n}})),1==s?n.values=o:s>0&&(n.values=(0,d.translate)("multiple"),n.filterValues=o),a.push(n)}))};s(t),s(i),s(e);var o=u(a);r(this.tagId).find(".detail-area ul").html(o),r(this.tagId).find(".detail-area ul li a").tooltip(),l=null}else r(this.tagId).find(".detail-area ul").empty();this.baseUpdateSize(),this.updateSize()},showLoading:function(){this.hideLoading();var e=c();r(this.tagId).append(e)},hideLoading:function(){clearTimeout(this.loadingTimeOut),this.loadingTimeOut=-1,r(this.tagId).find(".loading-pane").remove()},initializeDetailDrag:function(){if(!this.detailDragInitiated&&this.detailDraggable){this.detailDragInitiated=!0;var e=this;r(this.tagId).find("div.detail-area ul").sortable({helper:"clone",opacity:.8,cursor:"move",start:function(t,i){e.setPositionForDropDetails(),r(i.item[0]).closest(".pane").find(".drop-area").show()},stop:function(e,t){r(t.item[0]).closest(".pane").find(".drop-area").hide()}}),r(this.tagId).find(".drop-area .drop-item").droppable({accept:"div.detail-area ul li",hoverClass:"ui-state-active",drop:function(t,i){if(i&&i.draggable&&i.draggable.length>0&&e.currentResult&&e.currentResult.dims){var n=r(i.draggable[0]).attr("data-field"),a="column";r(this).hasClass("for-row")&&(a="row");var l=e.getRowIndex(),s=e.getColumnIndex();if("column"==a&&"complexchart"===e.currentResult.itemType)for(var o=!1,d=0;d<e.currentResult.itemProperties.nodesArray.length;d++){for(var u=0;u<e.currentResult.itemProperties.nodesArray[d].newDims.length;u++)e.currentResult.itemProperties.nodesArray[d].newDims[u].field==n&&(o=!0);if(!o)return}if("column"==a&&s&&s.field==n)return;if("row"==a&&l&&l.field==n)return;var c=[],m=[],h=[];"row"==a?(m.push(e.getIndexByField(n)),s&&s.field==n&&l?h.push(l):s&&s.field!=n&&h.push(s)):"column"==a&&(h.push(e.getIndexByField(n)),l&&l.field==n&&s?m.push(s):l&&l.field!=n&&m.push(l)),r.each(e.getIndexes(),(function(e,t){0!=m.length&&t==m[0]||0!=h.length&&t==h[0]||c.push(t)}));var p=e.getRowIndexField(),f=e.getColumnIndexField();e.updateOriginalRowCol(m,h,!0),e._evaluateNode(e.currentNodeId,c,m,h,"dropFilter"),e.synchronizeDrop(e.currentNodeId,p,f,c,m,h)}}})}},updateOriginalRowCol:function(e,t,i){e&&(i||e.length>0)&&(this.originalRow=r.extend({},e[0])),t&&(i||t.length>0)&&(this.originalCol=r.extend({},t[0]))},setBackgroundColor:function(e){this.currentResult&&(this.currentResult.itemProperties||(this.currentResult.itemProperties={})),this.currentResult.itemProperties.generalBackgroundColor=e,this.baseStyles()},setSummaryBy:function(e){this.currentResult&&this.currentResult.itemProperties&&(this.currentResult.itemProperties.summaryBy=e,this.refreshItemDash())},onFilterChange:function(e,t,i,n,a,l){var s=this.getIndexByField(e);if(s&&(a||!this.isUnlinkedIndex(e))){if((i||n)&&(!this.model.isReadyForEvaluate(e,this.currentNodeId)||n))return;if(s.values=t,l){clearTimeout(this.filterChangeTimeout);var o=this;this.filterChangeTimeout=setTimeout((function(){r(o.tagId).trigger("evaluateNodeFromCurrentResult"),o=null}),l)}else r(this.tagId).trigger("evaluateNodeFromCurrentResult")}},onFiltersChange:function(e){for(var t=!1,i=0;i<e.length;i++){var n=e[i].field,a=e[i].values,l=this.getIndexByField(n);l&&(this.isUnlinkedIndex(n)||(l.values=a,t=!0))}t&&r(this.tagId).trigger("evaluateNodeFromCurrentResult")},isUnlinkedIndex:function(e){var t=!1;return this.currentResult&&this.currentResult.itemProperties&&this.currentResult.itemProperties.indexEvents&&(this.currentResult.itemProperties.indexEvents[e]||this.currentResult.itemProperties.indexEvents[e+"."+this.currentNodeId])&&(t=!0),t},isDiagramView:function(){return!1},needRefresh:function(e){return!1},getNodesOfView:function(){if(this.currentNodeId)return[this.currentNodeId]},changeTitleColor:function(e){this.currentResult.itemProperties.title.style.color=e,this.baseStyles()},setNumberFormat:function(e){this.currentNodeId;this.currentResult.itemProperties.numberFormat=e,this.createFormatter(!0),this.applyNumberFormat()},setTitleEnabled:function(e){this.currentResult.itemProperties.title.enabled=e,this.baseStyles()},changeSubtitleColor:function(e){this.currentResult.itemProperties.subtitle.style.color=e,this.baseStyles()},addCreateItemHandlers:function(){var e=this;r(this.tagId).on("click",".item-area .item-class-selector button",(function(t){if(!e.checkNodeOwner()){var n,a,l=r(this).attr("data-key");switch(l){case"columnchart":case"complexchart":case"table":case"nodetable":case"wizard":case"filter":var s=["variable"];"wizard"==l&&(s=null,l=void 0),"filter"==l&&(s=["index","decision","inputnode"],l=void 0),function(e,t,n){i.e(31).then((function(){var r=[i(979)];(function(i){(new i).show(e,{callback:n,filteredClasses:t})}).apply(null,r)})).catch(i.oe)}(t,s,(function(t){var i=t.nodeId;"module"==t.nodeClass?e.createNewView({itemType:"objectItem",objectType:"diagramviewer",itemProperties:{diagramOptions:{currentModule:i}}}):e.initializeWithNode(i,l)}));break;case"inputform":n=t,a=function(t){var i=t.templateId,n=t.name;e.createNewView({itemType:"objectItem",objectType:"inputform",itemProperties:{templateId:i,inputForm:{templateId:i},title:{text:n,style:{color:"#000"},enabled:!0},subtitle:{style:{color:"#000"}}}})},i.e(49).then((function(){var e=[i(1171)];(function(e){(new e).show(n,{callback:a})}).apply(null,e)})).catch(i.oe);break;case"texteditor":case"diagramviewer":case"mapviewer":case"dashboardcontainer":e.createNewView({itemType:"objectItem",objectType:l,itemProperties:{}})}}}))},resetView:function(){this.checkNodeOwner()||this.createNewView({itemType:"empty"})},ensureOnlyDims:function(e,t,i){e||(e=[]),t||(t=[]),i||(i=[]),t.length>0&&e.push(t.pop()),i.length>0&&e.push(i.pop()),r(this.tagId).trigger("updateOriginalRowCol")},ensureOneColumn:function(e,t,i){e||(e=[]),t||(t=[]),i||(i=[]),t.length>0&&e.push(t.pop()),0==i.length&&e.length>0&&i.push(e.pop()),r(this.tagId).trigger("updateOriginalRowCol")},ensureOneRow:function(e,t,i){e||(e=[]),t||(t=[]),i||(i=[]),i.length>0&&e.push(i.pop()),0==t.length&&e.length>0&&t.push(e.pop()),r(this.tagId).trigger("updateOriginalRowCol")},createFormatter:function(e){this.currentResult.itemProperties.numberFormat&&(this.numberFormat=this.currentResult.itemProperties.numberFormat),this.numberFormatter&&!e||(this.numberFormatter=new d.NovixFormatter(this.numberFormat))},getIndexFormatter:function(e,t){if(t&&e)for(var i=0;i<t.length;i++)if(t[i].field.toLowerCase()==e.toLowerCase()||t[i].name.toLowerCase()==e.toLowerCase())return t[i].numberFormat?new d.NovixFormatter(t[i].numberFormat):null;return null},secureFormatValue:function(e){return this.numberFormatter||this.createFormatter(),this.numberFormatter.formatNumber(e)},clearItemProperties:function(e){e&&(delete e.bottomTotal,delete e.rightTotal,delete e.defMode,delete e.timeFormat,delete e.timeFormatType,delete e.calendarType)},calculateScaleFactor:function(e,t){var i=r(this.tagId).closest(".dashboard-area").width(),n=r(this.tagId).closest(".dashboard-area").height();this.scaleFactorW=1,e&&(this.scaleFactorW=i/e),this.scaleFactorH=1,t&&(this.scaleFactorH=n/t),this.maxScaleFactorW=this.scaleFactorW,this.maxScaleFactorW<.8?this.maxScaleFactorW=.8:this.maxScaleFactorW>1&&(this.maxScaleFactorW=1),this.maxScaleFactorH=this.scaleFactorH,this.maxScaleFactorH<.8?this.maxScaleFactorH=.8:this.maxScaleFactorH>1&&(this.maxScaleFactorH=1),r(this.tagId).closest(".main-fullscreen").length>0&&(this.maxScaleFactorH*=1.25,this.maxScaleFactorW*=1.25)},getItemSize:function(){var e=r(this.tagId),t={w:e.width(),h:e.height()};return e=null,t},checkSizeDic:function(){var e,t=this.getItemSize();for(var i in this.sizeDic){var n=this.sizeDic[i];if(t.w<n.w||t.h<n.h){e=i;break}}if(this.lastSizeKey&&this.lastSizeKey!=e){var a=this.lastSizeKey+"-"+e;this.lastSizeKey=e,this.sizeTransition[a]&&this.sizeTransition[a].reload?(r(this.tagId).trigger("evaluateNodeFromCurrentResult"),this.recreateItemDash()):this.sizeTransition.default&&this.sizeTransition.default.reload&&this.recreateItemDash()}this.lastSizeKey=e},viewInDiagram:function(){var e=this.currentNodeId;e&&Promise.all([i.e(12),i.e(17),i.e(21)]).then((function(){var t=[i(698)];(function(t){(new t).showInDiagram(e)}).apply(null,t)})).catch(i.oe)},getTimeFrame:function(){var e={};return this.currentResult&&this.currentResult.itemProperties&&(e.timeFormat=this.currentResult.itemProperties.timeFormat,e.timeFormatType=this.currentResult.itemProperties.timeFormatType,e.calendarType=this.currentResult.itemProperties.calendarType),e.timeFormat||(e.timeFormat="A"),e.timeFormatType||(e.timeFormatType="FLO"),e.calendarType||(e.calendarType="CAL"),e},synchronizeDrop:function(e,t,i,n,r,a){this.model&&this.model.synchronizeDrop(e,t,i,n,r,a,this.tagId)},onSynchronizeDrop:function(e,t,i,n,r,a){if(this.currentNodeId==e&&!((t||this.getRowIndexField())&&this.getRowIndexField()!=t||(i||this.getColumnIndexField())&&this.getColumnIndexField()!=i)){var l=n.slice(0),s=r.slice(0),o=a.slice(0);this.updateOriginalRowCol(s,o,!0),this._evaluateNode(e,l,s,o)}},onSynchronizeLevel:function(e,t){if(!this.isUnlinkedIndex(e)){var i=this.getIndexByField(e);i&&(i.currentLevel=t,i.values=[],this.refreshItemDash())}}})}.apply(t,s))||(e.exports=o)}).call(this,i(219),i(1),i(1),i(221))},767:function(e,t,i){"use strict";(function(n){var r,a=i(679);void 0===(r=function(){return n.Model.extend({url:"knowledgeBase",getPost:function(e,t){(0,a.send)("KnowledgeBase/getPost?nodeId="+e,null,{type:"GET"},t)},search:function(e,t){(0,a.send)("KnowledgeBase/search",e,{type:"POST"},t)},generatePost:function(e,t){(0,a.send)("KnowledgeBase/generatePost?nodeId="+e,null,{type:"POST"},t)},updatePost:function(e,t){(0,a.send)("KnowledgeBase/updatePost",e,{type:"PUT"},t)},deleteAttachedFile:function(e,t){(0,a.send)("KnowledgeBase/deleteDocument?url="+e,null,{type:"DELETE"},t)}})}.apply(t,[]))||(e.exports=r)}).call(this,i(219))}}]);