/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[207],{1826:function(e,n,t){var o=t(690);function a(e){return e&&(e.__esModule?e.default:e)}e.exports=(o.default||o).template({1:function(e,n,t,o,a){var r,s=e.lambda,i=e.escapeExpression;return'        <button class="btn btn-'+i(s(null!=n?n.css:n,n))+'" data-code="'+i(s(null!=n?n.code:n,n))+'" data-dismiss="modal"\n          aria-hidden="true">'+(null!=(r=t.if.call(null!=n?n:e.nullContext||{},null!=n?n.icon:n,{name:"if",hash:{},fn:e.program(2,a,0),inverse:e.noop,data:a}))?r:"")+" "+i(s(null!=n?n.title:n,n))+"</button>\n"},2:function(e,n,t,o,a){var r;return null!=(r=e.lambda(null!=n?n.icon:n,n))?r:""},compiler:[7,">= 4.0.0"],main:function(e,n,o,r,s){var i,l=e.lambda,c=e.escapeExpression,d=null!=n?n:e.nullContext||{};return'<div id="main-modal" class="modal fade publishToMyPyplanModal" tabindex="-1" role="dialog"\n  aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false" style="display: none;">\n  <div class="modal-dialog '+c(l(null!=n?n.modalClass:n,n))+'">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h4 class="modal-title" id="myModalLabel">'+c(l(null!=n?n.title:n,n))+'</h4>\n      </div>\n\n      <div class="modal-body" style="overflow-y:auto; overflow-x: hidden;">\n        <div class="container-fluid">\n\n          <div class="publishToMyPyplanModalContent">\n            <button class="btn btn-primary btnPublishToMyPyplan">'+c(a(t(688)).call(d,"publish",{name:"L",hash:{},data:s}))+'</button>\n            <div class="alert alert-warning alertModelWillBeSaved" role="alert">\n              '+c(a(t(688)).call(d,"model_will_be_saved",{name:"L",hash:{},data:s}))+'\n            </div>\n          </div>\n          <div class="progress progress-striped active nodisplay progressPublishToMyPyplan">\n            <div class="progress-bar" style="width: 100%;">\n            </div>\n          </div>\n          <input class="publishedItemLinkInput" disabled="true" />\n        </div>\n      </div>\n\n      <div class="modal-footer">\n'+(null!=(i=o.each.call(d,null!=n?n.buttons:n,{name:"each",hash:{},fn:e.program(1,s,0),inverse:e.noop,data:s}))?i:"")+"      </div>\n    </div>\n  </div>\n</div>"},useData:!0})},714:function(e,n,t){"use strict";(function(o){var a,r=t(693);void 0===(a=function(){return o.Model.extend({url:"myFileManager",getMainFolders:function(e){(0,r.send)("fileManager/getMainFolders/",null,{type:"GET"},e)},getFiles:function(e,n){(0,r.send)("fileManager/getFiles/?folder=".concat(encodeURIComponent(e)),null,{type:"GET"},n)},createFolder:function(e,n,t){(0,r.send)("fileManager/createFolder/",{folder_path:e,folder_name:n},{type:"POST"},t)},deleteFiles:function(e,n){(0,r.send)("fileManager/deleteFiles/",JSON.stringify({sources:e}),{type:"DELETE",contentType:"application/json",dataType:"text"},n)},renameFiles:function(e,n,t){(0,r.send)("fileManager/renameFile/?source=".concat(encodeURIComponent(e),"&newName=").concat(n),null,{type:"GET"},t)},unzipFile:function(e,n,t){(0,r.send)("fileManager/unzipFile/?source=".concat(e,"&targetFolder=").concat(encodeURIComponent(n)),null,{type:"GET",dataType:"text"},t)},moveFiles:function(e,n,t){var o=e.map(function(e){return"sources=".concat(e)}).join("&");(0,r.send)("fileManager/moveFiles/?".concat(o,"&target=").concat(encodeURIComponent(n)),null,{type:"GET",dataType:"text"},t)},copyToMyWorkspace:function(e,n){(0,r.send)("fileManager/copyToMyWorkspace/?source="+encodeURIComponent(e),null,{type:"GET",dataType:"text"},n)},copyFiles:function(e,n,t){var o=e.map(function(e){return"sources=".concat(e)}).join("&");(0,r.send)("fileManager/copyFiles/?".concat(o,"&target=").concat(encodeURIComponent(n)),null,{type:"GET",dataType:"text"},t)},duplicateFiles:function(e,n){var t=e.map(function(e){return"sources=".concat(e)}).join("&");(0,r.send)("fileManager/duplicateFiles/?".concat(t),null,{type:"GET"},n)},zipFiles:function(e,n){var t=e.map(function(e){return"sources=".concat(e)}).join("&");(0,r.send)("fileManager/zipFiles/?".concat(t),null,{type:"GET",dataType:"text"},n)},downloadFiles:function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){},i=e.map(function(e){return"sources=".concat(e)}).join("&"),l=new XMLHttpRequest;l.responseType="arraybuffer",l.open("GET","".concat(__apiURL,"/fileManager/download/?").concat(i),!0),l.setRequestHeader("Authorization","Token ".concat(__currentToken)),l.setRequestHeader("session-key",__currentSession?__currentSession.session_key:""),l.onloadstart=o,l.onreadystatechange=function(e){var o=e.currentTarget;o.onprogress=a,o.onerror=s,o.onloadend=r,o.readyState==o.DONE&&(200==o.status?n(o):t.e(17).then(function(){var e=[t(685)];(function(e){(new e).show({title:"ERROR!",text:o.response,notifyType:"error"})}).apply(null,e)}).catch(t.oe))},l.send()},getDepartments:function(e){(0,r.send)("departments/by_current_company/",null,{type:"GET"},e)},getDeniedDepartments:function(e,n){(0,r.send)("departments/denied/?folder=".concat(encodeURIComponent(e)),null,{type:"GET"},n)},setDeniedPath:function(e,n){(0,r.send)("departments/deny_items/",JSON.stringify(e),{type:"POST",contentType:"application/json;charset=utf-8"},n)},optimzeTemplates:function(e,n,t){var o=e.map(function(e){return"sources=".concat(e)}).join("&");(0,r.send)("fileManager/optimizeTemplates/?".concat(o),null,{type:"GET",dataType:"text"},n,t)}})}.apply(n,[]))||(e.exports=a)}).call(this,t(218))},855:function(e,n,t){"use strict";(function(o){var a,r=t(693);void 0===(a=function(){return o.Model.extend({url:"inputModule",defaults:{formsViewList:[]},search:function(e,n){(0,r.send)("reportManager/search/?text=".concat(e),null,{type:"GET"},n)},getMyReports:function(e,n){(0,r.send)("reportManager/myReports/?parent=".concat(e),null,{type:"GET"},n)},getFavsReports:function(e,n){(0,r.send)("reportManager/myReports/?parent=".concat(e,"&favs=true"),null,{type:"GET"},n)},getReportsSharedWithMe:function(e,n){(0,r.send)("reportManager/sharedWithMe/?parent=".concat(e),null,{type:"GET"},n)},getMySharedReports:function(e,n){(0,r.send)("reportManager/mySharedReports/?parent=".concat(e),null,{type:"GET"},n)},getRecentsReports:function(e,n){(0,r.send)("reportManager/recents/?parent=".concat(e),null,{type:"GET"},n)},exportDashboards:function(e,n){var o=new XMLHttpRequest;o.responseType="arraybuffer",o.open("PUT","".concat(__apiURL,"/reportManager/exportItems/"),!0),o.setRequestHeader("Authorization","Token ".concat(__currentToken)),o.setRequestHeader("session-key",__currentSession?__currentSession.session_key:""),o.setRequestHeader("Content-type","application/json"),o.onreadystatechange=function(e){var o=e.currentTarget;o.readyState==o.DONE&&(200==o.status?n(o):t.e(17).then(function(){var e=[t(685)];(function(e){(new e).show({title:"ERROR!",text:o.response,notifyType:"error"})}).apply(null,e)}).catch(t.oe))},o.send(JSON.stringify(e))},exportItemsAndPublish:function(e,n,t,o,a,s,i){(0,r.send)("reportManager/exportItemsAndPublish/",JSON.stringify({username:e,uuid:n,model_folder:t,model_id:o,dashboard_ids:a,report_ids:s}),{type:"PUT",contentType:"application/json;charset=utf-8"},i)},importDashboards:function(e,n){(0,r.send)("reportManager/importItems/",JSON.stringify(e),{type:"PUT",contentType:"application/json;charset=utf-8"},n)},create:function(e,n){(0,r.send)("reportManager/",e,{type:"POST"},function(e){void 0!=n&&n(e)})},createReport:function(e,n){(0,r.send)("reportManager/",e,{type:"POST"},function(e){void 0!=n&&n(e)})},dropOnReport:function(e,n){(0,r.send)("reportManager/dropOnReport/",JSON.stringify(e),{type:"PUT",contentType:"application/json;charset=utf-8"},n)},updateOrder:function(e){(0,r.send)("reportManager/changeOrder/",JSON.stringify({values:e}),{type:"PUT",contentType:"application/json;charset=utf-8"},function(e){})},setAsFav:function(e,n,t){(0,r.send)("reportManager/setAsFav/",JSON.stringify({report_ids:e.report_ids,dashboard_ids:e.dashboard_ids,is_fav:n}),{type:"PUT",contentType:"application/json;charset=utf-8",dataType:"text"},t)},updateName:function(e,n,t){(0,r.send)("reportManager/".concat(e,"/"),{name:n},{type:"PUT",dataType:"text"},function(e){void 0!=t&&t(e)})},deleteItems:function(e,n){(0,r.send)("reportManager/bulkDelete/",JSON.stringify({values:e}),{type:"DELETE",contentType:"application/json;charset=utf-8"},function(e){void 0!=n&&n(e)})},createTempId:function(){return"tmp-"+parseInt(5e5*Math.random())},copyToMyReports:function(e,n){(0,r.send)("reportManager/copyToMyReports/",JSON.stringify(e),{type:"PUT",contentType:"application/json;charset=utf-8",dataType:"text"},function(e){void 0!=n&&n(e)})},duplicateItems:function(e,n){(0,r.send)("reportManager/duplicateItems/",JSON.stringify(e),{type:"PUT",contentType:"application/json;charset=utf-8",dataType:"text"},function(e){n&&n(e)})}})}.apply(n,[]))||(e.exports=a)}).call(this,t(218))},948:function(e,n,t){"use strict";(function(o,a){var r,s,i=t(18);r=[t(747),t(855),t(219),t(714),t(1826)],void 0===(s=function(e,n,t,r,s){return o.View.extend({el:a("#main"),render:function(e){if(!(this.$el.find(".publishToMyPyplanModal").length>0)){this.itemId=e.itemId,this.itemType=e.itemType,e.buttons=[{title:(0,i.translate)("close"),code:"cancel"}];var n=s(e);this.$el.append(n);var t=a(".publishToMyPyplanModal");t.find(".modal-footer button").click(function(n){n.preventDefault();var o=!0,r=a(this).attr("data-code");return e.callback&&!1===e.callback.call(this,r,t)&&(o=!1),o&&(t.off("shown"),t.modal("hide")),!1}),t.on("show.bs.modal",function(){if(0===a(".publishToMyPyplanModal:visible").length){var n=100014+10*a(".modal:visible").length;a(this).css("z-index",n),setTimeout(function(){a(".modal-backdrop").not(".modal-stack").css("z-index",n-10).addClass("modal-stack")},0),e.hasOwnProperty("onLoad")&&e.onLoad(t),!0!==e.okOnEnter&&void 0!==e.okOnEnter||t.keyup(function(e){13==e.keyCode&&t.find("button.btn-primary").click()})}}),t.on("hidden.bs.modal",function(){t.off("hidden"),e.hasOwnProperty("onClose")&&e.onClose(t),t.remove()}),t.modal(e.backdrop?{backdrop:"static",keyboard:!1}:null),this.addHandlers(t)}},addHandlers:function(e){var o=this,s=e.find(".btnPublishToMyPyplan"),l=e.find(".progressPublishToMyPyplan");s.on("click",function(e){e.preventDefault(),l.show();new r;var s=new n,c=__currentSession.modelInfo.uri.substring(0,__currentSession.modelInfo.uri.lastIndexOf("/"));a("body").find(".mainTask.influence-diagram").length>0?a(".dockInfluenceDiagramProperty").trigger("saveModelChanges",[!1,function(e){e&&s.exportItemsAndPublish(__currentSession.my_username,__currentSession.my_uuid,c,__currentSession.modelInfo.modelId,"dashboard"==o.itemType?[o.itemId]:[],"report"==o.itemType?[o.itemId]:[],function(e){})}]):(new t).saveModel(function(){a("body").trigger("pendingChanges",[!1]),(0,i.showMessage)((0,i.translate)("model_successfully_saved")," ","success",!0),s.exportItemsAndPublish(__currentSession.my_username,__currentSession.my_uuid,c,"dashboard"==o.itemType?[o.itemId]:[],"report"==o.itemType?[o.itemId]:[],function(e){})})})}})}.apply(n,r))||(e.exports=s)}).call(this,t(218),t(1))}}]);