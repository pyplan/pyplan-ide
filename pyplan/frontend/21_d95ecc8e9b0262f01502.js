/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{1742:function(e,a,n){"use strict";(function(t,i){var o,r,c=n(18);o=[n(969),n(220),n(1767)],void 0===(r=function(e,a,o){return t.View.extend({el:i("#main"),diagram:void 0,nodeFinder:void 0,diagramClipboard:void 0,render:function(){var a=this,t=o();this.$el.append(t),(0,c.registerResizeEvents)("influcenDiagramResize",(function(){a.updateSizes(),i(".dockInfluenceDiagramProperty").trigger("updateSizesOnDock")})),this.updateSizes(),this.$el.find(".mainTask.influence-diagram").on("removeView",(function(){a.onRemoveView()})).on("refreshView",(function(){a.refreshDiagram()})).on("modelIdChanged",(function(e,n){a.diagram&&a.diagram.navigateToNode(n)})).on("evaluateNode",(function(e,n){a.evaluateNode(n)})).on("onKeyDown",(function(e,n,t){a.processKeyUp(n,t)})).keyup((function(e,n,t){8===e.keyCode&&a.processKeyUp(e,e.keyCode)})).on("changeEditMode",(function(e,n){if(a.diagram){if(a.diagram.setEditMode(n),a.diagram.currentHighlightNode&&a.diagram.getNodeFromDic(a.diagram.currentHighlightNode)){var t=a.diagram.getNodeFromDic(a.diagram.currentHighlightNode),o=a.diagram.currentHighlightNode;setTimeout((function(){a.diagram.$el.trigger("selectNodeById",[o])}),200),a.showNodeDefinition(null,t)}n||a.$el.find(".mainTask.influence-diagram").trigger("clearSelect"),i.cookie("cubeplan_edit_mode",n.toString(),{expires:1e3})}})),this.$el.on("click",".resetPosDiagram",(function(e){i("#main .diagram-area").trigger("resetPosAndZoom")})),this.addSliders((function(){i(".dockInfluenceDiagramProperty").hide(),n.e(22).then((function(){var e=[n(738)];(function(e){(new e).render()}).apply(null,e)})).catch(n.oe),n.e(70).then((function(){var e=[n(1592)];(function(e){a.nodeFinder=(new e).create({el:a.$el.find(".mainTask.influence-diagram .searchNode"),callback:function(e,n){a.diagram.navigateToNode(e.id),setTimeout((function(){n.select2("val","")}),100)}})}).apply(null,e)})).catch(n.oe)}));var r={contextMenu:!1,autoCenter:!1,breadCrumb:!0,nodeClick:function(e,n){a.showNodeDefinition(e,n)},nodeDoubleclick:function(e,n){i(".dockInfluenceDiagramProperty").trigger("saveCurrentNode"),setTimeout((function(){a.evaluateNode(n)}),100)},diagramClick:function(){a.$el.find(".mainTask.influence-diagram").trigger("diagramClick"),a.diagram&&a.diagram.clearHighlightNode()},nodeSelect:function(e,t){n.e(22).then((function(){var e=[n(738)];(function(e){(new e).loadDefinitionTab(t)}).apply(null,e)})).catch(n.oe),a.$el.find(".mainTask.influence-diagram").trigger("nodeSelect",[t,a.diagram.editMode])},nodesSelect:function(e,n){n&&n.length>1&&a.$el.find(".mainTask.influence-diagram").trigger("nodesSelect",[n,a.diagram.editMode])},clearSelect:function(e){a.$el.find(".mainTask.influence-diagram").trigger("clearSelect")},addNodeToDefinition:function(e,n){a.$el.find(".mainTask.influence-diagram").trigger("addNodeToWizardDefinition",[n])},updateProperties:function(e){},executeButton:function(e){a.executeButton(e)},nodeRightClick:function(e,n){a.nodeRightClick(e,n)}};if(this.diagram=new e(r),this.diagram.setElement(this.$el.find(".diagram-area")),this.diagram.render(),(0,c.haveAccess)("change_influence_diagram")){var l=!0;"false"===i.cookie("cubeplan_edit_mode")&&(l=!1),this.diagram.setEditMode(l)}this.options&&this.options.navigateToNode?this.diagram.navigateToNode(this.options.navigateToNode):this.drawDiagram()},onRemoveView:function(){(0,c.removeResizeEvent)("influcenDiagramResize"),this.diagram&&(this.diagram.destroy(),this.diagram=null),this.nodeFinder&&this.nodeFinder.destroy()},updateSizes:function(){if(this.$el.find(".diagram-area").is(":visible")){this.$el.find(".diagram-area").height(i(window).height()-50),this.$el.find(".diagram-area").width(i(window).width()-50),this.diagram&&this.diagram.onResize()}},addSliders:function(e){var a=i(".diagram-area"),t=this;Promise.resolve().then((function(){var i=[n(698)];(function(n){var i=new n;i.drawDashboardBars(a,e),(0,c.haveAccess)("change_influence_diagram")&&i.drawToolbarDiagram(a,{diagram:t.diagram})}).apply(null,i)})).catch(n.oe)},refreshDiagram:function(){this.diagram&&this.diagram.navigateCurrentModule()},drawDiagram:function(){this.diagram&&this.diagram.navigateDiagram()},evaluateNode:function(e){if("text"!=e.nodeClass&&"button"!=e.nodeClass){var t=new a,o=null;"formnode"!=e.nodeClass||"formnode_edit_table"!=e.formNodeLabel&&"formnode_subtable"!=e.formNodeLabel||(o={isInputNode:!0});var r=e.originalId?e.originalId:e.id;t.evaluateNode(r,(function(e){e&&0==e.dashVersion?n.e(7).then((function(){var a=[n(690)];(function(a){var n=new a;o&&o.isInputNode&&n.removeDashboardTaskFromHome(e.dashboardId);var t=i(".dockInfluenceDiagramProperty #nodePropertiesDock").attr("node-id");e.nodes===t&&i('.btn[data-action="run"]').click(),n.showDashboard(e.dashboardId,-1,e.name,!0,!1,o)}).apply(null,a)})).catch(n.oe):n.e(32).then((function(){var a=[n(687)];(function(a){var n=new a;o&&o.isInputNode&&n.removeDashboardTaskFromHome(e.id);var t=i(".dockInfluenceDiagramProperty #nodePropertiesDock").attr("node-id");e.node===t&&i('.btn[data-action="run"]').click(),n.showDashboard(e.id,-1,e.name,!0,!1,o,!0)}).apply(null,a)})).catch(n.oe)}))}},executeButton:function(e){var n=this,t=new a;i("#genericLoading").text((0,c.translate)("processing_please_wait")).show(),t.executeButton(e.id,(function(){n.queryForFinishCalc(e.id),i("#genericLoading").hide()}))},queryForFinishCalc:function(e){var n=this,t=new a,o=0;setTimeout((function(){!function a(){o++,t.isInBackground(e,(function(e){e?o<4?setTimeout((function(){a()}),300):setTimeout((function(){a()}),1e3):(i(".influence-diagram").length>0&&n&&n.diagram&&n.refreshDiagram(),n=null)}))}()}),200)},showNodeDefinition:function(e,a){this.diagram&&(a&&"module"!=a.nodeClass&&"module"!=a.originalClass&&"library"!=a.nodeClass&&"library"!=a.originalClass?(this.diagram.highlightNode(a.id),n.e(22).then((function(){var e=[n(738)];(function(e){(new e).loadDefinitionTab(a)}).apply(null,e)})).catch(n.oe)):(this.diagram.highlightNode(null),this.$el.find(".mainTask.influence-diagram").trigger("clearSelect")))},nodeRightClick:function(e,a){var n=this,t=(a=a).nodeClass;if("alias"==t.toLowerCase()&&(t=a.originalClass),"module"==t||"library"==t||"variable"==t||"index"==t||"function"==t){i.contextMenu.types.diagram_icon_text=function(e,a,n){i('<i class="'+e.iconClass+'"></i><span>'+e.name+"</span>").appendTo(this)};var o={_navigate:{type:"diagram_icon_text",name:(0,c.translate)("navigate_module"),iconClass:"fa fa-sign-in"}};(0,c.haveAccess)("change_group_permissions")&&(o=i.extend(o,{_setPermisions:{type:"diagram_icon_text",name:(0,c.translate)("set_restrictions"),iconClass:"fa fa-lock"}})),this.diagram.editMode&&(o=i.extend(o,{_exportModule:{type:"diagram_icon_text",name:(0,c.translate)("_export_module"),iconClass:"fa fa-download"}})),"variable"==t&&(o={_evaluate:{type:"diagram_icon_text",name:(0,c.translate)("evaluate_node"),iconClass:"fa fa-bolt"},_quickevaluate:{type:"diagram_icon_text",name:(0,c.translate)("quick_evaluate"),iconClass:"fa fa-play"},_copyToPyplanExcelAddIn:{type:"diagram_icon_text",name:(0,c.translate)("copy_to_pyplan_excel_addin"),iconClass:"fa fa-file-excel-o"}}),"function"!=t&&"index"!=t||(o={_quickevaluate:{type:"diagram_icon_text",name:(0,c.translate)("quick_evaluate"),iconClass:"fa fa-play"},_generate_api_endpoint:{type:"diagram_icon_text",name:(0,c.translate)("api_endpoint"),iconClass:"fa fa-link"}}),o&&(i.contextMenu({selector:".diagramContextMenu",trigger:"none",callback:function(e,t){switch(e){case"_setPermisions":n.setPermissions(a);break;case"_exportModule":n.exportModule(a);break;case"_copyToPyplanExcelAddIn":(0,c.copyTextToClipboard)("pyplan.getnodedata:"+(a.originalId?a.originalId:a.id));break;case"_evaluate":n.evaluateNode(a);break;case"_quickevaluate":n.quickEvaluateNode(a);break;case"_navigate":n.diagram.navigateThisModule(a.id);break;case"_generate_api_endpoint":n.generateAPIEndpoint(a)}},events:{hide:function(){i.contextMenu("destroy",".diagramContextMenu")}},items:o}),e&&e.clientX?i(".diagramContextMenu").contextMenu({x:e.clientX,y:e.clientY}):e&&e.touches&&e.touches.length>0?i(".diagramContextMenu").contextMenu({x:e.touches[0].clientX,y:e.touches[0].clientY}):i(".diagramContextMenu").contextMenu())}},generateAPIEndpoint:function(e){n.e(10).then((function(){var a=[n(681)];(function(a){(new a).showNodeSharer(e.id)}).apply(null,a)})).catch(n.oe)},setPermissions:function(e){e=e;Promise.resolve().then((function(){var a=[n(698)];(function(a){(new a).showPermissionsModal(e.id,(function(e,a){}))}).apply(null,a)})).catch(n.oe)},exportModule:function(e){e=e;Promise.resolve().then((function(){var a=[n(698)];(function(a){(new a).exportModuleModal(e.id,(function(e,a){}))}).apply(null,a)})).catch(n.oe)},processKeyUp:function(e,a){if(this.diagram){var t=!1,o=this.diagram.getSelectedNodes(),r=this.diagram.editMode,l=this;switch(a){case"alt+d":o&&o.length>0&&(o.length>1?(0,c.showMessage)((0,c.translate)("many_nodes_selected"),void 0,"error"):(i(".dockInfluenceDiagramProperty").trigger("saveCurrentNode"),i(".dashboard-tabs").trigger("refreshNodeChanges",[{nodeId:o[0].id}]),i(".tabs-area .toolbar").trigger("pendingRefresh",[{nodeId:o[0].id}]),i(".dashboard-tabs").trigger("refreshNodeChanges",[{nodeId:o[0].id}]),setTimeout((function(){l.openDocumentationModal(o[0])}),100))),t=!0;break;case"ctrl+r":o&&o.length>0&&(o.length>1?(0,c.showMessage)((0,c.translate)("many_nodes_selected"),void 0,"error"):(i(".dockInfluenceDiagramProperty").trigger("saveCurrentNode"),setTimeout((function(){"module"==o[0].nodeClass||"module"==o[0].originalClass||"library"==o[0].nodeClass||"library"==o[0].originalClass?l.diagram.navigateThisModule(o[0].id):l.evaluateNode(o[0])}),100))),t=!0;break;case"ctrl+e":o&&o.length>0&&(o.length>1?(0,c.showMessage)((0,c.translate)("many_nodes_selected"),void 0,"error"):(i(".dockInfluenceDiagramProperty").trigger("saveCurrentNode"),i(".dashboard-tabs").trigger("refreshNodeChanges",[{nodeId:o[0].id}]),i(".tabs-area .toolbar").trigger("pendingRefresh",[{nodeId:o[0].id}]),i(".dashboard-tabs").trigger("refreshNodeChanges",[{nodeId:o[0].id}]),setTimeout((function(){"module"==o[0].nodeClass||"module"==o[0].originalClass||"library"==o[0].nodeClass||"library"==o[0].originalClass?l.diagram.navigateThisModule(o[0].id):l.quickEvaluateNode(o[0])}),100))),t=!0;break;case"ctrl+y":this.diagram.toggleShowId(),t=!0;break;case"ctrl+h":r&&this.diagram.hasFocus()&&o&&1==o.length&&(this.diagram.navigateToOriginal(o[0].id),t=!0);break;case"ctrl+q":case"ctrl+shift+h":this.diagram.navigatePriorDiagam();break;case"ctrl+f":i(".influence-diagram").is(":visible")&&(this.$el.find(".node-finder input.searchNode").select2("open"),t=!0);break;case"ctrl+x":case"ctrl+c":if(r&&this.diagram.hasFocus()&&o&&o.length>0){var d=this.diagram.nodeSelector.currentSelection.slice(0),s={action:"copy",nodeList:[]};"ctrl+x"==a&&(s.action="move");for(var u=0;u<d.length;u++)s.nodeList.push({id:d[u].nodeData.id});this.diagram.jiggle(d,"move"==s.action),setTimeout((function(){l.diagram.stopJiggle(d)}),500),this.diagramClipboard=s,t=!0}break;case"ctrl+v":r&&this.diagram.hasFocus()&&this.diagramClipboard&&(this.diagramClipboard.nodeList.map((function(e){e.moduleId=l.diagram.currentModule})),"copy"==this.diagramClipboard.action?this.diagram.copyNodes(this.diagramClipboard.nodeList):"move"==this.diagramClipboard.action&&this.diagram.moveNodesToModule(this.diagramClipboard.nodeList));break;case"ctrl+d":r&&this.diagram.duplicateNodes(o),t=!0;break;case"ctrl+right":r&&this.diagram.hasFocus()&&o&&o.length>0&&(this.diagram.alignNodes(o,2),t=!0);break;case"ctrl+left":r&&this.diagram.hasFocus()&&o&&o.length>0&&(this.diagram.alignNodes(o,0),t=!0);break;case"ctrl+up":r&&this.diagram.hasFocus()&&o&&o.length>0&&(this.diagram.alignNodes(o,4),t=!0);break;case"ctrl+down":r&&this.diagram.hasFocus()&&o&&o.length>0&&(this.diagram.alignNodes(o,6),t=!0);break;case"right":case"left":case"up":case"down":r&&this.diagram.hasFocus()&&o&&o.length>0&&(this.diagram.moveNodes(a),t=!0);break;case"ctrl+s":i(".btnSaveModel").is(":visible")&&i(".btnSaveModel").trigger("click"),t=!0;break;case"ctrl+a":r&&this.diagram.$el.trigger("selectAll"),t=!0;break;case"ctrl+b":r&&1===o.length&&this.diagram.showNumberFormatPopup(o),t=!0;break;case"ctrl+i":r&&this.diagram.makeSameSize(o,1),t=!0;break;case"ctrl+g":r&&this.diagram.makeSameSize(o,2),t=!0;break;case"ctrl+m":r&&this.diagram.createAlias(o),t=!0;break;case"ctrl+alt+i":r&&this.diagram.createInputNode(o),t=!0;break;case"ctrl+alt+o":r&&this.diagram.createOutputNode(o),t=!0;break;case"ctrl+0":case"ctrl+1":case"ctrl+2":case"ctrl+3":case"ctrl+4":case"ctrl+5":case"ctrl+6":case"ctrl+7":case"ctrl+8":case"ctrl+9":if(r){var g=a.substring(a.length-1);if(1===o.length){var h=["MODULE","LIBRARY","LINKMODULE","MODEL","TEXT","PICTURE"].includes(o[0].nodeClass.toUpperCase());if("TEXT"===o[0].nodeClass.toUpperCase())return e.preventDefault(),!1;if(h&&"2"===g)return i("#nodePropertiesDock").trigger("shortcutTabProps","3"),e.preventDefault(),!1}i("#nodePropertiesDock").trigger("shortcutTabProps",g)}t=!0;break;case"del":case 8:if(r&&this.diagram.hasFocus())if((o=this.diagram.getSelectedNodes())&&o.length>0){t=!0;l=this;n.e(6).then((function(){var e=[n(662)];(function(e){var a=(0,c.translate)("sure_delete_selected_nodes").replace("##count##",o.length);(new e).show({title:(0,c.translate)("delete_nodes"),text:a,buttons:[,{title:(0,c.translate)("cancel"),code:"cancel"},{title:(0,c.translate)("delete"),css:"red",code:"yes"}],callback:function(e){"yes"==e&&l.diagram.deleteSelectedNodes()},onClose:function(){l.diagram.setFocus(),l=null}})}).apply(null,e)})).catch(n.oe)}break;case"ctrl+alt+0":r&&o.length>1&&this.diagram.makeSameSize(o),t=!0}t&&e.preventDefault()}},quickEvaluateNode:function(e){"text"!=e.nodeClass&&"button"!=e.nodeClass&&n.e(10).then((function(){var a=[n(681)];(function(a){(new a).quickEvaluate({nodeData:e})}).apply(null,a)})).catch(n.oe)},openDocumentationModal:function(e){n.e(10).then((function(){var a=[n(681)];(function(a){(new a).openDocumentationModal({nodeData:e})}).apply(null,a)})).catch(n.oe)}})}.apply(a,o))||(e.exports=r)}).call(this,n(219),n(1))},1767:function(e,a,n){var t=n(669);function i(e){return e&&(e.__esModule?e.default:e)}e.exports=(t.default||t).template({compiler:[8,">= 4.3.0"],main:function(e,a,t,o,r){var c=null!=a?a:e.nullContext||{},l=e.escapeExpression;return'<div class="container-fluid mainTask full-horizontal influence-diagram" style="position: relative;"\n    data-rel="influence_diagram" data-type="tab-content">\n\n    <div class="breadcrumbs nodisplay">\n\n        <div class="toolbar">\n\n        </div>\n\n        <div class="toolbar right">\n\n        </div>\n\n    </div>\n\n    <div class="row-fluid diagram-area">\n\n    </div>\n\n    <div class="node-finder">\n        <a class="btn resetPosDiagram" rel="tooltip" data-placement="bottom" data-title=\''+l(i(n(667)).call(c,"reset_zoom_position",{name:"L",hash:{},data:r,loc:{start:{line:21,column:89},end:{line:21,column:116}}}))+'\'><i\n                class="far fa-expand"></i></a>\n        <input type="text" class="searchNode nomargin" placeholder=\''+l(i(n(667)).call(c,"search_node",{name:"L",hash:{},data:r,loc:{start:{line:23,column:68},end:{line:23,column:87}}}))+'\' />\n    </div>\n\n    <span class="diagramContextMenu"> </span>\n</div>'},useData:!0})},698:function(e,a,n){"use strict";(function(t){var i,o,r=n(18);function c(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{},t=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(a){l(e,a,n[a])}))}return e}function l(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}i=[n(1742)],void 0===(o=function(e){return t.Controller.extend({name:"influenceDiagram",showDiagram:function(a){new e(a).render()},showPermissionsModal:function(e,a){n.e(164).then((function(){var t=[n(2327)];(function(n){(new n).render(e,a)}).apply(null,t)})).catch(n.oe)},exportModuleModal:function(e){n.e(213).then((function(){var a=[n(2330)];(function(a){(new a).render(e)}).apply(null,a)})).catch(n.oe)},importModuleModal:function(){n.e(147).then((function(){var e=[n(2332)];(function(e){(new e).render()}).apply(null,e)})).catch(n.oe)},showModelPreferencesModal:function(e){n.e(258).then((function(){var a=[n(2335)];(function(a){new a(e).render()}).apply(null,a)})).catch(n.oe)},drawDashboardBars:function(e,a){this.drawToolbar(e,(function(){a()}))},drawToolbar:function(e,a){n.e(50).then((function(){var t=[n(869)];(function(n){(new n).show({el:e,positions:["top","bottom"],onLoad:a,className:"dockInfluenceDiagramProperty bottom"})}).apply(null,t)})).catch(n.oe)},drawToolbarDiagram:function(e,a){n.e(216).then((function(){var t=[n(2337)];(function(n){var t=new n(a);t.setElement(e),t.render()}).apply(null,t)})).catch(n.oe)},showWizard:function(e,a,t){var i={nodeData:a,callback:t,modalClass:"smallModal"};Promise.all([n.e(15),n.e(97)]).then((function(){var a=[n(2340)("./".concat(e))];(function(e){new e(i).render(i)}).apply(null,a)})).catch(n.oe)},showInDiagram:function(e){Promise.resolve().then((function(){(function(a){var t=[n(663)];(function(n){var t=new n;t.existsTask("influence_diagram")?(t.selectTask("influence_diagram"),a(".mainTask.influence-diagram .diagram-area").trigger("navigateToNode",[e])):t.addTask("influence_diagram",(0,r.translate)("model"),{navigateToNode:e})}).apply(null,t)}).call(this,n(1))})).catch(n.oe)},selectColumsWizard:function(e,a){n.e(178).then((function(){var t=[n(1056)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,t)})).catch(n.oe)},selectRowsWizard:function(e,a){n.e(109).then((function(){var t=[n(1063)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,t)})).catch(n.oe)},calculatedFieldWizard:function(e,a){n.e(259).then((function(){var t=[n(1055)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,t)})).catch(n.oe)},pandasIndexWizard:function(e,a){Promise.all([n.e(15),n.e(261)]).then((function(){var t=[n(1062)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,t)})).catch(n.oe)},installLibsModal:function(e){n.e(257).then((function(){var a=[n(2343)];(function(a){(new a).render(e)}).apply(null,a)})).catch(n.oe)},manageLibsModal:function(e){n.e(177).then((function(){var a=[n(2345)];(function(a){(new a).render(e)}).apply(null,a)})).catch(n.oe)},setDataframeIndex:function(e,a){n.e(181).then((function(){var t=[n(1064)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,t)})).catch(n.oe)},indexFromPandas:function(e,a){n.e(217).then((function(){var t=[n(1061)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,t)})).catch(n.oe)},dataframeGroupby:function(e,a){n.e(180).then((function(){var t=[n(1060)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,t)})).catch(n.oe)},dataarrayFromPandas:function(e,a){n.e(179).then((function(){var t=[n(1059)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,t)})).catch(n.oe)},inputTable:function(e){n.e(260).then((function(){var a=[n(1057)];(function(a){new a(c({},e)).render()}).apply(null,a)})).catch(n.oe)},dataArrayFilter:function(e,a){n.e(134).then((function(){var t=[n(1058)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,t)})).catch(n.oe)}})}.apply(a,i))||(e.exports=o)}).call(this,n(676))}}]);