/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[220],{1859:function(n,e,t){"use strict";(function(a,s){var l,i,o=t(18);l=[t(722),t(1860),t(1865),t(1866)],void 0===(i=function(n,e,l,i){return a.View.extend({el:s("#main"),sessionsTimeout:void 0,mainMonitor:void 0,render:function(){var n=l();this.$el.append(n),this.getData(),this.drawPerformanceMonitor(),this.addHandlers()},getData:function(){var e=this;clearTimeout(e.sessionsTimeout),(new n).getAllSessions(function(n){0!=s("#session_list").length&&(e.drawTable(n),e.sessionsTimeout=setTimeout(function(){e.getData()},1e4))})},addHandlers:function(){var e=this,a=s("#session_list tbody");a.on("click","tr",function(){s("#session_list tbody tr").removeClass("selected"),s(this).addClass("selected");var n=s(this).attr("data-session-key");n&&e.drawSessionMonitor(n)}),a.on("click","tr button.btnKill",function(){var a=s(this).closest("tr").attr("data-session-key");return t.e(5).then(function(){var s=[t(683)];(function(t){(new t).show({title:(0,o.translate)("kill_session"),text:(0,o.translate)("sure_kill_session"),buttons:[{title:(0,o.translate)("yes"),css:"primary",code:"yes"},{title:(0,o.translate)("no"),code:"no"}],callback:function(t){"yes"==t&&(new n).killSessionByKey(a,function(){e.getData()})}})}).apply(null,s)}).catch(t.oe),!1}),a.on("click","tr button.btnRequestLogout",function(){var e=s(this).closest("tr").attr("data-session-key");t.e(5).then(function(){var a=[t(683)];(function(t){(new t).show({title:(0,o.translate)("request_kill_session"),text:(0,o.translate)("sure_request_kill_session"),buttons:[{title:(0,o.translate)("yes"),css:"primary",code:"yes"},{title:(0,o.translate)("no"),code:"no"}],callback:function(t){"yes"==t&&(new n).requireLogoutSessionByToken(e)}})}).apply(null,a)}).catch(t.oe)})},drawTable:function(n){var e=i({sessions:n}),t=s("#session_list tbody tr.selected").attr("data-token");s("#session_list tbody").html(e),t&&(s("#session_list tbody tr[data-token='"+t+"']").length>0?s("#session_list tbody tr[data-token='"+t+"']").addClass("selected"):this.mainMonitor&&this.mainMonitor.clearByToken())},drawPerformanceMonitor:function(){var n=new e;this.mainMonitor=n.show(s(".mainTask[data-rel='session-manager']"))},drawSessionMonitor:function(n){this.mainMonitor.setElement(s(".mainTask[data-rel='session-manager']")),this.mainMonitor.render(n)}})}.apply(e,l))||(n.exports=i)}).call(this,t(218),t(1))},1860:function(n,e,t){"use strict";(function(a){var s,l;s=[t(1861)],void 0===(l=function(n){return a.Controller.extend({name:"performanceMonitor",show:function(e){var t=new n;return t.setElement(e),t.render(),t}})}.apply(e,s))||(n.exports=l)}).call(this,t(694))},1861:function(n,e,t){"use strict";(function(a,s){var l,i;l=[t(1862),t(1863),t(1864)],void 0===(i=function(n,e,t){return a.View.extend({el:s("#main"),systemTimeOut:-1,byTokenInitialized:!1,current_session_key:"",render:function(n){if(n){if(clearTimeout(this.systemTimeOut),this.current_session_key=n,this.$el.find(".session_monitor").hide(),this.byTokenInitialized){var a=this.$el.find(".main_monitor").find(".sessionchart").highcharts();a.series[1].setData(Array(50).fill(0),!0,!0),a.series[0].setData(Array(50).fill(0),!0,!0)}else{this.byTokenInitialized=!0;var s=t();this.$el.find(".session_monitor").html(s),this.createSessionCharts()}this.getSystemResources()}else{s=e();this.$el.append(s),this.createMainCharts(),this.getSystemResources()}},clearByToken:function(){this.current_session_key="",this.byTokenInitialized=!1,this.$el.find(".session_monitor").empty()},removeView:function(){clearTimeout(this.systemTimeOut)},createMainCharts:function(){var n=this.$el;n.find(".cpuchart").length>0&&n.find(".cpuchart").highcharts({chart:{zoomType:"xy",height:220,marginTop:60},title:!1,xAxis:{type:"datetime",tickPixelInterval:100,labels:{enabled:!1}},yAxis:[{min:0,max:64,title:{text:"Memory (gb)"}},{min:0,max:100,title:{text:"% CPU"},opposite:!0}],tooltip:!1,legend:{align:"center",verticalAlign:"top",x:0,y:10},exporting:{enabled:!1},credits:!1,plotOptions:{series:{marker:{enabled:!1}}},series:[{name:"Memory (gb)",type:"area",yAxis:0,data:Array(50).fill(0),tooltip:{valueDecimals:2,valueSuffix:" gb"}},{name:"% CPU",type:"spline",yAxis:1,data:Array(50).fill(0),tooltip:{valueDecimals:0,valueSuffix:" %"}}]})},createSessionCharts:function(){var n=this.$el;n.find(".sessionchart").length>0&&n.find(".sessionchart").highcharts({chart:{zoomType:"xy",height:220,marginTop:60},title:!1,xAxis:{type:"datetime",tickPixelInterval:100,labels:{enabled:!1}},yAxis:[{min:0,max:64,title:{text:"Memory (gb)"}},{min:0,max:100,title:{text:"% CPU"},opposite:!0}],tooltip:{shared:!0},legend:{align:"center",verticalAlign:"top",x:0,y:10},exporting:{enabled:!1},credits:!1,plotOptions:{series:{marker:{enabled:!1}}},series:[{name:"Memory (gb)",type:"area",yAxis:0,data:Array(50).fill(0),tooltip:{valueDecimals:2,valueSuffix:" gb"}},{name:"% CPU",type:"spline",yAxis:1,data:Array(50).fill(0),tooltip:{valueDecimals:0,valueSuffix:" %"}}]})},getSystemResources:function(){clearTimeout(this.systemTimeOut);var e=new n,t=this.$el.find(".main_monitor"),a=this.$el.find(".session_monitor"),s=this;t.length>0&&e.getSystemResources(this.current_session_key,function(n){t.find("span[data-key='total_memory'] b").html(n.totalMemory.toFixed(2)+"G"),t.find("span[data-key='used_memory'] b").html(n.usedMemory.toFixed(2)+"G"),t.find("span[data-key='free_memory'] b").html((n.totalMemory-n.usedMemory).toFixed(2)+"G"),t.find("span[data-key='cpu_usage'] b").html(n.usedCPU.toFixed(2)+" %"),t.find("span[data-key='disk_size'] b").html(n.disk.size),t.find("span[data-key='disk_usage'] b").html("".concat(n.disk.used," (").concat(n.disk.percent,")"));var e=100*n.usedMemory/n.totalMemory;t.find("div.chart[data-key='memory']").find("span.v").html(e.toFixed(0)+" %");var l=t.find(".cpuchart").highcharts();if(l.series[1].addPoint(n.usedCPU,!0,!0),l.series[0].addPoint(n.usedMemory,!0,!0),l.yAxis[0].update({max:n.totalMemory}),n&&n.hasOwnProperty("session")){a.show(),a.find("span[data-key='pid'] b").html(n.session.pid),a.find("span[data-key='total_memory_quuota'] b").html(n.session.totalMemory.toFixed(2)+"G"),a.find("span[data-key='model_memory'] b").html(n.session.usedMemory.toFixed(2)+"G"),a.find("span[data-key='last_node'] b").html(n.session.currentNode);var i=t.find(".sessionchart").highcharts();i.series[1].addPoint(n.session.usedCPU,!0,!0),i.series[0].addPoint(n.session.usedMemory,!0,!0),i.yAxis[0].update({max:n.session.totalMemory})}else a.hide();s.systemTimeOut=setTimeout(function(){s.getSystemResources()},2e3)})}})}.apply(e,l))||(n.exports=i)}).call(this,t(218),t(1))},1862:function(n,e,t){"use strict";(function(a){var s,l=t(693);void 0===(s=function(){return a.Model.extend({getSystemResources:function(n,e){(0,l.send)("security/getSystemResources/",{session_key:n},{type:"GET",dataType:"text"},e,null,!0)}})}.apply(e,[]))||(n.exports=s)}).call(this,t(218))},1863:function(n,e,t){var a=t(690);function s(n){return n&&(n.__esModule?n.default:n)}n.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(n,e,a,l,i){var o=null!=e?e:n.nullContext||{},r=n.escapeExpression;return'<div class="row-fluid session-info main_monitor ">\n\n    <div class="box box-bordered box-color col-sm-6">\n        <div class="box-title">\n            <h3>\n                <i class="fa fa-bar-chart"></i>\n                <span>'+r(s(t(688)).call(o,"api_summary",{name:"L",hash:{},data:i,loc:{start:{line:7,column:22},end:{line:7,column:42}}}))+'</span>\n            </h3>\n        </div>\n        <div class="box-content">\n\n            <div class="row-fluid ">\n                <div class="col-sm-4">\n                    <span class="name" data-key="total_memory">'+r(s(t(688)).call(o,"system_memory",{name:"L",hash:{},data:i,loc:{start:{line:14,column:63},end:{line:14,column:85}}}))+': <b>-</b></span>\n                </div>\n                <div class="col-sm-4">\n                    <span class="name" data-key="used_memory">'+r(s(t(688)).call(o,"in_use",{name:"L",hash:{},data:i,loc:{start:{line:17,column:62},end:{line:17,column:77}}}))+': <b>-</b></span>\n                </div>\n                <div class="col-sm-4">\n                    <span class="name" data-key="free_memory">'+r(s(t(688)).call(o,"free",{name:"L",hash:{},data:i,loc:{start:{line:20,column:62},end:{line:20,column:75}}}))+': <b>-</b></span>\n                </div>\n                <div class="col-sm-4 ellipsable">\n                    <span class="name" data-key="cpu_usage">'+r(s(t(688)).call(o,"cpu_usage",{name:"L",hash:{},data:i,loc:{start:{line:23,column:60},end:{line:23,column:78}}}))+': <b>-</b></span>\n                </div>\n                <div class="col-sm-4 ellipsable">\n                    <span class="name" data-key="disk_size">'+r(s(t(688)).call(o,"disk_size",{name:"L",hash:{},data:i,loc:{start:{line:26,column:60},end:{line:26,column:78}}}))+': <b>-</b></span>\n                </div>\n                <div class="col-sm-4 ellipsable">\n                    <span class="name" data-key="disk_usage">'+r(s(t(688)).call(o,"disk_usage",{name:"L",hash:{},data:i,loc:{start:{line:29,column:61},end:{line:29,column:80}}}))+': <b>-</b></span>\n                </div>\n\n                <div class="col-sm-12">\n                    <div class="cpuchart">\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="box box-bordered box-color col-sm-6 session_monitor">\n\n    </div>\n\n</div>'},useData:!0})},1864:function(n,e,t){var a=t(690);function s(n){return n&&(n.__esModule?n.default:n)}n.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(n,e,a,l,i){var o=null!=e?e:n.nullContext||{},r=n.escapeExpression;return'<div class="box-title">\n    <h3>\n        <i class="fa fa-bar-chart"></i>\n        <span>'+r(s(t(688)).call(o,"selected_session",{name:"L",hash:{},data:i,loc:{start:{line:4,column:14},end:{line:4,column:39}}}))+'</span>\n    </h3>\n</div>\n<div class="box-content">\n\n    <div class="row-fluid ">\n        <div class="col-sm-4">\n            <span class="name" data-key="pid">PID: <b>-</b></span>\n        </div>\n\n        <div class="col-sm-4">\n            <span class="name" data-key="total_memory_quuota">'+r(s(t(688)).call(o,"memory_quota",{name:"L",hash:{},data:i,loc:{start:{line:15,column:62},end:{line:15,column:83}}}))+': <b>-</b></span>\n        </div>\n        <div class="col-sm-4">\n            <span class="name" data-key="model_memory">'+r(s(t(688)).call(o,"in_use_by_model",{name:"L",hash:{},data:i,loc:{start:{line:18,column:55},end:{line:18,column:79}}}))+': <b>-</b></span>\n        </div>\n        <div class="col-sm-12 ellipsable">\n            <span class="name" data-key="last_node">'+r(s(t(688)).call(o,"last_processed_node",{name:"L",hash:{},data:i,loc:{start:{line:21,column:52},end:{line:21,column:80}}}))+': <b>-</b></span>\n        </div>\n\n        <div class="col-sm-12">\n            <div class="sessionchart">\n            </div>\n        </div>\n\n    </div>\n</div>'},useData:!0})},1865:function(n,e,t){var a=t(690);function s(n){return n&&(n.__esModule?n.default:n)}n.exports=(a.default||a).template({compiler:[8,">= 4.3.0"],main:function(n,e,a,l,i){var o=null!=e?e:n.nullContext||{},r=n.escapeExpression;return'<div class="container-fluid mainTask" data-rel="session-manager" data-type="tab-content">\n  <div class="row-fluid session-info">\n    <div class="span12">\n      <div class="box box-bordered box-color">\n        <div class="box-title">\n          <h3>\n            <i class="fa fa-table"></i>\n            '+r(s(t(688)).call(o,"list_of_sessions",{name:"L",hash:{},data:i,loc:{start:{line:8,column:12},end:{line:8,column:36}}}))+'\n          </h3>\n        </div>\n        <div class="box-content nopadding">\n          <table id="session_list" class="table table-hover table-nomargin table-condensed selectable">\n            <thead>\n              <tr>\n                <th>'+r(s(t(688)).call(o,"open_at",{name:"L",hash:{},data:i,loc:{start:{line:15,column:20},end:{line:15,column:35}}}))+"</th>\n                <th>"+r(s(t(688)).call(o,"user_name",{name:"L",hash:{},data:i,loc:{start:{line:16,column:20},end:{line:16,column:37}}}))+"</th>\n                <th>"+r(s(t(688)).call(o,"current_model",{name:"L",hash:{},data:i,loc:{start:{line:17,column:20},end:{line:17,column:41}}}))+"</th>\n                <th>"+r(s(t(688)).call(o,"is_pool",{name:"L",hash:{},data:i,loc:{start:{line:18,column:20},end:{line:18,column:35}}}))+"</th>\n                <th class='hidden-1024'>"+r(s(t(688)).call(o,"active",{name:"L",hash:{},data:i,loc:{start:{line:19,column:40},end:{line:19,column:54}}}))+"</th>\n                <th>"+r(s(t(688)).call(o,"timeout_in",{name:"L",hash:{},data:i,loc:{start:{line:20,column:20},end:{line:20,column:38}}}))+'</th>\n                <th style="width:80px">'+r(s(t(688)).call(o,"actions",{name:"L",hash:{},data:i,loc:{start:{line:21,column:39},end:{line:21,column:54}}}))+"</th>\n              </tr>\n            </thead>\n            <tbody>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n"},useData:!0})},1866:function(n,e,t){var a=t(690);function s(n){return n&&(n.__esModule?n.default:n)}n.exports=(a.default||a).template({1:function(n,e,a,l,i){var o,r=n.lambda,c=n.escapeExpression,d=null!=e?e:n.nullContext||{};return'<tr data-session-key="'+c(r(null!=e?e.session_key:e,e))+'">\n  <td>'+c(r(null!=e?e.openAgo:e,e))+" "+c(s(t(688)).call(d,"minutes_ago",{name:"L",hash:{},data:i,loc:{start:{line:3,column:18},end:{line:3,column:37}}}))+"</td>\n  <td>"+c(r(null!=e?e.userName:e,e))+"</td>\n  <td><span "+(null!=(o=s(t(689)).call(d,null!=e?e.status:e,"==","processing",{name:"ifCond",hash:{},fn:n.program(2,i,0),inverse:n.noop,data:i,loc:{start:{line:5,column:12},end:{line:5,column:82}}}))?o:"")+">"+c(r(null!=e?e.currentModelFile:e,e))+"\n      "+(null!=(o=s(t(689)).call(d,null!=e?e.currentModelFile:e,"!=","",{name:"ifCond",hash:{},fn:n.program(4,i,0),inverse:n.noop,data:i,loc:{start:{line:6,column:6},end:{line:7,column:51}}}))?o:"")+"</span>\n  </td>\n  <td>"+(null!=(o=a.if.call(d,null!=e?e.isPool:e,{name:"if",hash:{},fn:n.program(9,i,0),inverse:n.noop,data:i,loc:{start:{line:9,column:6},end:{line:9,column:69}}}))?o:"")+"</td>\n  <td class='hidden-1024'>"+(null!=(o=s(t(689)).call(d,null!=e?e.activeAgo:e,"==",0,{name:"ifCond",hash:{},fn:n.program(9,i,0),inverse:n.program(11,i,0),data:i,loc:{start:{line:10,column:26},end:{line:11,column:59}}}))?o:"")+"</td>\n  <td>"+(null!=(o=s(t(689)).call(d,null!=e?e.timeoutIn:e,"==","-1",{name:"ifCond",hash:{},fn:n.program(13,i,0),inverse:n.program(15,i,0),data:i,loc:{start:{line:12,column:6},end:{line:12,column:86}}}))?o:"")+"</td>\n  <td>\n"+(null!=(o=s(t(695)).call(d,"kill_sessions",{name:"haveAccess",hash:{},fn:n.program(17,i,0),inverse:n.noop,data:i,loc:{start:{line:14,column:4},end:{line:24,column:19}}}))?o:"")+"  </td>\n</tr>\n"},2:function(n,e,t,a,s){return'style="color: #a94442" '},4:function(n,e,t,a,s){var l;return" "+(null!=(l=t.if.call(null!=e?e:n.nullContext||{},null!=e?e.readonly:e,{name:"if",hash:{},fn:n.program(5,s,0),inverse:n.program(7,s,0),data:s,loc:{start:{line:6,column:43},end:{line:7,column:40}}}))?l:"")},5:function(n,e,t,a,s){return""},7:function(n,e,t,a,s){return' <i\n        class="fa fa-pencil"></i>'},9:function(n,e,t,a,s){return'<span> <i class="fa fa-check"></i> </span>'},11:function(n,e,a,l,i){var o=n.escapeExpression;return" <span>\n      "+o(n.lambda(null!=e?e.activeAgo:e,e))+" "+o(s(t(688)).call(null!=e?e:n.nullContext||{},"minutes_ago",{name:"L",hash:{},data:i,loc:{start:{line:11,column:20},end:{line:11,column:39}}}))+" </span> "},13:function(n,e,t,a,s){return" "},15:function(n,e,a,l,i){var o=n.escapeExpression;return o(n.lambda(null!=e?e.timeoutIn:e,e))+" "+o(s(t(688)).call(null!=e?e:n.nullContext||{},"minutes",{name:"L",hash:{},data:i,loc:{start:{line:12,column:60},end:{line:12,column:75}}}))},17:function(n,e,a,l,i){var o,r=null!=e?e:n.nullContext||{};return'    <button class="btn btn-red btnKill" rel="tooltip" data-title="'+n.escapeExpression(s(t(688)).call(r,"kill_session",{name:"L",hash:{},data:i,loc:{start:{line:15,column:66},end:{line:15,column:86}}}))+'"><i\n        class="fa fa-power-off"></i></button>\n\n'+(null!=(o=a.if.call(r,null!=e?e.isPool:e,{name:"if",hash:{},fn:n.program(18,i,0),inverse:n.program(20,i,0),data:i,loc:{start:{line:18,column:4},end:{line:23,column:11}}}))?o:"")},18:function(n,e,t,a,s){return"\n"},20:function(n,e,a,l,i){return'    <button class="btn btn-orange btnRequestLogout" rel="tooltip" data-title="'+n.escapeExpression(s(t(688)).call(null!=e?e:n.nullContext||{},"request_kill_session",{name:"L",hash:{},data:i,loc:{start:{line:21,column:78},end:{line:21,column:106}}}))+'"><i\n        class="fa fa-power-off"></i></button>\n'},compiler:[8,">= 4.3.0"],main:function(n,e,t,a,s){var l;return null!=(l=t.each.call(null!=e?e:n.nullContext||{},null!=e?e.sessions:e,{name:"each",hash:{},fn:n.program(1,s,0),inverse:n.noop,data:s,loc:{start:{line:1,column:0},end:{line:27,column:9}}}))?l:""},useData:!0})}}]);