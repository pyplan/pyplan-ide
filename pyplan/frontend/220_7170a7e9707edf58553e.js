/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[220],{1849:function(e,n,a){"use strict";(function(t,s){var i,l,o=a(18);i=[a(724),a(1850),a(1855),a(1856)],void 0===(l=function(e,n,i,l){return t.View.extend({el:s("#main"),sessionsTimeout:void 0,mainMonitor:void 0,render:function(){var e=i();this.$el.append(e),this.getData(),this.drawPerformanceMonitor(),this.addHandlers()},getData:function(){var n=this;clearTimeout(n.sessionsTimeout),(new e).getAllSessions(function(e){0!=s("#session_list").length&&(n.drawTable(e),n.sessionsTimeout=setTimeout(function(){n.getData()},1e4))})},addHandlers:function(){var n=this,t=s("#session_list tbody");t.on("click","tr",function(){s("#session_list tbody tr").removeClass("selected"),s(this).addClass("selected");var e=s(this).attr("data-session-key");e&&n.drawSessionMonitor(e)}),t.on("click","tr button.btnKill",function(){var t=s(this).closest("tr").attr("data-session-key");return a.e(5).then(function(){var s=[a(684)];(function(a){(new a).show({title:(0,o.translate)("kill_session"),text:(0,o.translate)("sure_kill_session"),buttons:[{title:(0,o.translate)("yes"),css:"primary",code:"yes"},{title:(0,o.translate)("no"),code:"no"}],callback:function(a){"yes"==a&&(new e).killSessionByKey(t,function(){n.getData()})}})}).apply(null,s)}).catch(a.oe),!1}),t.on("click","tr button.btnRequestLogout",function(){var n=s(this).closest("tr").attr("data-session-key");a.e(5).then(function(){var t=[a(684)];(function(a){(new a).show({title:(0,o.translate)("request_kill_session"),text:(0,o.translate)("sure_request_kill_session"),buttons:[{title:(0,o.translate)("yes"),css:"primary",code:"yes"},{title:(0,o.translate)("no"),code:"no"}],callback:function(a){"yes"==a&&(new e).requireLogoutSessionByToken(n)}})}).apply(null,t)}).catch(a.oe)})},drawTable:function(e){var n=l({sessions:e}),a=s("#session_list tbody tr.selected").attr("data-token");s("#session_list tbody").html(n),a&&(s("#session_list tbody tr[data-token='"+a+"']").length>0?s("#session_list tbody tr[data-token='"+a+"']").addClass("selected"):this.mainMonitor&&this.mainMonitor.clearByToken())},drawPerformanceMonitor:function(){var e=new n;this.mainMonitor=e.show(s(".mainTask[data-rel='session-manager']"))},drawSessionMonitor:function(e){this.mainMonitor.setElement(s(".mainTask[data-rel='session-manager']")),this.mainMonitor.render(e)}})}.apply(n,i))||(e.exports=l)}).call(this,a(218),a(1))},1850:function(e,n,a){"use strict";(function(t){var s,i;s=[a(1851)],void 0===(i=function(e){return t.Controller.extend({name:"performanceMonitor",show:function(n){var a=new e;return a.setElement(n),a.render(),a}})}.apply(n,s))||(e.exports=i)}).call(this,a(694))},1851:function(e,n,a){"use strict";(function(t,s){var i,l;i=[a(1852),a(1853),a(1854)],void 0===(l=function(e,n,a){return t.View.extend({el:s("#main"),systemTimeOut:-1,byTokenInitialized:!1,current_session_key:"",render:function(e){if(e){if(clearTimeout(this.systemTimeOut),this.current_session_key=e,this.$el.find(".session_monitor").hide(),this.byTokenInitialized){var t=this.$el.find(".main_monitor").find(".sessionchart").highcharts();t.series[1].setData(Array(50).fill(0),!0,!0),t.series[0].setData(Array(50).fill(0),!0,!0)}else{this.byTokenInitialized=!0;var s=a();this.$el.find(".session_monitor").html(s),this.createSessionCharts()}this.getSystemResources()}else{s=n();this.$el.append(s),this.createMainCharts(),this.getSystemResources()}},clearByToken:function(){this.current_session_key="",this.byTokenInitialized=!1,this.$el.find(".session_monitor").empty()},removeView:function(){clearTimeout(this.systemTimeOut)},createMainCharts:function(){var e=this.$el;e.find(".cpuchart").length>0&&e.find(".cpuchart").highcharts({chart:{zoomType:"xy",height:220,marginTop:60},title:!1,xAxis:{type:"datetime",tickPixelInterval:100,labels:{enabled:!1}},yAxis:[{min:0,max:64,title:{text:"Memory (gb)"}},{min:0,max:100,title:{text:"% CPU"},opposite:!0}],tooltip:!1,legend:{align:"center",verticalAlign:"top",x:0,y:10},exporting:{enabled:!1},credits:!1,plotOptions:{series:{marker:{enabled:!1}}},series:[{name:"Memory (gb)",type:"area",yAxis:0,data:Array(50).fill(0),tooltip:{valueDecimals:2,valueSuffix:" gb"}},{name:"% CPU",type:"spline",yAxis:1,data:Array(50).fill(0),tooltip:{valueDecimals:0,valueSuffix:" %"}}]})},createSessionCharts:function(){var e=this.$el;e.find(".sessionchart").length>0&&e.find(".sessionchart").highcharts({chart:{zoomType:"xy",height:220,marginTop:60},title:!1,xAxis:{type:"datetime",tickPixelInterval:100,labels:{enabled:!1}},yAxis:[{min:0,max:64,title:{text:"Memory (gb)"}},{min:0,max:100,title:{text:"% CPU"},opposite:!0}],tooltip:{shared:!0},legend:{align:"center",verticalAlign:"top",x:0,y:10},exporting:{enabled:!1},credits:!1,plotOptions:{series:{marker:{enabled:!1}}},series:[{name:"Memory (gb)",type:"area",yAxis:0,data:Array(50).fill(0),tooltip:{valueDecimals:2,valueSuffix:" gb"}},{name:"% CPU",type:"spline",yAxis:1,data:Array(50).fill(0),tooltip:{valueDecimals:0,valueSuffix:" %"}}]})},getSystemResources:function(){clearTimeout(this.systemTimeOut);var n=new e,a=this.$el.find(".main_monitor"),t=this.$el.find(".session_monitor"),s=this;a.length>0&&n.getSystemResources(this.current_session_key,function(e){a.find("span[data-key='total_memory'] b").html(e.totalMemory.toFixed(2)+"G"),a.find("span[data-key='used_memory'] b").html(e.usedMemory.toFixed(2)+"G"),a.find("span[data-key='free_memory'] b").html((e.totalMemory-e.usedMemory).toFixed(2)+"G"),a.find("span[data-key='cpu_usage'] b").html(e.usedCPU.toFixed(2)+" %"),a.find("span[data-key='disk_size'] b").html(e.disk.size),a.find("span[data-key='disk_usage'] b").html("".concat(e.disk.used," (").concat(e.disk.percent,")"));var n=100*e.usedMemory/e.totalMemory;a.find("div.chart[data-key='memory']").find("span.v").html(n.toFixed(0)+" %");var i=a.find(".cpuchart").highcharts();if(i.series[1].addPoint(e.usedCPU,!0,!0),i.series[0].addPoint(e.usedMemory,!0,!0),i.yAxis[0].update({max:e.totalMemory}),e&&e.hasOwnProperty("session")){t.show(),t.find("span[data-key='pid'] b").html(e.session.pid),t.find("span[data-key='total_memory_quuota'] b").html(e.session.totalMemory.toFixed(2)+"G"),t.find("span[data-key='model_memory'] b").html(e.session.usedMemory.toFixed(2)+"G"),t.find("span[data-key='last_node'] b").html(e.session.currentNode);var l=a.find(".sessionchart").highcharts();l.series[1].addPoint(e.session.usedCPU,!0,!0),l.series[0].addPoint(e.session.usedMemory,!0,!0),l.yAxis[0].update({max:e.session.totalMemory})}else t.hide();s.systemTimeOut=setTimeout(function(){s.getSystemResources()},2e3)})}})}.apply(n,i))||(e.exports=l)}).call(this,a(218),a(1))},1852:function(e,n,a){"use strict";(function(t){var s,i=a(693);void 0===(s=function(){return t.Model.extend({getSystemResources:function(e,n){(0,i.send)("security/getSystemResources/",{session_key:e},{type:"GET",dataType:"text"},n,null,!0)}})}.apply(n,[]))||(e.exports=s)}).call(this,a(218))},1853:function(e,n,a){var t=a(690);function s(e){return e&&(e.__esModule?e.default:e)}e.exports=(t.default||t).template({compiler:[7,">= 4.0.0"],main:function(e,n,t,i,l){var o=null!=n?n:e.nullContext||{},r=e.escapeExpression;return'<div class="row-fluid session-info main_monitor ">\n\n    <div class="box box-bordered box-color col-sm-6">\n        <div class="box-title">\n            <h3>\n                <i class="fa fa-bar-chart"></i>\n                <span>'+r(s(a(688)).call(o,"api_summary",{name:"L",hash:{},data:l}))+'</span>\n            </h3>\n        </div>\n        <div class="box-content">\n\n            <div class="row-fluid ">\n                <div class="col-sm-4">\n                    <span class="name" data-key="total_memory">'+r(s(a(688)).call(o,"system_memory",{name:"L",hash:{},data:l}))+': <b>-</b></span>\n                </div>\n                <div class="col-sm-4">\n                    <span class="name" data-key="used_memory">'+r(s(a(688)).call(o,"in_use",{name:"L",hash:{},data:l}))+': <b>-</b></span>\n                </div>\n                <div class="col-sm-4">\n                    <span class="name" data-key="free_memory">'+r(s(a(688)).call(o,"free",{name:"L",hash:{},data:l}))+': <b>-</b></span>\n                </div>\n                <div class="col-sm-4 ellipsable">\n                    <span class="name" data-key="cpu_usage">'+r(s(a(688)).call(o,"cpu_usage",{name:"L",hash:{},data:l}))+': <b>-</b></span>\n                </div>\n                <div class="col-sm-4 ellipsable">\n                    <span class="name" data-key="disk_size">'+r(s(a(688)).call(o,"disk_size",{name:"L",hash:{},data:l}))+': <b>-</b></span>\n                </div>\n                <div class="col-sm-4 ellipsable">\n                    <span class="name" data-key="disk_usage">'+r(s(a(688)).call(o,"disk_usage",{name:"L",hash:{},data:l}))+': <b>-</b></span>\n                </div>\n\n                <div class="col-sm-12">\n                    <div class="cpuchart">\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="box box-bordered box-color col-sm-6 session_monitor">\n\n    </div>\n\n</div>'},useData:!0})},1854:function(e,n,a){var t=a(690);function s(e){return e&&(e.__esModule?e.default:e)}e.exports=(t.default||t).template({compiler:[7,">= 4.0.0"],main:function(e,n,t,i,l){var o=null!=n?n:e.nullContext||{},r=e.escapeExpression;return'<div class="box-title">\n    <h3>\n        <i class="fa fa-bar-chart"></i>\n        <span>'+r(s(a(688)).call(o,"selected_session",{name:"L",hash:{},data:l}))+'</span>\n    </h3>\n</div>\n<div class="box-content">\n\n    <div class="row-fluid ">\n        <div class="col-sm-4">\n            <span class="name" data-key="pid">PID: <b>-</b></span>\n        </div>\n\n        <div class="col-sm-4">\n            <span class="name" data-key="total_memory_quuota">'+r(s(a(688)).call(o,"memory_quota",{name:"L",hash:{},data:l}))+': <b>-</b></span>\n        </div>\n        <div class="col-sm-4">\n            <span class="name" data-key="model_memory">'+r(s(a(688)).call(o,"in_use_by_model",{name:"L",hash:{},data:l}))+': <b>-</b></span>\n        </div>\n        <div class="col-sm-12 ellipsable">\n            <span class="name" data-key="last_node">'+r(s(a(688)).call(o,"last_processed_node",{name:"L",hash:{},data:l}))+': <b>-</b></span>\n        </div>\n\n        <div class="col-sm-12">\n            <div class="sessionchart">\n            </div>\n        </div>\n\n    </div>\n</div>'},useData:!0})},1855:function(e,n,a){var t=a(690);function s(e){return e&&(e.__esModule?e.default:e)}e.exports=(t.default||t).template({compiler:[7,">= 4.0.0"],main:function(e,n,t,i,l){var o=null!=n?n:e.nullContext||{},r=e.escapeExpression;return'<div class="container-fluid mainTask" data-rel="session-manager" data-type="tab-content">\n  <div class="row-fluid session-info">\n    <div class="span12">\n      <div class="box box-bordered box-color">\n        <div class="box-title">\n          <h3>\n            <i class="fa fa-table"></i>\n            '+r(s(a(688)).call(o,"list_of_sessions",{name:"L",hash:{},data:l}))+'\n          </h3>\n        </div>\n        <div class="box-content nopadding">\n          <table id="session_list" class="table table-hover table-nomargin table-condensed selectable">\n            <thead>\n              <tr>\n                <th>'+r(s(a(688)).call(o,"open_at",{name:"L",hash:{},data:l}))+"</th>\n                <th>"+r(s(a(688)).call(o,"user_name",{name:"L",hash:{},data:l}))+"</th>\n                <th>"+r(s(a(688)).call(o,"current_model",{name:"L",hash:{},data:l}))+"</th>\n                <th>"+r(s(a(688)).call(o,"is_pool",{name:"L",hash:{},data:l}))+"</th>\n                <th class='hidden-1024'>"+r(s(a(688)).call(o,"active",{name:"L",hash:{},data:l}))+"</th>\n                <th>"+r(s(a(688)).call(o,"timeout_in",{name:"L",hash:{},data:l}))+'</th>\n                <th style="width:80px">'+r(s(a(688)).call(o,"actions",{name:"L",hash:{},data:l}))+"</th>\n              </tr>\n            </thead>\n            <tbody>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n"},useData:!0})},1856:function(e,n,a){var t=a(690);function s(e){return e&&(e.__esModule?e.default:e)}e.exports=(t.default||t).template({1:function(e,n,t,i,l){var o,r=e.lambda,d=e.escapeExpression,c=null!=n?n:e.nullContext||{};return'<tr data-session-key="'+d(r(null!=n?n.session_key:n,n))+'">\n  <td>'+d(r(null!=n?n.openAgo:n,n))+" "+d(s(a(688)).call(c,"minutes_ago",{name:"L",hash:{},data:l}))+"</td>\n  <td>"+d(r(null!=n?n.userName:n,n))+"</td>\n  <td><span "+(null!=(o=s(a(689)).call(c,null!=n?n.status:n,"==","processing",{name:"ifCond",hash:{},fn:e.program(2,l,0),inverse:e.noop,data:l}))?o:"")+">"+d(r(null!=n?n.currentModelFile:n,n))+"\n      "+(null!=(o=s(a(689)).call(c,null!=n?n.currentModelFile:n,"!=","",{name:"ifCond",hash:{},fn:e.program(4,l,0),inverse:e.noop,data:l}))?o:"")+"</span>\n  </td>\n  <td>"+(null!=(o=t.if.call(c,null!=n?n.isPool:n,{name:"if",hash:{},fn:e.program(9,l,0),inverse:e.noop,data:l}))?o:"")+"</td>\n  <td class='hidden-1024'>"+(null!=(o=s(a(689)).call(c,null!=n?n.activeAgo:n,"==",0,{name:"ifCond",hash:{},fn:e.program(9,l,0),inverse:e.program(11,l,0),data:l}))?o:"")+"</td>\n  <td>"+(null!=(o=s(a(689)).call(c,null!=n?n.timeoutIn:n,"==","-1",{name:"ifCond",hash:{},fn:e.program(13,l,0),inverse:e.program(15,l,0),data:l}))?o:"")+"</td>\n  <td>\n"+(null!=(o=s(a(695)).call(c,"kill_sessions",{name:"haveAccess",hash:{},fn:e.program(17,l,0),inverse:e.noop,data:l}))?o:"")+"  </td>\n</tr>\n"},2:function(e,n,a,t,s){return'style="color: #a94442" '},4:function(e,n,a,t,s){var i;return" "+(null!=(i=a.if.call(null!=n?n:e.nullContext||{},null!=n?n.readonly:n,{name:"if",hash:{},fn:e.program(5,s,0),inverse:e.program(7,s,0),data:s}))?i:"")},5:function(e,n,a,t,s){return""},7:function(e,n,a,t,s){return' <i\n        class="fa fa-pencil"></i>'},9:function(e,n,a,t,s){return'<span> <i class="fa fa-check"></i> </span>'},11:function(e,n,t,i,l){var o=e.escapeExpression;return" <span>\n      "+o(e.lambda(null!=n?n.activeAgo:n,n))+" "+o(s(a(688)).call(null!=n?n:e.nullContext||{},"minutes_ago",{name:"L",hash:{},data:l}))+" </span> "},13:function(e,n,a,t,s){return" "},15:function(e,n,t,i,l){var o=e.escapeExpression;return o(e.lambda(null!=n?n.timeoutIn:n,n))+" "+o(s(a(688)).call(null!=n?n:e.nullContext||{},"minutes",{name:"L",hash:{},data:l}))},17:function(e,n,t,i,l){var o,r=null!=n?n:e.nullContext||{};return'    <button class="btn btn-red btnKill" rel="tooltip" data-title="'+e.escapeExpression(s(a(688)).call(r,"kill_session",{name:"L",hash:{},data:l}))+'"><i\n        class="fa fa-power-off"></i></button>\n\n'+(null!=(o=t.if.call(r,null!=n?n.isPool:n,{name:"if",hash:{},fn:e.program(18,l,0),inverse:e.program(20,l,0),data:l}))?o:"")},18:function(e,n,a,t,s){return"\n"},20:function(e,n,t,i,l){return'    <button class="btn btn-orange btnRequestLogout" rel="tooltip" data-title="'+e.escapeExpression(s(a(688)).call(null!=n?n:e.nullContext||{},"request_kill_session",{name:"L",hash:{},data:l}))+'"><i\n        class="fa fa-power-off"></i></button>\n'},compiler:[7,">= 4.0.0"],main:function(e,n,a,t,s){var i;return null!=(i=a.each.call(null!=n?n:e.nullContext||{},null!=n?n.sessions:n,{name:"each",hash:{},fn:e.program(1,s,0),inverse:e.noop,data:s}))?i:""},useData:!0})}}]);