/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{1414:function(e,a,n){"use strict";(function(i,t){var o,r,c=n(18);o=[n(983),n(219),n(1437)],void 0===(r=function(e,a,o){return i.View.extend({el:t("#main"),diagram:void 0,nodeFinder:void 0,diagramClipboard:void 0,render:function(){var a=this,i=o();this.$el.append(i),(0,c.registerResizeEvents)("influcenDiagramResize",function(){a.updateSizes(),t(".dockInfluenceDiagramProperty").trigger("updateSizesOnDock")}),this.updateSizes(),this.$el.find(".mainTask.influence-diagram").on("removeView",function(){a.onRemoveView()}).on("refreshView",function(){a.refreshDiagram()}).on("modelIdChanged",function(e,n){a.diagram&&a.diagram.navigateToNode(n)}).on("evaluateNode",function(e,n){a.evaluateNode(n)}).on("onKeyDown",function(e,n,i){a.processKeyUp(n,i)}).keyup(function(e,n,i){8===e.keyCode&&a.processKeyUp(e,e.keyCode)}).on("changeEditMode",function(e,n){if(a.diagram){if(a.diagram.setEditMode(n),a.diagram.currentHighlightNode&&a.diagram.getNodeFromDic(a.diagram.currentHighlightNode)){var i=a.diagram.getNodeFromDic(a.diagram.currentHighlightNode),o=a.diagram.currentHighlightNode;setTimeout(function(){a.diagram.$el.trigger("selectNodeById",[o])},200),a.showNodeDefinition(null,i)}n||a.$el.find(".mainTask.influence-diagram").trigger("clearSelect"),t.cookie("cubeplan_edit_mode",n.toString(),{expires:1e3})}}),this.addSliders(function(){t(".dockInfluenceDiagramProperty").hide(),n.e(21).then(function(){var e=[n(743)];(function(e){(new e).render()}).apply(null,e)}).catch(n.oe),n.e(49).then(function(){var e=[n(1119)];(function(e){a.nodeFinder=(new e).create({el:a.$el.find(".mainTask.influence-diagram .searchNode"),callback:function(e,n){a.diagram.navigateToNode(e.id),setTimeout(function(){n.select2("val","")},100)}})}).apply(null,e)}).catch(n.oe)});var r={contextMenu:!1,autoCenter:!1,breadCrumb:!0,nodeClick:function(e,n){a.showNodeDefinition(e,n)},nodeDoubleclick:function(e,n){t(".dockInfluenceDiagramProperty").trigger("saveCurrentNode"),setTimeout(function(){a.evaluateNode(n)},100)},diagramClick:function(){a.$el.find(".mainTask.influence-diagram").trigger("diagramClick"),a.diagram&&a.diagram.clearHighlightNode()},nodeSelect:function(e,i){n.e(21).then(function(){var e=[n(743)];(function(e){(new e).loadDefinitionTab(i)}).apply(null,e)}).catch(n.oe),a.$el.find(".mainTask.influence-diagram").trigger("nodeSelect",[i,a.diagram.editMode])},nodesSelect:function(e,n){n&&n.length>1&&a.$el.find(".mainTask.influence-diagram").trigger("nodesSelect",[n,a.diagram.editMode])},clearSelect:function(e){a.$el.find(".mainTask.influence-diagram").trigger("clearSelect")},addNodeToDefinition:function(e,n){a.$el.find(".mainTask.influence-diagram").trigger("addNodeToWizardDefinition",[n])},updateProperties:function(e){},executeButton:function(e){a.executeButton(e)},nodeRightClick:function(e,n){a.nodeRightClick(e,n)}};if(this.diagram=new e(r),this.diagram.setElement(this.$el.find(".diagram-area")),this.diagram.render(),(0,c.haveAccess)("change_influence_diagram")){var d=!0;"false"===t.cookie("cubeplan_edit_mode")&&(d=!1),this.diagram.setEditMode(d)}this.options&&this.options.navigateToNode?this.diagram.navigateToNode(this.options.navigateToNode):this.drawDiagram()},onRemoveView:function(){(0,c.removeResizeEvent)("influcenDiagramResize"),this.diagram&&(this.diagram.destroy(),this.diagram=null),this.nodeFinder&&this.nodeFinder.destroy()},updateSizes:function(){if(this.$el.find(".diagram-area").is(":visible")){this.$el.find(".diagram-area").height(t(window).height()-50),this.$el.find(".diagram-area").width(t(window).width()-50),this.diagram&&this.diagram.onResize()}},addSliders:function(e){var a=t(".diagram-area"),i=this;Promise.resolve().then(function(){var t=[n(718)];(function(n){var t=new n;t.drawDashboardBars(a,e),(0,c.haveAccess)("change_influence_diagram")&&t.drawToolbarDiagram(a,{diagram:i.diagram})}).apply(null,t)}).catch(n.oe)},refreshDiagram:function(){this.diagram&&this.diagram.navigateCurrentModule()},drawDiagram:function(){this.diagram&&this.diagram.navigateDiagram()},evaluateNode:function(e){if("text"!=e.nodeClass&&"button"!=e.nodeClass){var i=new a,o=null;"formnode"!=e.nodeClass||"formnode_edit_table"!=e.formNodeLabel&&"formnode_subtable"!=e.formNodeLabel||(o={isInputNode:!0});var r=e.originalId?e.originalId:e.id;i.evaluateNode(r,function(e){e&&0==e.dashVersion?n.e(16).then(function(){var a=[n(701)];(function(a){var n=new a;o&&o.isInputNode&&n.removeDashboardTaskFromHome(e.dashboardId);var i=t(".dockInfluenceDiagramProperty #nodePropertiesDock").attr("node-id");e.nodes===i&&t('.btn[data-action="run"]').click(),n.showDashboard(e.dashboardId,-1,e.name,!0,!1,o)}).apply(null,a)}).catch(n.oe):n.e(32).then(function(){var a=[n(702)];(function(a){var n=new a;o&&o.isInputNode&&n.removeDashboardTaskFromHome(e.id);var i=t(".dockInfluenceDiagramProperty #nodePropertiesDock").attr("node-id");e.node===i&&t('.btn[data-action="run"]').click(),n.showDashboard(e.id,-1,e.name,!0,!1,o,!0)}).apply(null,a)}).catch(n.oe)})}},executeButton:function(e){var n=this,i=new a;t("#genericLoading").text((0,c.translate)("processing_please_wait")).show(),i.executeButton(e.id,function(){n.queryForFinishCalc(e.id),t("#genericLoading").hide()})},queryForFinishCalc:function(e){var n=this,i=new a,o=0;setTimeout(function(){!function a(){o++,i.isInBackground(e,function(e){e?o<4?setTimeout(function(){a()},300):setTimeout(function(){a()},1e3):(t(".influence-diagram").length>0&&n&&n.diagram&&n.refreshDiagram(),n=null)})}()},200)},showNodeDefinition:function(e,a){this.diagram&&(a&&"module"!=a.nodeClass&&"module"!=a.originalClass&&"library"!=a.nodeClass&&"library"!=a.originalClass?(this.diagram.highlightNode(a.id),n.e(21).then(function(){var e=[n(743)];(function(e){(new e).loadDefinitionTab(a)}).apply(null,e)}).catch(n.oe)):(this.diagram.highlightNode(null),this.$el.find(".mainTask.influence-diagram").trigger("clearSelect")))},nodeRightClick:function(e,a){var n=this,i=(a=a).nodeClass;if("alias"==i.toLowerCase()&&(i=a.originalClass),"module"==i||"library"==i||"variable"==i||"index"==i||"function"==i){t.contextMenu.types.diagram_icon_text=function(e,a,n){t('<i class="'+e.iconClass+'"></i><span>'+e.name+"</span>").appendTo(this)};var o={_navigate:{type:"diagram_icon_text",name:(0,c.translate)("navigate_module"),iconClass:"fa fa-sign-in"}};(0,c.haveAccess)("change_group_permissions")&&(o=t.extend(o,{_setPermisions:{type:"diagram_icon_text",name:(0,c.translate)("set_restrictions"),iconClass:"fa fa-lock"}})),this.diagram.editMode&&(o=t.extend(o,{_exportModule:{type:"diagram_icon_text",name:(0,c.translate)("_export_module"),iconClass:"fa fa-download"}})),"variable"==i&&(o={_evaluate:{type:"diagram_icon_text",name:(0,c.translate)("evaluate_node"),iconClass:"fa fa-bolt"},_quickevaluate:{type:"diagram_icon_text",name:(0,c.translate)("quick_evaluate"),iconClass:"fa fa-play"},_copyToPyplanExcelAddIn:{type:"diagram_icon_text",name:(0,c.translate)("copy_to_pyplan_excel_addin"),iconClass:"fa fa-file-excel-o"}}),"function"!=i&&"index"!=i||(o={_quickevaluate:{type:"diagram_icon_text",name:(0,c.translate)("quick_evaluate"),iconClass:"fa fa-play"},_generate_api_endpoint:{type:"diagram_icon_text",name:(0,c.translate)("api_endpoint"),iconClass:"fa fa-link"}}),o&&(t.contextMenu({selector:".diagramContextMenu",trigger:"none",callback:function(e,i){switch(e){case"_setPermisions":n.setPermissions(a);break;case"_exportModule":n.exportModule(a);break;case"_copyToPyplanExcelAddIn":(0,c.copyTextToClipboard)("pyplan.getnodedata:"+(a.originalId?a.originalId:a.id));break;case"_evaluate":n.evaluateNode(a);break;case"_quickevaluate":n.quickEvaluateNode(a);break;case"_navigate":n.diagram.navigateThisModule(a.id);break;case"_generate_api_endpoint":n.generateAPIEndpoint(a)}},events:{hide:function(){t.contextMenu("destroy",".diagramContextMenu")}},items:o}),e&&e.clientX?t(".diagramContextMenu").contextMenu({x:e.clientX,y:e.clientY}):e&&e.touches&&e.touches.length>0?t(".diagramContextMenu").contextMenu({x:e.touches[0].clientX,y:e.touches[0].clientY}):t(".diagramContextMenu").contextMenu())}},generateAPIEndpoint:function(e){n.e(10).then(function(){var a=[n(699)];(function(a){(new a).showNodeSharer(e.id)}).apply(null,a)}).catch(n.oe)},setPermissions:function(e){e=e;Promise.resolve().then(function(){var a=[n(718)];(function(a){(new a).showPermissionsModal(e.id,function(e,a){})}).apply(null,a)}).catch(n.oe)},exportModule:function(e){e=e;Promise.resolve().then(function(){var a=[n(718)];(function(a){(new a).exportModuleModal(e.id,function(e,a){})}).apply(null,a)}).catch(n.oe)},processKeyUp:function(e,a){if(this.diagram){var i=!1,o=this.diagram.getSelectedNodes(),r=this.diagram.editMode,d=this;switch(a){case"alt+d":o&&o.length>0&&(o.length>1?(0,c.showMessage)((0,c.translate)("many_nodes_selected"),void 0,"info"):(t(".dockInfluenceDiagramProperty").trigger("saveCurrentNode"),t(".dashboard-tabs").trigger("refreshNodeChanges",[{nodeId:o[0].id}]),t(".tabs-area .toolbar").trigger("pendingRefresh",[{nodeId:o[0].id}]),t(".dashboard-tabs").trigger("refreshNodeChanges",[{nodeId:o[0].id}]),setTimeout(function(){d.openDocumentationModal(o[0])},100))),i=!0;break;case"ctrl+r":o&&o.length>0&&(o.length>1?(0,c.showMessage)((0,c.translate)("many_nodes_selected"),void 0,"info"):(t(".dockInfluenceDiagramProperty").trigger("saveCurrentNode"),setTimeout(function(){"module"==o[0].nodeClass||"module"==o[0].originalClass||"library"==o[0].nodeClass||"library"==o[0].originalClass?d.diagram.navigateThisModule(o[0].id):d.evaluateNode(o[0])},100))),i=!0;break;case"ctrl+e":o&&o.length>0&&(o.length>1?(0,c.showMessage)((0,c.translate)("many_nodes_selected"),void 0,"info"):(t(".dockInfluenceDiagramProperty").trigger("saveCurrentNode"),t(".dashboard-tabs").trigger("refreshNodeChanges",[{nodeId:o[0].id}]),t(".tabs-area .toolbar").trigger("pendingRefresh",[{nodeId:o[0].id}]),t(".dashboard-tabs").trigger("refreshNodeChanges",[{nodeId:o[0].id}]),setTimeout(function(){"module"==o[0].nodeClass||"module"==o[0].originalClass||"library"==o[0].nodeClass||"library"==o[0].originalClass?d.diagram.navigateThisModule(o[0].id):d.quickEvaluateNode(o[0])},100))),i=!0;break;case"ctrl+y":this.diagram.toggleShowId(),i=!0;break;case"ctrl+h":r&&this.diagram.hasFocus()&&o&&1==o.length&&(this.diagram.navigateToOriginal(o[0].id),i=!0);break;case"ctrl+q":case"ctrl+shift+h":this.diagram.navigatePriorDiagam();break;case"ctrl+f":t(".influence-diagram").is(":visible")&&(this.$el.find(".node-finder input.searchNode").select2("open"),i=!0);break;case"ctrl+x":case"ctrl+c":if(r&&this.diagram.hasFocus()&&o&&o.length>0){var l=this.diagram.nodeSelector.currentSelection.slice(0),s={action:"copy",nodeList:[]};"ctrl+x"==a&&(s.action="move");for(var u=0;u<l.length;u++)s.nodeList.push({id:l[u].nodeData.id});this.diagram.jiggle(l,"move"==s.action),setTimeout(function(){d.diagram.stopJiggle(l)},500),this.diagramClipboard=s,i=!0}break;case"ctrl+v":r&&this.diagram.hasFocus()&&this.diagramClipboard&&(this.diagramClipboard.nodeList.map(function(e){e.moduleId=d.diagram.currentModule}),"copy"==this.diagramClipboard.action?this.diagram.copyNodes(this.diagramClipboard.nodeList):"move"==this.diagramClipboard.action&&this.diagram.moveNodesToModule(this.diagramClipboard.nodeList));break;case"ctrl+d":r&&this.diagram.duplicateNodes(o),i=!0;break;case"ctrl+right":r&&this.diagram.hasFocus()&&o&&o.length>0&&(this.diagram.alignNodes(o,2),i=!0);break;case"ctrl+left":r&&this.diagram.hasFocus()&&o&&o.length>0&&(this.diagram.alignNodes(o,0),i=!0);break;case"ctrl+up":r&&this.diagram.hasFocus()&&o&&o.length>0&&(this.diagram.alignNodes(o,4),i=!0);break;case"ctrl+down":r&&this.diagram.hasFocus()&&o&&o.length>0&&(this.diagram.alignNodes(o,6),i=!0);break;case"right":case"left":case"up":case"down":r&&this.diagram.hasFocus()&&o&&o.length>0&&(this.diagram.moveNodes(a),i=!0);break;case"ctrl+s":t(".btnSaveModel").is(":visible")&&t(".btnSaveModel").trigger("click"),i=!0;break;case"ctrl+a":r&&this.diagram.$el.trigger("selectAll"),i=!0;break;case"ctrl+b":r&&1===o.length&&this.diagram.showNumberFormatPopup(o),i=!0;break;case"ctrl+i":r&&this.diagram.makeSameSize(o,1),i=!0;break;case"ctrl+g":r&&this.diagram.makeSameSize(o,2),i=!0;break;case"ctrl+m":r&&this.diagram.createAlias(o),i=!0;break;case"ctrl+alt+i":r&&this.diagram.createInputNode(o),i=!0;break;case"ctrl+alt+o":r&&this.diagram.createOutputNode(o),i=!0;break;case"ctrl+0":case"ctrl+1":case"ctrl+2":case"ctrl+3":case"ctrl+4":case"ctrl+5":case"ctrl+6":case"ctrl+7":case"ctrl+8":case"ctrl+9":if(r){var g=a.substring(a.length-1);if(1===o.length){var h=["MODULE","LIBRARY","LINKMODULE","MODEL","TEXT","PICTURE"].includes(o[0].nodeClass.toUpperCase());if("TEXT"===o[0].nodeClass.toUpperCase())return e.preventDefault(),!1;if(h&&"2"===g)return t("#nodePropertiesDock").trigger("shortcutTabProps","3"),e.preventDefault(),!1}t("#nodePropertiesDock").trigger("shortcutTabProps",g)}i=!0;break;case"del":case 8:if(r&&this.diagram.hasFocus())if((o=this.diagram.getSelectedNodes())&&o.length>0){i=!0;d=this;n.e(5).then(function(){var e=[n(683)];(function(e){var a=(0,c.translate)("sure_delete_selected_nodes").replace("##count##",o.length);(new e).show({title:(0,c.translate)("delete_nodes"),text:a,buttons:[{title:(0,c.translate)("yes"),css:"primary",code:"yes"},{title:(0,c.translate)("cancel"),code:"cancel"}],callback:function(e){"yes"==e&&d.diagram.deleteSelectedNodes()},onClose:function(){d.diagram.setFocus(),d=null}})}).apply(null,e)}).catch(n.oe)}break;case"ctrl+alt+0":r&&o.length>1&&this.diagram.makeSameSize(o),i=!0}i&&e.preventDefault()}},quickEvaluateNode:function(e){"text"!=e.nodeClass&&"button"!=e.nodeClass&&n.e(10).then(function(){var a=[n(699)];(function(a){(new a).quickEvaluate({nodeData:e})}).apply(null,a)}).catch(n.oe)},openDocumentationModal:function(e){n.e(10).then(function(){var a=[n(699)];(function(a){(new a).openDocumentationModal({nodeData:e})}).apply(null,a)}).catch(n.oe)}})}.apply(a,o))||(e.exports=r)}).call(this,n(218),n(1))},1437:function(e,a,n){var i=n(690);e.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(e,a,i,t,o){return'<div class="container-fluid mainTask full-horizontal influence-diagram" style="position: relative;" data-rel="influence_diagram" data-type="tab-content" >\n\n        <div class="breadcrumbs nodisplay">\n\n            <div class="toolbar">\n\n            </div>\n\n             <div class="toolbar right">\n\n             </div>\n\n        </div>\n\n        <div class="row-fluid diagram-area">\n\n        </div>\n\n        <div class="node-finder">\n            <input type="text" class="searchNode nomargin" placeholder=\''+e.escapeExpression(function(e){return e&&(e.__esModule?e.default:e)}(n(688)).call(null!=a?a:e.nullContext||{},"search_node",{name:"L",hash:{},data:o,loc:{start:{line:20,column:72},end:{line:20,column:91}}}))+'\' />\n        </div>\n\n        <span class="diagramContextMenu"> </span>\n</div>\n'},useData:!0})},718:function(e,a,n){"use strict";(function(i){var t,o,r=n(18);function c(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(a){d(e,a,n[a])})}return e}function d(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}t=[n(1414)],void 0===(o=function(e){return i.Controller.extend({name:"influenceDiagram",showDiagram:function(a){new e(a).render()},showPermissionsModal:function(e,a){n.e(224).then(function(){var i=[n(1935)];(function(n){(new n).render(e,a)}).apply(null,i)}).catch(n.oe)},exportModuleModal:function(e){n.e(225).then(function(){var a=[n(1938)];(function(a){(new a).render(e)}).apply(null,a)}).catch(n.oe)},importModuleModal:function(){n.e(226).then(function(){var e=[n(1940)];(function(e){(new e).render()}).apply(null,e)}).catch(n.oe)},showModelPreferencesModal:function(e){n.e(227).then(function(){var a=[n(1943)];(function(a){new a(e).render()}).apply(null,a)}).catch(n.oe)},drawDashboardBars:function(e,a){this.drawToolbar(e,function(){a()})},drawToolbar:function(e,a){n.e(43).then(function(){var i=[n(755)];(function(n){(new n).show({el:e,positions:["top","bottom"],onLoad:a,className:"dockInfluenceDiagramProperty lightgrey bottom"})}).apply(null,i)}).catch(n.oe)},drawToolbarDiagram:function(e,a){Promise.all([n.e(306),n.e(228)]).then(function(){var i=[n(1945)];(function(n){var i=new n(a);i.setElement(e),i.render()}).apply(null,i)}).catch(n.oe)},showWizard:function(e,a,i){i={nodeData:a,modalClass:"smallModal"};Promise.all([n.e(15),n.e(229)]).then(function(){var e=[n(1955)];(function(e){new e(i).render(i)}).apply(null,e)}).catch(n.oe)},showInDiagram:function(e){Promise.resolve().then(function(){(function(a){var i=[n(684)];(function(n){var i=new n;i.existsTask("influence_diagram")?(i.selectTask("influence_diagram"),a(".mainTask.influence-diagram .diagram-area").trigger("navigateToNode",[e])):i.addTask("influence_diagram",(0,r.translate)("model"),{navigateToNode:e})}).apply(null,i)}).call(this,n(1))}).catch(n.oe)},selectColumsWizard:function(e,a){n.e(230).then(function(){var i=[n(1957)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,i)}).catch(n.oe)},selectRowsWizard:function(e,a){n.e(231).then(function(){var i=[n(1960)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,i)}).catch(n.oe)},calculatedFieldWizard:function(e,a){n.e(232).then(function(){var i=[n(1965)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,i)}).catch(n.oe)},pandasIndexWizard:function(e,a){Promise.all([n.e(15),n.e(233)]).then(function(){var i=[n(1967)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,i)}).catch(n.oe)},installLibsModal:function(e){n.e(234).then(function(){var a=[n(1969)];(function(a){(new a).render(e)}).apply(null,a)}).catch(n.oe)},setDataframeIndex:function(e,a){n.e(235).then(function(){var i=[n(1971)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,i)}).catch(n.oe)},dataframeGroupby:function(e,a){n.e(236).then(function(){var i=[n(1974)];(function(n){new n(c({},e,{callback:a})).render()}).apply(null,i)}).catch(n.oe)}})}.apply(a,t))||(e.exports=o)}).call(this,n(694))}}]);