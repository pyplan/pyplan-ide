/*! Copyright Novix S.A. 2019. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[230],{2002:function(n,a,e){"use strict";(function(l,s){var i,t,o=function(n){return n&&n.__esModule?n:{default:n}}(e(924)),d=e(18);function c(n,a,e){return a in n?Object.defineProperty(n,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[a]=e,n}i=[e(219),e(2003)],void 0===(t=function(n,a){return l.View.extend({el:s("#main"),currentFile:null,tableSchemaInstance:null,render:function(e){var l=this;this.$el.find("#main-modal").length>0||(new n).getFilesForImportWizard("csv",function(n){var i=a(function(n){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{},l=Object.keys(e);"function"==typeof Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(e).filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),l.forEach(function(a){c(n,a,e[a])})}return n}({},e,{files:n}));l.$el.append(i),s(".form-wizard").length>0&&(s(".form-wizard").formwizard({formPluginEnabled:!0,validationEnabled:!0,focusFirstInput:!1,disableUIStyles:!0,formOptions:{beforeSubmit:function(n){if(l.tableSchemaInstance){var a=l.tableSchemaInstance.getData(),e=[];s.each(a,function(n,a){a[2]&&e.push(a[0])}),l.refreshPreview(s(".selectEncoding").val(),s(".selectSeparator").val(),s(".selectRows").val(),e)}},dataType:"json",resetForm:!0}}),s(".form-wizard").bind("before_step_shown",function(n,a){a.isFirstStep?s(".wizardNext").hide():s(".wizardNext").show(),"thirdStep"===a.currentStep&&l.refreshPreview(s(".selectEncoding").val(),s(".selectSeparator").val(),s(".selectRows").val(),[],"getColumns")})),s(".csvModal").on("change",".selectEncoding, .selectSeparator, .selectRows",function(n){l.refreshPreview(s(".selectEncoding").val(),s(".selectSeparator").val(),s(".selectRows").val(),[],"readFile")}),s(".csvModal").on("click",".onReadUrl",function(n){l.currentFile=s("#main-modal").find(".txtUrl").val(),l.refreshPreview("auto","auto",200,[],"readFile"),s(".wizardNext").click()}),s(".csvModal").on("change",".selLocalFiles",function(n){l.currentFile=s("#main-modal").find(".selLocalFiles").val(),l.refreshPreview("auto","auto",200,[],"readFile"),s(".wizardNext").click()}),l.createUploader(),s("#modelInfoModal").length>0&&s("#modelInfoModal").modal("hide"),e.hasOwnProperty("html")&&s("#main-modal .modal-body").html(e.html),s("#main-modal .modal-footer button").click(function(){var n=!0;return e.callback&&!1===e.callback.call(this,s(this).attr("data-code"),s("#main-modal"))&&(n=!1),n&&(s("#main-modal").off("shown"),s("#main-modal").modal("hide")),!1}),s("#main-modal").on("show.bs.modal",function(){if(0===s("#main-modal:visible").length){var n=1040+10*s(".modal:visible").length;s(this).css("z-index",n),setTimeout(function(){s(".modal-backdrop").not(".modal-stack").css("z-index",n-10).addClass("modal-stack")},0),e.hasOwnProperty("onLoad")&&e.onLoad(s("#main-modal")),!0!==e.okOnEnter&&void 0!==e.okOnEnter||s("#main-modal").keyup(function(n){13==n.keyCode&&s("#main-modal button.btn-primary").click()})}}),s("#main-modal").on("hidden.bs.modal",function(){s("#main-modal").off("hidden"),e.hasOwnProperty("onClose")&&e.onClose(s("#main-modal")),s("#main-modal").remove()});var t=null;e.backdrop&&(t={backdrop:"static",keyboard:!1}),s("#main-modal").modal(t)})},createUploader:function(){var n=this,a=s("#plupload");s("#plupload").css("position","relative"),s("#plupload").css("z-index","1000"),s("#plupload").css("width","100%"),s("#plupload").css("height","300px"),a.pluploadQueue({runtimes:"html5",url:"".concat(__apiURL,"/fileManager/upload/"),headers:{Authorization:"Token ".concat(__currentToken),"session-key":__currentSession.session_key},file_data_name:"files",max_file_size:"0",chunk_size:"10mb",unique_names:!1,filters:{title:"Text and CSV",extensions:"txt,csv,gzip,zip"},flash_swf_url:"js/plupload/plupload.flash.swf",silverlight_xap_url:"js/plupload/plupload.silverlight.xap",multipart_params:{action:"uploadFileToModelFolder",folder_path:__currentSession.modelInfo.uri.substring(0,__currentSession.modelInfo.uri.lastIndexOf("/"))},init:{FilesAdded:function(n,a){s(".fileError").hide(),n.start(),s("#plupload_browse").prop("disabled",!0),s("#plupload_browse").hide(),s("#uploading").show()},UploadComplete:function(a,e){n.currentFile=e[0].name,n.refreshPreview("auto","auto",200,[],"readFile"),s(".wizardNext").click(),a.splice(),a.refresh(),s("#plupload_browse").prop("disabled",!1),s("#plupload_browse").show(),s("#uploading").hide()},FileUploaded:function(n,a,e){},Error:function(n,a){(0,d.showMessage)(a.code+": "+a.message,null,"error")}}}),s(".plupload_filelist_footer").css("height","auto"),s(".plupload_header").remove(),s(".plupload_progress_container").addClass("progress").addClass("progress-striped"),s(".plupload_progress_bar").addClass("bar"),s(".plupload_button").each(function(){s(this).hasClass("plupload_add")?(s(this).attr("class","btn plupload_add btn-primary").html("<i class='fa fa-plus-circle'></i> "+s(this).html()),s(this).addClass("btn-small")):(s(this).attr("class","btn plupload_start btn-success").html("<i class='fa fa-cloud-upload'></i> "+s(this).html()),s(this).hide())}),s("#plupload_filelist").bind("drop",function(n){var e=(a=s("#plupload")).pluploadQueue();e.splice(),e.refresh()}).bind("dragleave",function(n){return!1})},refreshPreview:function(n,a,l,i,t){var o=this,d={wizard:"sourcecsv",action:t,params:{filename:o.currentFile,encoding:n,sep:a,rows:l}};"Submit"===s(".wizardNext").val()&&(d.action="generateDefinition",d.params.nodeId=o.options.nodeData.identifier),i.length>0&&(d.params.indexes=i),Promise.resolve().then(function(){var n=[e(219)];(function(n){(new n).callWizard(d,function(n){"ok"===n?(s("#main-modal").modal("hide"),e.e(22).then(function(){var n=[e(742)];(function(n){o.options.nodeData.id||(o.options.nodeData.id=o.options.nodeData.identifier),(new n).loadDefinitionTab(o.options.nodeData,!1,".btnTabWizard")}).apply(null,n)}).catch(e.oe)):"getColumns"===t?o.initSchemaGrid(n):o.initGrid(n.result)},function(n){})}).apply(null,n)}).catch(e.oe)},initGrid:function(n){for(var a=n.schema.fields,e={columns:[],data:n.data,colHeaders:[],height:450,stretchH:"all",readOnly:!0},l=0;l<a.length;l++){var i={};i.data=a[l].name,e.colHeaders.push(a[l].name),e.columns.push(i)}var t=s(".handsonGrid").get(0);setTimeout(function(){new o.default(t,e)},500)},initSchemaGrid:function(n){var a=this,e={columns:[{data:"field",readOnly:!0},{data:"dtype",readOnly:!0},{data:"isIndex",type:"checkbox"}],data:n.map(function(n){return n.isIndex="index"===n.type,n}),colHeaders:["Field","Type","Is index"],colWidths:[null,15,10],height:450,stretchH:"all",manualColumnResize:!0,manualRowResize:!0,afterRenderer:function(n,a,e){2===e&&s(n).css("text-align","center")}},l=s(".handsonSchema").get(0);setTimeout(function(){a.tableSchemaInstance=new o.default(l,e)},500)}})}.apply(a,i))||(n.exports=t)}).call(this,e(218),e(1))},2003:function(n,a,e){var l=e(690);n.exports=(l.default||l).template({1:function(n,a,e,l,s){var i,t,o=n.escapeExpression;return'                        <option value="'+o(n.lambda(null!=(i=null!=a?a.data:a)?i.fullPath:i,a))+'">'+o("function"==typeof(t=null!=(t=e.text||(null!=a?a.text:a))?t:e.helperMissing)?t.call(null!=a?a:n.nullContext||{},{name:"text",hash:{},data:s}):t)+"</option>\n"},3:function(n,a,e,l,s){var i,t=null!=a?a:n.nullContext||{},o=e.helperMissing,d=n.escapeExpression;return'        <button class="btn btn-'+d("function"==typeof(i=null!=(i=e.css||(null!=a?a.css:a))?i:o)?i.call(t,{name:"css",hash:{},data:s}):i)+'" data-code="'+d("function"==typeof(i=null!=(i=e.code||(null!=a?a.code:a))?i:o)?i.call(t,{name:"code",hash:{},data:s}):i)+'" data-dismiss="modal" aria-hidden="true">'+d("function"==typeof(i=null!=(i=e.title||(null!=a?a.title:a))?i:o)?i.call(t,{name:"title",hash:{},data:s}):i)+"</button>\n"},compiler:[7,">= 4.0.0"],main:function(n,a,e,l,s){var i,t,o=null!=a?a:n.nullContext||{};return'<div id="main-modal" class="modal fade csvModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"\n  aria-hidden="true" style="display: none;">\n  <div class="modal-dialog '+n.escapeExpression("function"==typeof(t=null!=(t=e.modalClass||(null!=a?a.modalClass:a))?t:e.helperMissing)?t.call(o,{name:"modalClass",hash:{},data:s}):t)+'">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>\n        <h4 class="modal-title" id="myModalLabel">CSV Data source</h4>\n      </div>\n\n      <div class="modal-body" style="overflow-y:auto; overflow-x: hidden;">\n        <div class="box-content">\n          <form class="form-horizontal form-wizard ui-formwizard" id="csvForm" novalidate="novalidate">\n            <div class="step ui-formwizard-content" id="firstStep" style="display: block;">\n              <ul class="wizard-steps steps-3">\n                <li class="active">\n                  <div class="single-step">\n                    <span class="title">\n                      1</span>\n                    <span class="circle">\n                      <span class="active"></span>\n                    </span>\n                    <span class="description">\n                      Read CSV file\n                    </span>\n                  </div>\n                </li>\n                <li>\n                  <div class="single-step">\n                    <span class="title">\n                      2</span>\n                    <span class="circle">\n                    </span>\n                    <span class="description">\n                      Data Preview\n                    </span>\n                  </div>\n                </li>\n                <li>\n                  <div class="single-step">\n                    <span class="title">\n                      3</span>\n                    <span class="circle">\n                    </span>\n                    <span class="description">\n                      Schema\n                    </span>\n                  </div>\n                </li>\n              </ul>\n              <div class="step-forms">\n                <div class="fileError" style="display: none;">ERROR FILE FORMAT</div>\n\n                <div id="plupload">\n                </div>\n\n                <span class="lblSeparator">OR</span>\n                <div class="separator"></div>\n                <div style="clear:both;"></div>\n\n                <div class="row">\n                  <div class="form-group">\n                    <label for="textfield" class="control-label col-sm-3" style="text-align:left;">\n                      From server:\n                    </label>\n                    <div class="col-sm-9">\n                      <select name="select" class="form-control selLocalFiles">\n                        <option value=""> Select a file </option>\n'+(null!=(i=e.each.call(o,null!=a?a.files:a,{name:"each",hash:{},fn:n.program(1,s,0),inverse:n.noop,data:s}))?i:"")+'\n                      </select>\n                    </div>\n                  </div>\n                </div>\n\n                <span class="lblSeparator">OR</span>\n                <div class="separator"></div>\n                <div style="clear:both;"></div>\n\n                <div class="row">\n                  <div class="form-group">\n                    <label for="textfield" class="control-label col-sm-3" style="text-align:left;">\n                      From URL:\n                    </label>\n                    <div class="col-sm-9">\n                      <div class="input-group">\n                        <input type="text" placeholder="http://yoururl/file.csv" class="form-control txtUrl">\n                        <div class="input-group-btn">\n                          <button class="btn btn-primary onReadUrl" type="button">Read</button>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n              </div>\n            </div>\n            <div class="step ui-formwizard-content" id="secondStep" style="display: none;">\n              <ul class="wizard-steps steps-3">\n                <li>\n                  <div class="single-step">\n                    <span class="title">\n                      1</span>\n                    <span class="circle">\n\n                    </span>\n                    <span class="description">\n                      Read CSV file\n                    </span>\n                  </div>\n                </li>\n                <li class="active">\n                  <div class="single-step">\n                    <span class="title">\n                      2</span>\n                    <span class="circle">\n                      <span class="active"></span>\n                    </span>\n                    <span class="description">\n                      Data Preview\n                    </span>\n                  </div>\n                </li>\n                <li>\n                  <div class="single-step">\n                    <span class="title">\n                      3</span>\n                    <span class="circle">\n                    </span>\n                    <span class="description">\n                      Schema\n                    </span>\n                  </div>\n                </li>\n              </ul>\n              <div class="form-group">\n\n                <div class="row">\n                  <div class="col-sm-4">\n                    <div class="form-group">\n                      <label for="textfield" class="control-label">Encoding</label>\n                      <select name="select" class="form-control selectEncoding">\n                        <option value="auto">Auto</option>\n                        <option value="ascii">us-ascii</option>\n                        <option value="cp850">IBM850</option>\n                        <option value="cp852">IBM852</option>\n                        <option value="cp1251">windows-1251</option>\n                        <option value="cp1252">windows-1252</option>\n                        <option value="utf_8">UTF-8</option>\n                        <option value="utf_16">UTF-16</option>\n                        <option value="latin_1">latin1</option>\n                      </select>\n                    </div>\n                  </div>\n                  <div class="col-sm-4">\n                    <div class="form-group">\n                      <label for="textfield" class="control-label">Separator</label>\n                      <select name="select" class="form-control selectSeparator">\n                        <option value="auto">Auto</option>\n                        <option value=","> , </option>\n                        <option value=";"> ; </option>\n                        <option value="\t">Tab</option>\n                        <option value=" ">Space</option>\n                        <option value="|"> | </option>\n                      </select>\n                    </div>\n                  </div>\n                  <div class="col-sm-4">\n                    <div class="form-group">\n                      <label for="textfield" class="control-label">Rows</label>\n                      <select name="select" class="form-control selectRows">\n                        <option value="10">10</option>\n                        <option value="50">50</option>\n                        <option value="100">100</option>\n                        <option value="200" selected>200</option>\n                        <option value="500">500</option>\n                        <option value="1000">1000</option>\n                      </select>\n                    </div>\n                  </div>\n                </div>\n\n                <div class="row">\n                  <div class="col-sm-12">\n                    <div class="handsonGrid" style="width:100%; height:100%;"></div>\n                  </div>\n                </div>\n\n              </div>\n\n            </div>\n            <div class="step ui-formwizard-content" id="thirdStep" style="display: none;">\n              <ul class="wizard-steps steps-3">\n                <li>\n                  <div class="single-step">\n                    <span class="title">\n                      1</span>\n                    <span class="circle">\n\n                    </span>\n                    <span class="description">\n                      Read CSV file\n                    </span>\n                  </div>\n                </li>\n                <li>\n                  <div class="single-step">\n                    <span class="title">\n                      2</span>\n                    <span class="circle">\n\n                    </span>\n                    <span class="description">\n                      Data Preview\n                    </span>\n                  </div>\n                </li>\n                <li class="active">\n                  <div class="single-step">\n                    <span class="title">\n                      3</span>\n                    <span class="circle">\n                      <span class="active"></span>\n                    </span>\n                    <span class="description">\n                      Schema\n                    </span>\n                  </div>\n                </li>\n              </ul>\n              <div class="form-group">\n                <div class="row">\n                  <div class="col-sm-12">\n                    <div class="handsonSchema" style="width:100%; height:100%;"></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div class="form-actions">\n              <input type="reset" class="btn ui-wizard-content ui-formwizard-button" value="Back" id="back">\n              <input type="submit" class="btn btn-primary ui-wizard-content ui-formwizard-button wizardNext nodisplay"\n                value="Next" id="next">\n            </div>\n          </form>\n        </div>\n      </div>\n      <div class="modal-footer">\n'+(null!=(i=e.each.call(o,null!=a?a.buttons:a,{name:"each",hash:{},fn:n.program(3,s,0),inverse:n.noop,data:s}))?i:"")+"      </div>\n    </div>\n  </div>\n</div>"},useData:!0})}}]);