/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[235],{1961:function(n,e,a){"use strict";(function(l,t){var s,i,o=function(n){return n&&n.__esModule?n:{default:n}}(a(883)),c=a(18);function r(n){return function(n){if(Array.isArray(n)){for(var e=0,a=new Array(n.length);e<n.length;e++)a[e]=n[e];return a}}(n)||function(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(n,e){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);e&&(l=l.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),a.push.apply(a,l)}return a}function p(n,e,a){return e in n?Object.defineProperty(n,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[e]=a,n}s=[a(219),a(1962)],void 0===(i=function(n,e){return l.View.extend({el:t("#main"),currentFile:null,tableSchemaInstance:null,render:function(a){var l=this;this.$el.find("#main-modal").length>0||(new n).getFilesForImportWizard("csv",function(n){var s=e(function(n){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?d(a,!0).forEach(function(e){p(n,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):d(a).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))})}return n}({},a,{files:n}));l.$el.append(s),t(".form-wizard").length>0&&(t(".form-wizard").formwizard({formPluginEnabled:!0,validationEnabled:!0,focusFirstInput:!1,disableUIStyles:!0,formOptions:{beforeSubmit:function(n){if(l.tableSchemaInstance){var e=l.tableSchemaInstance.getData(),a=[];t.each(e,function(n,e){e[2]&&a.push(e[0])}),l.refreshPreview(t(".selectEncoding").val(),t(".selectSeparator").val(),t(".selectRows").val(),a)}},dataType:"json",resetForm:!0}}),t(".form-wizard").bind("before_step_shown",function(n,e){e.isFirstStep?t(".wizardNext").hide():t(".wizardNext").show(),"thirdStep"===e.currentStep&&l.refreshPreview(t(".selectEncoding").val(),t(".selectSeparator").val(),t(".selectRows").val(),[],"getColumns")})),t(".csvModal").on("change",".selectEncoding, .selectSeparator, .selectRows",function(n){l.refreshPreview(t(".selectEncoding").val(),t(".selectSeparator").val(),t(".selectRows").val(),[],"readFile")}),t(".csvModal").on("click",".onReadUrl",function(n){l.currentFile=t("#main-modal").find(".txtUrl").val(),l.refreshPreview("auto","auto",200,[],"readFile"),t(".wizardNext").click()}),t(".csvModal").on("change",".selLocalFiles",function(n){l.currentFile=t("#main-modal").find(".selLocalFiles").val(),l.refreshPreview("auto","auto",200,[],"readFile"),t(".wizardNext").click()}),l.createUploader(),t("#modelInfoModal").length>0&&t("#modelInfoModal").modal("hide"),a.hasOwnProperty("html")&&t("#main-modal .modal-body").html(a.html),t("#main-modal .modal-footer button").click(function(){var n=!0;return a.callback&&!1===a.callback.call(this,t(this).attr("data-code"),t("#main-modal"))&&(n=!1),n&&(t("#main-modal").off("shown"),t("#main-modal").modal("hide")),!1}),t("#main-modal").on("show.bs.modal",function(){if(0===t("#main-modal:visible").length){var n=1040+10*t(".modal:visible").length;t(this).css("z-index",n),setTimeout(function(){t(".modal-backdrop").not(".modal-stack").css("z-index",n-10).addClass("modal-stack")},0),a.hasOwnProperty("onLoad")&&a.onLoad(t("#main-modal")),!0!==a.okOnEnter&&void 0!==a.okOnEnter||t("#main-modal").keyup(function(n){13==n.keyCode&&t("#main-modal button.btn-primary").click()})}}),t("#main-modal").on("hidden.bs.modal",function(){t("#main-modal").off("hidden"),a.hasOwnProperty("onClose")&&a.onClose(t("#main-modal")),t("#main-modal").remove()});var i=null;a.backdrop&&(i={backdrop:"static",keyboard:!1}),t("#main-modal").modal(i)})},createUploader:function(){var n=this,e=t("#plupload");t("#plupload").css("position","relative"),t("#plupload").css("z-index","1000"),t("#plupload").css("width","100%"),t("#plupload").css("height","300px"),e.pluploadQueue({runtimes:"html5",url:"".concat(__apiURL,"/fileManager/upload/"),headers:{Authorization:"Token ".concat(__currentToken),"session-key":__currentSession.session_key},file_data_name:"files",max_file_size:"0",chunk_size:"10mb",unique_names:!1,filters:{title:"Text and CSV",extensions:"txt,csv,gzip,zip"},flash_swf_url:"js/plupload/plupload.flash.swf",silverlight_xap_url:"js/plupload/plupload.silverlight.xap",multipart_params:{action:"uploadFileToModelFolder",folder_path:__currentSession.modelInfo.uri.substring(0,__currentSession.modelInfo.uri.lastIndexOf("/"))},init:{FilesAdded:function(n,e){t(".fileError").hide(),n.start(),t("#plupload_browse").prop("disabled",!0),t("#plupload_browse").hide(),t("#uploading").show()},UploadComplete:function(e,a){n.currentFile=a[0].name,n.refreshPreview("auto","auto",200,[],"readFile"),t(".wizardNext").click(),e.splice(),e.refresh(),t("#plupload_browse").prop("disabled",!1),t("#plupload_browse").show(),t("#uploading").hide()},FileUploaded:function(n,e,a){},Error:function(n,e){(0,c.showMessage)(e.code+": "+e.message,null,"error")}}}),t(".plupload_filelist_footer").css("height","auto"),t(".plupload_header").remove(),t(".plupload_progress_container").addClass("progress").addClass("progress-striped"),t(".plupload_progress_bar").addClass("bar"),t(".plupload_button").each(function(){t(this).hasClass("plupload_add")?(t(this).attr("class","btn plupload_add btn-primary").html("<i class='fa fa-plus-circle'></i> "+t(this).html()),t(this).addClass("btn-small")):(t(this).attr("class","btn plupload_start btn-success").html("<i class='fa fa-cloud-upload'></i> "+t(this).html()),t(this).hide())}),t("#plupload_filelist").bind("drop",function(n){var a=(e=t("#plupload")).pluploadQueue();a.splice(),a.refresh()}).bind("dragleave",function(n){return!1})},refreshPreview:function(n,e,l,s,i){var o=this,c={wizard:"sourcecsv",action:i,params:{filename:o.currentFile,encoding:n,sep:e,rows:l}};"Submit"===t(".wizardNext").val()&&(c.action="generateDefinition",c.params.nodeId=o.options.nodeData.identifier),s.length>0&&(c.params.indexes=s),Promise.resolve().then(function(){var n=[a(219)];(function(n){(new n).callWizard(c,function(n){"ok"===n?(t("#main-modal").modal("hide"),a.e(20).then(function(){var n=[a(739)];(function(n){o.options.nodeData.id||(o.options.nodeData.id=o.options.nodeData.identifier),(new n).loadDefinitionTab(o.options.nodeData,!1,".btnTabWizard")}).apply(null,n)}).catch(a.oe)):"getColumns"===i?o.initSchemaGrid(n):o.initGrid(n.result)},function(n){})}).apply(null,n)}).catch(a.oe)},initGrid:function(n){for(var e=n.schema.fields,a={columns:[],data:n.data,colHeaders:[],height:450,stretchH:"all",readOnly:!0},l=0;l<e.length;l++){var s={};s.data=e[l].name,a.colHeaders.push(e[l].name),a.columns.push(s)}var i=t(".handsonGrid").get(0);setTimeout(function(){new o.default(i,a)},500)},initSchemaGrid:function(n){var e=this,a=t(".btnSelectAll"),l=t(".btnUnselectAll"),s={columns:[{data:"field",readOnly:!0},{data:"dtype",readOnly:!0},{data:"isIndex",type:"checkbox"}],data:n.map(function(n){return n.isIndex="index"===n.type,n}),colHeaders:["Field","Type","Is index"],colWidths:[null,15,10],height:450,stretchH:"all",manualColumnResize:!0,manualRowResize:!0,afterRenderer:function(n,e,a){2===a&&t(n).css("text-align","center")}},i=t(".handsonSchema").get(0);setTimeout(function(){e.tableSchemaInstance=new o.default(i,s),a.on("click",function(n){n.preventDefault(),n.stopPropagation();var a=e.tableSchemaInstance.countRows();r(Array(a)).forEach(function(n,a){e.tableSchemaInstance.setDataAtCell(a,2,!0)})}),l.on("click",function(n){n.preventDefault(),n.stopPropagation();var a=e.tableSchemaInstance.countRows();r(Array(a)).forEach(function(n,a){e.tableSchemaInstance.setDataAtCell(a,2,!1)})})},500)}})}.apply(e,s))||(n.exports=i)}).call(this,a(218),a(1))},1962:function(n,e,a){var l=a(690);n.exports=(l.default||l).template({1:function(n,e,a,l,t){var s,i,o=n.escapeExpression;return'                        <option value="'+o(n.lambda(null!=(s=null!=e?e.data:e)?s.fullPath:s,e))+'">'+o("function"==typeof(i=null!=(i=a.text||(null!=e?e.text:e))?i:n.hooks.helperMissing)?i.call(null!=e?e:n.nullContext||{},{name:"text",hash:{},data:t,loc:{start:{line:69,column:58},end:{line:69,column:66}}}):i)+"</option>\n"},3:function(n,e,a,l,t){var s,i=null!=e?e:n.nullContext||{},o=n.hooks.helperMissing,c=n.escapeExpression;return'        <button class="btn btn-'+c("function"==typeof(s=null!=(s=a.css||(null!=e?e.css:e))?s:o)?s.call(i,{name:"css",hash:{},data:t,loc:{start:{line:261,column:31},end:{line:261,column:38}}}):s)+'" data-code="'+c("function"==typeof(s=null!=(s=a.code||(null!=e?e.code:e))?s:o)?s.call(i,{name:"code",hash:{},data:t,loc:{start:{line:261,column:51},end:{line:261,column:59}}}):s)+'" data-dismiss="modal" aria-hidden="true">'+c("function"==typeof(s=null!=(s=a.title||(null!=e?e.title:e))?s:o)?s.call(i,{name:"title",hash:{},data:t,loc:{start:{line:261,column:101},end:{line:261,column:110}}}):s)+"</button>\n"},compiler:[8,">= 4.3.0"],main:function(n,e,a,l,t){var s,i,o=null!=e?e:n.nullContext||{};return'<div id="main-modal" class="modal fade csvModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"\n  aria-hidden="true" style="display: none;">\n  <div class="modal-dialog '+n.escapeExpression("function"==typeof(i=null!=(i=a.modalClass||(null!=e?e.modalClass:e))?i:n.hooks.helperMissing)?i.call(o,{name:"modalClass",hash:{},data:t,loc:{start:{line:3,column:27},end:{line:3,column:41}}}):i)+'">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>\n        <h4 class="modal-title" id="myModalLabel">CSV Data source</h4>\n      </div>\n\n      <div class="modal-body" style="overflow-y:auto; overflow-x: hidden;">\n        <div class="box-content">\n          <form class="form-horizontal form-wizard ui-formwizard" id="csvForm" novalidate="novalidate">\n            <div class="step ui-formwizard-content" id="firstStep" style="display: block;">\n              <ul class="wizard-steps steps-3">\n                <li class="active">\n                  <div class="single-step">\n                    <span class="title">\n                      1</span>\n                    <span class="circle">\n                      <span class="active"></span>\n                    </span>\n                    <span class="description">\n                      Read CSV file\n                    </span>\n                  </div>\n                </li>\n                <li>\n                  <div class="single-step">\n                    <span class="title">\n                      2</span>\n                    <span class="circle">\n                    </span>\n                    <span class="description">\n                      Data Preview\n                    </span>\n                  </div>\n                </li>\n                <li>\n                  <div class="single-step">\n                    <span class="title">\n                      3</span>\n                    <span class="circle">\n                    </span>\n                    <span class="description">\n                      Schema\n                    </span>\n                  </div>\n                </li>\n              </ul>\n              <div class="step-forms">\n                <div class="fileError" style="display: none;">ERROR FILE FORMAT</div>\n\n                <div id="plupload">\n                </div>\n\n                <span class="lblSeparator">OR</span>\n                <div class="separator"></div>\n                <div style="clear:both;"></div>\n\n                <div class="row">\n                  <div class="form-group">\n                    <label for="textfield" class="control-label col-sm-3" style="text-align:left;">\n                      From server:\n                    </label>\n                    <div class="col-sm-9">\n                      <select name="select" class="form-control selLocalFiles">\n                        <option value=""> Select a file </option>\n'+(null!=(s=a.each.call(o,null!=e?e.files:e,{name:"each",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t,loc:{start:{line:68,column:24},end:{line:70,column:33}}}))?s:"")+'\n                      </select>\n                    </div>\n                  </div>\n                </div>\n\n                <span class="lblSeparator">OR</span>\n                <div class="separator"></div>\n                <div style="clear:both;"></div>\n\n                <div class="row">\n                  <div class="form-group">\n                    <label for="textfield" class="control-label col-sm-3" style="text-align:left;">\n                      From URL:\n                    </label>\n                    <div class="col-sm-9">\n                      <div class="input-group">\n                        <input type="text" placeholder="http://yoururl/file.csv" class="form-control txtUrl">\n                        <div class="input-group-btn">\n                          <button class="btn btn-primary onReadUrl" type="button">Read</button>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n              </div>\n            </div>\n            <div class="step ui-formwizard-content" id="secondStep" style="display: none;">\n              <ul class="wizard-steps steps-3">\n                <li>\n                  <div class="single-step">\n                    <span class="title">\n                      1</span>\n                    <span class="circle">\n\n                    </span>\n                    <span class="description">\n                      Read CSV file\n                    </span>\n                  </div>\n                </li>\n                <li class="active">\n                  <div class="single-step">\n                    <span class="title">\n                      2</span>\n                    <span class="circle">\n                      <span class="active"></span>\n                    </span>\n                    <span class="description">\n                      Data Preview\n                    </span>\n                  </div>\n                </li>\n                <li>\n                  <div class="single-step">\n                    <span class="title">\n                      3</span>\n                    <span class="circle">\n                    </span>\n                    <span class="description">\n                      Schema\n                    </span>\n                  </div>\n                </li>\n              </ul>\n              <div class="form-group">\n\n                <div class="row">\n                  <div class="col-sm-4">\n                    <div class="form-group">\n                      <label for="textfield" class="control-label">Encoding</label>\n                      <select name="select" class="form-control selectEncoding">\n                        <option value="auto">Auto</option>\n                        <option value="ascii">us-ascii</option>\n                        <option value="cp850">IBM850</option>\n                        <option value="cp852">IBM852</option>\n                        <option value="cp1251">windows-1251</option>\n                        <option value="cp1252">windows-1252</option>\n                        <option value="utf_8">UTF-8</option>\n                        <option value="utf_16">UTF-16</option>\n                        <option value="latin_1">latin1</option>\n                      </select>\n                    </div>\n                  </div>\n                  <div class="col-sm-4">\n                    <div class="form-group">\n                      <label for="textfield" class="control-label">Separator</label>\n                      <select name="select" class="form-control selectSeparator">\n                        <option value="auto">Auto</option>\n                        <option value=","> , </option>\n                        <option value=";"> ; </option>\n                        <option value="\t">Tab</option>\n                        <option value=" ">Space</option>\n                        <option value="|"> | </option>\n                      </select>\n                    </div>\n                  </div>\n                  <div class="col-sm-4">\n                    <div class="form-group">\n                      <label for="textfield" class="control-label">Rows</label>\n                      <select name="select" class="form-control selectRows">\n                        <option value="10">10</option>\n                        <option value="50">50</option>\n                        <option value="100">100</option>\n                        <option value="200" selected>200</option>\n                        <option value="500">500</option>\n                        <option value="1000">1000</option>\n                      </select>\n                    </div>\n                  </div>\n                </div>\n\n                <div class="row">\n                  <div class="col-sm-12">\n                    <div class="handsonGrid" style="width:100%; height:100%;"></div>\n                  </div>\n                </div>\n\n              </div>\n\n            </div>\n            <div class="step ui-formwizard-content" id="thirdStep" style="display: none;">\n              <ul class="wizard-steps steps-3">\n                <li>\n                  <div class="single-step">\n                    <span class="title">\n                      1</span>\n                    <span class="circle">\n\n                    </span>\n                    <span class="description">\n                      Read CSV file\n                    </span>\n                  </div>\n                </li>\n                <li>\n                  <div class="single-step">\n                    <span class="title">\n                      2</span>\n                    <span class="circle">\n\n                    </span>\n                    <span class="description">\n                      Data Preview\n                    </span>\n                  </div>\n                </li>\n                <li class="active">\n                  <div class="single-step">\n                    <span class="title">\n                      3</span>\n                    <span class="circle">\n                      <span class="active"></span>\n                    </span>\n                    <span class="description">\n                      Schema\n                    </span>\n                  </div>\n                </li>\n              </ul>\n              <div class="form-group">\n                <div class="row">\n                  <div class="col-sm-12">\n                    <div class="handsonActions text-right">\n                      <button type=\'button\' class=\'btn btn-green btnSelectAll\' rel=\'tooltip\'\n                        data-original-title=\'Select All\'>\n                        <i class=\'fa fa-check\' />Select All\n                      </button>\n                      <button type=\'button\' class=\'btn btn-orange btnUnselectAll\' rel=\'tooltip\'\n                        data-original-title=\'Unselect All\'>\n                        <i class="fa fa-times" /> Unselect All\n                      </button>\n                    </div>\n                    <div class="handsonSchema" style="width:100%; height:100%;"></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div class="form-actions">\n              <input type="reset" class="btn ui-wizard-content ui-formwizard-button" value="Back" id="back">\n              <input type="submit" class="btn btn-primary ui-wizard-content ui-formwizard-button wizardNext nodisplay"\n                value="Next" id="next">\n            </div>\n          </form>\n        </div>\n      </div>\n      <div class="modal-footer">\n'+(null!=(s=a.each.call(o,null!=e?e.buttons:e,{name:"each",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t,loc:{start:{line:260,column:8},end:{line:262,column:17}}}))?s:"")+"      </div>\n    </div>\n  </div>\n</div>"},useData:!0})}}]);