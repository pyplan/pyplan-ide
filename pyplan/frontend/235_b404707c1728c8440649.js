/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[235],{1971:function(n,a,e){"use strict";(function(t,l){var i,o,s=e(18);i=[e(219),e(1972),e(1973)],void 0===(o=function(n,a,i){return t.View.extend({el:l("#main"),render:function(n){if(!(this.$el.find(".manageLibsModal").length>0)){var t=this;t.isRefreshing=!1,n.notDesktop=!1,n.canSaveModel=this.canSaveModel(),n.cantSaveModel=!n.canSaveModel,n.buttons=n.canSaveModel?[{title:(0,s.translate)("save_model_and_close"),code:"save",icon:"<i class='fad fa-save'></i>",css:"primary"}]:[{title:(0,s.translate)("close"),code:"cancel"}];var i=a(n);this.$el.append(i);var o=l(".manageLibsModal");t.getData(),o.find(".modal-footer button").click(function(a){a.preventDefault();var i=!0,r=l(this).attr("data-code");return n.callback&&!1===n.callback.call(this,r,o)&&(i=!1),i&&(t.toggleButtons(o,!0),"save"==r?(t.toggleButtons(o,!0),Promise.resolve().then(function(){var n=[e(219)];(function(n){(new n).saveModel(function(){l("body").trigger("pendingChanges",[!1]),(0,s.showMessage)((0,s.translate)("model_successfully_saved")," ","success",!0),o.off("shown"),o.modal("hide")})}).apply(null,n)}).catch(e.oe),t.toggleButtons(o,!1)):(o.off("shown"),o.modal("hide"))),!1}),o.on("show.bs.modal",function(){if(0===l(".manageLibsModal:visible").length){var a=100014+10*l(".modal:visible").length;l(this).css("z-index",a),setTimeout(function(){l(".modal-backdrop").not(".modal-stack").css("z-index",a-10).addClass("modal-stack")},0),n.hasOwnProperty("onLoad")&&n.onLoad(o),!0!==n.okOnEnter&&void 0!==n.okOnEnter||o.keyup(function(n){13==n.keyCode&&o.find("button.btn-primary").click()})}}),o.on("hidden.bs.modal",function(){o.off("hidden"),n.hasOwnProperty("onClose")&&n.onClose(o),o.remove()}),o.modal(n.backdrop?{backdrop:"static",keyboard:!1}:null),t.addHandlers(o)}},getData:function(){var a=this;if(!this.isRefreshing){this.isRefreshing=!0;var e=["pip","setuptools"];//!IMPORTANT libs that are installed in /data/models/<companyname>/<username>/.venv/ but are system libraries
(new n).listInstalledLibraries(function(n){var t={libraries:n.map(function(n){return n.isSystem=!0,"/usr"==n.location.substring(0,4)||e.includes(n.name)||(n.isSystem=!1),n})};a.instantiateTable(a,t)})}},instantiateTable:function(n,a){var t=l(".manageLibsModal"),o=t.find(".manageLibsTable");l.fn.dataTable.isDataTable(t.find(".manageLibsTable"))&&o.DataTable().clear().destroy(),o.find(".thName").width("25%"),o.find(".thVersion").width("25%"),o.find(".thSystem").width("25%"),o.find(".thActions").width("25%");var r=[{data:"name"},{data:null,render:function(n,a,e){var t=null;return n?(t=l('<div><span class="badge">'.concat(n.version,"</span></div>"))).prop("outerHTML"):t}},{data:null,render:function(n,a,e){var t=l('<div><span class="badge badge-info">user lib</span></div>');return n&&n.isSystem&&(t=l('<div style="color:#368ee0;"><span class="badge badge-primary">system lib</span></div>')),t.prop("outerHTML")}},{data:null,render:function(a,e,t){var i=null;return a&&!a.isSystem&&n.canSaveModel()?(i=l('<div><button class="btn btn-mini btn-red btnRemoveLibrary" data-original-title="'.concat((0,s.translate)("remove_library"),'" rel="tooltip" data-title="').concat((0,s.translate)("remove_library"),'"><i class="fas fa-trash"></i></button></div>'))).prop("outerHTML"):i}}];o.find(".thName").width("34%"),o.find(".thVersion").width("33%"),o.find(".thActions").width("33%"),r=[{data:"name"},{data:null,render:function(n,a,e){var t=null;return n?(t=l('<div><span class="badge">'.concat(n.version,"</span></div>"))).prop("outerHTML"):t}},{data:null,render:function(a,e,t){var i=null;return a&&!a.isSystem&&n.canSaveModel()?(i=l('<div><button class="btn btn-mini btn-red btnRemoveLibrary" data-original-title="'.concat((0,s.translate)("remove_library"),'" rel="tooltip" data-title="').concat((0,s.translate)("remove_library"),'"><i class="fas fa-trash"></i></button></div>'))).prop("outerHTML"):i}}];var d=o.DataTable({pageLength:10,lengthChange:!1,data:a.libraries,order:[[2,"desc"]],columns:r,initComplete:function(){l(".manageLibsTable tbody").off("click",".btnRemoveLibrary"),l(".manageLibsTable tbody").on("click",".btnRemoveLibrary",function(a){a.preventDefault();var o=d.row(l(this).closest("tr")).data(),r={title:(0,s.translate)("remove_library"),content:i({name:o.name}),left:a.clientX,top:a.clientY};e.e(12).then(function(){var a=[e(735)];(function(a){(new a).show(r,function(a){var i=l("#".concat(a.options.id));i.find(".cancelRemoveLib").on("click",function(n){i.trigger("hide")}),i.find(".confirmRemoveLib").on("click",function(a){i.trigger("hide"),n.toggleButtons(t,!0),Promise.resolve().then(function(){var a=[e(219)];(function(a){(new a).uninstallLibrary(o.name,o.location,function(a){(0,s.showMessage)((0,s.translate)("library_successfully_removed")," ","success",!0),n.toggleButtons(t),n.getData()})}).apply(null,a)}).catch(e.oe)})})}).apply(null,a)}).catch(e.oe)})}});n.isRefreshing=!1},addHandlers:function(n){var a=this;n.find(".btnAddLibrary").on("click",function(n){n.preventDefault(),Promise.resolve().then(function(){var n=[e(714)];(function(n){(new n).installLibsModal({title:(0,s.translate)("install_libraries"),okOnEnter:!0,modalClass:"mediumModal",buttons:[{title:(0,s.translate)("close"),code:"cancel"}],onLoad:function(n){n.find(".pureHtmlEditor").focus()}})}).apply(null,n)}).catch(e.oe)}),l(".manageLibsModal").on("refreshData",function(n){a.getData()})},toggleButtons:function(n){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.find(".btnAddLibrary").attr("disabled",a),n.find(".modal-footer button").attr("disabled",a),n.find(".btnRemoveLibrary").attr("disabled",a)},canSaveModel:function(){var n=!1,a=__currentSession.autoopenUri&&__currentSession.autoopenUri.toLowerCase().indexOf("/public/")>=0;return((0,s.haveAccess)("change_model")&&!a||(0,s.haveAccess)("change_public_model")&&a)&&(n=!0,__currentSession.modelInfo&&__currentSession.modelInfo.readonly&&(n=!1)),n}})}.apply(a,i))||(n.exports=o)}).call(this,e(218),e(1))},1972:function(n,a,e){var t=e(690);function l(n){return n&&(n.__esModule?n.default:n)}n.exports=(t.default||t).template({1:function(n,a,t,i,o){return'            <button class="btn btn-primary btnAddLibrary"><i class="fad fa-plus-circle"></i>\n              '+n.escapeExpression(l(e(688)).call(null!=a?a:n.nullContext||{},"install_libraries",{name:"L",hash:{},data:o}))+"</button>\n"},3:function(n,a,e,t,l){return'                  <th class="thSystem">System</th>\n'},5:function(n,a,t,i,o){var s=null!=a?a:n.nullContext||{},r=n.escapeExpression;return'            <div class="alert alert-warning alertCantSaveModel" role="alert">\n              <b>'+r(l(e(688)).call(s,"not_perm_to_save_model",{name:"L",hash:{},data:o}))+"</b><br />\n              "+r(l(e(688)).call(s,"can_list_libs_but_not_change",{name:"L",hash:{},data:o}))+"\n            </div>\n"},7:function(n,a,e,t,l){var i,o=n.lambda,s=n.escapeExpression;return'        <button class="btn btn-'+s(o(null!=a?a.css:a,a))+'" data-code="'+s(o(null!=a?a.code:a,a))+'" data-dismiss="modal"\n          aria-hidden="true">'+(null!=(i=e.if.call(null!=a?a:n.nullContext||{},null!=a?a.icon:a,{name:"if",hash:{},fn:n.program(8,l,0),inverse:n.noop,data:l}))?i:"")+" "+s(o(null!=a?a.title:a,a))+"</button>\n"},8:function(n,a,e,t,l){var i;return null!=(i=n.lambda(null!=a?a.icon:a,a))?i:""},compiler:[7,">= 4.0.0"],main:function(n,a,e,t,l){var i,o=n.lambda,s=n.escapeExpression,r=null!=a?a:n.nullContext||{};return'<div id="main-modal" class="modal fade manageLibsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"\n  aria-hidden="true" data-backdrop="static" data-keyboard="false" style="display: none;">\n  <div class="modal-dialog '+s(o(null!=a?a.modalClass:a,a))+'">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>\n        <h4 class="modal-title" id="myModalLabel">'+s(o(null!=a?a.title:a,a))+'</h4>\n      </div>\n\n      <div class="modal-body" style="overflow-y:auto; overflow-x: hidden;">\n        <div class="container-fluid">\n          <div class="row manageLibsActions">\n'+(null!=(i=e.if.call(r,null!=a?a.canSaveModel:a,{name:"if",hash:{},fn:n.program(1,l,0),inverse:n.noop,data:l}))?i:"")+'          </div>\n          <div class="row manageLibsList">\n            <table class="table table-stripped table-hover manageLibsTable">\n              <thead class="thead-light">\n                <tr>\n                  <th class="thName">Name</th>\n                  <th class="thVersion">Version</th>\n'+(null!=(i=e.if.call(r,null!=a?a.notDesktop:a,{name:"if",hash:{},fn:n.program(3,l,0),inverse:n.noop,data:l}))?i:"")+'                  <th class="thActions">Actions</th>\n                </tr>\n              </thead>\n            </table>\n          </div>\n          <div class="row manageLibsBottomActions">\n'+(null!=(i=e.if.call(r,null!=a?a.cantSaveModel:a,{name:"if",hash:{},fn:n.program(5,l,0),inverse:n.noop,data:l}))?i:"")+'\n          </div>\n        </div>\n\n      </div>\n\n      <div class="modal-footer">\n'+(null!=(i=e.each.call(r,null!=a?a.buttons:a,{name:"each",hash:{},fn:n.program(7,l,0),inverse:n.noop,data:l}))?i:"")+"      </div>\n    </div>\n  </div>\n</div>"},useData:!0})},1973:function(n,a,e){var t=e(690);function l(n){return n&&(n.__esModule?n.default:n)}n.exports=(t.default||t).template({compiler:[7,">= 4.0.0"],main:function(n,a,t,i,o){var s=null!=a?a:n.nullContext||{},r=n.escapeExpression;return'<div class="removeLibraryPopoverContent">\n  <div class="sureRemoveLib">'+r(l(e(688)).call(s,"sure_delete_library",{name:"L",hash:{},data:o}))+" "+r(n.lambda(null!=a?a.name:a,a))+' ?</div>\n  <div class="removeLibActions">\n    <button class="btn btn-mini btn-primary confirmRemoveLib">'+r(l(e(688)).call(s,"confirm_delete_library",{name:"L",hash:{},data:o}))+'</button>\n    <button class="btn btn-mini cancelRemoveLib">'+r(l(e(688)).call(s,"cancel",{name:"L",hash:{},data:o}))+"</button>\n  </div>\n</div>"},useData:!0})}}]);