/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[239],{1978:function(n,a,e){"use strict";(function(t,l){var o,i,s=e(18);o=[e(219),e(1979),e(1980),e(1981)],void 0===(i=function(n,a,o,i){return t.View.extend({el:l("#main"),render:function(n){if(!(this.$el.find(".manageLibsModal").length>0)){var t=this;t.isRefreshing=!1,n.notDesktop=!1,n.canSaveModel=this.canSaveModel(),n.cantSaveModel=!n.canSaveModel,n.buttons=n.canSaveModel?[{title:(0,s.translate)("save_model_and_close"),code:"save",icon:'<i class="fad fa-save"></i>',css:"primary"}]:[{title:(0,s.translate)("close"),code:"cancel"}];var o=a(n);this.$el.append(o);var i=l(".manageLibsModal");t.getData(),i.find(".modal-footer button").click(function(a){a.preventDefault();var o=!0,r=l(this).attr("data-code");return n.callback&&!1===n.callback.call(this,r,i)&&(o=!1),o&&(t.toggleButtons(i,!0),"save"==r?(t.toggleButtons(i,!0),Promise.resolve().then(function(){var n=[e(219)];(function(n){(new n).saveModel(function(){l("body").trigger("pendingChanges",[!1]),(0,s.showMessage)((0,s.translate)("model_successfully_saved"),"","success",!0),i.off("shown"),i.modal("hide")})}).apply(null,n)}).catch(e.oe),t.toggleButtons(i,!1)):(i.off("shown"),i.modal("hide"))),!1}),i.on("show.bs.modal",function(){if(0===l(".manageLibsModal:visible").length){var a=100014+10*l(".modal:visible").length;l(this).css("z-index",a),setTimeout(function(){l(".modal-backdrop").not(".modal-stack").css("z-index",a-10).addClass("modal-stack")},0),n.hasOwnProperty("onLoad")&&n.onLoad(i),!0!==n.okOnEnter&&void 0!==n.okOnEnter||i.keyup(function(n){13==n.keyCode&&i.find("button.btn-primary").click()})}}),i.on("hidden.bs.modal",function(){i.off("hidden"),n.hasOwnProperty("onClose")&&n.onClose(i),i.remove()}),i.modal(n.backdrop?{backdrop:"static",keyboard:!1}:null),t.addHandlers(i)}},getData:function(){var a=this;if(!this.isRefreshing){this.isRefreshing=!0;var e=["pip","setuptools"];//!IMPORTANT libs that are installed in /data/models/<companyname>/<username>/.venv/ but are system libraries
(new n).listInstalledLibraries(function(n){var t={libraries:n.map(function(n){return n.isSystem=!0,"/usr"==n.location.substring(0,4)||e.includes(n.name)||(n.isSystem=!1),n})};a.instantiateTable(a,t)})}},instantiateTable:function(n,a){var t=l(".manageLibsModal"),r=t.find(".manageLibsTable"),d=r.find(".thName"),c=r.find(".thVersion"),u=(r.find(".thSystem"),r.find(".thActions")),b=null;l.fn.dataTable.isDataTable(r)&&r.DataTable().clear().destroy(),d.width("34%"),c.width("33%"),u.width("33%"),b=[{data:"name"},{data:null,render:function(n,a,e){var t=null;return n?(t=l('<div><span class="badge">'.concat(n.version,"</span></div>"))).prop("outerHTML"):t}},{data:null,render:function(a,e,t){var o=null;return a&&!a.isSystem&&n.canSaveModel()?(o=l(i())).prop("outerHTML"):o}}];var m=r.DataTable({pageLength:10,lengthChange:!1,data:a.libraries,order:[[2,"desc"]],columns:b,initComplete:function(){l(".manageLibsTable tbody").off("click",".btnRemoveLibrary"),l(".manageLibsTable tbody").on("click",".btnRemoveLibrary",function(a){a.preventDefault();var i=m.row(l(this).closest("tr")).data(),r={title:(0,s.translate)("remove_library"),content:o({name:i.name}),left:a.clientX,top:a.clientY};e.e(13).then(function(){var a=[e(737)];(function(a){(new a).show(r,function(a){var o=l("#".concat(a.options.id));o.find(".cancelRemoveLib").on("click",function(n){o.trigger("hide")}),o.find(".confirmRemoveLib").on("click",function(a){o.trigger("hide"),n.toggleButtons(t,!0),Promise.resolve().then(function(){var a=[e(219)];(function(a){(new a).uninstallLibrary(i.name,i.location,function(a){(0,s.showMessage)((0,s.translate)("library_successfully_removed")," ","success",!0),n.toggleButtons(t),n.getData()})}).apply(null,a)}).catch(e.oe)})})}).apply(null,a)}).catch(e.oe)})}});n.isRefreshing=!1},addHandlers:function(n){var a=this;n.find(".btnAddLibrary").on("click",function(n){n.preventDefault(),Promise.resolve().then(function(){var n=[e(714)];(function(n){(new n).installLibsModal({title:(0,s.translate)("install_libraries"),okOnEnter:!0,modalClass:"mediumModal",buttons:[{title:(0,s.translate)("close"),code:"cancel"}],onLoad:function(n){n.find(".pureHtmlEditor").focus()}})}).apply(null,n)}).catch(e.oe)}),l(".manageLibsModal").on("refreshData",function(n){a.getData()})},toggleButtons:function(n){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.find(".btnAddLibrary").attr("disabled",a),n.find(".modal-footer button").attr("disabled",a),n.find(".btnRemoveLibrary").attr("disabled",a)},canSaveModel:function(){var n=!1,a=__currentSession.autoopenUri&&__currentSession.autoopenUri.toLowerCase().indexOf("/public/")>=0;return((0,s.haveAccess)("change_model")&&!a||(0,s.haveAccess)("change_public_model")&&a)&&(n=!0,__currentSession.modelInfo&&__currentSession.modelInfo.readonly&&(n=!1)),n}})}.apply(a,o))||(n.exports=i)}).call(this,e(218),e(1))},1979:function(n,a,e){var t=e(690);function l(n){return n&&(n.__esModule?n.default:n)}n.exports=(t.default||t).template({1:function(n,a,t,o,i){return'            <button class="btn btn-primary btnAddLibrary"><i class="fad fa-plus-circle"></i>\n              '+n.escapeExpression(l(e(688)).call(null!=a?a:n.nullContext||{},"install_libraries",{name:"L",hash:{},data:i}))+"</button>\n"},3:function(n,a,e,t,l){return'                  <th class="thSystem">System</th>\n'},5:function(n,a,t,o,i){var s=null!=a?a:n.nullContext||{},r=n.escapeExpression;return'            <div class="alert alert-warning alertCantSaveModel" role="alert">\n              <b>'+r(l(e(688)).call(s,"not_perm_to_save_model",{name:"L",hash:{},data:i}))+"</b><br />\n              "+r(l(e(688)).call(s,"can_list_libs_but_not_change",{name:"L",hash:{},data:i}))+"\n            </div>\n"},7:function(n,a,e,t,l){var o,i=n.lambda,s=n.escapeExpression;return'        <button class="btn btn-'+s(i(null!=a?a.css:a,a))+'" data-code="'+s(i(null!=a?a.code:a,a))+'" data-dismiss="modal"\n          aria-hidden="true">'+(null!=(o=e.if.call(null!=a?a:n.nullContext||{},null!=a?a.icon:a,{name:"if",hash:{},fn:n.program(8,l,0),inverse:n.noop,data:l}))?o:"")+" "+s(i(null!=a?a.title:a,a))+"</button>\n"},8:function(n,a,e,t,l){var o;return null!=(o=n.lambda(null!=a?a.icon:a,a))?o:""},compiler:[7,">= 4.0.0"],main:function(n,a,e,t,l){var o,i=n.lambda,s=n.escapeExpression,r=null!=a?a:n.nullContext||{};return'<div id="main-modal" class="modal fade manageLibsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"\n  aria-hidden="true" data-backdrop="static" data-keyboard="false" style="display: none;">\n  <div class="modal-dialog '+s(i(null!=a?a.modalClass:a,a))+'">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h4 class="modal-title" id="myModalLabel">'+s(i(null!=a?a.title:a,a))+'</h4>\n      </div>\n\n      <div class="modal-body" style="overflow-y:auto; overflow-x: hidden;">\n        <div class="container-fluid">\n          <div class="row manageLibsActions">\n'+(null!=(o=e.if.call(r,null!=a?a.canSaveModel:a,{name:"if",hash:{},fn:n.program(1,l,0),inverse:n.noop,data:l}))?o:"")+'          </div>\n          <div class="row manageLibsList">\n            <table class="table table-stripped table-hover manageLibsTable">\n              <thead class="thead-light">\n                <tr>\n                  <th class="thName">Name</th>\n                  <th class="thVersion">Version</th>\n'+(null!=(o=e.if.call(r,null!=a?a.notDesktop:a,{name:"if",hash:{},fn:n.program(3,l,0),inverse:n.noop,data:l}))?o:"")+'                  <th class="thActions">Actions</th>\n                </tr>\n              </thead>\n            </table>\n          </div>\n          <div class="row manageLibsBottomActions">\n'+(null!=(o=e.if.call(r,null!=a?a.cantSaveModel:a,{name:"if",hash:{},fn:n.program(5,l,0),inverse:n.noop,data:l}))?o:"")+'\n          </div>\n        </div>\n\n      </div>\n\n      <div class="modal-footer">\n'+(null!=(o=e.each.call(r,null!=a?a.buttons:a,{name:"each",hash:{},fn:n.program(7,l,0),inverse:n.noop,data:l}))?o:"")+"      </div>\n    </div>\n  </div>\n</div>"},useData:!0})},1980:function(n,a,e){var t=e(690);function l(n){return n&&(n.__esModule?n.default:n)}n.exports=(t.default||t).template({compiler:[7,">= 4.0.0"],main:function(n,a,t,o,i){var s=null!=a?a:n.nullContext||{},r=n.escapeExpression;return'<div class="removeLibraryPopoverContent">\n  <div class="sureRemoveLib">'+r(l(e(688)).call(s,"sure_delete_library",{name:"L",hash:{},data:i}))+" "+r(n.lambda(null!=a?a.name:a,a))+' ?</div>\n  <div class="removeLibActions">\n    <button class="btn btn-mini btn-primary confirmRemoveLib">'+r(l(e(688)).call(s,"confirm_delete_library",{name:"L",hash:{},data:i}))+'</button>\n    <button class="btn btn-mini cancelRemoveLib">'+r(l(e(688)).call(s,"cancel",{name:"L",hash:{},data:i}))+"</button>\n  </div>\n</div>"},useData:!0})},1981:function(n,a,e){var t=e(690);n.exports=(t.default||t).template({compiler:[7,">= 4.0.0"],main:function(n,a,t,l,o){var i=n.escapeExpression;return'<div>\n  <button class="btn btn-mini btn-red btnRemoveLibrary" data-original-title="'+i(function(n){return n&&(n.__esModule?n.default:n)}(e(688)).call(null!=a?a:n.nullContext||{},"remove_library",{name:"L",hash:{},data:o}))+'" rel="tooltip"\n    data-title="'+i(n.lambda(null!=a?a.remove_library:a,a))+'">\n    <i class="fas fa-trash"></i>\n  </button>\n</div>'},useData:!0})}}]);