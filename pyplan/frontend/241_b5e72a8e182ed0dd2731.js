/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[241],{1977:function(n,e,a){"use strict";(function(t,l){var o,i,s=a(18);o=[a(219),a(1978),a(1979),a(1980)],void 0===(i=function(n,e,o,i){return t.View.extend({el:l("#main"),render:function(n){if(!(this.$el.find(".manageLibsModal").length>0)){var t=this;t.isRefreshing=!1,n.notDesktop=!1,n.canSaveModel=this.canSaveModel(),n.cantSaveModel=!n.canSaveModel,n.buttons=n.canSaveModel?[{title:(0,s.translate)("save_model_and_close"),code:"save",icon:'<i class="fad fa-save"></i>',css:"primary"}]:[{title:(0,s.translate)("close"),code:"cancel"}];var o=e(n);this.$el.append(o);var i=l(".manageLibsModal");t.getData(),i.find(".modal-footer button").click(function(e){e.preventDefault();var o=!0,r=l(this).attr("data-code");return n.callback&&!1===n.callback.call(this,r,i)&&(o=!1),o&&(t.toggleButtons(i,!0),"save"==r?(t.toggleButtons(i,!0),Promise.resolve().then(function(){var n=[a(219)];(function(n){(new n).saveModel(function(){l("body").trigger("pendingChanges",[!1]),(0,s.showMessage)((0,s.translate)("model_successfully_saved"),"","success",!0),i.off("shown"),i.modal("hide")})}).apply(null,n)}).catch(a.oe),t.toggleButtons(i,!1)):(i.off("shown"),i.modal("hide"))),!1}),i.on("show.bs.modal",function(){if(0===l(".manageLibsModal:visible").length){var e=100014+10*l(".modal:visible").length;l(this).css("z-index",e),setTimeout(function(){l(".modal-backdrop").not(".modal-stack").css("z-index",e-10).addClass("modal-stack")},0),n.hasOwnProperty("onLoad")&&n.onLoad(i),!0!==n.okOnEnter&&void 0!==n.okOnEnter||i.keyup(function(n){13==n.keyCode&&i.find("button.btn-primary").click()})}}),i.on("hidden.bs.modal",function(){i.off("hidden"),n.hasOwnProperty("onClose")&&n.onClose(i),i.remove()}),i.modal(n.backdrop?{backdrop:"static",keyboard:!1}:null),t.addHandlers(i)}},getData:function(){var e=this;if(!this.isRefreshing){this.isRefreshing=!0;var a=["pip","setuptools"];//!IMPORTANT libs that are installed in /data/models/<companyname>/<username>/.venv/ but are system libraries
(new n).listInstalledLibraries(function(n){var t={libraries:n.map(function(n){return n.isSystem=!0,"/usr"==n.location.substring(0,4)||a.includes(n.name)||(n.isSystem=!1),n})};e.instantiateTable(e,t)})}},instantiateTable:function(n,e){var t=l(".manageLibsModal"),r=t.find(".manageLibsTable"),c=r.find(".thName"),d=r.find(".thVersion"),u=(r.find(".thSystem"),r.find(".thActions")),m=null;l.fn.dataTable.isDataTable(r)&&r.DataTable().clear().destroy(),c.width("34%"),d.width("33%"),u.width("33%"),m=[{data:"name"},{data:null,render:function(n,e,a){var t=null;return n?(t=l('<div><span class="badge">'.concat(n.version,"</span></div>"))).prop("outerHTML"):t}},{data:null,render:function(e,a,t){var o=null;return e&&!e.isSystem&&n.canSaveModel()?(o=l(i())).prop("outerHTML"):o}}];var b=r.DataTable({pageLength:10,lengthChange:!1,data:e.libraries,order:[[2,"desc"]],columns:m,initComplete:function(){l(".manageLibsTable tbody").off("click",".btnRemoveLibrary"),l(".manageLibsTable tbody").on("click",".btnRemoveLibrary",function(e){e.preventDefault();var i=b.row(l(this).closest("tr")).data(),r={title:(0,s.translate)("remove_library"),content:o({name:i.name}),left:e.clientX,top:e.clientY};a.e(14).then(function(){var e=[a(734)];(function(e){(new e).show(r,function(e){var o=l("#".concat(e.options.id));o.find(".cancelRemoveLib").on("click",function(n){o.trigger("hide")}),o.find(".confirmRemoveLib").on("click",function(e){o.trigger("hide"),n.toggleButtons(t,!0),Promise.resolve().then(function(){var e=[a(219)];(function(e){(new e).uninstallLibrary(i.name,i.location,function(e){(0,s.showMessage)((0,s.translate)("library_successfully_removed")," ","success",!0),n.toggleButtons(t),n.getData()})}).apply(null,e)}).catch(a.oe)})})}).apply(null,e)}).catch(a.oe)})}});n.isRefreshing=!1},addHandlers:function(n){var e=this;n.find(".btnAddLibrary").on("click",function(n){n.preventDefault(),Promise.resolve().then(function(){var n=[a(713)];(function(n){(new n).installLibsModal({title:(0,s.translate)("install_libraries"),okOnEnter:!0,modalClass:"mediumModal",buttons:[{title:(0,s.translate)("close"),code:"cancel"}],onLoad:function(n){n.find(".pureHtmlEditor").focus()}})}).apply(null,n)}).catch(a.oe)}),l(".manageLibsModal").on("refreshData",function(n){e.getData()})},toggleButtons:function(n){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.find(".btnAddLibrary").attr("disabled",e),n.find(".modal-footer button").attr("disabled",e),n.find(".btnRemoveLibrary").attr("disabled",e)},canSaveModel:function(){var n=!1,e=__currentSession.autoopenUri&&__currentSession.autoopenUri.toLowerCase().indexOf("/public/")>=0;return((0,s.haveAccess)("change_model")&&!e||(0,s.haveAccess)("change_public_model")&&e)&&(n=!0,__currentSession.modelInfo&&__currentSession.modelInfo.readonly&&(n=!1)),n}})}.apply(e,o))||(n.exports=i)}).call(this,a(218),a(1))},1978:function(n,e,a){var t=a(690);function l(n){return n&&(n.__esModule?n.default:n)}n.exports=(t.default||t).template({1:function(n,e,t,o,i){return'            <button class="btn btn-primary btnAddLibrary"><i class="fad fa-plus-circle"></i>\n              '+n.escapeExpression(l(a(688)).call(null!=e?e:n.nullContext||{},"install_libraries",{name:"L",hash:{},data:i,loc:{start:{line:14,column:14},end:{line:14,column:39}}}))+"</button>\n"},3:function(n,e,a,t,l){return'                  <th class="thSystem">System</th>\n'},5:function(n,e,t,o,i){var s=null!=e?e:n.nullContext||{},r=n.escapeExpression;return'            <div class="alert alert-warning alertCantSaveModel" role="alert">\n              <b>'+r(l(a(688)).call(s,"not_perm_to_save_model",{name:"L",hash:{},data:i,loc:{start:{line:34,column:17},end:{line:34,column:47}}}))+"</b><br />\n              "+r(l(a(688)).call(s,"can_list_libs_but_not_change",{name:"L",hash:{},data:i,loc:{start:{line:35,column:14},end:{line:35,column:50}}}))+"\n            </div>\n"},7:function(n,e,a,t,l){var o,i=n.lambda,s=n.escapeExpression;return'        <button class="btn btn-'+s(i(null!=e?e.css:e,e))+'" data-code="'+s(i(null!=e?e.code:e,e))+'" data-dismiss="modal"\n          aria-hidden="true">'+(null!=(o=a.if.call(null!=e?e:n.nullContext||{},null!=e?e.icon:e,{name:"if",hash:{},fn:n.program(8,l,0),inverse:n.noop,data:l,loc:{start:{line:47,column:29},end:{line:47,column:58}}}))?o:"")+" "+s(i(null!=e?e.title:e,e))+"</button>\n"},8:function(n,e,a,t,l){var o;return null!=(o=n.lambda(null!=e?e.icon:e,e))?o:""},compiler:[8,">= 4.3.0"],main:function(n,e,a,t,l){var o,i=n.lambda,s=n.escapeExpression,r=null!=e?e:n.nullContext||{};return'<div id="main-modal" class="modal fade manageLibsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"\n  aria-hidden="true" data-backdrop="static" data-keyboard="false" style="display: none;">\n  <div class="modal-dialog '+s(i(null!=e?e.modalClass:e,e))+'">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h4 class="modal-title" id="myModalLabel">'+s(i(null!=e?e.title:e,e))+'</h4>\n      </div>\n\n      <div class="modal-body" style="overflow-y:auto; overflow-x: hidden;">\n        <div class="container-fluid">\n          <div class="row manageLibsActions">\n'+(null!=(o=a.if.call(r,null!=e?e.canSaveModel:e,{name:"if",hash:{},fn:n.program(1,l,0),inverse:n.noop,data:l,loc:{start:{line:12,column:12},end:{line:15,column:19}}}))?o:"")+'          </div>\n          <div class="row manageLibsList">\n            <table class="table table-stripped table-hover manageLibsTable">\n              <thead class="thead-light">\n                <tr>\n                  <th class="thName">Name</th>\n                  <th class="thVersion">Version</th>\n'+(null!=(o=a.if.call(r,null!=e?e.notDesktop:e,{name:"if",hash:{},fn:n.program(3,l,0),inverse:n.noop,data:l,loc:{start:{line:23,column:18},end:{line:25,column:25}}}))?o:"")+'                  <th class="thActions">Actions</th>\n                </tr>\n              </thead>\n            </table>\n          </div>\n          <div class="row manageLibsBottomActions">\n'+(null!=(o=a.if.call(r,null!=e?e.cantSaveModel:e,{name:"if",hash:{},fn:n.program(5,l,0),inverse:n.noop,data:l,loc:{start:{line:32,column:12},end:{line:37,column:19}}}))?o:"")+'\n          </div>\n        </div>\n\n      </div>\n\n      <div class="modal-footer">\n'+(null!=(o=a.each.call(r,null!=e?e.buttons:e,{name:"each",hash:{},fn:n.program(7,l,0),inverse:n.noop,data:l,loc:{start:{line:45,column:8},end:{line:48,column:17}}}))?o:"")+"      </div>\n    </div>\n  </div>\n</div>"},useData:!0})},1979:function(n,e,a){var t=a(690);function l(n){return n&&(n.__esModule?n.default:n)}n.exports=(t.default||t).template({compiler:[8,">= 4.3.0"],main:function(n,e,t,o,i){var s=null!=e?e:n.nullContext||{},r=n.escapeExpression;return'<div class="removeLibraryPopoverContent">\n  <div class="sureRemoveLib">'+r(l(a(688)).call(s,"sure_delete_library",{name:"L",hash:{},data:i,loc:{start:{line:2,column:29},end:{line:2,column:56}}}))+" "+r(n.lambda(null!=e?e.name:e,e))+' ?</div>\n  <div class="removeLibActions">\n    <button class="btn btn-mini btn-primary confirmRemoveLib">'+r(l(a(688)).call(s,"confirm_delete_library",{name:"L",hash:{},data:i,loc:{start:{line:4,column:62},end:{line:4,column:92}}}))+'</button>\n    <button class="btn btn-mini cancelRemoveLib">'+r(l(a(688)).call(s,"cancel",{name:"L",hash:{},data:i,loc:{start:{line:5,column:49},end:{line:5,column:63}}}))+"</button>\n  </div>\n</div>"},useData:!0})},1980:function(n,e,a){var t=a(690);n.exports=(t.default||t).template({compiler:[8,">= 4.3.0"],main:function(n,e,t,l,o){var i=n.escapeExpression;return'<div>\n  <button class="btn btn-mini btn-red btnRemoveLibrary" data-original-title="'+i(function(n){return n&&(n.__esModule?n.default:n)}(a(688)).call(null!=e?e:n.nullContext||{},"remove_library",{name:"L",hash:{},data:o,loc:{start:{line:2,column:77},end:{line:2,column:99}}}))+'" rel="tooltip"\n    data-title="'+i(n.lambda(null!=e?e.remove_library:e,e))+'">\n    <i class="fas fa-trash"></i>\n  </button>\n</div>'},useData:!0})}}]);