/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[257,5],{2014:function(e,n,t){"use strict";(function(l,a){var i,o,c=t(18);i=[t(717),t(683),t(2015),t(2016)],void 0===(o=function(e,n,t,i){return l.View.extend({el:a("#n_o_n_e"),field:"",tagId:"",fileManagerModel:new e,currentView:void 0,render:function(e,l){var o=this;o.path=e;var s=t();(new n).show({title:(0,c.translate)("denied_departments"),html:s,modalClass:"filterviewModal",buttons:[{title:"OK",css:"primary",code:"ok"},{title:(0,c.translate)("cancel"),code:"cancel"}],callback:function(e,n){"ok"==e&&o.applyFilters(n,l)},onClose:function(e){o.removeView(e)},onLoad:function(n){(0,c.postRender)(n),o.addHandlers(n),o.fileManagerModel.getDepartments(function(t){var l=i(t={items:t}),s=a("div.filterlist ul");s.selectonic({multi:!0,keyboard:!0,keyboardMode:"toggle",mouseMode:"toggle",focusOnHover:!0,selectionBlur:!1,focusBlur:!1,select:function(e,n){},unselectAll:function(e,n){}}),n.find("div.filterlist ul").append(l),s.perfectScrollbar(),o.initializeSelectedFilters(e,n),(0,c.postRender)(n.find("div.filterlist ul")),setTimeout(function(){n.find("input[name='filterText1']").focus()},500)})}})},removeView:function(e){this.currentView=null},addHandlers:function(e){e.find(".selectAll").on("click",function(){e.find("div.filterlist ul li:visible").each(function(e,n){a(n).addClass("j-selected")})}),e.find(".selectNone").on("click",function(){e.find(".filterlist ul li").each(function(e,n){a("div.filterlist ul").selectonic("unselect",n)})})},initializeSelectedFilters:function(e,n){this.fileManagerModel.getDeniedDepartments(e,function(e){e&&e.forEach(function(e){n.find(".filterlist ul li").each(function(n,t){parseInt(a(t).find("span").attr("data-rel"))===e.id&&a("div.filterlist ul").selectonic("select",t)})})})},applyFilters:function(e,n){var t=this,l=[];e.find(".filterlist ul li.j-selected").each(function(e,n){l.push(a(n).find("span").attr("data-rel"))});var i={folder:this.path,departments:l};this.fileManagerModel.setDeniedPath(i,function(e){n(t.path,e)})}})}.apply(n,i))||(e.exports=o)}).call(this,t(218),t(1))},2015:function(e,n,t){var l=t(690);function a(e){return e&&(e.__esModule?e.default:e)}e.exports=(l.default||l).template({compiler:[7,">= 4.0.0"],main:function(e,n,l,i,o){var c=null!=n?n:e.nullContext||{},s=e.escapeExpression;return'<div class="filterview unselectable">\n  <div class="row" style="padding: 10px 0;">\n    <div class="col-sm-12">\n      <div class="form-group">\n        <label for="textfield" class="control-label col-sm-1" style="padding-top: 4px;">Select:</label>\n        <div class="col-sm-11">\n          <a href="#" class="btn btn-small btn-lime selectAll">'+s(a(t(688)).call(c,"_all",{name:"L",hash:{},data:o}))+'</a>\n\n          <a href="#" class="btn btn-small btn-lime selectNone">'+s(a(t(688)).call(c,"_none",{name:"L",hash:{},data:o}))+'</a>\n        </div>\n      </div>\n\n\n    </div>\n  </div>\n  <div class="filterlist">\n      <ul></ul>\n  </div>\n</div>\n'},useData:!0})},2016:function(e,n,t){var l=t(690);e.exports=(l.default||l).template({1:function(e,n,t,l,a){var i,o=null!=n?n:e.nullContext||{},c=t.helperMissing,s=e.escapeExpression;return'<li>\n  <span data-rel="'+s("function"==typeof(i=null!=(i=t.id||(null!=n?n.id:n))?i:c)?i.call(o,{name:"id",hash:{},data:a}):i)+'">'+s("function"==typeof(i=null!=(i=t.name||(null!=n?n.name:n))?i:c)?i.call(o,{name:"name",hash:{},data:a}):i)+"</span>\n</li>\n"},compiler:[7,">= 4.0.0"],main:function(e,n,t,l,a){var i;return null!=(i=t.each.call(null!=n?n:e.nullContext||{},null!=n?n.items:n,{name:"each",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a}))?i:""},useData:!0})},683:function(e,n,t){"use strict";(function(l){var a;void 0===(a=function(){return l.Controller.extend({name:"showModal",show:function(e){Promise.all([t.e(2),t.e(119)]).then(function(){var n=[t(700)];(function(n){(new n).render(e)}).apply(null,n)}).catch(t.oe)}})}.apply(n,[]))||(e.exports=a)}).call(this,t(694))},717:function(e,n,t){"use strict";(function(l){var a,i=t(693);void 0===(a=function(){return l.Model.extend({url:"myFileManager",getMainFolders:function(e){(0,i.send)("fileManager/getMainFolders/",null,{type:"GET"},e)},getFiles:function(e,n){(0,i.send)("fileManager/getFiles/?folder=".concat(encodeURIComponent(e)),null,{type:"GET"},n)},createFolder:function(e,n,t){(0,i.send)("fileManager/createFolder/",{folder_path:e,folder_name:n},{type:"POST"},t)},deleteFiles:function(e,n){(0,i.send)("fileManager/deleteFiles/",JSON.stringify({sources:e}),{type:"DELETE",contentType:"application/json",dataType:"text"},n)},renameFiles:function(e,n,t){(0,i.send)("fileManager/renameFile/?source=".concat(encodeURIComponent(e),"&newName=").concat(n),null,{type:"GET"},t)},unzipFile:function(e,n,t){(0,i.send)("fileManager/unzipFile/?source=".concat(e,"&targetFolder=").concat(encodeURIComponent(n)),null,{type:"GET",dataType:"text"},t)},moveFiles:function(e,n,t){var l=e.map(function(e){return"sources=".concat(e)}).join("&");(0,i.send)("fileManager/moveFiles/?".concat(l,"&target=").concat(encodeURIComponent(n)),null,{type:"GET",dataType:"text"},t)},copyToMyWorkspace:function(e,n){(0,i.send)("fileManager/copyToMyWorkspace/?source="+encodeURIComponent(e),null,{type:"GET",dataType:"text"},n)},copyFiles:function(e,n,t){var l=e.map(function(e){return"sources=".concat(e)}).join("&");(0,i.send)("fileManager/copyFiles/?".concat(l,"&target=").concat(encodeURIComponent(n)),null,{type:"GET",dataType:"text"},t)},duplicateFiles:function(e,n){var t=e.map(function(e){return"sources=".concat(e)}).join("&");(0,i.send)("fileManager/duplicateFiles/?".concat(t),null,{type:"GET"},n)},zipFiles:function(e,n){var t=e.map(function(e){return"sources=".concat(e)}).join("&");(0,i.send)("fileManager/zipFiles/?".concat(t),null,{type:"GET",dataType:"text"},n)},downloadFiles:function(e,n){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){},c=e.map(function(e){return"sources=".concat(e)}).join("&"),s=new XMLHttpRequest;s.responseType="arraybuffer",s.open("GET","".concat(__apiURL,"/fileManager/download/?").concat(c),!0),s.setRequestHeader("Authorization","Token ".concat(__currentToken)),s.setRequestHeader("session-key",__currentSession?__currentSession.session_key:""),s.onloadstart=l,s.onreadystatechange=function(e){var l=e.currentTarget;l.onprogress=a,l.onerror=o,l.onloadend=i,l.readyState==l.DONE&&(200==l.status?n(l):t.e(18).then(function(){var e=[t(685)];(function(e){(new e).show({title:"ERROR!",text:l.response,notifyType:"error"})}).apply(null,e)}).catch(t.oe))},s.send()},getDepartments:function(e){(0,i.send)("departments/by_current_company/",null,{type:"GET"},e)},getDeniedDepartments:function(e,n){(0,i.send)("departments/denied/?folder=".concat(encodeURIComponent(e)),null,{type:"GET"},n)},setDeniedPath:function(e,n){(0,i.send)("departments/deny_items/",JSON.stringify(e),{type:"POST",contentType:"application/json;charset=utf-8"},n)},optimzeTemplates:function(e,n,t){var l=e.map(function(e){return"sources=".concat(e)}).join("&");(0,i.send)("fileManager/optimizeTemplates/?".concat(l),null,{type:"GET",dataType:"text"},n,t)}})}.apply(n,[]))||(e.exports=a)}).call(this,t(218))}}]);