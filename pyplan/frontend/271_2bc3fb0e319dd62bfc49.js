/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[271],{2061:function(n,a,e){"use strict";(function(t,i){var s,o,l=e(18);s=[e(2062),e(2063),e(2064)],void 0===(o=function(n,a,e){return t.View.extend({el:i("#main"),render:function(n){var e=this,t={nodeList:n.nodeList},s=a(t);this.$el.append(s),i("#scenarioManager").on("hidden.bs.modal",function(){i("#scenarioManager").off("hidden"),i("#scenarioManager").remove()}).modal("show"),setTimeout(function(){e.addHandlers(i("#scenarioManager")),e.checkIsLoaded(i("#scenarioManager"))},200),(0,l.postRender)(i("#scenarioManager"))},addHandlers:function(a){var e=this;i("#scenarioManager").on("updateProgress",function(n,e){e&&(a.find("#scenarioManager_create .progressBar div.progress-bar").css("width",e.percent+"%"),a.find("#scenarioManager_create .progressBar p").html((0,l.translate)("saving")+" "+e.nodeTitle+" ..."))}),a.find(".nav-tabs li a").on("click",function(){a.find(".nav-tabs li").removeClass("active"),i(this).parent().addClass("active"),a.find(".tab-pane").removeClass("active"),a.find(i(this).attr("data-rel")).addClass("active"),"#scenarioManager_list"==i(this).attr("data-rel")&&e.loadList(a)}),a.find("form").on("submit",function(){var e=[];if(a.find(".node-list input[type='checkbox']").each(function(n,a){i(this).is(":checked")&&e.push({nodeId:i(this).attr("data-id")})}),e.length>0&&0==i(this).validate().errorList.length){var t={name:a.find("input[name='scenario_name']").val(),description:a.find("textarea[name='scenario_description']").val(),nodeList:e};a.find("#scenarioManager_create .inputData").hide(),a.find("#scenarioManager_create .progressBar").show(),a.find("#scenarioManager_create .progressBar div.bar").css("width","10%"),a.find("#scenarioManager_create .progressBar p").html((0,l.translate)("saving")+" ..."),(new n).create(t,function(){a.find("#scenarioManager_create .progressBar div.bar").css("width","100%"),setTimeout(function(){a.find("#scenarioManager_create .progressBar").hide(),a.find("#scenarioManager_create .createResult").show(),setTimeout(function(){a.find("#scenarioManager_create .createResult").hide(),a.find("input[name='scenario_name']").val(""),a.find("textarea[name='scenario_description']").val(""),a.find("#scenarioManager_create .inputData").show()},2e3)},300)},function(){a.find("#scenarioManager_create .createResult").hide(),a.find("#scenarioManager_create .inputData").show()})}return!1}),a.find(".btnUnload").on("click",function(){(new n).unload(function(n){i("#scenarioManager").modal("hide"),i(".mainTask").trigger("scenarioUnloaded"),i(".breadcrumbs .toolbar .btnRefresh").click()})})},loadList:function(a){var t=this;a.find("#scenarioManager_list .scenario-table").length>0&&a.find("#scenarioManager_list .scenario-table").dataTable().fnDestroy();a.find("#scenarioManager_list").empty();var s=new n;s.list(function(n){n.unshift({scenarioId:-1,name:(0,l.translate)("current_scenario")});var o=[],r=e(n);a.find("#scenarioManager_list").html(r),a.find("#scenarioManager_list .scenario-table").cubeTable(null,{sDom:"ftp",iDisplayLength:7,bSort:!1,bDestroy:!0,bAutoWidth:!1,columnDefs:[{targets:[2],visible:!1}],fnDrawCallback:function(){a.find("#scenarioManager_list .scenario-table tbody tr").each(function(){0==i(this).find(".icheckbox_square-blue").length&&(0,l.icheck)(i(this))})}}),a.find("#scenarioManager_list .scenario-table tbody ").on("click","i.info",function(){a.find(".scenario-popover").removeClass("nodisplay");var e=a.find(".scenario-popover");e.find("h5").empty(),e.find("span.nodelist").empty(),e.find("span.nodedescription").empty(),e.find("span.modelInfo").empty();for(var t=i(this).closest("tr").attr("data-id"),s=0;s<n.length;s++)if(n[s].scenarioId==t){var o="";if(n[s].nodeList&&n[s].nodeList.length>0)for(var l=0;l<n[s].nodeList.length;l++)l>0&&(o+=", "),o+=n[s].nodeList[l].nodeTitle;e.find("h5").text(n[s].name),e.find("span.nodelist").text(o),n[s].description&&e.find("span.nodedescription").text(n[s].description),n[s].modelInfo&&e.find("span.modelInfo").text(n[s].modelInfo);break}e.removeClass("nodisplay")}),a.find("#scenarioManager_list .scenario-table tbody ").on("click",".select_scenario",function(){i(this).is(":checked")?o.push(i(this).closest("tr").attr("data-id")):o.indexOf(i(this).closest("tr").attr("data-id"))>=0&&o.splice(o.indexOf(i(this).closest("tr").attr("data-id")),1);var n=o.length;1==n&&"-1"==o[0]&&(n=0),0==n?(a.find(".controls span.info").empty(),a.find(".controls button").addClass("disabled")):(a.find(".controls span.info").text(n+" "+(0,l.translate)("selected")),a.find(".controls button").removeClass("disabled"));var e=a.find("#scenarioManager_list .scenario-table").DataTable(),t=e.$('input[type="checkbox"]');2===n?(e.column(2).visible(!0),e.$("label.control--radio").hide(),e.$("label.control--radio input").prop("checked",!1),i.each(t,function(n,a){i(a).is(":checked")&&i(e.$("label.control--radio")[n]).show()})):(e.column(2).visible(!1),e.$("label.control--radio").hide())});var c=a.find("#scenarioManager_list .scenario-table").DataTable();c.on("click",'input[name="isBaseScenarioRadioBtn"]',function(){c.$("label.control--radio input:checked")[1]&&i(c.$("label.control--radio input:checked")[1]).prop("checked",!1);var n=o.length,e=a.find('input[name="isBaseScenarioRadioBtn"]:checked').val(),t=a.find('input[name="isBaseScenarioRadioBtn"]:checked').attr("data-name");a.find(".controls span.info").html(n+" "+(0,l.translate)("selected")+", <b>"+t+"</b> as base scenario.");var s=e;(o=i.grep(o,function(n){return n!=s})).unshift(e)}),a.find("#scenarioManager_list .scenario-popover .box-title button.remove ").on("click",function(){a.find(".scenario-popover").addClass("nodisplay")}),a.find("#scenarioManager_list .controls .btnLoad").on("click",function(){i(this).hasClass("disabled")||(a.find("#scenarioManager_list  .controls button").hide(),s.load(o,function(){i("#scenarioManager").modal("hide"),i(".mainTask").trigger("scenarioLoaded"),i(".breadcrumbs .toolbar .btnRefresh").click()},function(){a.find("#scenarioManager_list  .controls button").show(),a.find("#scenarioManager_list  .controls .btnSure").hide()}))}),a.find("#scenarioManager_list  .controls .btnDelete").on("click",function(){i(this).hasClass("disabled")||(a.find("#scenarioManager_list  .controls button").hide(),a.find("#scenarioManager_list  .controls .btnSure").show())}),a.find("#scenarioManager_list  .controls .btnCancel").on("click",function(){a.find("#scenarioManager_list  .controls button").show(),a.find("#scenarioManager_list  .controls .btnSure").hide()}),a.find("#scenarioManager_list  .controls .btnGoDelete").on("click",function(){a.find("#scenarioManager_list  .controls btnSure").hide();var n=0;i.each(o,function(e,i){s.delete(i,function(){++n>=o.length&&t.loadList(a)})})})})},checkIsLoaded:function(a){(new n).listLoaded(function(n){if(n&&n.length>0){var e=n.join();a.find("#scenarioManager_loaded .detailLoaded").text((0,l.translate)("scenarios_loaded").replace("##scenarios##",e)),a.find("a[data-rel='#scenarioManager_loaded']").closest("li").show(),a.find("a[data-rel='#scenarioManager_loaded']").click()}})}})}.apply(a,s))||(n.exports=o)}).call(this,e(218),e(1))},2062:function(n,a,e){"use strict";(function(t){var i,s=e(693);void 0===(i=function(){return t.Model.extend({list:function(n){(0,s.send)("Scenario/List",null,null,n)},get:function(n,a){(0,s.send)("Scenario/Get/"+n,null,null,a)},create:function(n,a,e){(0,s.send)("Scenario/Create",n,{type:"POST"},a,e)},delete:function(n,a){(0,s.send)("Scenario/Delete/"+n,null,{type:"DELETE"},a)},load:function(n,a,e){(0,s.send)("Scenario/Load",{values:n},{type:"PUT"},a,e)},listLoaded:function(n,a){(0,s.send)("Scenario/listLoaded",null,null,n,a)},unload:function(n,a){(0,s.send)("Scenario/unload",null,null,n,a)}})}.apply(a,[]))||(n.exports=i)}).call(this,e(218))},2063:function(n,a,e){var t=e(690);function i(n){return n&&(n.__esModule?n.default:n)}n.exports=(t.default||t).template({1:function(n,a,e,t,i){var s=n.lambda,o=n.escapeExpression;return'                  <div class="itemList">\n                    <input type="checkbox" class=\'icheck-me\' data-skin="square" data-color="blue" data-id="'+o(s(null!=a?a.id:a,a))+"\"\n                      checked> <label class='inline'>"+o(s(null!=a?a.name:a,a))+"</label>\n                  </div>\n"},compiler:[7,">= 4.0.0"],main:function(n,a,t,s,o){var l,r=null!=a?a:n.nullContext||{},c=n.escapeExpression;return'<div id="scenarioManager" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"\n  aria-hidden="true" style="display: none;">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>\n        <h3 id="myModalLabel">'+c(i(e(688)).call(r,"scenario_manager",{name:"L",hash:{},data:o}))+'</h3>\n      </div>\n\n      <div class="modal-body">\n        <ul class="nav nav-tabs">\n          <li class="active">\n            <a href="#" data-rel="#scenarioManager_create"><i class="fa fa-file"></i> '+c(i(e(688)).call(r,"create_scenario",{name:"L",hash:{},data:o}))+'</a>\n          </li>\n          <li>\n            <a href="#" data-rel="#scenarioManager_list"><i class="fa fa-list"></i> '+c(i(e(688)).call(r,"list_of_scenarios",{name:"L",hash:{},data:o}))+'</a>\n          </li>\n\n          <li style="display:none">\n            <a href="#" data-rel="#scenarioManager_loaded"><i class="fa fa-database"></i> '+c(i(e(688)).call(r,"loaded_scenarios",{name:"L",hash:{},data:o}))+'</a>\n          </li>\n\n        </ul>\n\n        <div class="tab-content tab-content-inline tab-content-bottom">\n          <div class="tab-pane active" id="scenarioManager_create">\n\n            <div class="inputData">\n              <h5>'+c(i(e(688)).call(r,"include_this_nodes",{name:"L",hash:{},data:o}))+"</h5>\n              <form class='form-validate'>\n                <div class=\"node-list\">\n"+(null!=(l=t.each.call(r,null!=a?a.nodeList:a,{name:"each",hash:{},fn:n.program(1,o,0),inverse:n.noop,data:o}))?l:"")+"                </div>\n                <div>\n                  <label>"+c(i(e(688)).call(r,"scenario_name",{name:"L",hash:{},data:o}))+'</label>\n                  <input class="input-xxlarge form-control" name="scenario_name" type="text" autocomplete="off"\n                    data-rule-required="true">\n                </div>\n\n                <div>\n                  <label>'+c(i(e(688)).call(r,"_description",{name:"L",hash:{},data:o}))+'</label>\n                  <textarea class="input-xxlarge form-control" name="scenario_description" rows="3"></textarea>\n                </div>\n                <button class="btn btn-primary btn-small"><i class="fa fa-file"></i> '+c(i(e(688)).call(r,"create_scenario",{name:"L",hash:{},data:o}))+'</button>\n              </form>\n            </div>\n            <div class="progressBar nodisplay">\n              <p>'+c(i(e(688)).call(r,"saving",{name:"L",hash:{},data:o}))+' ...</p>\n              <div class="progress progress-striped active">\n                <div class="progress-bar" style="width: 10%;"></div>\n              </div>\n            </div>\n\n            <div class="createResult nodisplay">\n              <p>'+c(i(e(688)).call(r,"scenario_created",{name:"L",hash:{},data:o}))+'</p>\n            </div>\n\n          </div>\n          <div class="tab-pane" id="scenarioManager_list"></div>\n\n          <div class="tab-pane" id="scenarioManager_loaded">\n\n            <h5><span class="detailLoaded"></span></h5>\n            <a href="#" class="btnUnload">'+c(i(e(688)).call(r,"click_here_for_unload",{name:"L",hash:{},data:o}))+"</a>\n\n          </div>\n\n        </div>\n      </div>\n\n    </div>\n  </div>\n</div>"},useData:!0})},2064:function(n,a,e){var t=e(690);function i(n){return n&&(n.__esModule?n.default:n)}n.exports=(t.default||t).template({1:function(n,a,t,s,o){var l=n.lambda,r=n.escapeExpression;return'            <tr data-id="'+r(l(null!=a?a.scenarioId:a,a))+'" style="height:35px;">\n                <td>\n                  <label class="control control--checkbox" style="margin-bottom: 17px;">\n                    <input type="checkbox" class="select_scenario" name="'+r(l(null!=a?a.scenarioId:a,a))+'" />\n                    <div class="control__indicator"></div>\n                  </label>\n                </td>\n                <td>'+r(l(null!=a?a.name:a,a))+'</td>\n                <td class="text-center">\n                  <label class="control nolabel control--radio" style="display:none;">\n                    <input type="radio" name="isBaseScenarioRadioBtn" value="'+r(l(null!=a?a.scenarioId:a,a))+'" data-name="'+r(l(null!=a?a.name:a,a))+'" />\n                    <div class="control__indicator"></div>\n                  </label>\n                </td>\n                <td>'+r(i(e(787)).call(null!=a?a:n.nullContext||{},null!=a?a.createdDate:a,{name:"formatDate",hash:{},data:o}))+'</td>\n                <td> <i class="fa fa-info-circle info"></i></td>\n            </tr>\n\n'},compiler:[7,">= 4.0.0"],main:function(n,a,t,s,o){var l,r=null!=a?a:n.nullContext||{},c=n.escapeExpression;return'\n\n <table class="table table-nomargin table-condensed scenario-table table-hover">\n    <thead>\n        <tr>\n            <th width="7%"></th>\n            <th width="55%">'+c(i(e(688)).call(r,"name",{name:"L",hash:{},data:o}))+'</th>\n            <th width="15%">Set as base</th>\n            <th width="20%">'+c(i(e(688)).call(r,"created_at",{name:"L",hash:{},data:o}))+'</th>\n            <th width="3%"></th>\n        </tr>\n    </thead>\n    <tbody>\n'+(null!=(l=t.each.call(r,a,{name:"each",hash:{},fn:n.program(1,o,0),inverse:n.noop,data:o}))?l:"")+'    </tbody>\n</table>\n\n<div class="scenario-popover nodisplay">\n\n    <div class="box">\n        <div class="box-title">\n            <h5></h5>\n            <div class="actions">\n                <button class="btn btn-mini remove"><i class="fa fa-times"></i></button>\n            </div>\n        </div>\n        <div class="box-content">\n            \n            <h6>'+c(i(e(688)).call(r,"model_path",{name:"L",hash:{},data:o}))+'</h6>\n            <span class="modelInfo"></span>\n            <h6>'+c(i(e(688)).call(r,"nodes",{name:"L",hash:{},data:o}))+'</h6>\n            <span class="nodelist"></span>\n            <h6>'+c(i(e(688)).call(r,"_description",{name:"L",hash:{},data:o}))+'</h6>\n            <span class="nodedescription"></span>\n\n        </div>\n    </div>\n</div>\n\n<div class="controls">\n    <span class="info"></span>\n    <button class="btn btn-small btn-red disabled btnDelete"><i class="fa fa-trash"></i> '+c(i(e(688)).call(r,"delete_selected_scenario",{name:"L",hash:{},data:o}))+'</button>\n    <button class="btn btn-small btn-green disabled btnLoad"><i class="fa fa-cloud-upload"></i> '+c(i(e(688)).call(r,"load_selected_scenario",{name:"L",hash:{},data:o}))+'</button>\n\n\n    <button class="btn btn-small btn-grey nodisplay btnCancel btnSure"></i> '+c(i(e(688)).call(r,"cancel",{name:"L",hash:{},data:o}))+'</button>\n    <button class="btn btn-small btn-red nodisplay btnGoDelete btnSure">'+c(i(e(688)).call(r,"yes",{name:"L",hash:{},data:o}))+'</button>\n    <span class="btnSure nodisplay">'+c(i(e(688)).call(r,"sure_delete",{name:"L",hash:{},data:o}))+"</span>\n\n</div>\n"},useData:!0})},787:function(n,a,e){"use strict";var t=e(18);n.exports=function(n){return(0,t.formatDate)(n)}}}]);