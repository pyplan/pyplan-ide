/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[275],{2118:function(e,t,l){"use strict";(function(o,n){var a,i;a=[l(750)],void 0===(i=function(e){return o.View.extend({el:n("none"),from:0,to:0,includeAll:!1,render:function(){var t=-1,l=this;this.el=this.options.$el,this.model=new e;var o=0;this.options.inputLength&&(o=this.options.inputLength),this.includeAll=this.options.includeAll;var a=this.el.parent().width();a=a<100?150:a;l.options.relatedObject.length;n(this.el).on("relatedChanged",function(){l.queryOne()}),n("[node-filter-id='"+l.options.nodeFilterId+"']").on("dashboardIndexChange",function(e,t){l.queryByIndex(t)});var i=!1;"1"!==l.options.filterType&&1!==l.options.filterType||(i=!0),n(this.el).select2({placeholder:"Search...",width:a,minimumInputLength:o,multiple:i,query:function(e){clearTimeout(t);var o=l.options.params.pageSize,a=(e.page-1)*o+1,i=a+o-1;l.options.params.filters=[],1===e.page&&(a=1,i=o),l.options.params.fromReg=a,l.options.params.toReg=i,l.options.relatedObject&&n.each(l.options.relatedObject,function(e,t){var o=t.relatedEl.select2("val"),n=[o=""===o?"-1":o];if("string"!=typeof o&&o.length>1){for(var a=0;a<o.length;a++)o[a]="'"+o[a]+"'";n=o}"-1"!==o&&l.options.params.filters.push({field:(t.relatedManyToManyEntity?t.relatedManyToManyEntity+".":"")+t.relatedField,values:n,relatedManyToManyKey:t.relatedManyToManyKey})}),e.context="something",t=setTimeout(function(){e.term&&""!==e.term&&l.options.params.filters.push({field:l.options.labelField,values:[e.term],useLike:!0}),l.options.sortBy&&""!==l.options.sortBy&&l.options.params.filters.push({sortBy:l.options.sortBy});var t=l.options.params;l.model.getData(t,function(t){var n=!0,a="";if(t.length>0)for(var i=0;i<t.length;i++)a=t[i][l.options.labelField],t[i].text=null===a?"":a,parseInt(e.element.select2("val"))===t[i].id&&(t[i].disabled=!0);(0===t.length||t.length<o)&&(n=!1),1===e.page&&l.includeAll&&t.unshift({id:"-1",text:"All"}),e.callback({results:t,more:n})})},400)},escapeMarkup:function(e){return e},initSelection:function(e,t){var l="1"===e.attr("filter-type"),o=e.select2("data");o[0].id=e.select2("data")[0].id,o[0].text=e.select2("data")[0].text,l||(o=o[0]),t(o)}}).on("select2-selecting",function(e){l.options.callback&&setTimeout(function(){l.options.callback(n(l.el).select2("data"))},100)}).on("change",function(e){}).on("select2-removed",function(e){l.options.callback&&setTimeout(function(){l.options.callback(n(l.el).select2("data"))},100)}),l.options.readOnly&&n(l.el).select2("readonly",!0),l.options.selectedId&&n(l.el).select2("val",l.options.selectedId);var s=this.options.relatedObject.length>0;if(l.includeAll||s||l.queryOne(),l.includeAll){n(l.el).select2("data",[{id:"-1",text:"All"}]),n(l.el).select2("val","-1").trigger("select2-selecting")}},queryOne:function(){var e=this;if(e.includeAll){n(e.el).select2("data",[{id:"-1",text:"All"}]),n(e.el).select2("val","-1"),e.options.callback(n(e.el).select2("data"))}else{e.options.params.filters=[],e.options.relatedObject&&n.each(e.options.relatedObject,function(t,l){var o=l.relatedEl.select2("val"),n=[o=""===o?"-1":o];if("string"!=typeof o&&o.length>1){for(var a=0;a<o.length;a++)o[a]="'"+o[a]+"'";n=o}"-1"!==o&&e.options.params.filters.push({field:(l.relatedManyToManyEntity?l.relatedManyToManyEntity+".":"")+l.relatedField,values:n,relatedManyToManyKey:l.relatedManyToManyKey})}),e.options.sortBy&&""!==e.options.sortBy&&(e.options.params.sortBy=e.options.sortBy);var t=e.options.params;t.fromReg=1,t.toReg=1;var l="";e.model.getData(t,function(t){if(t.length>0){for(var o=0;o<t.length;o++)l=t[o][e.options.labelField],t[o].text=null===l?"":l;n(e.el).select2("data",t),n(e.el).select2("val",t[0].id)}else n(e.el).select2("data",{id:-2,text:""});e.options.callback(n(e.el).select2("data"))})}},queryByIndex:function(e){var t=this;if(t.includeAll){n(t.el).select2("data",[{id:"-1",text:"All"}]),n(t.el).select2("val","-1"),t.options.callback(n(t.el).select2("data"))}else{if(t.options.params.filters=[],1===e.length)e[0]=e[0];else for(var l=0;l<e.length;l++)e[l]="'"+e[l]+"'";t.options.params.filters=[{field:t.options.labelField,values:e,useLike:!0}],t.options.sortBy&&""!==t.options.sortBy&&(t.options.params.sortBy=t.options.sortBy),(e=t.options.params).fromReg=1,e.toReg=1e5;var o="";t.model.getData(e,function(e){if(e.length>0){for(var l=0;l<e.length;l++)e[l].id=e[l].id,o=e[l][t.options.labelField],e[l].text=null===o?"":o,e[l][t.options.labelField]=null===o?"":o,e[l][t.options.valueField]=e[l][t.options.labelField];n(t.el).select2("data",e)}else n(t.el).select2("data",null),n(t.el).select2("val",null);t.options.callback(n(t.el).select2("data"))})}},destroy:function(){n(this.el).select2("destroy")}})}.apply(t,a))||(e.exports=i)}).call(this,l(218),l(1))}}]);