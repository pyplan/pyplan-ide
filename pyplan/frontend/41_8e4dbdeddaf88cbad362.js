/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[41,282],{1381:function(t,e,a){"use strict";(function(n,i,r){var o,d,s=a(18);function l(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}o=[a(687),a(1725)],void 0===(d=function(t,e){var o,d=n.View.extend((o={el:i("#main"),menuInitiated:!1,editionModeInitiated:!1,dashboardModels:[],render:function(e,a){this.dashboardId=e;var n=this;if(this.dashboardModels.push(this.options.dashboardModel),this.dashboardController=new t,r(),1===i(".tabs-area .dash-tabs").length)return!1;function r(){var t=!!event&&i(event.currentTarget).hasClass("reports-view");if(event&&(event.target===window||t)){i(".tabs-area").show();var e=i(".tabs-area .toolbar").width(),a=i(".pagination").width(),r=i("#left").width();i(".nav-tabs").width(i(window).width()-e-a-r-100),setTimeout((function(){n.doAdapt()}),350)}}window.location.href.indexOf("/#shared/")>0&&this.refreshDashboardTabs(a,!0),i(window).resize(r)},reloadDashboard:function(t,e){var a=this.getModel().getItemsModel();i.each(a,(function(t,e){i(e.tagId).trigger("removeItemView")})),this.getModel().removeAllItemsModel();var n=this;this.getModel().getDashboard(t,(function(t){n.refreshDashboardName(t),n.getModel().setNodeOwner(t.nodeOwner),n.parseDashboard(t,e),n.getParent().find("div.breadcrumbs2").show(),n.checkShared(t,!1),n=null}))},refreshDashboardName:function(t){if(t){var e=t.dashboardId,a=t.name;this.dashboardName=a,i("span[data-rel='dashboard-"+e+"']").text(a),i("#topMenuBar li a[rel='dashboard-"+e+"']").text(a),i(".dash-tabs li a[data-rel='"+e+"']").text(a)}},getModel:function(t){var e=t?i(t.target):this.getParent().find(".dash-tabs li a.active"),a=null;if(e.length>0){var n=e.attr("data-rel"),r=e.attr("data-key").split("dashboard-")[1];i.each(this.dashboardModels,(function(t,e){e.attributes.dashId!=n&&e.attributes.dashId!=r||(a=e)}))}return a},checkShared:function(t,e){var a=this.getModel();if(a){if(window.location.href.indexOf("/#shared/")>0)return i(".tabs-area").find(".toolbar .shared-message").hide(),i(".tabs-area").find(".toolbar .btn-group .btn").hide(),i(".tabs-area").find(".toolbar .btn-group .btnRefresh").show(),this.checkFromDiagram(a.attributes),!1;if(null===a.attributes.imOwner||a.attributes.imOwner)e||(i(".tabs-area").find(".toolbar .btnEdit").show(),i(".tabs-area").find(".toolbar .btnShare").show(),i(".tabs-area").find(".toolbar .shared-message").html(""));else{i(".tabs-area").find(".toolbar .btnEdit").hide(),i(".tabs-area").find(".toolbar .btnShare").hide(),i(".tabs-area").find(".toolbar .shared-message").html((0,s.translate)("Is shared"));var n=this;this.getParent().on("refreshImageDashboard",(function(t,e){n.reloadDashboard(e)}))}this.checkFromDiagram(a.attributes)}},addHandlers:function(){var e=this;i(".tabs-area .dash-tabs").on("click",'li a:not(".moreBtn")',(function(){if(event.preventDefault(),i(".tabs-area .dash-tabs ul.-secondary li:visible").length>=1&&i(".tabs-area .dash-tabs .moreBtn").click(),i(".tabs-area .nav-tabs li").find("a").removeClass("active"),i(this).addClass("active"),"true"!==i(this).attr("data-opened")){i(".dashboard-titles li a").attr("data-opened",!1),i(this).attr("data-opened",!0);var t=i(this).attr("data-rel");Promise.resolve().then((function(){var e=[a(687)];(function(e){(new e).showEmbeddableDashboard(t,"dashboard","Loading...",!1,!1,{embeddable:!0})}).apply(null,e)})).catch(a.oe)}var n=i(this).attr("data-rel");Promise.resolve().then((function(){var t=[a(664)];(function(t){(new t).selectTask("dashboard-".concat(n))}).apply(null,t)})).catch(a.oe),e.checkShared(!1)})),i(".tabs-area .dash-tabs").on("click","li i",(function(){i(this).closest("li").find("a").attr("data-key");var t=i(this).closest("li").find("a").attr("data-rel");t=t.indexOf("-")>1?t:parseInt(t.split("-")[0]),e.dashboardModels.splice(e.dashboardModels.findIndex((function(e){return e.attributes.dashId==t})),1),Promise.resolve().then((function(){var n=[a(664)];(function(a){(new a).removeTask("dashboard-"+t),setTimeout((function(){e.refreshDashboardTabs()}),150)}).apply(null,n)})).catch(a.oe)})),i(document).off("contextmenu",".tabs-area li a"),i(document).on("contextmenu",".tabs-area li a",(function(t){return e.showTabContextMenu(i(this),t),!1})),this.getParent().find("div.toolbar button.btnEdit").on("click",i.proxy((function(){e.getGrid().data("gridstack").grid.float=!1,e.getGrid().closest(".dashboardTask").find(".nodeDefinitionWindow").trigger("removePanel"),e.editionModeInitiated||(e.editionModeInitiated=!0),e.refreshMode(!0)}),this)),this.getParent().find("div.toolbar button.btnAdd").on("click",(function(){e.addNewWidget(e)})),this.getParent().find("div.toolbar button.btnShow").on("click",i.proxy((function(){this.refreshMode(!1),this.checkFromDiagram(this.getModel().attributes),e.getGrid().data("gridstack").grid.float=!0,setTimeout((function(){e.saveDashboard(),e.doAdapt()}),200)}),this)),this.getParent().find("div.toolbar button.btnCancel").on("click",(function(){e.getParent().find("div.toolbar button.btnShow").hide(),e.getParent().find("div.toolbar button.btnCancel").hide(),e.getParent().find("div.toolbar button.btnAdd").hide(),e.getParent().find("div.sure_cancel_dashboard").show(),e.getParent().find("div.toolbar button.btnGoCancel").show(),e.getParent().find("div.toolbar button.btnCancelCancel").show()})),this.getParent().find("div.toolbar button.btnGoCancel").on("click",(function(){var t=e.getParent().find("a.active").attr("data-rel");e.getParent().find("div.sure_cancel_dashboard").hide(),e.refreshMode(!1),e.getGrid().addClass("grid-stack-autoposition"),i('[data-rel="dashboard-'+t+'"]').trigger("reloadDashboard")})),this.getParent().find("div.toolbar button.btnCancelCancel").on("click",(function(){e.getParent().find("div.sure_cancel_dashboard").hide(),e.getParent().find("div.toolbar button.btnShow").show(),e.getParent().find("div.toolbar button.btnCancel").show(),e.getParent().find("div.toolbar button.btnAdd").show()})),this.getParent().find("div.toolbar button.btnShare").on("click",i.proxy((function(){var t=i(".dashboardTask:visible").attr("data-id").split(/-(.+)/)[1];(0,s.haveAccess)("share_dashboard")?a.e(51).then((function(){var e=[a(1223)];(function(e){(new e).showSharer(t)}).apply(null,e)})).catch(a.oe):a.e(18).then((function(){var t=[a(665)];(function(t){(new t).show({title:"WARNING!",text:(0,s.translate)("share_dashboard_access_denied"),notifyType:"error"})}).apply(null,t)})).catch(a.oe)}),this)),this.getParent().find("div.toolbar button.btnScenarios").on("click",(function(){a.e(34).then((function(){(function(t){var n=[a(973)];(function(a){var n={nodeList:[]},r=[];i.each(i(".dash-tabs li a"),(function(t,a){var n=i(this).attr("data-rel");r=i('div.mainTask[data-rel="dashboard-'+n+'"]').triggerHandler("getModel",[r]),d=e.getModel().getItemModel(n)}));var o=[];i.each(r,(function(t,e){i.each(e.getItemsModel(),(function(t,e){o.push(e)}))}));var s=["indexlist","formnode","selector","button","objectItem","map","indicator"];"cubengine"==__currentSession.modelInfo.engine&&(s=["indexlist","formnode","selector","button","objectItem","map"]),i.each(o,(function(e,a){if(a&&a.currentNodeId)if(a.currentResult&&-1!==t.inArray(a.currentResult.itemType,s));else{var r=a.currentNodeId;a.currentResult&&a.currentResult.nodeProperties&&a.currentResult.nodeProperties.originalId&&(r=a.currentResult.nodeProperties.originalId),a.pivotTable&&a.pivotTable.metadata&&a.pivotTable.metadata.nodeProperties&&a.pivotTable.metadata.nodeProperties.originalId&&(r=a.pivotTable.metadata.nodeProperties.originalId),0===i.grep(n.nodeList,(function(t){return t.id===r})).length&&n.nodeList.push({id:r,name:a.currentResult&&a.currentResult.itemProperties&&a.currentResult.itemProperties.title?a.currentResult.itemProperties.title.text:a.currentNodeId})}})),(new a).show(n)}).apply(null,n)}).call(this,a(1))})).catch(a.oe)})),this.getParent().find("div.toolbar button.btnDataSnapshot").on("click",(function(){a.e(34).then((function(){var t=[a(973)];(function(t){(new t).showDataSnapshot()}).apply(null,t)})).catch(a.oe)})),this.getParent().find("div.toolbar button.btnCopy").on("click",(function(){var t=i(".dashboardTask:visible").attr("data-id").split(/-(.+)/)[1],n=e.getParent().find("a.active").first().text();e.dashboardController.showCopyDashboard(t,n,(function(t,n){Promise.resolve().then((function(){var r=[a(687)];(function(a){i("#model-summary").trigger("fullRefresh"),e.dashboardController.showDashboard(t,-1,n)}).apply(null,r)})).catch(a.oe)}))})),this.getParent().find("div.toolbar button.btnPulishInMy").on("click",(function(){var e=i(".dashboardTask:visible").attr("data-id").split(/-(.+)/)[1],a=new t,n={title:(0,s.translate)("publish_dashboard_to_my_pyplan"),okOnEnter:!0,modalClass:"smallModal",itemId:e,itemType:"dashboard"};__currentSession.my_uuid?a.publishToMyPyplanModal(n):a.loginInToMyPyplanModal(function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})))),n.forEach((function(e){l(t,e,a[e])}))}return t}({},n,{title:(0,s.translate)("login_to_my_pyplan")}))})),this.getParent().find("div.toolbar button.btnRefresh").on("click",i.proxy((function(){Promise.resolve().then((function(){var t=[a(220)];(function(t){(new t).executeForRefresh((function(t){var a=[];e.noQuery&&i.each(e.noQuery,(function(t,e){i.each(e.rel,(function(t,e){a.push(e)}))})),e.getModel().initializeDashboardQuery(e.noQuery);var n=e.getModel().getItemsModel();i.each(n,(function(t,e){a.indexOf(e.currentNodeId)>=0||i(e.tagId).trigger("refreshItemDash")}))}))}).apply(null,t)})).catch(a.oe)}),this)),this.getParent().find("div.toolbar button.btnComments").on("click",(function(){var t=e.getParent().find("a.active").attr("data-rel");Promise.resolve().then((function(){var n=[a(687)];(function(a){(new a).showDashboardComments({dashboardId:t,parent:e.getParent()})}).apply(null,n)})).catch(a.oe)})),this.getParent().find("div.toolbar button.btnPrint").on("click",(function(){var t=e.getParent().find("a.active").attr("data-rel");Promise.resolve().then((function(){var e=[a(763)];(function(e){(new e).printDashboard(t)}).apply(null,e)})).catch(a.oe)})),this.getParent().find(".main-fullscreen button[data-rel='close-screen']").on("click",(function(){var t=i(this).closest(".main-fullscreen").find(".item-area").parent(),a="#"+t.attr("data-parent"),n=(t.attr("data-parent"),i(a)),r=i(this).closest(".main-fullscreen"),o=(n.offset(),t.attr("data-orignal-w")),d=t.attr("data-orignal-h"),s=t.attr("data-orignal-y"),l=t.attr("data-orignal-x"),h=i(this);r.animate({top:s+"px",left:l+"px",width:o,height:d},{done:function(){i.wrapper.append(t.detach()),r.hide(),h.show(),e.updateSizes(),e.getModel().getItemModel(a).onEndNormalScreenAnimation()}}),e.getModel().getItemModel(a).updateSize(o,d,!0)})),this.getParent().find(".report-navigator a").on("click",(function(){event.preventDefault();var t=i(this).attr("data-id"),a=i(this).attr("data-rel"),n=i(this).attr("title");if(t){if(e.dashboardController.showDashboard(t,a,n),e.getParent().find(".dash-tabs li a.active").attr("data-rel")===a)return;e.getNavigator(t)}}))},getCurrentViewPort:function(){var t;return this.isBreakpoint("xs")?t="xs":this.isBreakpoint("sm")?t="sm":this.isBreakpoint("md")?t="md":this.isBreakpoint("lg")&&(t="lg"),t},checkFromDiagram:function(t){var e=i(".tabs-area .toolbar"),a=e.find(".btnCopy"),n=e.find(".btnPulishInMy");t.node&&""!==t.node&&null!==t.node?(a.hide(),e.find(".btnShare").hide(),n.hide()):(window.location.href.indexOf("/#shared/")<0&&a.show(),n.show())},addNewWidget:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;(c=t).fromAddButton=!0;var r=this.getGrid().data("gridstack"),o=0;r.grid.nodes.length>0&&(o=Math.max.apply(Math,r.grid.nodes.map((function(t){return t.y+t.height}))));var d=this.getCurrentViewPort(),s=12,l=7;switch(d){case"xs":s=2,l=3;break;case"sm":case"md":s=6,l=4;break;case"lg":s=12}var h={x:0,y:o,width:s,height:l};e&&(h=e);var c=this;n&&"empty"!=n.itemType?a.e(0).then((function(){var t=[a(717)];(function(t){var e=new t({model:c.getModel()});e.setElement(i("div.grid-stack")),e.currentResult=i.extend(!0,{},n.currentResult),e.grid=r,e.dashboardModel=c.getModel(),e.loadingDashboard=!0,e.currentResult.itemId=i.uuid(),e.currentResult.itemType="table"==n.currentResult.itemType?"columnchart":"table",e.currentResult.itemProperties.bottomTotal=!1,e.currentResult.itemProperties.rightTotal=!1,e.currentResult.x=h.x,e.currentResult.y=h.y,e.currentResult.width=h.width,e.currentResult.height=h.height,c.getModel().addItemToModel(e),e.createNewView(e.currentResult,!1)}).apply(null,t)})).catch(a.oe):Promise.resolve().then((function(){var t=[a(687)];(function(t){(new t).getEmptyContent(c.getModel(),(function(t){t.setElement(c.getGrid()),t.model=c.getModel(),t.grid=r,t.currentResult=h,t.itemType="empty",t.currentResult.itemType="empty",t._applyItemId(h,null);t.render(null,null,!0),c.getModel().addItemToModel(t),t.setEditMode(c.getModel().editMode)}))}).apply(null,t)})).catch(a.oe),c.getModel().setStateModified(!0)},refreshMode:function(t){var e=this;e.getModel().editMode=t,this.getParent().find("div.toolbar button").hide(),this.getGrid().data("gridstack").setStatic(!t);var n=this.getModel().getItemsModel();i.each(n,(function(e,a){a.setEditMode(t)})),t?(this.getParent().find(".dash-tabs").hide(),this.getGrid().addClass("editing"),this.getParent().find("div.toolbar button.btnShow").show(),this.getParent().find("div.toolbar button.btnCancel").show(),this.getParent().find("div.toolbar button.btnAdd").show(),this.getGrid().removeClass("grid-stack-autoposition")):(this.getParent().find(".dash-tabs").show(),this.getGrid().removeClass("editing"),this.getParent().find("div.toolbar button").show(),this.getParent().find("div.toolbar button.btnShow").hide(),this.getParent().find("div.toolbar button.btnCancel").hide(),this.getParent().find("div.toolbar button.btnAdd").hide()),a.e(86).then((function(){var t=[a(749)];(function(t){(new t).list(null,(function(t){e.getModel().setStyleLibraries(t)}))}).apply(null,t)})).catch(a.oe)},sortWidgets:function(t,e){return t.currentResult.y<e.currentResult.y?-1:t.currentResult.y>e.currentResult.y?1:t.currentResult.x<e.currentResult.x?-1:t.currentResult.x>e.currentResult.x?1:0},saveDashboard:function(){var t=this,e={},a=[],n=this.getModel().getItemsModel(),r=[],o=[];i.each(n,(function(t,e){var a=e.getRelatedNoQuery();a&&a.length>0&&r.push({node:e.currentNodeId,rel:a});var n=e.getStylesUsed();n&&(o=o.concat(n))})),e.noQuery=r,n.sort(this.sortWidgets),i.each(n,(function(t,n){e={};var r=n.tagId;if(n){e.index=t,e.nodeId=n.currentNodeId,e.itemId=n.itemId;var o=n.grid.grid.getNodeDataByDOMEl(i(r));e.x=o.x,e.y=o.y,e.width=o.width,e.height=o.height,e.itemProperties=n.currentResult.itemProperties,e.itemType=n.currentResult.itemType,e.objectType=n.currentResult.objectType,n.currentResult&&(e.itemType=n.currentResult.itemType,"objectItem"==e.itemType&&(e.objectType=n.currentResult.objectType),e.rows=n.currentResult.rows,e.columns=n.currentResult.columns,e.dims=n.currentResult.dims,e.itemProperties=n.currentResult.itemProperties),a.push(e)}}));var d=t.getParent().find(".dash-tabs li a.active").attr("data-key").split(/-(.+)/)[1];this.getModel().getDashboard(d,(function(e){var r,s=t.getModel().getStateModified();switch(r=e.definition?e.definition:{},t.getCurrentViewPort()){case"xs":r.definitionSmall=a,s&&(delete r.definitionLarge,delete r.definitionMedium);break;case"sm":case"md":r.definitionMedium=a,s&&(delete r.definitionLarge,delete r.definitionSmall);break;case"lg":r.definitionLarge=a,s&&(delete r.definitionMedium,delete r.definitionSmall)}t.getModel().updateDefinition(d,r,o,(function(){i.each(n,(function(t,e){e.onSaveDashboard()})),t.getModel().setStateModified(!1),t=null}))}))},recalcWidgets:function(t,e){var a,n=this.getCurrentViewPort(),i=t;switch(e){case"xs":a=r.map(i,(function(t){var e,a=1===t.width||2===t.width?t.width:2;e=a>=2?0:0===t.x||1===t.x?t.x:0;var n=Object.assign({},t);return n.width=a,n.x=e,n}),this);break;case"sm":case"md":var o=2;"xs"===n&&(o=3);a=r.map(i,(function(t){var e=t.width*o;e=Math.floor(e);var a=t.x*o;a=Math.floor(a);var n=Object.assign({},t);return n.width=e,n.x=a,n}),this);break;case"lg":o=2;"xs"===n&&(o=6),a=r.map(i,(function(t){var e=t.width*o;e=Math.floor(e);var a=t.x*o;a=Math.floor(a);var n=Object.assign({},t);return n.width=e,n.x=a,n}),this)}return a}},l(o,"getCurrentViewPort",(function(){var t;return this.isBreakpoint("xs")?t="xs":this.isBreakpoint("sm")?t="sm":this.isBreakpoint("md")?t="md":this.isBreakpoint("lg")&&(t="lg"),t})),l(o,"isBreakpoint",(function(t){return i(".device-"+t).is(":visible")})),l(o,"showTabContextMenu",(function(t,e){var n={_me:{name:(0,s.translate)("close")},_all:{name:(0,s.translate)("close_all")},_others:{name:(0,s.translate)("close_all_but_this")}};i.contextMenu("destroy",".tabs-area"),i.contextMenu({selector:".tabs-area",callback:function(e,n){switch(e){case"_me":t.closest("li").find("i").click();break;case"_all":case"_others":var r=t.attr("data-key");"_all"==e&&(r="_123123_"),Promise.resolve().then((function(){var n=[a(664)];(function(a){var n=new a,o=[];t.closest("ul.dash-tabs").find("li a:not(.moreBtn)").each((function(t,e){i(e).attr("data-key")!=r&&o.push(i(e).attr("data-key"))})),o.length>0&&i.each(o,(function(t,a){"_all"==e?n.removeTask(a,!1):(n.selectTask(r),n.removeTask(a,!0))}))}).apply(null,n)})).catch(a.oe)}},items:n,events:{hide:function(t){i.contextMenu("destroy",".tabs-area")}},zIndex:0}),i(".tabs-area").contextMenu({x:e.clientX,y:e.clientY})})),l(o,"refreshDashboardTabs",(function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this,n=[];e?this.options.dashboardModel.getNavigator({dashboardId:this.dashboardId},(function(e){e&&e.list.length>1?i.each(e.list,(function(t,e){n.push({id:e.uuid||e.id,key:"dashboard-"+(e.uuid||e.id),title:e.name,closeBtn:!1,notDesktop:!1})})):"dashboard"!==t&&"evaluatedNode"!==t&&void 0!==t||a.dashboardModels.forEach((function(t){var e="dashboard-"+t.attributes.dashId,a=t.attributes.dashId,r=!!t.attributes.extraOptions&&t.attributes.extraOptions.closable,o=i("#topMenuBar ul li a[rel='"+e+"']").text();o||(o=i('.dashboardTask.new[data-rel="'+e+'"]').attr("dash-title")),n.push({id:a,key:e,title:o,closeBtn:r,notDesktop:!1})})),n.length>0&&a.drawTabs(n)})):(i(".dashboardTask.new").each((function(t,e){var a=i(e).attr("data-rel"),r=a.split(/-(.+)/)[1],o=i("#topMenuBar ul li a[rel='"+a+"']").text();o||(o=i(e).attr("dash-title")),n.push({id:r,key:a,title:o,closeBtn:!0,notDesktop:!1})})),n.length>0&&a.drawTabs(n))})),l(o,"drawTabs",(function(t){var a=this;i(".tabs-area").remove();var n,r=i(".tabs-area");if(r.empty(),r.hide(),t.length>0){var o=e(t);i(o).insertBefore(i(i(".mainTask.dashboardTask")[0])),r.show()}var d=i(".dashboardTask:visible").attr("data-rel");window.location.href.indexOf("/#shared/")>0?n=i('.tabs-area .nav-tabs li a[data-key="'+d+'"]'):(n=i('.tabs-area .nav-tabs li a[data-key="'+d+'"]'),this.dashboardId=n.attr("data-rel")),n.addClass("active"),n.attr("data-opened",!0),n.click(),this.getNavigator(this.dashboardId);var s=i(".nav-tabs"),l=s.find(".-primary");s.addClass("--jsfied"),l.append('\n        <li class="-more">\n          <a class="moreBtn" aria-haspopup="true" aria-expanded="false">\n            More <span>&darr;</span>\n          </a>\n          <ul class="-secondary">\n            '.concat(l.html(),"\n          </ul>\n        </li>\n      "));var h=i("li.-more").find(".moreBtn");h.on("click",(function(t){t.preventDefault(),s.toggleClass("--show-secondary"),h.attr("aria-expanded",s.hasClass("--show-secondary"))})),this.addHandlers(),this.doAdapt(),i(".tabs-area .toolbar").on("pendingRefresh",(function(t,e){var n=a.getParent().find(".dash-tabs li a");i.each(n,(function(t,n){var r=i(n).attr("data-rel");i.each(a.dashboardModels,(function(t,a){parseInt(a.attributes.dashId)===parseInt(r)&&i.each(a.getItemsModel(),(function(t,a){a.currentNodeId==e.nodeId&&i(n).attr("pending-refresh",!0)}))}))}))})),i(".tabs-area .toolbar").on("checkIfPendingRefresh",(function(){"true"===a.getParent().find(".dash-tabs li a.active").attr("pending-refresh")&&(i(".tabs-area .toolbar .btnRefresh").click(),a.getParent().find(".dash-tabs li a.active").attr("pending-refresh",!1)),a.checkShared(null,!1)})),a.checkShared(null,!1)})),l(o,"getNavigator",(function(t){var e=this,a=this.getModel();a&&(a.getNavigator({dashboardId:t},(function(a){if(a&&a.list.length>1){(a.priorUuid>0||a.priorId>0)&&e.getParent().find(".btnNavigatorPrior").attr("data-id",a.priorUuid||a.priorId).attr("data-rel",a.priorId).attr("title",a.priorName).closest("li").removeClass("disabled"),(a.nextUuid>0||a.nextId>0)&&e.getParent().find(".btnNavigatorNext").attr("data-id",a.nextUuid||a.nextId).attr("data-rel",a.nextId).attr("title",a.nextName).closest("li").removeClass("disabled"),e.getParent().find(".nav-tabs li a").removeClass("active");var n=e.getParent().find('.nav-tabs li a[data-rel="'.concat(t,'"]'));0===n.length&&(n=e.getParent().find('.nav-tabs li a[data-key="dashboard-'.concat(t,'"]'))),n.addClass("active")}else e.getParent().find(".btnNavigatorPrior").closest("li").addClass("disabled"),e.getParent().find(".btnNavigatorNext").closest("li").addClass("disabled")})),window.location.href.indexOf("/#shared/")>0&&i(".report-navigator").hide())})),l(o,"doAdapt",(function(){i(".tabs-area").show();var t=i(".tabs-area .toolbar").width(),e=(i(".nav-tabs").width(),i(".pagination").width()),a=i("#left").width();i(".nav-tabs").width(i(window).width()-t-e-a-100);var n=i(".nav-tabs"),r=n.find(".-primary"),o=n.find(".-primary > li:not(.-more)"),d=n.find(".-secondary").find("li"),s=n.find("li"),l=i("li.-more"),h=l.find(".moreBtn");s.each((function(t,e){e.classList.remove("--hidden")}));var c=h.length>0?h.width():0,u=[],f=r.length>0?r.width():0;o.each((function(t,e){f>=c+e.offsetWidth?c+=e.offsetWidth:(e.classList.add("--hidden"),u.push(t))})),u.length?d.each((function(t,e){u.includes(t)||e.classList.add("--hidden")})):(l.addClass("--hidden"),n.removeClass("--show-secondary"),h.attr("aria-expanded",!1)),i(".mainTask:visible").hasClass("dashboardTask")?i(".tabs-area").show():i(".tabs-area").hide()})),l(o,"getParent",(function(){return i(".tabs-area")})),l(o,"getGrid",(function(){var t=this.getParent().find("a.active").attr("data-rel");return i(".grid-dash-"+t)})),o));return d}.apply(e,o))||(t.exports=d)}).call(this,a(219),a(1),a(221))},1724:function(t,e,a){var n=a(670);t.exports=(n.default||n).template({1:function(t,e,a,n,i){return" from-external "},compiler:[8,">= 4.3.0"],main:function(t,e,a,n,i){var r,o,d=null!=e?e:t.nullContext||{},s=t.hooks.helperMissing,l=t.escapeExpression,h=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div\n  class="container-fluid mainTask full-horizontal dashboardTask new hideClose '+(null!=(r=h(a,"if").call(d,null!=(r=null!=e?h(e,"extraOptions"):e)?h(r,"external"):r,{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.noop,data:i,loc:{start:{line:2,column:78},end:{line:2,column:129}}}))?r:"")+'"\n  data-rel="dashboard-'+l("function"==typeof(o=null!=(o=h(a,"id")||(null!=e?h(e,"id"):e))?o:s)?o.call(d,{name:"id",hash:{},data:i,loc:{start:{line:3,column:22},end:{line:3,column:28}}}):o)+'" dash-name="'+l("function"==typeof(o=null!=(o=h(a,"dashTitle")||(null!=e?h(e,"dashTitle"):e))?o:s)?o.call(d,{name:"dashTitle",hash:{},data:i,loc:{start:{line:3,column:41},end:{line:3,column:54}}}):o)+'" data-type="tab-content">\n\n\n\n  <div class="breadcrumbs2 nodisplay">\n  </div>\n\n  <div class="device-xs visible-xs"></div>\n  <div class="device-sm visible-sm"></div>\n  <div class="device-md visible-md"></div>\n  <div class="device-lg visible-lg"></div>\n  <div class="device-xl visible-xl"></div>\n\n  <div style="display: none;">\n    <span>Number of Columns:</span> <span id="grid-size"></span>\n  </div>\n\n\n\n  <div class="grid-stack grid-dash-'+l("function"==typeof(o=null!=(o=h(a,"id")||(null!=e?h(e,"id"):e))?o:s)?o.call(d,{name:"id",hash:{},data:i,loc:{start:{line:22,column:35},end:{line:22,column:41}}}):o)+' dashboard-area main-pane">\n  </div>\n\n\n  <div class="main-fullscreen" style="display: none; position:absolute;">\n    <div class="item-toolbar-view">\n      <button class="btn btn-small" data-rel="close-screen">\n        <i class="fa fa-arrows-alt"></i>\n      </button>\n    </div>\n  </div>\n</div>'},useData:!0})},1725:function(t,e,a){var n=a(670);function i(t){return t&&(t.__esModule?t.default:t)}t.exports=(n.default||n).template({1:function(t,e,n,r,o){return'      <button class="btn btnEdit" title="'+t.escapeExpression(i(a(668)).call(null!=e?e:t.nullContext||{},"edit_dashboard",{name:"L",hash:{},data:o,loc:{start:{line:6,column:41},end:{line:6,column:63}}}))+'">\n        <i class="fa fa-pencil-square-o"></i>\n      </button>\n      <button class="btn btnShow nodisplay">\n        <i class="fa fa-check"></i>\n      </button>\n      <button class="btn btnCancel nodisplay">\n        <i class="fa fa-times"></i>\n      </button>\n      <button class="btn btnAdd nodisplay">\n        <i class="fa fa-plus"></i>\n      </button>\n'},3:function(t,e,a,n,i){return""},5:function(t,e,n,r,o){return'      <button class="btn btnCopy" title="'+t.escapeExpression(i(a(668)).call(null!=e?e:t.nullContext||{},"copy_dashboard",{name:"L",hash:{},data:o,loc:{start:{line:29,column:41},end:{line:29,column:63}}}))+'">\n        <i class="far fa-copy"></i>\n      </button>\n'},7:function(t,e,n,r,o){var d;return null!=(d=i(a(681)).call(null!=e?e:t.nullContext||{},"share_dashboard",{name:"haveAccess",hash:{},fn:t.program(8,o,0),inverse:t.noop,data:o,loc:{start:{line:49,column:6},end:{line:53,column:21}}}))?d:""},8:function(t,e,n,r,o){return'      <button class="btn btnShare" title="'+t.escapeExpression(i(a(668)).call(null!=e?e:t.nullContext||{},"share",{name:"L",hash:{},data:o,loc:{start:{line:50,column:42},end:{line:50,column:55}}}))+'">\n        <i class="fa fa-share-square"></i>\n      </button>\n'},10:function(t,e,n,r,o){return'      <button class="btn btn-success btnPulishInMy" title="'+t.escapeExpression(i(a(668)).call(null!=e?e:t.nullContext||{},"publish_dashboard_to_my_pyplan",{name:"L",hash:{},data:o,loc:{start:{line:55,column:59},end:{line:55,column:97}}}))+'">\n        <i class="fad fa-cloud-upload-alt"></i>\n      </button>\n'},12:function(t,e,n,r,o){var d,s=t.lambda,l=t.escapeExpression,h=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'      <li>\n        <a href="#" data-rel="'+l(s(null!=e?h(e,"id"):e,e))+'" data-key="'+l(s(null!=e?h(e,"key"):e,e))+'" title="'+l(s(null!=e?h(e,"title"):e,e))+'">'+l(s(null!=e?h(e,"title"):e,e))+"</a>\n"+(null!=(d=i(a(669)).call(null!=e?e:t.nullContext||{},null!=e?h(e,"closeBtn"):e,"==",!0,{name:"ifCond",hash:{},fn:t.program(13,o,0),inverse:t.noop,data:o,loc:{start:{line:78,column:8},end:{line:80,column:19}}}))?d:"")+"      </li>\n"},13:function(t,e,a,n,i){return'        <i class="fa fa-close" />\n'},compiler:[8,">= 4.3.0"],main:function(t,e,n,r,o){var d,s=null!=e?e:t.nullContext||{},l=t.escapeExpression,h=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="tabs-area">\n\n  <div class="toolbar" style="float: left; background: #eee; padding-right:2px;">\n    <div class="btn-group">\n'+(null!=(d=i(a(681)).call(s,"add_dashboard",{name:"haveAccess",hash:{},fn:t.program(1,o,0),inverse:t.noop,data:o,loc:{start:{line:5,column:6},end:{line:18,column:21}}}))?d:"")+'      <button class="btn btnRefresh" title="'+l(i(a(668)).call(s,"refresh_dashboard",{name:"L",hash:{},data:o,loc:{start:{line:19,column:44},end:{line:19,column:69}}}))+'">\n        <i class="fa fa-refresh"></i>\n      </button>\n\n'+(null!=(d=i(a(681)).call(s,"MANAGESCENARIOS",{name:"haveAccess",hash:{},fn:t.program(3,o,0),inverse:t.noop,data:o,loc:{start:{line:23,column:6},end:{line:27,column:21}}}))?d:"")+(null!=(d=i(a(681)).call(s,"add_dashboard",{name:"haveAccess",hash:{},fn:t.program(5,o,0),inverse:t.noop,data:o,loc:{start:{line:28,column:6},end:{line:32,column:21}}}))?d:"")+"\n\n"+(null!=(d=i(a(681)).call(s,"list_dashboardcomments",{name:"haveAccess",hash:{},fn:t.program(3,o,0),inverse:t.noop,data:o,loc:{start:{line:38,column:6},end:{line:42,column:21}}}))?d:"")+"\n\n"+(null!=(d=h(n,"if").call(s,null!=(d=null!=e?h(e,"0"):e)?h(d,"notDesktop"):d,{name:"if",hash:{},fn:t.program(7,o,0),inverse:t.program(10,o,0),data:o,loc:{start:{line:48,column:6},end:{line:58,column:13}}}))?d:"")+'\n      <div class="sure_cancel_dashboard nodisplay">\n        <span>'+l(i(a(668)).call(s,"sure_cancel_save_dashboard",{name:"L",hash:{},data:o,loc:{start:{line:61,column:14},end:{line:61,column:48}}}))+'</span>\n        <button class="btn btn-small btnCancelCancel">'+l(i(a(668)).call(s,"cancel",{name:"L",hash:{},data:o,loc:{start:{line:62,column:54},end:{line:62,column:68}}}))+'</button>\n        <button class="btn btn-small btn-red btnGoCancel">'+l(i(a(668)).call(s,"_discard_changes",{name:"L",hash:{},data:o,loc:{start:{line:63,column:58},end:{line:63,column:82}}}))+'</button>\n      </div>\n\n      <a class="btn btn-default" id="save-widgets" href="#" style="display: none;">Save</a>\n\n    </div>\n    <span class="shared-message"></span>\n  </div>\n\n  <nav class="nav-tabs" style="float: left;">\n    <ul class="dash-tabs -primary nodisplay">\n\n'+(null!=(d=h(n,"each").call(s,e,{name:"each",hash:{},fn:t.program(12,o,0),inverse:t.noop,data:o,loc:{start:{line:75,column:6},end:{line:82,column:15}}}))?d:"")+'\n    </ul>\n  </nav>\n\n  <ul class="pagination pagination-sm report-navigator">\n    <li class="disabled">\n      <a href="#" class="btnNavigatorPrior">\n        <i class="fa fa-chevron-left"></i>\n      </a>\n    </li>\n    <li class="disabled">\n      <a href="#" class="btnNavigatorNext">\n        <i class="fa fa-chevron-right"></i>\n      </a>\n    </li>\n  </ul>\n</div>'},useData:!0})},726:function(t,e,a){"use strict";(function(n,i){var r,o=a(679);void 0===(r=function(){return n.Model.extend({defaults:{dashId:null,dashboardViewList:[],modifiedDash:!1,noQuery:[],styleLibraries:[],nodeOwner:"",extraOptions:void 0},resizeTimeOut:0,getDashboard:function(t,e){(0,o.send)("dashboardManager/by_id/".concat(t,"/"),null,null,(function(t){t&&(e(t),i("#summary").trigger("refresh"))}))},getNavigator:function(t,e){var a=t.reportId,n=void 0===a?null:a,i=t.dashboardId,r=void 0===i?null:i,d="";n?(d="?report_id=".concat(n),r&&(d+="&dashboard_id=".concat(r))):r&&(d="?dashboard_id=".concat(r)),(0,o.send)("reportManager/getNavigator/".concat(d),null,null,e)},calculateScaleFactor:function(t,e){if(this.getItemsModel().length>0)for(var a=this.getItemsModel(),n=0;n<a.length;n++)a[n].calculateScaleFactor(t,e)},updateSizes:function(t,e){if(this.getItemsModel().length>0){var a=300;e&&(a=1),clearTimeout(this.resizeTimeOut);var n=this.getItemsModel();this.resizeTimeOut=setTimeout((function(){var t;for(t=0;t<n.length;t++)n[t].baseUpdateSize(),n[t].updateSize()}),a)}},setStateModified:function(t){this.set({modifiedDash:t})},getStateModified:function(){return this.get("modifiedDash")},addItemToModel:function(t){this.get("dashboardViewList").push(t)},getItemsModel:function(){return this.get("dashboardViewList")},getItemModel:function(t){var e,a=this.getItemsModel();for(e=0;e<a.length;e++)if(a[e].tagId==t)return a[e]},countItemsModelByNodeId:function(t){for(var e=0,a=this.getItemsModel(),n=0;n<a.length;n++)a[n].currentNodeId&&t&&a[n].currentNodeId.toLowerCase()==t.toLowerCase()&&e++;return e},removeItemModel:function(t){var e,a=this.getItemsModel();for(e=0;e<a.length;e++)if(a[e].tagId==t.tagId){a.splice(e,1);break}this.set({dashboardViewList:a})},removeAllItemsModel:function(){this.set("dashboardViewList",[])},changeItemModel:function(t,e){this.removeItemModel(t),this.addItemToModel(e)},setNodeOwner:function(t){this.set("node",t)},getNodeOwner:function(){return this.get("node")},onFilterChange:function(t,e,a,n,i,r){if(i){var o=this.getItemModel(i);if(o&&o.isUnlinkedIndex(t))return void o.onFilterChange(t,e,a,n,!0)}var d=this.getItemsModel();if(d)for(var s=0;s<d.length;s++)d[s].onFilterChange(t,e,a,n,!1,r)},onFiltersChange:function(t){var e=this.getItemsModel();if(e)for(var a=0;a<e.length;a++)e[a].onFiltersChange(t)},synchronizeDrop:function(t,e,a,n,i,r,o){if(o){var d=this.getItemsModel();if(d)for(var s=0;s<d.length;s++)d[s].tagId&&d[s].tagId!=o&&d[s].onSynchronizeDrop(t,e,a,n,i,r)}},synchronizeLevel:function(t,e,a){if(a){var n=this.getItemsModel();if(n)for(var i=0;i<n.length;i++)n[i].tagId&&n[i].tagId!=a&&n[i].onSynchronizeLevel(t,e)}},getNodeFullData:function(t,e,a,n){var i={node:t};e&&(i.fromRow=1,i.toRow=e),(0,o.send)("dashboardManager/getNodeFullData/",i,{type:"GET"},a,n)},getNodeIndexes:function(t,e){(0,o.send)("dashboardManager/getNodeIndexes/",{node:t},null,(function(t){t&&e(t)}))},getIndexValues:function(t,e){(0,o.send)("dashboardManager/getIndexValues/",t,null,(function(t){t&&e(t)}))},getGeoDef:function(t,e){(0,o.send)("Dashboard/GetGeoDef/"+t,null,null,(function(t){t&&e(t)}))},evaluateNode:function(t,e,a,n,i,r,d,s,l,h,c,u,f,g,b){s||(s="sum");var m={node:t,dims:e,rows:a,columns:n,summaryBy:s,bottomTotal:c,rightTotal:u,timeFormat:f,timeFormatType:g,calendarType:b},v="evaluateNode";r&&(v="evaluateNodeDef"),l&&l>0&&h&&h>0&&(m.fromRow=l*(h-1)+1,m.toRow=l*h),(0,o.send)("dashboardManager/".concat(v,"/"),JSON.stringify(m),{type:"POST",contentType:"application/json;charset=utf-8"},i,d)},evaluateNodeForPivot:function(t,e,a,n){(0,o.send)("Dashboard/EvaluateNodeForPivot/",{node:t},{type:"GET"},(function(t){var r=t.value,o={success:function(t,a,n){e(t)},complete:function(){i("#mainLoading").hide(),i("#secondLoading").hide(),a()},dataType:"json",progress:function(t){if(t.lengthComputable){var e=t.loaded/t.total*100;n(e)}else try{var a=this.getResponseHeader("X-Content-Length");e=t.loaded/a*100;n(e)}catch(t){}}};i("#secondLoading").show(),i.ajax("".concat(__apiURL,"/scripts/download.aspx?name=").concat(r),o)}),a)},updateDefinition:function(t,e,a,n){var r=[];a&&i.each(a,(function(t,e){r.push({id:e})}));var d={dashboardId:t,definition:e,styles:a};(0,o.send)("dashboardManager/".concat(t,"/"),JSON.stringify(d),{type:"PATCH",contentType:"application/json;charset=utf-8",dataType:"text"},(function(t){null!=n&&n(t)}))},updateDashboardImage:function(t,e,a){var n={id:t,fileData:e};(0,o.send)("Dashboard/UpdateImage/",n,{type:"PUT"},(function(e){i("#summary").trigger("refresh"),i("#model-summary").trigger("refresh",{id:t}),e&&a&&a(e)}))},validateIndexes:function(t,e){var a=function(e){var a;for(a=0;a<t.length;a++)if(t[a].field==e)return t[a]},n=function(t){var e,n;for(e=0;e<t.length;e++)null!=(n=a(t[e].field))&&(t[e].name=n.name)};n(e.dims),n(e.rows),n(e.columns)},initializeDashboardQuery:function(t){this.set("noQuery",t),this._initNoQuery()},_initNoQuery:function(){var t=this.get("noQuery");t&&t.length>0&&i.each(t,(function(t,e){e.started=!1}))},isReadyForEvaluate:function(t,e){var a=!0,n=this.get("noQuery");return n&&n.length>0&&i.each(n,(function(n,i){i.node==t?i.started=!0:0==i.started&&i.rel&&i.rel.indexOf(e)>=0&&(a=!1)})),a},setNodeValueChanges:function(t,e){(0,o.send)("dashboardManager/pivotGrid/setCubeChanges/",JSON.stringify(t),{type:"POST",contentType:"application/json;charset=utf-8"},(function(t){e(t),i("body").trigger("pendingChanges",[!0])}))},isResultComputed:function(t,e){(0,o.send)("dashboardManager/isResultComputed/",JSON.stringify({nodes:t}),{type:"POST",contentType:"application/json;charset=utf-8"},(function(t){e(t)}))},reevaluateNodesNeeded:function(t){i(".dashboardTask").trigger("reevaluateNodesNeeded",[t])},reevaluateNodesNeededInThisDashboard:function(t){for(var e=[],a=this.getItemsModel(),n=0;n<a.length;n++){var r=a[n].getNodesOfView();r&&(e=e.concat(r))}e.length>0&&this.isResultComputed(e,(function(e){if(e&&e.length>0)for(var n=0;n<a.length;n++)t&&a[n].tagId==t||(e.indexOf(a[n].currentNodeId)>=0&&i(a[n].tagId).trigger("evaluateNodeFromCurrentResult"),a[n].needRefresh(e)&&a[n].refreshItemDash())}))},applyNumberFormat:function(t){for(var e=this.getItemsModel(),a=0;a<e.length;a++)e[a].currentNodeId==t&&e[a].applyNumberFormat()},getStyleLibrary:function(t){var e=this.get("styleLibraries");if(e)for(var a=0;a<e.length;a++)if(e[a].id==t)return e[a].definition;return[]},getStyleLibraries:function(){return this.get("styleLibraries")},setStyleLibraries:function(t){return this.set("styleLibraries",t)},refreshStyleLibraries:function(t){var e=this;a.e(86).then((function(){var n=[a(749)];(function(a){(new a).list(null,(function(a){e.set("styleLibraries",a),t(a)}))}).apply(null,n)})).catch(a.oe)},syncDrilldown:function(t,e,a){var n=this.getItemsModel();if(n)for(var i=0;i<n.length;i++)n[i].tagId!=a&&n[i].syncDrilldown(t,e,a)},syncDrillUp:function(t,e){var a=this.getItemsModel();if(a)for(var n=0;n<a.length;n++)a[n].tagId!=e&&a[n].syncDrillup(t,e)},syncShowHideLegend:function(t,e,a){},viewAsChart:function(t,e){(0,o.send)("Dashboard/viewAsChart/",t,{type:"POST"},e)}})}.apply(e,[]))||(t.exports=r)}).call(this,a(219),a(1))},869:function(t,e,a){"use strict";(function(n,i,r,o){var d,s,l=a(18);d=[a(687),a(726),a(1724),a(1381)],void 0===(s=function(t,e,d,s){return n.View.extend({el:i("#main"),menuInitiated:!1,editionModeInitiated:!1,fromExternal:!1,initialize:function(){},render:function(n,o,h,c,u){this.currentDashboardId=n,this.keyView="div.mainTask[data-rel='dashboard-"+n+"']",c&&c.external&&(this.fromExternal=!0);var f={id:n,extraOptions:c};this.dashboardModel=new e({dashId:n,dashboardViewList:[],nodeOwner:"",imOwner:u,editMode:!1,extraOptions:c}),this.dashboardController=new t;var g=this,b=d(f);this.$el.append(b),this.dashboardTabs=new s({dashboardModel:this.dashboardModel}),this.dashboardTabs.render(n),this.reloadDashboard(n,c,h),g.fromAddButton=!1,this.currentViewPort=this.getCurrentViewPort();var m=12;switch(this.currentViewPort){case"xs":m=2;break;case"sm":case"md":m=6;break;case"lg":m=12}var v={float:!0,staticGrid:!0,verticalMargin:2,cellHeight:68,disableOneColumnMode:!0,width:m,resizable:{handles:"sw, w, se, e, s"},draggable:{handle:".widgetTitle",scroll:!0}};g.getGrid().removeClass("grid-stack-12").removeClass("grid-stack-6"),g.getGrid().gridstack(v),g.grid=g.getGrid().data("gridstack"),i(window).on("resize.updateSizes",(function(t){i(".mainTask.dashboardTask:visible").length>=1&&g.updateSizes(t)})),this.updateSizes(),this.addHandlers(),this.addGenericHandlers(),i(this.keyView).on("reloadDashboard",(function(){g.grid.removeAll(),g.reloadDashboard(n,!1)})),this.getGrid().on("added",(function(t,e){g.fromAddButton&&(g.afterAddWidget(),g.fromAddButton=!1)})).on("removed",(function(t,e){})).on("gsresizestop",(function(t,e){setTimeout((function(){var t=r(e).attr("id");g.afterChangeWidget(t);var a=g.dashboardModel.getItemModel("#"+t);a.updateSize(),i(".chartToolbar.popover").length>0&&a.addProperties(!0)}),100)})).on("dragstop",(function(t,e){setTimeout((function(){var e=r(t.target).attr("id");g.afterChangeWidget(e);var a=g.dashboardModel.getItemModel("#"+e);i(".chartToolbar.popover").length>0&&a.addProperties(!0)}),100)})),this.getGrid().on("click",".clearWidget",(function(t){var e=i(t.target).closest(".grid-stack-item-content").find(".chartTypeSelector").length,n=i(t.target).closest(".grid-stack-item").attr("data-gs-id");if(!g.dashboardModel.getItemModel("#".concat(n)).checkNodeOwner())return!e&&void a.e(7).then((function(){var e=[a(663)];(function(e){(new e).show({title:(0,l.translate)("clear_widget"),text:(0,l.translate)("sure_clear_widget"),buttons:[{title:(0,l.translate)("no"),code:"no"},{title:(0,l.translate)("clear"),css:"red",code:"yes"}],callback:function(e){if("yes"==e){var n="#"+i(t.target).closest(".grid-stack-item").attr("id"),r=i(t.target).closest(".grid-stack-item").attr("id"),o=g.dashboardModel.getItemModel(n),d={x:o.currentResult.x,y:o.currentResult.y,width:o.currentResult.width,height:o.currentResult.height};g.dashboardModel.removeItemModel(o),g.grid.remove_widget(n),Promise.resolve().then((function(){var t=[a(687)];(function(t){(new t).getEmptyContent(g.dashboardModel,(function(t){t.setElement(g.grid),t.model=g.dashboardModel,t.grid=g.grid,t.currentResult=d,t.itemType="empty",t.currentResult.itemType="empty",t._applyItemId(null,r),t.render(),g.dashboardModel.addItemToModel(t),t.setEditMode(g.dashboardModel.editMode)}))}).apply(null,t)})).catch(a.oe)}}})}).apply(null,e)})).catch(a.oe)})),this.getGrid().on("click",".restoreWidget",(function(t){var e=i(event.target).closest(".grid-stack-item");i(e).find(".restoreWidget").hide();var a=i(e).find(".grid-stack-item-content"),n=a.attr("data-orignal-w"),r=a.attr("data-orignal-h"),o=a.attr("data-orignal-x"),d=a.attr("data-orignal-y");e.animate({top:d,left:o,width:n,height:r},{done:function(){e.removeAttr("style"),g.dashboardModel.getItemModel("#"+e.attr("id")).updateSize(n,e.height()-28,!0),i("body").css("overflow-y","visible"),i("#"+e.attr("id")+"-fullscreenHelper").hide(),setTimeout((function(){window.scrollTo(0,i("#"+e.attr("id")).offset().top)}),100)}})})),this.getGrid().on("click",".splitWidgetRight",(function(t){var e=i(t.currentTarget).attr("graph");g.getGrid().find(".splitWidgetRight").removeAttr("graph"),g.getGrid().find(".splitWidgetBottom").removeAttr("graph"),parseInt(i(t.currentTarget).closest(".grid-stack-item").attr("data-gs-width"))>1&&g.splitWidget(t,"right",e)})),this.getGrid().on("click",".splitWidgetBottom",(function(t){var e=i(t.currentTarget).attr("graph");g.getGrid().find(".splitWidgetRight").removeAttr("graph"),g.getGrid().find(".splitWidgetBottom").removeAttr("graph"),parseInt(i(t.currentTarget).closest(".grid-stack-item").attr("data-gs-height"))>1&&g.splitWidget(t,"bottom",e)})),this.getGrid().on("click",".removeWidget",(function(t){var e=i(t.target).closest(".grid-stack-item").attr("data-gs-id");g.dashboardModel.getItemModel("#"+e).checkNodeOwner()||a.e(7).then((function(){var e=[a(663)];(function(e){(new e).show({title:(0,l.translate)("delete_widget"),text:(0,l.translate)("sure_delete_widget"),buttons:[{title:(0,l.translate)("cancel"),code:"no"},{title:(0,l.translate)("delete"),css:"red",code:"yes"}],callback:function(e){"yes"==e&&g.removeWidget(t)}})}).apply(null,e)})).catch(a.oe)})),i(".clearGrid").on("click",(function(){g.clearGrid()})),this.getGrid().on("click",".moreChartTypes",(function(t){var e=i(event.target).closest(".grid-stack-item").attr("data-gs-id");g.moreChartTypesMenu(e)})),i(".dash-overlay").on("click",(function(){g.closeToolbar()})),i("#save-widgets").on("click",(function(){setTimeout((function(){g.saveDashboard()}),200)})),this.clearGrid=function(){return this.grid.removeAll(),!0}.bind(this),this.getThis().on("refreshView",(function(){g.getParent().find("div.toolbar button.btnRefresh").trigger("click")})),this.getThis().on("changeNumberFormat",(function(t,e){g&&g.dashboardModel&&g.dashboardModel.applyNumberFormat(e)})),this.getThis().on("reevaluateNodesNeeded",(function(t,e){g&&g.dashboardModel&&g.dashboardModel.reevaluateNodesNeededInThisDashboard(e)})),this.getThis().on("removeView",(function(){g.onRemoveView()})),this.getThis().on("beforeRemoveView",(function(t,e){g.onBeforeRemoveView(t,e)})),this.getParent().on("selectView",(function(){i(".tabs-area .nav-tabs li a").removeClass("active"),i('.tabs-area .nav-tabs li a[data-rel="'+g.currentDashboardId+'"]').addClass("active"),g.updateSizes()}))},updateSizes:function(t){var e=this,a=-1;clearTimeout(a);var n=t;a=setTimeout((function(){if(i(e.keyView).is(":visible")&&n&&n.target===window&&e.currentViewPort!=e.getCurrentViewPort()){e.currentViewPort=e.getCurrentViewPort();i(window).height();95,e.reloadDashboard(e.currentDashboardId,!1)}}),600)},splitWidget:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;function n(t){return t==parseFloat(t)?!(t%2):void 0}t.preventDefault();var r,o,d=this.getGrid().data("gridstack"),s=i(t.currentTarget).closest(".grid-stack-item"),l=s.attr("data-gs-x"),h=s.attr("data-gs-y"),c=s.attr("data-gs-width"),u=s.attr("data-gs-height"),f=n(c),g=n(u);"right"===e&&(c=Math.floor(s.attr("data-gs-width")/2),l=Math.round(s.attr("data-gs-x"))+c,r=f?c:c+1,o=u),"bottom"===e&&(u=Math.floor(s.attr("data-gs-height")/2),h=Math.round(s.attr("data-gs-y"))+u,r=c,o=g?u:u+1),d.resize(s,c,u);var b=this.dashboardModel.getItemModel("#"+s.attr("id"));b.currentResult.width=c,b.currentResult.height=u,b.itemType=a||"empty",this.dashboardModel.updateSizes(!0,!0);var m={x:l,y:h,width:r,height:o};this.dashboardTabs.addNewWidget(this.dashboardTabs,m,b),this.dashboardModel.setStateModified(!0)},removeWidget:function(t){t.preventDefault();var e=this.getGrid().data("gridstack"),a=i(t.currentTarget).closest(".grid-stack-item");e.remove_widget(a);var n=this.dashboardModel.getItemModel("#"+a.attr("id"));this.dashboardModel.removeItemModel(n),this.dashboardModel.setStateModified(!0)},isBreakpoint:function(t){return i(".device-"+t).is(":visible")},afterAddWidget:function(){this.getGrid().data("gridstack"),this.getCurrentViewPort()},afterChangeWidget:function(t){this.getGrid().data("gridstack"),this.getCurrentViewPort();var e=this.dashboardModel.getItemModel("#"+t);e.currentResult.x=i("#"+t).attr("data-gs-x"),e.currentResult.y=i("#"+t).attr("data-gs-y"),e.currentResult.width=i("#"+t).attr("data-gs-width"),e.currentResult.height=i("#"+t).attr("data-gs-height")},afterGridChange:function(){this.getGrid().data("gridstack")&&(this.isBreakpoint("xs")||(this.isBreakpoint("sm")||(this.isBreakpoint("md")||this.isBreakpoint("lg"))))},prepareWidgets:function(t,e){var a,n,r=[],o=this.grid.grid.nodes;return r.lg=[],r.md=[],r.sm=[],r.xs=[],i.each(o,(function(t,i){switch(e){case"lg":a=1===i.width?i.width:i.width/2,a=Math.floor(a),n=0===i.x?i.x:i.x/2,n=Math.floor(n);var o={height:i.height,maxHeight:i.maxHeight,maxWidth:i.maxWidth,minHeight:i.minHeight,minWidth:i.minWidth,width:i.width,x:i.x,y:i.y,id:i.id},d={height:i.height,maxHeight:i.maxHeight,maxWidth:a,minHeight:i.minHeight,minWidth:a,width:a,x:n,y:i.y,id:i.id};a=1===i.width||2===i.width?i.width:2,n=i.width>1?0:i.x>=1?1:0;var s={height:i.height,maxHeight:i.maxHeight,maxWidth:a,minHeight:i.minHeight,minWidth:a,width:a,x:n,y:i.y,id:i.id};r.lg.push(o),r.md.push(d),r.sm.push(d),r.xs.push(s);break;case"sm":case"md":d={height:i.height,maxHeight:i.maxHeight,maxWidth:i.maxWidth,minHeight:i.minHeight,minWidth:i.minWidth,width:i.width,x:i.x,y:i.y,id:i.id};a=2*i.width,a=Math.floor(a),n=2*i.x,n=Math.floor(n);o={height:i.height,maxHeight:i.maxHeight,maxWidth:a,minHeight:i.minHeight,minWidth:a,width:a,x:n,y:i.y,id:i.id};a=1===i.width||2===i.width?i.width:2,n=a>=2?0:0===i.x||1===i.x?i.x:0;s={height:i.height,maxHeight:i.maxHeight,maxWidth:a,minHeight:i.minHeight,minWidth:a,width:a,x:n,y:i.y,id:i.id};r.lg.push(o),r.md.push(d),r.sm.push(d),r.xs.push(s)}})),r},getSerializedDataForViewport:function(t){var e=localStorage.getItem("@DashboardName-"+t);return e=JSON.parse(e)},getCurrentViewPort:function(){var t;return this.isBreakpoint("xs")?t="xs":this.isBreakpoint("sm")?t="sm":this.isBreakpoint("md")?t="md":this.isBreakpoint("lg")&&(t="lg"),t},getOptionsMenu:function(){var t=this,e={callback:function(e,n){switch(e){case"columnchart":case"complexchart":case"table":case"nodetable":case"wizard":case"filter":var r=i("#"+n).closest(".grid-stack-item"),o=["variable"];"wizard"==e&&(o=null,e=void 0),"filter"==e&&(o=["index","decision","inputnode"],e=void 0),function(t,e,n){a.e(31).then((function(){var i=[a(979)];(function(a){(new a).show(t,{callback:n,filteredClasses:e})}).apply(null,i)})).catch(a.oe)}(event,o,(function(a){var i=a.nodeId;if("module"==a.nodeClass)t.createNewView({itemType:"objectItem",objectType:"diagramviewer",itemProperties:{diagramOptions:{currentModule:i}}});else{var r=t.dashboardModel.getItemModel("#"+n);r.grid=t.grid,r.currentResult.itemProperties={},r.currentResult.itemType="objectItem",r.currentResult.objectType=e,r.model=t.dashboardModel,r.initializeWithNode(i)}}));break;case"inputform":!function(t,e){a.e(49).then((function(){var n=[a(1172)];(function(a){(new a).show(t,{callback:e})}).apply(null,n)})).catch(a.oe)}(event,(function(a){var r=a.templateId,o=a.name,d=t.dashboardModel.getItemModel("#"+n),s=i("#"+n).closest(".grid-stack-item");t.grid.remove_widget(s),d.grid=t.grid,d.currentResult.itemProperties={templateId:r,inputForm:{templateId:r},title:{text:o,style:{color:"#000"},enabled:!0},subtitle:{style:{color:"#000"}}},d.currentResult.itemType="objectItem",d.currentResult.objectType=e,d.model=t.dashboardModel,d.editMode=!0,d.createNewView(d.currentResult)}));break;case"texteditor":case"diagramviewer":case"mapviewer":case"menuwidget":var d=t.dashboardModel.getItemModel("#"+n);r=i("#"+n).closest(".grid-stack-item");t.grid.remove_widget(r),d.grid=t.grid,d.currentResult.itemProperties={},d.currentResult.itemType="objectItem",d.currentResult.objectType=e,d.model=t.dashboardModel,d.editMode=!0,d.createNewView(d.currentResult)}},items:{}};return e.items.texteditor={type:"icon_text",name:"Text",iconClass:""},e.items.mapviewer={type:"icon_text",name:"Gis Map",iconClass:""},e.items.inputform={type:"icon_text",name:"Input Form",iconClass:""},e.items.wizard={type:"icon_text",name:"Wizard",iconClass:""},e.items.filter={type:"icon_text",name:"Filter",iconClass:""},e.items.menuwidget={type:"icon_text",name:"Menu",iconClass:""},e},moreChartTypesMenu:function(t){var e='div[data-gs-id="'+t+'"] .moreChartTypes',a=this.getOptionsMenu();if(a&&(this.menuInitiated&&i.contextMenu("destroy",e),!i.isEmptyObject(a.items))){var n=this;this.menuInitiated=!0,i.contextMenu({selector:e,callback:function(e,i){a.callback(e,t),a.items&&a.items[e]&&a.items[e].persist&&setTimeout((function(){n.moreChartTypesMenu()}),100)},items:a.items})}this.menuInitiated&&i(e).contextMenu()},closeToolbar:function(){var t,e=i(".popover");Promise.resolve().then((function(){var n=[a(726)];(function(a){var n=(new a).getItemsModel();i.each(n,(function(t,e){i(e.tagId).css("z-index",1)})),e.length>0&&(t=e.attr("data-id"),e.remove(),i(t).css("z-index",1),i(".dash-overlay").hide())}).apply(null,n)})).catch(a.oe)},recalcWidgets:function(t,e){var a,n=this.getCurrentViewPort(),i=t;switch(e){case"xs":a=o.map(i,(function(t){var e,a=1===t.width||2===t.width?t.width:2;e=a>=2?0:0===t.x||1===t.x?t.x:0;var n=Object.assign({},t);return n.width=a,n.x=e,n}),this);break;case"sm":case"md":var r=2;"xs"===n&&(r=3);a=o.map(i,(function(t){var e=t.width*r;e=Math.floor(e);var a=t.x*r;a=Math.floor(a);var n=Object.assign({},t);return n.width=e,n.x=a,n}),this);break;case"lg":r=2;"xs"===n&&(r=6),a=o.map(i,(function(t){var e=t.width*r;e=Math.floor(e);var a=t.x*r;a=Math.floor(a);var n=Object.assign({},t);return n.width=e,n.x=a,n}),this)}return a},reloadDashboard:function(t,a,n,r){var o=this;i(".tabs-area").find(".toolbar").hide(),this.dashboardModel||(this.dashboardModel=new e({dashId:t,dashboardViewList:[],nodeOwner:"",extraOptions:null}));var d=this.dashboardModel.getItemsModel();i.each(d,(function(t,e){i(e.tagId).trigger("removeItemView")})),o.dashboardModel.removeAllItemsModel(),o.grid&&o.grid.removeAll(),o.getParent().find(".grid-stack.dashboard-area").empty(),this.dashboardModel.getDashboard(t,(function(e){i('.nav-tabs li a[data-rel="'+t+'"]').text(e.name),o.getParent().attr("dash-title",e.name);var d=o.getCurrentViewPort(),s=12,l={};if(e.definition){switch(l=e.definition,d){case"xs":l=l.definitionSmall?l.definitionSmall:l.definitionMedium?o.recalcWidgets(l.definitionMedium,"xs"):o.recalcWidgets(l.definitionLarge,"xs"),s=2;break;case"sm":case"md":l.definitionMedium?(l=l.definitionMedium,o.getGrid().removeClass("grid-stack-autoposition")):l.definitionLarge?(o.getGrid().addClass("grid-stack-autoposition"),l=l.definitionLarge):(o.getGrid().addClass("grid-stack-autoposition"),l=o.recalcWidgets(l.definitionSmall,"md")),s=6;break;case"lg":l.definitionLarge?(l=l.definitionLarge,o.getGrid().removeClass("grid-stack-autoposition")):l=l.definitionMedium?o.recalcWidgets(l.definitionMedium,"lg"):o.recalcWidgets(l.definitionSmall,"lg"),s=12}e.definition=l}else switch(o.currentViewPort){case"xs":s=2;break;case"sm":case"md":s=6;break;case"lg":s=12}o.getGrid().removeClass("grid-stack-12").removeClass("grid-stack-6").removeClass("grid-stack-2"),o.getGrid().addClass("grid-stack-"+s),o.getGrid().data("gridstack").setGridWidth(s),window.location.href.indexOf("/#shared/")>0?(null==r&&o.dashboardTabs.refreshDashboardTabs("evaluatedNode",a),i(".tabs-area .toolbar").hide(),i(".loader.embeddable").hide(),i("body").css("background-color","#FFF")):o.dashboardTabs.refreshDashboardTabs(),e.uuid&&(i('.mainTask.dashboardTask.new[data-rel="dashboard-'+t+'"]').attr("data-id","dashboard-"+e.dashboardId),i('.nav-tabs li a[data-rel="'+t+'"]').attr("data-key","dashboard-"+e.dashboardId)),o.dashboardModel.attributes.imOwner=e.ownerId===__currentSession.userCompanyId,o.refreshDashboardName(e),o.dashboardModel.setNodeOwner(e.node),o.parseDashboard(e,n),o.getParent().find("div.breadcrumbs2").show(),o.checkShared(e,n),o.checkFromDiagram(e),i(".tabs-area").find(".toolbar").show(),window.location.href.indexOf("/#shared/")>0&&(i(".loadingPlaceholder").hide(),i(".loader.embeddable").hide(),i("body").css("background-color","#FFF")),o=null}))},checkFromDiagram:function(t){if(""!==t.node&&null!==t.node){var e=i(".tabs-area .toolbar");e.find(".btnCopy").hide(),e.find(".btnShare").hide(),e.find(".btnPulishInMy").hide()}},checkShared:function(t,e){if(window.location.href.indexOf("/#shared/")>0)return i(".tabs-area").find(".toolbar .shared-message").hide(),i(".tabs-area").find(".toolbar .btn-group .btn").hide(),i(".tabs-area").find(".toolbar .btn-group .btnRefresh").show(),!1;if(this.dashboardModel.attributes.imOwner)e||(i(".tabs-area").find(".toolbar .btnEdit").show(),i(".tabs-area").find(".toolbar .btnShare").show(),i(".tabs-area").find(".toolbar .shared-message").html(""));else{i(".tabs-area").find(".toolbar .btnEdit").hide(),i(".tabs-area").find(".toolbar .btnShare").hide(),i(".tabs-area").find(".toolbar .shared-message").html((0,l.translate)("Is shared"));var a=this;this.getParent().on("refreshImageDashboard",(function(t,e){a.reloadDashboard(e)}))}},refreshDashboardName:function(t){if(window.location.href.indexOf("/#shared/")<0){var e=i("#topMenuBar span#currentTask").attr("data-rel").match(/-/g).length>1;if(t){var a=e?t.uuid:t.dashboardId,n=t.name;this.dashboardName=n,i('span[data-rel="dashboard-'.concat(a,'"]')).text(n),i('#topMenuBar li a[rel="dashboard-'.concat(a,'"]')).text(n),i('.dash-tabs li a[data-rel="'.concat(a,'"]')).text(n),i('.dash-tabs li a[data-rel="'.concat(a,'"]')).attr("title",n)}}},removeDashboard:function(t){Promise.resolve().then((function(){var e=[a(664)];(function(e){(new e).removeTask(t)}).apply(null,e)})).catch(a.oe)},parseDashboard:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=t.definition;this.dashboardModel.setStyleLibraries(t.styleLibraries);var o=n.dashboardModel.get("extraOptions")&&n.dashboardModel.get("extraOptions").isInputNode;if(t.definition&&!o||!t.node||this.dashboardController.getEmptyContent(this.dashboardModel,(function(a){var r=n.getCurrentViewPort(),d=12;"sm"!==r&&"md"!==r||(d=6);var s=i("#main").height()-80,l=Math.floor(s/68);a.setElement(i("div.grid-stack")),a.grid=n.grid,a.dashboardModel=n.dashboardModel,a.currentResult={x:0,y:0,width:d,height:l},a.loadingDashboard=!0,a.render(),n.dashboardModel.addItemToModel(a),a.initializeWithNode(t.node,!!o&&"nodetable"),t.definition&&""!=t.definition&&!o||e&&i("div.toolbar button.btnEdit").click()})),r&&r.length>0){var d=[],s=[];r.noQuery&&r.noQuery.length>0&&null!=r.noQuery[0].rel&&(d=r.noQuery,i.each(d,(function(t,e){i.each(e.rel,(function(t,e){s.push(e)}))}))),n.noQuery=d,n.ownerWidth=r.ownerWidth,n.ownerHeight=r.ownerHeight,n.dashboardModel.initializeDashboardQuery(n.noQuery);var l=d.indexOf(r.nodeId)>=0;i.each(r,(function(t,e){"empty"===e.itemType?Promise.resolve().then((function(){var t=[a(687)];(function(t){(new t).getEmptyContent(n.dashboardModel,(function(t){t.setElement(i("div.grid-stack")),t.grid=n.grid,t.currentResult=e,t.dashboardModel=n.dashboardModel,t.loadingDashboard=!0,t.render(),i(t.tagId).find(".btnMenu").hide(),n.dashboardModel.addItemToModel(t)}))}).apply(null,t)})).catch(a.oe):a.e(0).then((function(){var t=[a(717)];(function(t){var a=new t({model:n.dashboardModel});a.setElement(i("div.grid-stack")),a.grid=n.grid,a.dashboardModel=n.dashboardModel,a.loadingDashboard=!0,a.widget=e,n.dashboardModel.addItemToModel(a),a.createNewView(e,l)}).apply(null,t)})).catch(a.oe)}))}t.definition&&!o||e&&(i("div.toolbar button.btnEdit").click(),setTimeout((function(t){n.dashboardTabs.addNewWidget(n.dashboardTabs)}),100)),n.fromExternal&&setTimeout((function(){n.initPromiseWatcher()}),1e3)},resetView:function(){this.checkNodeOwner()||this.createNewView({itemType:"empty"})},getThis:function(){return i(this.keyView)},onRemoveView:function(){i(".tabs-area").remove(),i(".mainTask.dashboardTask.new").length<1&&i(window).off("resize.updateSizes"),0===i(".mainTask.dashboardTask.new").length&&i(window).off("keyup.closeTabs"),i(this.keyView).off(),this.dashboardController=null;var t=this.dashboardModel.getItemsModel();i.each(t,(function(t,e){i(e.tagId).trigger("removeItemView")})),this.dashboardModel.removeAllItemsModel(),this.dashboardModel=null,this.noQuery=null;var e=this;setTimeout((function(){e.dashboardTabs.refreshDashboardTabs(),e.dashboardTabs.getModel()&&window.location.href.indexOf("/#shared/")<0&&e.dashboardTabs.checkFromDiagram(e.dashboardTabs.getModel().attributes),e=null}),300)},onBeforeRemoveView:function(t,e){if(i(".mainTask.dashboardTask.new").length<1&&i(window).off("resize.updateSizes"),this.dashboardModel.editMode){t.preventDefault();var n=this;a.e(7).then((function(){var t=[a(663)];(function(t){(new t).show({title:(0,l.translate)("_save")+": "+n.dashboardName,text:(0,l.translate)("save_pending_changes"),buttons:[{title:(0,l.translate)("cancel"),code:"cancel"},{title:(0,l.translate)("discard"),css:"red",code:"no"},{title:(0,l.translate)("_save"),css:"primary",code:"yes"}],callback:function(t){"yes"==t?(n.refreshMode(!1),n.saveDashboard(),setTimeout((function(){e()}),1e3)):"no"==t&&(n.dashboardModel.editMode=!1,setTimeout((function(){e(!0)}),1e3))}})}).apply(null,t)})).catch(a.oe)}},refreshMode:function(t){this.dashboardModel.editMode=t,this.getParent().find("div.toolbar button").hide();var e=this.dashboardModel.getItemsModel();i.each(e,(function(e,a){a.setEditMode(t)})),t?(this.getParent().find(".dash-tabs").hide(),this.getParent().closest(".mainTask").addClass("editing"),this.getParent().find("div.toolbar button.btnShow").show(),this.getParent().find("div.toolbar button.btnCancel").show(),this.getParent().find("div.objectsToolbar").fadeIn(),this.getParent().find(".dockDashboardProperty").fadeIn()):(this.getParent().find(".dash-tabs").show(),this.getParent().closest(".mainTask").removeClass("editing"),this.getParent().find("div.toolbar button").show(),this.getParent().find("div.toolbar button.btnShow").hide(),this.getParent().find("div.toolbar button.btnCancel").hide(),this.getParent().find("div.objectsToolbar").fadeOut(),this.getParent().find(".dockDashboardProperty").fadeOut())},addGenericHandlers:function(){var t=i(this.keyView),e=this;void 0!==__currentSession.fromEmbedded&&(this.fromEmbedded=__currentSession.fromEmbedded),this.fromEmbedded||t.on("click",".link-to-dashboard",(function(){if(!e.dashboardModel.editMode){var t=i(this).attr("data-dashboard-id"),n=(0,l.translate)("loading_dashboard"),r=!0;if("_self"===i(this).attr("data-target")&&(r=!1),e.dashboardController.showDashboard(t,-1,n,!0,e.dashboardModel.editMode),!r){var o=e.getParent().attr("data-rel");Promise.resolve().then((function(){var t=[a(664)];(function(t){(new t).removeTask(o,!0)}).apply(null,t)})).catch(a.oe)}}}))},addHandlers:function(){1===i(".mainTask.dashboardTask.new").length&&i(window).on("keyup.closeTabs",(function(t){t.ctrlKey&&81===t.keyCode&&i(".tabs-area .dash-tabs li a.active").closest("li").find("i.fa.fa-close").click()}))},getParent:function(){return i(this.keyView)},getGrid:function(){return i(".grid-dash-"+this.currentDashboardId)},initPromiseWatcher:function(){if(this.dashboardModel){var t=this.dashboardModel.getItemsModel();if(t&&t.length>0){var e=!0;if(i.each(t,(function(t,a){0==i(a.tagId).find(".item-class-selector").length&&(e=e&&a.isReady)})),!e&&this.getParent().find(".dashboard-area").length>0){var a=this;setTimeout((function(){a.initPromiseWatcher(),a=null}),1e3)}}}}})}.apply(e,d))||(t.exports=s)}).call(this,a(219),a(1),a(1),a(221))}}]);