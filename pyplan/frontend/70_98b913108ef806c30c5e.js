/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{1124:function(n,e,t){"use strict";(function(i){var a,l=t(693);void 0===(a=function(){return i.Model.extend({list:function(n){(0,l.send)("departments/?page=1",null,{type:"GET",contentType:"application/json;charset=utf-8",dataType:"text"},n)},getDepartment:function(n,e){(0,l.send)("departments/"+n+"/",null,null,e)},update:function(n,e,t){(0,l.send)("departments/"+n+"/",JSON.stringify(e),{type:"PUT",contentType:"application/json;charset=utf-8",dataType:"text"},t)},partialUpdate:function(n,e,t){(0,l.send)("departments/"+n+"/",JSON.stringify(e),{type:"PATCH",contentType:"application/json;charset=utf-8",dataType:"text"},t)},create:function(n,e){(0,l.send)("departments/",JSON.stringify(n),{type:"POST",contentType:"application/json;charset=utf-8",dataType:"text"},e)},delete:function(n,e){(0,l.send)("departments/"+n+"/",null,{type:"DELETE"},e)}})}.apply(e,[]))||(n.exports=a)}).call(this,t(218))},1321:function(n,e,t){"use strict";(function(i,a){var l,d,o=t(18),s=function(n){return n&&n.__esModule?n:{default:n}}(t(1322));l=[t(1124),t(710),t(725),t(1961)],void 0===(d=function(n,e,l,d){return i.View.extend({el:a("#main"),_uId:"",definitionEditor:null,actionEditor:null,deniedEditor:null,render:function(){a("#mainLoading").show(),a("div[data-rel='abm-department']").remove();var i,c,r=new n,u=this;this._uId=a.uuid(),i=this.options.departmentId?new Promise(function(n,t){r.getDepartment(u.options.departmentId,function(t){var i={id:u._uId,dataRel:"abm-department",tmpClass:"department-edit",title:(0,o.translate)("_editDepartment")};t.engine_definitions=JSON.stringify(t.engine_definitions),t.login_action=JSON.stringify(t.login_action),t.denied_items=JSON.stringify(t.denied_items);var s={department:t,isSuper:__currentSession.userIsSuperUser},c=e(i),r=l(),m=d(s);u.$el.append(c),a("div[data-id='"+u._uId+"']").find("div.abm-content").append(r),a("div[data-id='"+u._uId+"']").find("div.form-content").append(m),n(t)})}):new Promise(function(n,t){var i={id:u._uId,dataRel:"abm-department",tmpClass:"department-create",title:(0,o.translate)("_newDepartment")},s={isSuper:__currentSession.userIsSuperUser},c=e(i),r=l(),m=d(s);u.$el.append(c),a("div[data-id='"+u._uId+"']").find("div.abm-content").append(r),a("div[data-id='"+u._uId+"']").find("div.form-content").append(m),a("div[data-id='"+u._uId+"']").find("div.department-code input").removeAttr("disabled"),n(null)}),c=new Promise(function(n,e){t.e(24).then(function(){var e=[t(726)];(function(e){(new e).list(function(e){n(e)})}).apply(null,e)}).catch(t.oe)}),Promise.all([i,c]).then(function(n){var e=n[1],t=a("div[data-id='"+u._uId+"'] div.company-id select");a.each(e.results,function(n,e){t.append(a("<option />").val(e.id).text(e.name))});var i=n[0],l=a("div[data-id='"+u._uId+"']").find(".engineDefinitions")[0],d={mode:"code",modes:["code","form","text","tree"]};u.definitionEditor=new s.default(l,d);var c=a("div[data-id='"+u._uId+"']").find(".loginAction")[0];d={mode:"code",modes:["code","form","text","tree"]};u.actionEditor=new s.default(c,d);var r=a("div[data-id='"+u._uId+"']").find(".deniedItems")[0];d={mode:"code",modes:["code","form","text","tree"]};(u.deniedEditor=new s.default(r,d),i)&&((t=a("div[data-id='"+u._uId+"'] div.company-id select")).val(i.company.id),""!==i.engine_definitions&&u.definitionEditor.set(JSON.parse(i.engine_definitions)),""!==i.login_action&&u.actionEditor.set(JSON.parse(i.login_action)),""!==i.denied_items&&u.deniedEditor.set(JSON.parse(i.denied_items)));(0,o.postRender)(u.$el.find("div[data-id='"+u._uId+"']")),u.addHandlers(),a("#mainLoading").hide()})},save:function(){var e=this._uId,i=a("div[data-id='"+e+"']").find("form");if(!a(i).validate().errorList.length>0){var l=a("div[data-id='"+e+"']").find("div.department-name input").val(),d=a("div[data-id='"+e+"']").find("div.department-code input").val(),o=a("div[data-id='"+e+"']").find("div.company-id select").val(),s=""===this.definitionEditor.get()?{}:this.definitionEditor.get(),c=""===this.actionEditor.get()?{}:this.actionEditor.get(),r=""===this.deniedEditor.get()?{}:this.deniedEditor.get(),u=new n,m={company_id:o,code:d,name:l,engine_definitions:""===a.trim(s)?"{}":JSON.stringify(s),login_action:""===a.trim(c)?"{}":JSON.stringify(c),denied_items:""===a.trim(r)?"{}":JSON.stringify(r)};__currentSession.userIsSuperUser&&(m.company_id=o),this.options.departmentId?u.partialUpdate(this.options.departmentId,m,function(){Promise.resolve().then(function(){var n=[t(802)];(function(n){(new n).show()}).apply(null,n)}).catch(t.oe)}):u.create(m,function(){Promise.resolve().then(function(){var n=[t(802)];(function(n){(new n).show()}).apply(null,n)}).catch(t.oe)})}},cancel:function(){Promise.resolve().then(function(){var n=[t(802)];(function(n){(new n).show()}).apply(null,n)}).catch(t.oe)},addHandlers:function(){a("div[data-id='"+this._uId+"']").find("form").on("submit",a.proxy(function(){return this.save(),!1},this)),a("div[data-id='"+this._uId+"']").find("div.submit button.btn-cancel").on("click",a.proxy(function(){return this.cancel(),!1},this)),a("div[data-id='"+this._uId+"']").find("div.abm-top-options a.btn-close").on("click",this.cancel)}})}.apply(e,l))||(n.exports=d)}).call(this,t(218),t(1))},1961:function(n,e,t){var i=t(690);function a(n){return n&&(n.__esModule?n.default:n)}n.exports=(i.default||i).template({1:function(n,e,i,l,d){return'<div class="form-group">\n    <label for="textfield" class="col-sm-2 control-label">'+n.escapeExpression(a(t(688)).call(null!=e?e:n.nullContext||{},"_company",{name:"L",hash:{},data:d,loc:{start:{line:21,column:58},end:{line:21,column:74}}}))+'</label>\n    <div class="col-sm-10">\n        <div class="col-sm-5 company-id">\n            <select class="form-control" data-rule-required="true">\n            </select>\n        </div>\n    </div>\n</div>\n'},compiler:[8,">= 4.3.0"],main:function(n,e,i,l,d){var o,s=null!=e?e:n.nullContext||{},c=n.escapeExpression,r=n.lambda;return'<div class="form-group">\n    <label for="textfield" class="col-sm-2 control-label">'+c(a(t(688)).call(s,"_name",{name:"L",hash:{},data:d,loc:{start:{line:2,column:58},end:{line:2,column:71}}}))+'</label>\n    <div class="col-sm-10">\n        <div class="col-sm-5 department-name">\n            <input type="text" value="'+c(r(null!=(o=null!=e?e.department:e)?o.name:o,e))+'" class="form-control" name="departmentName"\n                data-rule-required="true" data-rule-minlength="3">\n        </div>\n    </div>\n</div>\n<div class="form-group">\n    <label for="textfield" class=" col-sm-2 control-label">'+c(a(t(688)).call(s,"_code",{name:"L",hash:{},data:d,loc:{start:{line:11,column:59},end:{line:11,column:72}}}))+'</label>\n    <div class="col-sm-10">\n        <div class="col-sm-5 department-code">\n            <input type="text" value="'+c(r(null!=(o=null!=e?e.department:e)?o.code:o,e))+'" class="form-control" data-rule-required="true" disabled="disabled">\n        </div>\n    </div>\n</div>\n\n'+(null!=(o=a(t(689)).call(s,null!=e?e.isSuper:e,"==",!0,{name:"ifCond",hash:{},fn:n.program(1,d,0),inverse:n.noop,data:d,loc:{start:{line:19,column:0},end:{line:29,column:11}}}))?o:"")+'\n<div class="form-group">\n    <label for="textfield" class="col-sm-2 control-label">'+c(a(t(688)).call(s,"_engineDefinitions",{name:"L",hash:{},data:d,loc:{start:{line:32,column:58},end:{line:32,column:84}}}))+'</label>\n    <div class="col-sm-10 engineDefinitions">\n\n    </div>\n</div>\n<div class="form-group">\n    <label for="textfield" class="col-sm-2 control-label">'+c(a(t(688)).call(s,"_loginAction",{name:"L",hash:{},data:d,loc:{start:{line:38,column:58},end:{line:38,column:78}}}))+'</label>\n    <div class="col-sm-10 loginAction">\n    </div>\n</div>\n<div class="form-group">\n    <label for="textfield" class="col-sm-2 control-label">'+c(a(t(688)).call(s,"_deniedItems",{name:"L",hash:{},data:d,loc:{start:{line:43,column:58},end:{line:43,column:78}}}))+'</label>\n    <div class="col-sm-10 deniedItems">\n    </div>\n</div>'},useData:!0})},710:function(n,e,t){var i=t(690);n.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(n,e,t,i,a){var l,d=null!=e?e:n.nullContext||{},o=n.hooks.helperMissing,s=n.escapeExpression;return'<div class="abm-base-tmp '+s("function"==typeof(l=null!=(l=t.tmpClass||(null!=e?e.tmpClass:e))?l:o)?l.call(d,{name:"tmpClass",hash:{},data:a,loc:{start:{line:1,column:25},end:{line:1,column:37}}}):l)+' container-fluid mainTask" data-id="'+s("function"==typeof(l=null!=(l=t.id||(null!=e?e.id:e))?l:o)?l.call(d,{name:"id",hash:{},data:a,loc:{start:{line:1,column:73},end:{line:1,column:79}}}):l)+'" data-rel="'+s("function"==typeof(l=null!=(l=t.dataRel||(null!=e?e.dataRel:e))?l:o)?l.call(d,{name:"dataRel",hash:{},data:a,loc:{start:{line:1,column:91},end:{line:1,column:102}}}):l)+'" data-type="tab-content">\n    <div class="row">\n        <div class="col-sm-12">\n            <div class="box">\n                <div class="box-title">\n                    <h3><i class="fa fa-th-list"></i>'+s("function"==typeof(l=null!=(l=t.title||(null!=e?e.title:e))?l:o)?l.call(d,{name:"title",hash:{},data:a,loc:{start:{line:6,column:53},end:{line:6,column:62}}}):l)+'</h3>\n                    <div class="actions abm-top-options">\n                        <a href="#" class="btn btn-close"><i class="fa fa-times"></i></a>\n                    </div>\n                </div>\n        <div class="box-content nopadding abm-content">\n\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'},useData:!0})},725:function(n,e,t){var i=t(690);function a(n){return n&&(n.__esModule?n.default:n)}n.exports=(i.default||i).template({compiler:[8,">= 4.3.0"],main:function(n,e,i,l,d){var o=null!=e?e:n.nullContext||{},s=n.escapeExpression;return'<form action="#" id="baseForm" method="POST" class=\'form-horizontal form-bordered form-validate\' novalidate="novalidate">\n    <div class="form-content">\n\n    </div>\n    <div class="submit form-actions col-sm-12">\n        <button type="submit" class="btn btn-primary btn-save">'+s(a(t(688)).call(o,"_save",{name:"L",hash:{},data:d,loc:{start:{line:6,column:63},end:{line:6,column:76}}}))+'</button>\n        <button type="button" class="btn btn-cancel">'+s(a(t(688)).call(o,"cancel",{name:"L",hash:{},data:d,loc:{start:{line:7,column:53},end:{line:7,column:67}}}))+"</button>\n    </div>\n</form>\n"},useData:!0})}}]);