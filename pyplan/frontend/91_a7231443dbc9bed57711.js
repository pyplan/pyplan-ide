/*! Copyright Pyplan 2020. All rights reserved. */
(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{1181:function(e,t,n){var r,o,i;o=[n(925)],void 0===(i="function"==typeof(r=function(e){return e.createModule("TextRange",["WrappedSelection"],function(e,t){function n(e,t){for(var n=e.slice(t.start,t.end),r={isWord:t.isWord,chars:n,toString:function(){return n.join("")}},o=0,i=n.length;i>o;++o)n[o].token=r;return r}function r(e,t,r){for(var o,i=r(e,t),a=[],s=0;o=i[s++];)a.push(n(e,o));return a}function o(e,t){var n=B(e,t);return t.hasOwnProperty("wordOptions")&&(n.wordOptions=function(e){var t,n;return e?(t=e.language||F,I(n={},G[t]||G[F]),I(n,e),n):G[F]}(n.wordOptions)),t.hasOwnProperty("characterOptions")&&(n.characterOptions=B(n.characterOptions,$)),n}function i(e,t){var n=Z(e,"display",t),r=e.tagName.toLowerCase();return"block"==n&&z&&J.hasOwnProperty(r)?J[r]:n}function a(e){for(var t=function(e){return function(e){for(var t=[];e.parentNode;)t.unshift(e.parentNode),e=e.parentNode;return t}(e).concat([e])}(e),n=0,r=t.length;r>n;++n)if(1==t[n].nodeType&&"none"==i(t[n]))return!0;return!1}function s(e,t){return!t&&e.hasChildNodes()?e.firstChild:function(e){for(;e&&!e.nextSibling;)e=e.parentNode;return e?e.nextSibling:null}(e)}function c(e){var t=e.previousSibling;if(t){for(e=t;e.hasChildNodes();)e=e.lastChild;return e}var n=e.parentNode;return n&&1==n.nodeType?n:null}function l(e){if(!e||3!=e.nodeType)return!1;var t=e.data;if(""===t)return!0;var n=e.parentNode;if(!n||1!=n.nodeType)return!1;var r=Z(e.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(t)&&/^(normal|nowrap)$/.test(r)||/^[\t\r ]+$/.test(t)&&"pre-line"==r}function d(e){if(""===e.data)return!0;if(!l(e))return!1;var t=e.parentNode;return!t||!!a(e)}function u(e){var t=e.nodeType;return 7==t||8==t||a(e)||/^(script|style)$/i.test(e.nodeName)||function(e){var t;return 3==e.nodeType&&(t=e.parentNode)&&"hidden"==Z(t,"visibility")}(e)||d(e)}function f(e,t){var n=e.nodeType;return 7==n||8==n||1==n&&"none"==i(e,t)}function h(){this.store={}}function p(e,t,n){return function(r){var o=this.cache;if(o.hasOwnProperty(e))return o[e];var i=t.call(this,n?this[n]:this,r);return o[e]=i,i}}function g(e,t){this.node=e,this.session=t,this.cache=new h,this.positions=new h}function m(e,t){this.offset=t,this.nodeWrapper=e,this.node=e.node,this.session=e.session,this.cache=new h}function v(){return de||(C(),de=new ue)}function C(){de&&de.detach(),de=null}function N(e,n,r,o){function i(){var e=null;return n?(e=s,c||(s=s.previousVisible(),c=!s||r&&s.equals(r))):c||(e=s=s.nextVisible(),c=!s||r&&s.equals(r)),c&&(s=null),e}r&&(n?u(r.node)&&(r=e.previousVisible()):u(r.node)&&(r=r.nextVisible()));var a,s=e,c=!1,l=!1;return{next:function(){if(l)return l=!1,a;for(var e;e=i();)if(e.getCharacter(o))return a=e,e;return null},rewind:function(){if(!a)throw t.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");l=!0},dispose:function(){e=r=null}}}function R(e,t,n){function o(e){for(var t,n,r=[],o=e?i:a,s=!1,c=!1;t=o.next();){if(n=t.character,M.test(n))c&&(c=!1,s=!0);else{if(s){o.rewind();break}c=!0}r.push(t)}return r}var i=N(e,!1,null,t),a=N(e,!0,null,t),s=n.tokenizer,c=o(!0),l=o(!1).reverse(),d=r(l.concat(c),n,s),u=c.length?d.slice(fe(d,c[0].token)):[],f=l.length?d.slice(0,fe(d,l.pop().token)+1):[];return{nextEndToken:function(){for(var e,t;1==u.length&&!(e=u[0]).isWord&&(t=o(!0)).length>0;)u=r(e.chars.concat(t),n,s);return u.shift()},previousStartToken:function(){for(var e,t;1==f.length&&!(e=f[0]).isWord&&(t=o(!1)).length>0;)f=r(t.reverse().concat(e.chars),n,s);return f.pop()},dispose:function(){i.dispose(),a.dispose(),u=f=null}}}function y(e,t,n,r){var o=e.getRangeBoundaryPosition(t,!0),i=e.getRangeBoundaryPosition(t,!1),a=r?i:o,s=r?o:i;return N(a,!!r,s,n)}function E(t,n,r){var o=e.createRange(t.node);return o.setStartAndEnd(t.node,t.offset,n.node,n.offset),!o.expand("word",{wordOptions:r})}function S(e,t,n,r,o){function i(e,t){var n=g[e].previousVisible(),r=g[t-1],i=!o.wholeWordsOnly||E(n,r,o.wordOptions);return{startPos:n,endPos:r,valid:i}}for(var a,s,c,l,d,u,f=j(o.direction),h=N(e,f,e.session.getRangeBoundaryPosition(r,f),o.characterOptions),p="",g=[],m=null;a=h.next();)if(s=a.character,n||o.caseSensitive||(s=s.toLowerCase()),f?(g.unshift(a),p=s+p):(g.push(a),p+=s),n){if(d=t.exec(p))if(c=d.index,l=c+d[0].length,u){if(!f&&l<p.length||f&&c>0){m=i(c,l);break}}else u=!0}else if(-1!=(c=p.indexOf(t))){m=i(c,c+t.length);break}return u&&(m=i(c,l)),h.dispose(),m}function T(e){return function(){var t=!!de,n=v(),r=[n].concat(D.toArray(arguments)),o=e.apply(this,r);return t||C(),o}}function w(e,t){return T(function(n,r,i,a){typeof i==b&&(i=r,r=A),a=o(a,Q);var s=e;t&&(s=i>=0,this.collapse(!s));var c=function(e,t,n,r,o){var i,a,s,c,l=0,d=e,u=Math.abs(n);if(0!==n){var f=0>n;switch(t){case A:for(a=N(e,f,null,r);(i=a.next())&&u>l;)++l,d=i;s=i,a.dispose();break;case P:for(var h=R(e,r,o),p=f?h.previousStartToken:h.nextEndToken;(c=p())&&u>l;)c.isWord&&(++l,d=f?c.chars[0]:c.chars[c.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+t+"' not implemented")}f?(d=d.previousVisible(),l=-l):d&&d.isLeadingSpace&&!d.isTrailingSpace&&(t==P&&(a=N(e,!1,null,r),s=a.next(),a.dispose()),s&&(d=s.previousVisible()))}return{position:d,unitsMoved:l}}(n.getRangeBoundaryPosition(this,s),r,i,a.characterOptions,a.wordOptions),l=c.position;return this[s?"setStart":"setEnd"](l.node,l.offset),c.unitsMoved})}function O(e){return T(function(t,n){n=B(n,$);for(var r,o=y(t,this,n,!e),i=0;(r=o.next())&&M.test(r.character);)++i;o.dispose();var a=i>0;return a&&this[e?"moveStart":"moveEnd"]("character",e?i:-i,{characterOptions:n}),a})}function x(e){return T(function(t,n){var r=!1;return this.changeEachRange(function(t){r=t[e](n)||r}),r})}var b="undefined",A="character",P="word",_=e.dom,D=e.util,I=D.extend,B=D.createOptions,L=_.getBody,k=/^[ \t\f\r\n]+$/,W=/^[ \t\f\r]+$/,M=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,H=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,F="en",j=e.Selection.isDirectionBackward,V=!1,U=!1;!function(){var t=_.createTestElement(document,"<p>1 </p><p></p>",!0),n=t.firstChild,r=e.getSelection();r.collapse(n.lastChild,2),r.setStart(n.firstChild,0),t.innerHTML="1 <br />",r.collapse(t,2),r.setStart(t.firstChild,0),V=1==(""+r).length,t.innerHTML="1 <p>1</p>",r.collapse(t,2),r.setStart(t.firstChild,0),U=1==(""+r).length,_.removeNode(t),r.removeAllRanges()}();var z,$={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includeSpaceBeforeBlock:!0,includePreLineTrailingSpace:!0,ignoreCharacters:""},q={includeBlockContentTrailingSpace:!1,includeSpaceBeforeBr:!V,includeSpaceBeforeBlock:!U,includePreLineTrailingSpace:!0},G={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:function(e,t){function n(e,t,n){s.push({start:e,end:t,isWord:n})}for(var r,o,i,a=e.join(""),s=[],c=0;r=t.wordRegex.exec(a);){if(o=r.index,i=o+r[0].length,o>c&&n(c,o,!1),t.includeTrailingSpace)for(;H.test(e[i]);)++i;n(o,i,!0),c=i}return c<e.length&&n(c,e.length,!1),s}}},Y={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},Q={wordOptions:null,characterOptions:null},K={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},X={wordOptions:null,characterOptions:null,direction:"forward"},Z=_.getComputedStyleProperty;!function(){var e=document.createElement("table"),t=L(document);t.appendChild(e),z="block"==Z(e,"display"),t.removeChild(e)}();var J={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};h.prototype={get:function(e){return this.store.hasOwnProperty(e)?this.store[e]:null},set:function(e,t){return this.store[e]=t}};var ee={getPosition:function(e){var t=this.positions;return t.get(e)||t.set(e,new m(this,e))},toString:function(){return"[NodeWrapper("+_.inspectNode(this.node)+")]"}};g.prototype=ee;var te="NON_SPACE",ne="UNCOLLAPSIBLE_SPACE",re="COLLAPSIBLE_SPACE",oe="TRAILING_SPACE_BEFORE_BLOCK",ie="TRAILING_SPACE_IN_BLOCK",ae="TRAILING_SPACE_BEFORE_BR",se="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK",ce="INCLUDED_TRAILING_LINE_BREAK_AFTER_BR";I(ee,{isCharacterDataNode:p("isCharacterDataNode",_.isCharacterDataNode,"node"),getNodeIndex:p("nodeIndex",_.getNodeIndex,"node"),getLength:p("nodeLength",_.getNodeLength,"node"),containsPositions:p("containsPositions",function(e){return _.isCharacterDataNode(e)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(e.nodeName)},"node"),isWhitespace:p("isWhitespace",l,"node"),isCollapsedWhitespace:p("isCollapsedWhitespace",d,"node"),getComputedDisplay:p("computedDisplay",i,"node"),isCollapsed:p("collapsed",u,"node"),isIgnored:p("ignored",f,"node"),next:p("nextPos",s,"node"),previous:p("previous",c,"node"),getTextNodeInfo:p("textNodeInfo",function(e){var t=null,n=!1,r=Z(e.parentNode,"whiteSpace"),o="pre-line"==r;return o?(t=W,n=!0):("normal"==r||"nowrap"==r)&&(t=k,n=!0),{node:e,text:e.data,spaceRegex:t,collapseSpaces:n,preLine:o}},"node"),hasInnerText:p("hasInnerText",function(e,t){for(var n=this.session,r=n.getPosition(e.parentNode,this.getNodeIndex()+1),o=n.getPosition(e,0),i=t?r:o,a=t?o:r;i!==a;){if(i.prepopulateChar(),i.isDefinitelyNonEmpty())return!0;i=t?i.previousVisible():i.nextVisible()}return!1},"node"),isRenderedBlock:p("isRenderedBlock",function(e){for(var t=e.getElementsByTagName("br"),n=0,r=t.length;r>n;++n)if(!u(t[n]))return!0;return this.hasInnerText()},"node"),getTrailingSpace:p("trailingSpace",function(e){if("br"==e.tagName.toLowerCase())return"";switch(this.getComputedDisplay()){case"inline":for(var t=e.lastChild;t;){if(!f(t))return 1==t.nodeType?this.session.getNodeWrapper(t).getTrailingSpace():"";t=t.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"\t";default:return this.isRenderedBlock(!0)?"\n":""}return""},"node"),getLeadingSpace:p("leadingSpace",function(){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.isRenderedBlock(!1)?"\n":""}return""},"node")});var le={character:"",characterType:"EMPTY",isBr:!1,prepopulateChar:function(){var e=this;if(!e.prepopulatedChar){var t=e.node,n=e.offset,r="",o="EMPTY",i=!1;if(n>0)if(3==t.nodeType){var a=t.data,s=a.charAt(n-1),c=e.nodeWrapper.getTextNodeInfo(),l=c.spaceRegex;c.collapseSpaces?l.test(s)?n>1&&l.test(a.charAt(n-2))||(c.preLine&&"\n"===a.charAt(n)?(r=" ",o=se):(r=" ",o=re)):(r=s,o=te,i=!0):(r=s,o=ne,i=!0)}else{var d=t.childNodes[n-1];if(d&&1==d.nodeType&&!u(d)&&("br"==d.tagName.toLowerCase()?(r="\n",e.isBr=!0,o=re,i=!1):e.checkForTrailingSpace=!0),!r){var f=t.childNodes[n];f&&1==f.nodeType&&!u(f)&&(e.checkForLeadingSpace=!0)}}e.prepopulatedChar=!0,e.character=r,e.characterType=o,e.isCharInvariant=i}},isDefinitelyNonEmpty:function(){var e=this.characterType;return e==te||e==ne},resolveLeadingAndTrailingSpaces:function(){if(this.prepopulatedChar||this.prepopulateChar(),this.checkForTrailingSpace){var e=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();e&&(this.isTrailingSpace=!0,this.character=e,this.characterType=re),this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){var t=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();t&&(this.isLeadingSpace=!0,this.character=t,this.characterType=re),this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(e){for(var t=this;t=t.previousVisible();)if(""!==t.getCharacter(e))return t;return null},getCharacter:function(e){function t(){return u||(c=f.getPrecedingUncollapsedPosition(e),u=!0),c}this.resolveLeadingAndTrailingSpaces();var n=this.character,r=function(e){var t=e||"",n="string"==typeof t?t.split(""):t;return n.sort(function(e,t){return e.charCodeAt(0)-t.charCodeAt(0)}),n.join("").replace(/(.)\1+/g,"$1")}(e.ignoreCharacters),o=""!==n&&r.indexOf(n)>-1;if(this.isCharInvariant)return o?"":n;var i=["character",e.includeSpaceBeforeBr,e.includeBlockContentTrailingSpace,e.includePreLineTrailingSpace,r].join("_"),a=this.cache.get(i);if(null!==a)return a;var s,c,l="",d=this.characterType==re,u=!1,f=this;return d&&(this.type==ce?l="\n":" "==n&&(!t()||c.isTrailingSpace||"\n"==c.character||" "==c.character&&c.characterType==re)||("\n"==n&&this.isLeadingSpace?t()&&"\n"!=c.character&&(l="\n"):(s=this.nextUncollapsed())&&(s.isBr?this.type=ae:s.isTrailingSpace&&"\n"==s.character?this.type=ie:s.isLeadingSpace&&"\n"==s.character&&(this.type=oe),"\n"==s.character?(this.type!=ae||e.includeSpaceBeforeBr)&&(this.type!=oe||e.includeSpaceBeforeBlock)&&(this.type==ie&&s.isTrailingSpace&&!e.includeBlockContentTrailingSpace||(this.type!=se||s.type!=te||e.includePreLineTrailingSpace)&&("\n"==n?s.isTrailingSpace?this.isTrailingSpace||this.isBr&&(s.type="TRAILING_LINE_BREAK_AFTER_BR",t()&&c.isLeadingSpace&&!c.isTrailingSpace&&"\n"==c.character?s.character="":s.type=ce):l="\n":" "==n&&(l=" "))):l=n))),r.indexOf(l)>-1&&(l=""),this.cache.set(i,l),l},equals:function(e){return!!e&&this.node===e.node&&this.offset===e.offset},inspect:function(){return"[Position("+_.inspectNode(this.node)+":"+this.offset+")]"},toString:function(){return this.character}};m.prototype=le,I(le,{next:p("nextPos",function(e){var t,n,r,o=e.nodeWrapper,i=e.node,a=e.offset,s=o.session;return i?(a==o.getLength()?(t=i.parentNode,n=t?o.getNodeIndex()+1:0):o.isCharacterDataNode()?(t=i,n=a+1):(r=i.childNodes[a],s.getNodeWrapper(r).containsPositions()?(t=r,n=0):(t=i,n=a+1)),t?s.getPosition(t,n):null):null}),previous:p("previous",function(e){var t,n,r,o=e.nodeWrapper,i=e.node,a=e.offset,s=o.session;return 0==a?(t=i.parentNode,n=t?o.getNodeIndex():0):o.isCharacterDataNode()?(t=i,n=a-1):(r=i.childNodes[a-1],s.getNodeWrapper(r).containsPositions()?(t=r,n=_.getNodeLength(r)):(t=i,n=a-1)),t?s.getPosition(t,n):null}),nextVisible:p("nextVisible",function(e){var t=e.next();if(!t)return null;var n=t.nodeWrapper,r=t.node,o=t;return n.isCollapsed()&&(o=n.session.getPosition(r.parentNode,n.getNodeIndex()+1)),o}),nextUncollapsed:p("nextUncollapsed",function(e){for(var t=e;t=t.nextVisible();)if(t.resolveLeadingAndTrailingSpaces(),""!==t.character)return t;return null}),previousVisible:p("previousVisible",function(e){var t=e.previous();if(!t)return null;var n=t.nodeWrapper,r=t.node,o=t;return n.isCollapsed()&&(o=n.session.getPosition(r.parentNode,n.getNodeIndex())),o})});var de=null,ue=function(){function e(e){var t=new h;return{get:function(n){var r=t.get(n[e]);if(r)for(var o,i=0;o=r[i++];)if(o.node===n)return o;return null},set:function(n){var r=n.node[e],o=t.get(r)||t.set(r,[]);o.push(n)}}}function t(){this.initCaches()}var n=D.isHostProperty(document.documentElement,"uniqueID");return t.prototype={initCaches:function(){this.elementCache=n?function(){var e=new h;return{get:function(t){return e.get(t.uniqueID)},set:function(t){e.set(t.node.uniqueID,t)}}}():e("tagName"),this.textNodeCache=e("data"),this.otherNodeCache=e("nodeName")},getNodeWrapper:function(e){var t;switch(e.nodeType){case 1:t=this.elementCache;break;case 3:t=this.textNodeCache;break;default:t=this.otherNodeCache}var n=t.get(e);return n||(n=new g(e,this),t.set(n)),n},getPosition:function(e,t){return this.getNodeWrapper(e).getPosition(t)},getRangeBoundaryPosition:function(e,t){var n=t?"start":"end";return this.getPosition(e[n+"Container"],e[n+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},t}();I(_,{nextNode:s,previousNode:c});var fe=Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n=0,r=e.length;r>n;++n)if(e[n]===t)return n;return-1};I(e.rangePrototype,{moveStart:w(!0,!1),moveEnd:w(!1,!1),move:w(!0,!0),trimStart:O(!0),trimEnd:O(!1),trim:T(function(e,t){var n=this.trimStart(t),r=this.trimEnd(t);return n||r}),expand:T(function(e,t,n){var r=!1,i=(n=o(n,K)).characterOptions;if(t||(t=A),t==P){var a,s,c=n.wordOptions,l=e.getRangeBoundaryPosition(this,!0),d=e.getRangeBoundaryPosition(this,!1),u=R(l,i,c),f=u.nextEndToken(),h=f.chars[0].previousVisible();if(this.collapsed)a=f;else{var p=R(d,i,c);a=p.previousStartToken()}return s=a.chars[a.chars.length-1],h.equals(l)||(this.setStart(h.node,h.offset),r=!0),s&&!s.equals(d)&&(this.setEnd(s.node,s.offset),r=!0),n.trim&&(n.trimStart&&(r=this.trimStart(i)||r),n.trimEnd&&(r=this.trimEnd(i)||r)),r}return this.moveEnd(A,1,n)}),text:T(function(e,t){return this.collapsed?"":function(e,t,n){for(var r,o=[],i=y(e,t,n);r=i.next();)o.push(r);return i.dispose(),o}(e,this,B(t,$)).join("")}),selectCharacters:T(function(e,t,n,r,o){var i={characterOptions:o};t||(t=L(this.getDocument())),this.selectNodeContents(t),this.collapse(!0),this.moveStart("character",n,i),this.collapse(!0),this.moveEnd("character",r-n,i)}),toCharacterRange:T(function(e,t,n){t||(t=L(this.getDocument()));var r,o,i=t.parentNode,a=_.getNodeIndex(t),s=-1==_.comparePoints(this.startContainer,this.endContainer,i,a),c=this.cloneRange();return s?(c.setStartAndEnd(this.startContainer,this.startOffset,i,a),r=-c.text(n).length):(c.setStartAndEnd(i,a,this.startContainer,this.startOffset),r=c.text(n).length),o=r+this.text(n).length,{start:r,end:o}}),findText:T(function(t,n,r){(r=o(r,Y)).wholeWordsOnly&&(r.wordOptions.includeTrailingSpace=!1);var i=j(r.direction),a=r.withinRange;a||(a=e.createRange()).selectNodeContents(this.getDocument());var s=n,c=!1;"string"==typeof s?r.caseSensitive||(s=s.toLowerCase()):c=!0;var l=t.getRangeBoundaryPosition(this,!i),d=a.comparePoint(l.node,l.offset);-1===d?l=t.getRangeBoundaryPosition(a,!0):1===d&&(l=t.getRangeBoundaryPosition(a,!1));for(var u,f=l,h=!1;;)if(u=S(f,s,c,a,r)){if(u.valid)return this.setStartAndEnd(u.startPos.node,u.startPos.offset,u.endPos.node,u.endPos.offset),!0;f=i?u.startPos:u.endPos}else{if(!r.wrap||h)return!1;a=a.cloneRange(),f=t.getRangeBoundaryPosition(a,!i),a.setBoundary(l.node,l.offset,i),h=!0}}),pasteHtml:function(e){if(this.deleteContents(),e){var t=this.createContextualFragment(e),n=t.lastChild;this.insertNode(t),this.collapseAfter(n)}}}),I(e.selectionPrototype,{expand:T(function(e,t,n){this.changeEachRange(function(e){e.expand(t,n)})}),move:T(function(e,t,n,r){var o=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var i=this.getRangeAt(0);r||(r={}),r.characterOptions=B(r.characterOptions,q),o=i.move(t,n,r),this.setSingleRange(i)}return o}),trimStart:x("trimStart"),trimEnd:x("trimEnd"),trim:x("trim"),selectCharacters:T(function(t,n,r,o,i,a){var s=e.createRange(n);s.selectCharacters(n,r,o,a),this.setSingleRange(s,i)}),saveCharacterRanges:T(function(e,t,n){for(var r=this.getAllRanges(),o=r.length,i=[],a=1==o&&this.isBackward(),s=0,c=r.length;c>s;++s)i[s]={characterRange:r[s].toCharacterRange(t,n),backward:a,characterOptions:n};return i}),restoreCharacterRanges:T(function(t,n,r){this.removeAllRanges();for(var o,i,a,s=0,c=r.length;c>s;++s)i=r[s],a=i.characterRange,(o=e.createRange(n)).selectCharacters(n,a.start,a.end,i.characterOptions),this.addRange(o,i.backward)}),text:T(function(e,t){for(var n=[],r=0,o=this.rangeCount;o>r;++r)n[r]=this.getRangeAt(r).text(t);return n.join("")})}),e.innerText=function(t,n){var r=e.createRange(t);r.selectNodeContents(t);var o=r.text(n);return o},e.createWordIterator=function(e,t,n){var r=v();n=o(n,X);var i=r.getPosition(e,t),a=R(i,n.characterOptions,n.wordOptions),s=j(n.direction);return{next:function(){return s?a.previousStartToken():a.nextEndToken()},dispose:function(){a.dispose(),this.next=function(){}}}},e.noMutation=function(e){var t=v();e(t),C()},e.noMutation.createEntryPointFunction=T,e.textRange={isBlockNode:function(e){return e&&(1==e.nodeType&&!/^(inline(-block|-table)?|none)$/.test(i(e))||9==e.nodeType||11==e.nodeType)},isCollapsedWhitespaceNode:d,createPosition:T(function(e,t,n){return e.getPosition(t,n)})}}),e})?r.apply(t,o):r)||(e.exports=i)},1182:function(e,t,n){var r,o,a;o=[n(925)],void 0===(a="function"==typeof(r=function(e){return e.createModule("ClassApplier",["WrappedSelection"],function(e,t){function n(e,t){for(var n in e)if(e.hasOwnProperty(n)&&!1===t(n,e[n]))return!1;return!0}function r(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function o(e,t){return!!e&&new RegExp("(?:^|\\s)"+t+"(?:\\s|$)").test(e)}function a(e,t){if("object"==typeof e.classList)return e.classList.contains(t);var n="string"==typeof e.className,r=n?e.className:e.getAttribute("class");return o(r,t)}function s(e,t){if("object"==typeof e.classList)e.classList.add(t);else{var n="string"==typeof e.className,r=n?e.className:e.getAttribute("class");r?o(r,t)||(r+=" "+t):r=t,n?e.className=r:e.setAttribute("class",r)}}function c(e){var t="string"==typeof e.className;return t?e.className:e.getAttribute("class")}function l(e){return e&&e.split(/\s+/).sort().join(" ")}function d(e){return l(c(e))}function u(e,t){return d(e)==d(t)}function f(e,t){for(var n=t.split(/\s+/),o=0,i=n.length;i>o;++o)if(!a(e,r(n[o])))return!1;return!0}function h(e,t,n,r){-1==n&&(n=t.childNodes.length);var o=e.parentNode,i=A.getNodeIndex(e);I(r,function(e){!function(e,t,n,r,o){var i=e.node,a=e.offset,s=i,c=a;i==r&&a>o&&++c,i!=t||a!=n&&a!=n+1||(s=r,c+=o-n),i==t&&a>n+1&&--c,e.node=s,e.offset=c}(e,o,i,t,n)}),t.childNodes.length==n?t.appendChild(e):t.insertBefore(e,t.childNodes[n])}function p(e,t){var n=e.parentNode,r=A.getNodeIndex(e);I(t,function(e){!function(e,t,n){e.node==t&&e.offset>n&&--e.offset}(e,n,r)}),A.removeNode(e)}function g(e,t){return function(e,t,n,r,o){for(var i,a=[];i=e.firstChild;)h(i,t,n++,o),a.push(i);return r&&p(e,o),a}(e,e.parentNode,A.getNodeIndex(e),!0,t)}function m(e,t){var n=e.cloneRange();n.selectNodeContents(t);var r=n.intersection(e),o=r?r.toString():"";return""!=o}function v(e){for(var t,n=e.getNodes([3]),r=0;(t=n[r])&&!m(e,t);)++r;for(var o=n.length-1;(t=n[o])&&!m(e,t);)--o;return n.slice(r,o+1)}function C(e,t){if(e.attributes.length!=t.attributes.length)return!1;for(var n,r,o,i=0,a=e.attributes.length;a>i;++i)if(n=e.attributes[i],"class"!=(o=n.name)){if(r=t.attributes.getNamedItem(o),null===n!=(null===r))return!1;if(n.specified!=r.specified)return!1;if(n.specified&&n.nodeValue!==r.nodeValue)return!1}return!0}function N(e,t){for(var n,r=0,o=e.attributes.length;o>r;++r)if(n=e.attributes[r].name,(!t||!_(t,n))&&e.attributes[r].specified&&"class"!=n)return!0;return!1}function R(e){var t;return e&&1==e.nodeType&&((t=e.parentNode)&&9==t.nodeType&&"on"==t.designMode||W(e)&&!W(e.parentNode))}function y(e){return(W(e)||1!=e.nodeType&&W(e.parentNode))&&!R(e)}function E(e){return e&&1==e.nodeType&&!M.test(k(e,"display"))}function S(e){var t,n,r=[];for(t=0;n=e[t++];)r.push(new P(n.startContainer,n.startOffset),new P(n.endContainer,n.endOffset));return r}function T(e,t){for(var n,r,o,i=0,a=e.length;a>i;++i)n=e[i],r=t[2*i],o=t[2*i+1],n.setStartAndEnd(r.node,r.offset,o.node,o.offset)}function w(e,n,r,o){var i,a,s=0==r;if(A.isAncestorOf(n,e))return e;if(A.isCharacterDataNode(n)){var c=A.getNodeIndex(n);if(0==r)r=c;else{if(r!=n.length)throw t.createError("splitNodeAt() should not be called with offset in the middle of a data node ("+r+" in "+n.data);r=c+1}n=n.parentNode}if(function(e,t){return A.isCharacterDataNode(e)?0==t?!!e.previousSibling:t!=e.length||!!e.nextSibling:t>0&&t<e.childNodes.length}(n,r)){i=n.cloneNode(!1),a=n.parentNode,i.id&&i.removeAttribute("id");for(var l,d=0;l=n.childNodes[r];)h(l,i,d++,o);return h(i,a,A.getNodeIndex(n)+1,o),n==e?i:w(e,a,A.getNodeIndex(i),o)}if(e!=n){i=n.parentNode;var u=A.getNodeIndex(n);return s||u++,w(e,i,u,o)}return e}function O(e){var t=e?"nextSibling":"previousSibling";return function(n,r){var o=n.parentNode,i=n[t];if(i){if(i&&3==i.nodeType)return i}else if(r&&(i=o[t])&&1==i.nodeType&&function(e,t){return e.namespaceURI==t.namespaceURI&&e.tagName.toLowerCase()==t.tagName.toLowerCase()&&u(e,t)&&C(e,t)&&"inline"==k(e,"display")&&"inline"==k(t,"display")}(o,i)){var a=i[e?"firstChild":"lastChild"];if(a&&3==a.nodeType)return a}return null}}function x(e){this.isElementMerge=1==e.nodeType,this.textNodes=[];var t=this.isElementMerge?e.lastChild:e;t&&(this.textNodes[0]=t)}function b(e,t,o){var i,a,s,c,d=this;d.cssClass=d.className=e;var u=null,f={};if("object"==typeof t&&null!==t){for(void 0!==t.elementTagName&&(t.elementTagName=t.elementTagName.toLowerCase()),o=t.tagNames,u=t.elementProperties,f=t.elementAttributes,a=0;c=V[a++];)t.hasOwnProperty(c)&&(d[c]=t[c]);i=t.normalize}else i=t;d.normalize=void 0===i||i,d.attrExceptions=[];var h=document.createElement(d.elementTagName);d.elementProperties=d.copyPropertiesToElement(u,h,!0),n(f,function(e,t){d.attrExceptions.push(e),f[e]=""+t}),d.elementAttributes=f,d.elementSortedClassName=d.elementProperties.hasOwnProperty("className")?l(d.elementProperties.className+" "+e):e,d.applyToAnyTagName=!1;var p=typeof o;if("string"==p)"*"==o?d.applyToAnyTagName=!0:d.tagNames=r(o.toLowerCase()).split(/\s*,\s*/);else if("object"==p&&"number"==typeof o.length)for(d.tagNames=[],a=0,s=o.length;s>a;++a)"*"==o[a]?d.applyToAnyTagName=!0:d.tagNames.push(o[a].toLowerCase());else d.tagNames=[d.elementTagName]}var A=e.dom,P=A.DomPosition,_=A.arrayContains,D=e.util,I=D.forEach,B=D.isHostMethod(document,"createElementNS"),L=function(){function e(e,t,n){return t&&n?" ":""}return function(t,n){if("object"==typeof t.classList)t.classList.remove(n);else{var r="string"==typeof t.className,o=r?t.className:t.getAttribute("class");o=o.replace(new RegExp("(^|\\s)"+n+"(\\s|$)"),e),r?t.className=o:t.setAttribute("class",o)}}}(),k=A.getComputedStyleProperty,W=function(){var e=document.createElement("div");return"boolean"==typeof e.isContentEditable?function(e){return e&&1==e.nodeType&&e.isContentEditable}:function(e){return!(!e||1!=e.nodeType||"false"==e.contentEditable)&&("true"==e.contentEditable||W(e.parentNode))}}(),M=/^inline(-block|-table)?$/i,H=/[^\r\n\t\f \u200B]/,F=O(!1),j=O(!0);x.prototype={doMerge:function(e){var t=this.textNodes,n=t[0];if(t.length>1){var r,o=A.getNodeIndex(n),i=[],a=0;I(t,function(t,s){r=t.parentNode,s>0&&(r.removeChild(t),r.hasChildNodes()||A.removeNode(r),e&&I(e,function(e){e.node==t&&(e.node=n,e.offset+=a),e.node==r&&e.offset>o&&(--e.offset,e.offset==o+1&&len-1>s&&(e.node=n,e.offset=a))})),i[s]=t.data,a+=t.data.length}),n.data=i.join("")}return n.data},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){var e=[];return I(this.textNodes,function(t,n){e[n]="'"+t.data+"'"}),"[Merge("+e.join(",")+")]"}};var V=["elementTagName","ignoreWhiteSpace","applyToEditableOnly","useExistingElements","removeEmptyElements","onElementCreate"],U={};b.prototype={elementTagName:"span",elementProperties:{},elementAttributes:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,useExistingElements:!0,removeEmptyElements:!0,onElementCreate:null,copyPropertiesToElement:function(e,t,n){var r,o,i,a,c,d,u={};for(var f in e)if(e.hasOwnProperty(f))if(a=e[f],c=t[f],"className"==f)s(t,a),s(t,this.className),t[f]=l(t[f]),n&&(u[f]=a);else if("style"==f){for(r in o=c,n&&(u[f]=i={}),e[f])e[f].hasOwnProperty(r)&&(o[r]=a[r],n&&(i[r]=o[r]));this.attrExceptions.push(f)}else t[f]=a,n&&(u[f]=t[f],d=U.hasOwnProperty(f)?U[f]:f,this.attrExceptions.push(d));return n?u:""},copyAttributesToElement:function(e,t){for(var n in e)e.hasOwnProperty(n)&&!/^class(?:Name)?$/i.test(n)&&t.setAttribute(n,e[n])},appliesToElement:function(e){return _(this.tagNames,e.tagName.toLowerCase())},getEmptyElements:function(e){var t=this;return e.getNodes([1],function(e){return t.appliesToElement(e)&&!e.hasChildNodes()})},hasClass:function(e){return 1==e.nodeType&&(this.applyToAnyTagName||this.appliesToElement(e))&&a(e,this.className)},getSelfOrAncestorWithClass:function(e){for(;e;){if(this.hasClass(e))return e;e=e.parentNode}return null},isModifiable:function(e){return!this.applyToEditableOnly||y(e)},isIgnorableWhiteSpaceNode:function(e){return this.ignoreWhiteSpace&&e&&3==e.nodeType&&function(e){if(0==e.data.length)return!0;if(H.test(e.data))return!1;switch(k(e.parentNode,"whiteSpace")){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(e.data))return!1}return E(e.previousSibling)||E(e.nextSibling)}(e)},postApply:function(e,t,n,r){var o,a,s=e[0],c=e[e.length-1],l=[],d=s,u=c,f=0,h=c.length;I(e,function(e){(a=F(e,!r))?(o||(o=new x(a),l.push(o)),o.textNodes.push(e),e===s&&(d=o.textNodes[0],f=d.length),e===c&&(u=o.textNodes[0],h=o.getLength())):o=null});var p=j(c,!r);if(p&&(o||(o=new x(c),l.push(o)),o.textNodes.push(p)),l.length){for(i=0,len=l.length;len>i;++i)l[i].doMerge(n);t.setStartAndEnd(d,f,u,h)}},createContainer:function(e){var t=A.getDocument(e),n=B&&!A.isHtmlNamespace(e)&&e.namespaceURI?t.createElementNS(e.namespaceURI,this.elementTagName):t.createElement(this.elementTagName);return this.copyPropertiesToElement(this.elementProperties,n,!1),this.copyAttributesToElement(this.elementAttributes,n),s(n,this.className),this.onElementCreate&&this.onElementCreate(n,this),n},elementHasProperties:function(e,t){var r=this;return n(t,function(t,n){if("className"==t)return f(e,n);if("object"==typeof n){if(!r.elementHasProperties(e[t],n))return!1}else if(e[t]!==n)return!1})},elementHasAttributes:function(e,t){return n(t,function(t,n){return e.getAttribute(t)===n&&void 0})},applyToTextNode:function(e){if(function(e){var t=e.parentNode;return t&&1==t.nodeType&&!/^(textarea|style|script|select|iframe)$/i.test(t.nodeName)}(e)){var t=e.parentNode;if(1==t.childNodes.length&&this.useExistingElements&&this.appliesToElement(t)&&this.elementHasProperties(t,this.elementProperties)&&this.elementHasAttributes(t,this.elementAttributes))s(t,this.className);else{var n=e.parentNode,r=this.createContainer(n);n.insertBefore(r,e),r.appendChild(e)}}},isRemovable:function(e){return e.tagName.toLowerCase()==this.elementTagName&&d(e)==this.elementSortedClassName&&this.elementHasProperties(e,this.elementProperties)&&!N(e,this.attrExceptions)&&this.elementHasAttributes(e,this.elementAttributes)&&this.isModifiable(e)},isEmptyContainer:function(e){var t=e.childNodes.length;return 1==e.nodeType&&this.isRemovable(e)&&(0==t||1==t&&this.isEmptyContainer(e.firstChild))},removeEmptyContainers:function(e){var t=this,n=e.getNodes([1],function(e){return t.isEmptyContainer(e)}),r=[e],o=S(r);I(n,function(e){p(e,o)}),T(r,o)},undoToTextNode:function(e,t,n,r){if(!t.containsNode(n)){var o=t.cloneRange();o.selectNode(n),o.isPointInRange(t.endContainer,t.endOffset)&&(w(n,t.endContainer,t.endOffset,r),t.setEndAfter(n)),o.isPointInRange(t.startContainer,t.startOffset)&&(n=w(n,t.startContainer,t.startOffset,r))}this.isRemovable(n)?g(n,r):L(n,this.className)},splitAncestorWithClass:function(e,t,n){var r=this.getSelfOrAncestorWithClass(e);r&&w(r,e,t,n)},undoToAncestor:function(e,t){this.isRemovable(e)?g(e,t):L(e,this.className)},applyToRange:function(e,t){var n=this,r=S((t=t||[])||[]);e.splitBoundariesPreservingPositions(r),n.removeEmptyElements&&n.removeEmptyContainers(e);var o=v(e);if(o.length){I(o,function(e){n.isIgnorableWhiteSpaceNode(e)||n.getSelfOrAncestorWithClass(e)||!n.isModifiable(e)||n.applyToTextNode(e,r)});var i=o[o.length-1];e.setStartAndEnd(o[0],0,i,i.length),n.normalize&&n.postApply(o,e,r,!1),T(t,r)}var a=n.getEmptyElements(e);I(a,function(e){s(e,n.className)})},applyToRanges:function(e){for(var t=e.length;t--;)this.applyToRange(e[t],e);return e},applyToSelection:function(t){var n=e.getSelection(t);n.setRanges(this.applyToRanges(n.getAllRanges()))},undoToRange:function(e,t){var n=this,r=S(t=t||[]);e.splitBoundariesPreservingPositions(r),n.removeEmptyElements&&n.removeEmptyContainers(e,r);var o,i,a=v(e),s=a[a.length-1];if(a.length){n.splitAncestorWithClass(e.endContainer,e.endOffset,r),n.splitAncestorWithClass(e.startContainer,e.startOffset,r);for(var c=0,l=a.length;l>c;++c)o=a[c],(i=n.getSelfOrAncestorWithClass(o))&&n.isModifiable(o)&&n.undoToAncestor(i,r);e.setStartAndEnd(a[0],0,s,s.length),n.normalize&&n.postApply(a,e,r,!0),T(t,r)}var d=n.getEmptyElements(e);I(d,function(e){L(e,n.className)})},undoToRanges:function(e){for(var t=e.length;t--;)this.undoToRange(e[t],e);return e},undoToSelection:function(t){var n=e.getSelection(t),r=e.getSelection(t).getAllRanges();this.undoToRanges(r),n.setRanges(r)},isAppliedToRange:function(e){if(e.collapsed||""==e.toString())return!!this.getSelfOrAncestorWithClass(e.commonAncestorContainer);var t=e.getNodes([3]);if(t.length)for(var n,r=0;n=t[r++];)if(!this.isIgnorableWhiteSpaceNode(n)&&m(e,n)&&this.isModifiable(n)&&!this.getSelfOrAncestorWithClass(n))return!1;return!0},isAppliedToRanges:function(e){var t=e.length;if(0==t)return!1;for(;t--;)if(!this.isAppliedToRange(e[t]))return!1;return!0},isAppliedToSelection:function(t){var n=e.getSelection(t);return this.isAppliedToRanges(n.getAllRanges())},toggleRange:function(e){this.isAppliedToRange(e)?this.undoToRange(e):this.applyToRange(e)},toggleSelection:function(e){this.isAppliedToSelection(e)?this.undoToSelection(e):this.applyToSelection(e)},getElementsWithClassIntersectingRange:function(e){var t=[],n=this;return e.getNodes([3],function(e){var r=n.getSelfOrAncestorWithClass(e);r&&!_(t,r)&&t.push(r)}),t},detach:function(){}},b.util={hasClass:a,addClass:s,removeClass:L,getClass:c,hasSameClasses:u,hasAllClasses:f,replaceWithOwnChildren:g,elementsHaveSameNonClassAttributes:C,elementHasNonClassAttributes:N,splitNodeAt:w,isEditableElement:W,isEditingHost:R,isEditable:y},e.CssClassApplier=e.ClassApplier=b,e.createClassApplier=function(e,t,n){return new b(e,t,n)},D.createAliasForDeprecatedMethod(e,"createCssClassApplier","createClassApplier",t)}),e})?r.apply(t,o):r)||(e.exports=a)},1183:function(e,t,n){var r=n(690);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,o){var i,a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,c=e.escapeExpression;return'<div class="texteditorObject">\n    \n    <div class="text-editor-content nodisplay">\n        '+c("function"==typeof(i=null!=(i=n.htmlcontent||(null!=t?t.htmlcontent:t))?i:s)?i.call(a,{name:"htmlcontent",hash:{},data:o,loc:{start:{line:4,column:8},end:{line:4,column:23}}}):i)+'\n    </div>\n\n    <div class="text-editor-wraper nodisplay" >\n\n        <div id="'+c("function"==typeof(i=null!=(i=n.key||(null!=t?t.key:t))?i:s)?i.call(a,{name:"key",hash:{},data:o,loc:{start:{line:9,column:17},end:{line:9,column:24}}}):i)+'" class="wysiwyg_editor" contenteditable="true" spellcheck="true">\n            \n        </div>\n\n\n    </div>\n\n    \n</div>'},useData:!0})},1184:function(e,t,n){var r=n(690);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,o){var i;return'<textarea class="pureHtmlEditor" rows="15">'+e.escapeExpression("function"==typeof(i=null!=(i=n.html||(null!=t?t.html:t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"html",hash:{},data:o,loc:{start:{line:1,column:43},end:{line:1,column:51}}}):i)+"</textarea>"},useData:!0})},1185:function(e,t,n){var r=n(690);e.exports=(r.default||r).template({compiler:[8,">= 4.3.0"],main:function(e,t,n,r,o){return'<div style="width:300px; height:230px;">\n\n  <div id="drop-area" style="width:300px;">\n\n    <div class="drop-area-text">\n      <p>Drag an Drop images or</p>\n      <label class="lblUploadImage" for="fileElem">Click Here</label>\n      <input type="file" id="fileElem" accept=".jpg,.jpeg,.png">\n      <p class="drop-area-error"></p>\n    </div>\n  </div>\n\n\n  <div class="input-group">\n    <input type="text" class="form-control imgUrl" placeholder="www.example.com">\n    <div class="input-group-btn">\n      <button class="btn wysiwyg-toolbar-icon" type="button">\n        <i class=\'fa fa-check\'></i>\n      </button>\n    </div>\n  </div>\n\n</div>'},useData:!0})},708:function(e,t){e.exports=function(){return""}},925:function(e,t,n){var r,o;void 0===(o="function"==typeof(r=function(){var e="object",t="function",n="undefined",r=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],o=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],i=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],a=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function s(n,r){var o=typeof n[r];return o==t||!(o!=e||!n[r])||"unknown"==o}function c(t,n){return!(typeof t[n]!=e||!t[n])}function l(e,t){return typeof e[t]!=n}function d(e){return function(t,n){for(var r=n.length;r--;)if(!e(t,n[r]))return!1;return!0}}var u=d(s),f=d(c),h=d(l);function p(e){return e&&u(e,a)&&h(e,i)}function g(e){return c(e,"body")?e.body:e.getElementsByTagName("body")[0]}var m,v,C={},N=typeof window!=n&&typeof document!=n,R={isHostMethod:s,isHostObject:c,isHostProperty:l,areHostMethods:u,areHostObjects:f,areHostProperties:h,isTextRange:p,getBody:g,forEach:[].forEach?function(e,t){e.forEach(t)}:function(e,t){for(var n=0,r=e.length;n<r;++n)t(e[n],n)}},y={version:"1.3.0",initialized:!1,isBrowser:N,supported:!0,util:R,features:{},modules:C,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==n||rangyAutoInitialize}};function E(e){typeof console!=n&&s(console,"log")&&console.log(e)}function S(e,t){N&&t?alert(e):E(e)}function T(e){y.initialized=!0,y.supported=!1,S("Rangy is not supported in this environment. Reason: "+e,y.config.alertOnFail)}y.fail=T,y.warn=function(e){S("Rangy warning: "+e,y.config.alertOnWarn)},{}.hasOwnProperty?(R.extend=m=function(e,t,n){var r,o;for(var i in t)t.hasOwnProperty(i)&&(r=e[i],o=t[i],n&&null!==r&&"object"==typeof r&&null!==o&&"object"==typeof o&&m(r,o,!0),e[i]=o);return t.hasOwnProperty("toString")&&(e.toString=t.toString),e},R.createOptions=function(e,t){var n={};return m(n,t),e&&m(n,e),n}):T("hasOwnProperty not supported"),N||T("Rangy can only run in a browser"),function(){var e;if(N){var t=document.createElement("div");t.appendChild(document.createElement("span"));var n=[].slice;try{1==n.call(t.childNodes,0)[0].nodeType&&(e=function(e){return n.call(e,0)})}catch(e){}}e||(e=function(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e[n];return t}),R.toArray=e}(),N&&(s(document,"addEventListener")?v=function(e,t,n){e.addEventListener(t,n,!1)}:s(document,"attachEvent")?v=function(e,t,n){e.attachEvent("on"+t,n)}:T("Document does not have required addEventListener or attachEvent method"),R.addListener=v);var w=[];function O(e){return e.message||e.description||String(e)}function x(){if(N&&!y.initialized){var e,t=!1,n=!1;s(document,"createRange")&&(e=document.createRange(),u(e,o)&&h(e,r)&&(t=!0));var i=g(document);if(i&&"body"==i.nodeName.toLowerCase())if(i&&s(i,"createTextRange")&&p(e=i.createTextRange())&&(n=!0),t||n){var a;for(var c in y.initialized=!0,y.features={implementsDomRange:t,implementsTextRange:n},C)(a=C[c])instanceof _&&a.init(a,y);for(var l=0,d=w.length;l<d;++l)try{w[l](y)}catch(e){E("Rangy init listener threw an exception. Continuing. Detail: "+O(e))}}else T("Neither Range nor TextRange are available");else T("No body element found")}}function b(e,t,n){n&&(e+=" in module "+n.name),y.warn("DEPRECATED: "+e+" is deprecated. Please use "+t+" instead.")}function A(e,t,n,r){e[t]=function(){return b(t,n,r),e[n].apply(e,R.toArray(arguments))}}R.deprecationNotice=b,R.createAliasForDeprecatedMethod=A,y.init=x,y.addInitListener=function(e){y.initialized?e(y):w.push(e)};var P=[];function _(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function D(e,t,n){var r=new _(e,t,function(t){if(!t.initialized){t.initialized=!0;try{n(y,t),t.supported=!0}catch(t){var r="Module '"+e+"' failed to load: "+O(t);E(r),t.stack&&E(t.stack)}}});return C[e]=r,r}function I(){}y.addShimListener=function(e){P.push(e)},N&&(y.shim=y.createMissingNativeApi=function(e){e=e||window,x();for(var t=0,n=P.length;t<n;++t)P[t](e)},A(y,"createMissingNativeApi","shim")),_.prototype={init:function(){for(var e,t,n=this.dependencies||[],r=0,o=n.length;r<o;++r){if(t=n[r],!((e=C[t])&&e instanceof _))throw new Error("required module '"+t+"' not found");if(e.init(),!e.supported)throw new Error("required module '"+t+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error(e)},warn:function(e){y.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){y.warn("DEPRECATED: "+e+" in module "+this.name+" is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},y.createModule=function(e){var t,n;2==arguments.length?(t=arguments[1],n=[]):(t=arguments[2],n=arguments[1]);var r=D(e,n,t);y.initialized&&y.supported&&r.init()},y.createCoreModule=function(e,t,n){D(e,t,n)},y.RangePrototype=I,y.rangePrototype=new I,y.selectionPrototype=new function(){},y.createCoreModule("DomUtil",[],function(e,t){var n="undefined",r=e.util,o=r.getBody;r.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),r.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var i=document.createElement("div");r.areHostMethods(i,["insertBefore","appendChild","cloneNode"]||!r.areHostObjects(i,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),r.isHostProperty(i,"innerHTML")||t.fail("Element is missing innerHTML property");var a=document.createTextNode("test");r.areHostMethods(a,["splitText","deleteData","insertData","appendData","cloneNode"]||!r.areHostObjects(i,["previousSibling","nextSibling","childNodes","parentNode"])||!r.areHostProperties(a,["data"]))||t.fail("Incomplete Text Node implementation");var s=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1};function c(e){for(var t=0;e=e.previousSibling;)++t;return t}function l(e,t){var n,r=[];for(n=e;n;n=n.parentNode)r.push(n);for(n=t;n;n=n.parentNode)if(s(r,n))return n;return null}function d(e,t,n){for(var r=n?t:t.parentNode;r;){if(r===e)return!0;r=r.parentNode}return!1}function u(e,t,n){for(var r,o=n?e:e.parentNode;o;){if((r=o.parentNode)===t)return o;o=r}return null}function f(e){var t=e.nodeType;return 3==t||4==t||8==t}function h(e,t){var n=t.nextSibling,r=t.parentNode;return n?r.insertBefore(e,n):r.appendChild(e),e}function p(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=n)return e.ownerDocument;if(typeof e.document!=n)return e.document;if(e.parentNode)return p(e.parentNode);throw t.createError("getDocument: no document found for node")}function g(e){var r=p(e);if(typeof r.defaultView!=n)return r.defaultView;if(typeof r.parentWindow!=n)return r.parentWindow;throw t.createError("Cannot get a window object for node")}function m(e){if(typeof e.contentDocument!=n)return e.contentDocument;if(typeof e.contentWindow!=n)return e.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element")}function v(e){return e&&r.isHostMethod(e,"setTimeout")&&r.isHostObject(e,"document")}var C,N=!1;function R(e){try{return e.parentNode,!1}catch(e){return!0}}function y(e){if(!e)return"[No node]";if(N&&R(e))return"[Broken node]";if(f(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+c(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function E(e){this.root=e,this._next=e}function S(e,t){this.node=e,this.offset=t}function T(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}!function(){var t=document.createElement("b");t.innerHTML="1";var n=t.firstChild;t.innerHTML="<br />",N=R(n),e.features.crashyTextNodes=N}(),typeof window.getComputedStyle!=n?C=function(e,t){return g(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=n?C=function(e,t){return e.currentStyle?e.currentStyle[t]:""}:t.fail("No means of obtaining computed style properties found"),E.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},S.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+y(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},T.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},T.prototype.toString=function(){return this.message},e.dom={arrayContains:s,isHtmlNamespace:function(e){var t;return typeof e.namespaceURI==n||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t},parentElement:function(e){var t=e.parentNode;return 1==t.nodeType?t:null},getNodeIndex:c,getNodeLength:function(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}},getCommonAncestor:l,isAncestorOf:d,isOrIsAncestorOf:function(e,t){return d(e,t,!0)},getClosestAncestorIn:u,isCharacterDataNode:f,isTextOrCommentNode:function(e){if(!e)return!1;var t=e.nodeType;return 3==t||8==t},insertAfter:h,splitDataNode:function(e,t,n){var r=e.cloneNode(!1);if(r.deleteData(0,t),e.deleteData(t,e.length-t),h(r,e),n)for(var o,i=0;o=n[i++];)o.node==e&&o.offset>t?(o.node=r,o.offset-=t):o.node==e.parentNode&&o.offset>c(e)&&++o.offset;return r},getDocument:p,getWindow:g,getIframeWindow:function(e){if(typeof e.contentWindow!=n)return e.contentWindow;if(typeof e.contentDocument!=n)return e.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element")},getIframeDocument:m,getBody:o,isWindow:v,getContentDocument:function(e,t,n){var o;if(e?r.isHostProperty(e,"nodeType")?o=1==e.nodeType&&"iframe"==e.tagName.toLowerCase()?m(e):p(e):v(e)&&(o=e.document):o=document,!o)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return o},getRootContainer:function(e){for(var t;t=e.parentNode;)e=t;return e},comparePoints:function(e,n,r,o){var i,a,s,d,f;if(e==r)return n===o?0:n<o?-1:1;if(i=u(r,e,!0))return n<=c(i)?-1:1;if(i=u(e,r,!0))return c(i)<o?-1:1;if(!(a=l(e,r)))throw new Error("comparePoints error: nodes have no common ancestor");if(s=e===a?a:u(e,a,!0),d=r===a?a:u(r,a,!0),s===d)throw t.createError("comparePoints got to case 4 and childA and childB are the same!");for(f=a.firstChild;f;){if(f===s)return-1;if(f===d)return 1;f=f.nextSibling}},isBrokenNode:R,inspectNode:y,getComputedStyleProperty:C,createTestElement:function(e,t,n){var r=o(e),i=e.createElement("div");i.contentEditable=""+!!n,t&&(i.innerHTML=t);var a=r.firstChild;return a?r.insertBefore(i,a):r.appendChild(i),i},removeNode:function(e){return e.parentNode.removeChild(e)},fragmentFromNodeChildren:function(e){for(var t,n=p(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n},createIterator:function(e){return new E(e)},DomPosition:S},e.DOMException=T}),y.createCoreModule("DomRange",["DomUtil"],function(e,t){var n=e.dom,r=e.util,o=n.DomPosition,i=e.DOMException,a=n.isCharacterDataNode,s=n.getNodeIndex,c=n.isOrIsAncestorOf,l=n.getDocument,d=n.comparePoints,u=n.splitDataNode,f=n.getClosestAncestorIn,h=n.getNodeLength,p=n.arrayContains,g=n.getRootContainer,m=e.features.crashyTextNodes,v=n.removeNode;function C(e,t){return 3!=e.nodeType&&(c(e,t.startContainer)||c(e,t.endContainer))}function N(e){return e.document||l(e.startContainer)}function R(e){return new o(e.parentNode,s(e))}function y(e){return new o(e.parentNode,s(e)+1)}function E(e,t,r){var o=11==e.nodeType?e.firstChild:e;return a(t)?r==t.length?n.insertAfter(e,t):t.parentNode.insertBefore(e,0==r?t:u(t,r)):r>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[r]),o}function S(e,t,n){if($(e),$(t),N(t)!=N(e))throw new i("WRONG_DOCUMENT_ERR");var r=d(e.startContainer,e.startOffset,t.endContainer,t.endOffset),o=d(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?r<=0&&o>=0:r<0&&o>0}function T(e,t,r){var o,i,a,s;for(r=r||{stop:!1};a=e.next();)if(e.isPartiallySelectedSubtree()){if(!1===t(a))return void(r.stop=!0);if(T(s=e.getSubtreeIterator(),t,r),s.detach(),r.stop)return}else for(o=n.createIterator(a);i=o.next();)if(!1===t(i))return void(r.stop=!0)}function w(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(w(t=e.getSubtreeIterator()),t.detach()):e.remove()}function O(e){for(var t,n,r=N(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),n=e.getSubtreeIterator(),t.appendChild(O(n)),n.detach()):e.remove(),10==t.nodeType)throw new i("HIERARCHY_REQUEST_ERR");r.appendChild(t)}return r}function x(e){var t=void 0===e.getName?"Range":e.getName();return"["+t+"("+n.inspectNode(e.startContainer)+":"+e.startOffset+", "+n.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function b(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&a(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||a(this.sc)?f(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||a(this.ec)?f(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}b.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,a(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!a(n)||n!==this.sc&&n!==this.ec?n.parentNode&&v(n):(e=n===this.sc?this.so:0,t=n===this.ec?this.eo:n.length,e!=t&&n.deleteData(e,t-e))},isPartiallySelectedSubtree:function(){var e=this._current;return C(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)(e=this.range.cloneRange()).collapse(!1);else{e=new fe(N(this.range));var t=this._current,n=t,r=0,o=t,i=h(t);c(t,this.sc)&&(n=this.sc,r=this.so),c(t,this.ec)&&(o=this.ec,i=this.eo),ue(e,n,r,o,i)}return new b(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var A=[1,3,4,5,7,8,10],P=[2,9,11],_=[1,3,4,5,7,8,10,11],D=[1,3,4,5,7,8];function I(e){return function(t,n){for(var r,o=n?t:t.parentNode;o;){if(r=o.nodeType,p(e,r))return o;o=o.parentNode}return null}}var B=I([9,11]),L=I([5,6,10,12]),k=I([6,10,12]);function W(e,t){if(k(e,t))throw new i("INVALID_NODE_TYPE_ERR")}function M(e,t){if(!p(t,e.nodeType))throw new i("INVALID_NODE_TYPE_ERR")}function H(e,t){if(t<0||t>(a(e)?e.length:e.childNodes.length))throw new i("INDEX_SIZE_ERR")}function F(e,t){if(B(e,!0)!==B(t,!0))throw new i("WRONG_DOCUMENT_ERR")}function j(e){if(L(e,!0))throw new i("NO_MODIFICATION_ALLOWED_ERR")}function V(e,t){if(!e)throw new i(t)}function U(e,t){return t<=(a(e)?e.length:e.childNodes.length)}function z(e){return!!e.startContainer&&!!e.endContainer&&!(m&&(n.isBrokenNode(e.startContainer)||n.isBrokenNode(e.endContainer)))&&g(e.startContainer)==g(e.endContainer)&&U(e.startContainer,e.startOffset)&&U(e.endContainer,e.endOffset)}function $(e){if(!z(e))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+e.inspect()+")")}var q=document.createElement("style"),G=!1;try{q.innerHTML="<b>x</b>",G=3==q.firstChild.nodeType}catch(e){}e.features.htmlParsingConforms=G;var Y=G?function(e){var t=this.startContainer,r=l(t);if(!t)throw new i("INVALID_STATE_ERR");var o=null;return 1==t.nodeType?o=t:a(t)&&(o=n.parentElement(t)),(o=null===o||"HTML"==o.nodeName&&n.isHtmlNamespace(l(o).documentElement)&&n.isHtmlNamespace(o)?r.createElement("body"):o.cloneNode(!1)).innerHTML=e,n.fragmentFromNodeChildren(o)}:function(e){var t=N(this),r=t.createElement("body");return r.innerHTML=e,n.fragmentFromNodeChildren(r)};function Q(e,t){$(e);var n=e.startContainer,r=e.startOffset,o=e.endContainer,i=e.endOffset,c=n===o;a(o)&&i>0&&i<o.length&&u(o,i,t),a(n)&&r>0&&r<n.length&&(n=u(n,r,t),c?(i-=r,o=n):o==n.parentNode&&i>=s(n)&&i++,r=0),e.setStartAndEnd(n,r,o,i)}function K(e){$(e);var t=e.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}var X=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],Z=0,J=1,ee=2,te=3,ne=0,re=1,oe=2,ie=3;function ae(e){e.START_TO_START=Z,e.START_TO_END=J,e.END_TO_END=ee,e.END_TO_START=te,e.NODE_BEFORE=ne,e.NODE_AFTER=re,e.NODE_BEFORE_AND_AFTER=oe,e.NODE_INSIDE=ie}function se(e){ae(e),ae(e.prototype)}function ce(e,t){return function(){$(this);var n,r,o=this.startContainer,i=this.startOffset,a=this.commonAncestorContainer,s=new b(this,!0);o!==a&&(n=f(o,a,!0),r=y(n),o=r.node,i=r.offset),T(s,j),s.reset();var c=e(s);return s.detach(),t(this,o,i,o,i),c}}function le(t,n){function o(e,t){return function(n){M(n,A),M(g(n),P);var r=(e?R:y)(n);(t?i:c)(this,r.node,r.offset)}}function i(e,t,r){var o=e.endContainer,i=e.endOffset;t===e.startContainer&&r===e.startOffset||(g(t)==g(o)&&1!=d(t,r,o,i)||(o=t,i=r),n(e,t,r,o,i))}function c(e,t,r){var o=e.startContainer,i=e.startOffset;t===e.endContainer&&r===e.endOffset||(g(t)==g(o)&&-1!=d(t,r,o,i)||(o=t,i=r),n(e,o,i,t,r))}var l=function(){};l.prototype=e.rangePrototype,t.prototype=new l,r.extend(t.prototype,{setStart:function(e,t){W(e,!0),H(e,t),i(this,e,t)},setEnd:function(e,t){W(e,!0),H(e,t),c(this,e,t)},setStartAndEnd:function(){var e=arguments,t=e[0],r=e[1],o=t,i=r;switch(e.length){case 3:i=e[2];break;case 4:o=e[2],i=e[3]}n(this,t,r,o,i)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:o(!0,!0),setStartAfter:o(!1,!0),setEndBefore:o(!0,!1),setEndAfter:o(!1,!1),collapse:function(e){$(this),e?n(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):n(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){W(e,!0),n(this,e,0,e,h(e))},selectNode:function(e){W(e,!1),M(e,A);var t=R(e),r=y(e);n(this,t.node,t.offset,r.node,r.offset)},extractContents:ce(O,n),deleteContents:ce(w,n),canSurroundContents:function(){$(this),j(this.startContainer),j(this.endContainer);var e=new b(this,!0),t=e._first&&C(e._first,this)||e._last&&C(e._last,this);return e.detach(),!t},splitBoundaries:function(){Q(this)},splitBoundariesPreservingPositions:function(e){Q(this,e)},normalizeBoundaries:function(){$(this);var e,t=this.startContainer,r=this.startOffset,o=this.endContainer,i=this.endOffset,c=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(o=e,i=e.length,e.appendData(t.data),v(t))},l=function(e){var n=e.previousSibling;if(n&&n.nodeType==e.nodeType){t=e;var a=e.length;if(r=n.length,e.insertData(0,n.data),v(n),t==o)i+=r,o=t;else if(o==e.parentNode){var c=s(e);i==c?(o=e,i=a):i>c&&i--}}},d=!0;if(a(o))i==o.length?c(o):0==i&&(e=o.previousSibling)&&e.nodeType==o.nodeType&&(i=e.length,t==o&&(d=!1),e.appendData(o.data),v(o),o=e);else{if(i>0){var u=o.childNodes[i-1];u&&a(u)&&c(u)}d=!this.collapsed}if(d){if(a(t))0==r?l(t):r==t.length&&(e=t.nextSibling)&&e.nodeType==t.nodeType&&(o==e&&(o=t,i+=t.length),t.appendData(e.data),v(e));else if(r<t.childNodes.length){var f=t.childNodes[r];f&&a(f)&&l(f)}}else t=o,r=i;n(this,t,r,o,i)},collapseToPoint:function(e,t){W(e,!0),H(e,t),this.setStartAndEnd(e,t)}}),se(t)}function de(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:n.getCommonAncestor(e.startContainer,e.endContainer)}function ue(e,t,r,o,i){e.startContainer=t,e.startOffset=r,e.endContainer=o,e.endOffset=i,e.document=n.getDocument(t),de(e)}function fe(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this.document=e,de(this)}r.extend(e.rangePrototype,{compareBoundaryPoints:function(e,t){var n,r,o,i;$(this),F(this.startContainer,t.startContainer);var a=e==te||e==Z?"start":"end",s=e==J||e==Z?"start":"end";return n=this[a+"Container"],r=this[a+"Offset"],o=t[s+"Container"],i=t[s+"Offset"],d(n,r,o,i)},insertNode:function(e){if($(this),M(e,_),j(this.startContainer),c(e,this.startContainer))throw new i("HIERARCHY_REQUEST_ERR");var t=E(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){var e,t;if($(this),this.collapsed)return N(this).createDocumentFragment();if(this.startContainer===this.endContainer&&a(this.startContainer))return(e=this.startContainer.cloneNode(!0)).data=e.data.slice(this.startOffset,this.endOffset),(t=N(this).createDocumentFragment()).appendChild(e),t;var n=new b(this,!0);return e=function e(t){for(var n,r,o,a=N(t.range).createDocumentFragment();r=t.next();){if(n=t.isPartiallySelectedSubtree(),r=r.cloneNode(!n),n&&(o=t.getSubtreeIterator(),r.appendChild(e(o)),o.detach()),10==r.nodeType)throw new i("HIERARCHY_REQUEST_ERR");a.appendChild(r)}return a}(n),n.detach(),e},canSurroundContents:function(){$(this),j(this.startContainer),j(this.endContainer);var e=new b(this,!0),t=e._first&&C(e._first,this)||e._last&&C(e._last,this);return e.detach(),!t},surroundContents:function(e){if(M(e,D),!this.canSurroundContents())throw new i("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);E(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){$(this);for(var e,t=new fe(N(this)),n=X.length;n--;)t[e=X[n]]=this[e];return t},toString:function(){$(this);var e=this.startContainer;if(e===this.endContainer&&a(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new b(this,!0);return T(n,function(e){3!=e.nodeType&&4!=e.nodeType||t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){$(this);var t=e.parentNode,n=s(e);if(!t)throw new i("NOT_FOUND_ERR");var r=this.comparePoint(t,n),o=this.comparePoint(t,n+1);return r<0?o>0?oe:ne:o>0?re:ie},comparePoint:function(e,t){return $(this),V(e,"HIERARCHY_REQUEST_ERR"),F(e,this.startContainer),d(e,t,this.startContainer,this.startOffset)<0?-1:d(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:Y,toHtml:function(){return K(this)},intersectsNode:function(e,t){if($(this),g(e)!=function(e){return g(e.startContainer)}(this))return!1;var n=e.parentNode,r=s(e);if(!n)return!0;var o=d(n,r,this.endContainer,this.endOffset),i=d(n,r+1,this.startContainer,this.startOffset);return t?o<=0&&i>=0:o<0&&i>0},isPointInRange:function(e,t){return $(this),V(e,"HIERARCHY_REQUEST_ERR"),F(e,this.startContainer),d(e,t,this.startContainer,this.startOffset)>=0&&d(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return S(this,e,!1)},intersectsOrTouchesRange:function(e){return S(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=d(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=d(this.endContainer,this.endOffset,e.endContainer,e.endOffset),r=this.cloneRange();return-1==t&&r.setStart(e.startContainer,e.startOffset),1==n&&r.setEnd(e.endContainer,e.endOffset),r}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return-1==d(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==d(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new i("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==ie},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,h(e))<=0},containsRange:function(e){var t=this.intersection(e);return null!==t&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var r=n.pop();return t.setEnd(r,r.length),this.containsRange(t)}return this.containsNodeContents(e)},getNodes:function(e,t){return $(this),function(e,t,n){var r,o=!(!t||!t.length),i=!!n;o&&(r=new RegExp("^("+t.join("|")+")$"));var s=[];return T(new b(e,!1),function(t){if((!o||r.test(t.nodeType))&&(!i||n(t))){var c=e.startContainer;if(t!=c||!a(c)||e.startOffset!=c.length){var l=e.endContainer;t==l&&a(l)&&0==e.endOffset||s.push(t)}}}),s}(this,e,t)},getDocument:function(){return N(this)},collapseBefore:function(e){this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){this.setStartAfter(e),this.collapse(!0)},getBookmark:function(t){var r=N(this),o=e.createRange(r);t=t||n.getBody(r),o.selectNodeContents(t);var i=this.intersection(o),a=0,s=0;return i&&(o.setEnd(i.startContainer,i.startOffset),a=o.toString().length,s=a+i.toString().length),{start:a,end:s,containerNode:t}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);for(var r,o,i,a,s=[t],c=!1,l=!1;!l&&(r=s.pop());)if(3==r.nodeType)o=n+r.length,!c&&e.start>=n&&e.start<=o&&(this.setStart(r,e.start-n),c=!0),c&&e.end>=n&&e.end<=o&&(this.setEnd(r,e.end-n),l=!0),n=o;else for(a=r.childNodes,i=a.length;i--;)s.push(a[i])},getName:function(){return"DomRange"},equals:function(e){return fe.rangesEqual(this,e)},isValid:function(){return z(this)},inspect:function(){return x(this)},detach:function(){}}),le(fe,ue),r.extend(fe,{rangeProperties:X,RangeIterator:b,copyComparisonConstants:se,createPrototypeRange:le,inspect:x,toHtml:K,getRangeDocument:N,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),e.DomRange=fe}),y.createCoreModule("WrappedRange",["DomRange"],function(e,t){var n,r,o=e.dom,i=e.util,a=o.DomPosition,s=e.DomRange,c=o.getBody,l=o.getContentDocument,d=o.isCharacterDataNode;if(e.features.implementsDomRange&&function(){var r,a,d=s.rangeProperties;function u(e){for(var t,n=d.length;n--;)t=d[n],e[t]=e.nativeRange[t];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}n=function(e){if(!e)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=e,u(this)},s.createPrototypeRange(n,function(e,t,n,r,o){var i=e.startContainer!==t||e.startOffset!=n,a=e.endContainer!==r||e.endOffset!=o,s=!e.equals(e.nativeRange);(i||a||s)&&(e.setEnd(r,o),e.setStart(t,n))}),(r=n.prototype).selectNode=function(e){this.nativeRange.selectNode(e),u(this)},r.cloneContents=function(){return this.nativeRange.cloneContents()},r.surroundContents=function(e){this.nativeRange.surroundContents(e),u(this)},r.collapse=function(e){this.nativeRange.collapse(e),u(this)},r.cloneRange=function(){return new n(this.nativeRange.cloneRange())},r.refresh=function(){u(this)},r.toString=function(){return this.nativeRange.toString()};var f=document.createTextNode("test");c(document).appendChild(f);var h=document.createRange();h.setStart(f,0),h.setEnd(f,0);try{h.setStart(f,1),r.setStart=function(e,t){this.nativeRange.setStart(e,t),u(this)},r.setEnd=function(e,t){this.nativeRange.setEnd(e,t),u(this)},a=function(e){return function(t){this.nativeRange[e](t),u(this)}}}catch(e){r.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}u(this)},r.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}u(this)},a=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(r){this.nativeRange[t](n),this.nativeRange[e](n)}u(this)}}}r.setStartBefore=a("setStartBefore","setEndBefore"),r.setStartAfter=a("setStartAfter","setEndAfter"),r.setEndBefore=a("setEndBefore","setStartBefore"),r.setEndAfter=a("setEndAfter","setStartAfter"),r.selectNodeContents=function(e){this.setStartAndEnd(e,0,o.getNodeLength(e))},h.selectNodeContents(f),h.setEnd(f,3);var p=document.createRange();p.selectNodeContents(f),p.setEnd(f,4),p.setStart(f,2),-1==h.compareBoundaryPoints(h.START_TO_END,p)&&1==h.compareBoundaryPoints(h.END_TO_START,p)?r.compareBoundaryPoints=function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:r.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var g=document.createElement("div");g.innerHTML="123";var m=g.firstChild,v=c(document);v.appendChild(g),h.setStart(m,1),h.setEnd(m,2),h.deleteContents(),"13"==m.data&&(r.deleteContents=function(){this.nativeRange.deleteContents(),u(this)},r.extractContents=function(){var e=this.nativeRange.extractContents();return u(this),e}),v.removeChild(g),v=null,i.isHostMethod(h,"createContextualFragment")&&(r.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),c(document).removeChild(f),r.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createNativeRange=function(e){return(e=l(e,t,"createNativeRange")).createRange()}}(),e.features.implementsTextRange){var u=function(e,t,n,r,i){var s=e.duplicate();s.collapse(n);var c=s.parentElement();if(o.isOrIsAncestorOf(t,c)||(c=t),!c.canHaveHTML){var l=new a(c.parentNode,o.getNodeIndex(c));return{boundaryPosition:l,nodeInfo:{nodeIndex:l.offset,containerElement:l.node}}}var u=o.getDocument(c).createElement("span");u.parentNode&&o.removeNode(u);for(var f,h,p,g,m,v=n?"StartToStart":"StartToEnd",C=i&&i.containerElement==c?i.nodeIndex:0,N=c.childNodes.length,R=N,y=R;y==N?c.appendChild(u):c.insertBefore(u,c.childNodes[y]),s.moveToElementText(u),0!=(f=s.compareEndPoints(v,e))&&C!=R;){if(-1==f){if(R==C+1)break;C=y}else R=R==C+1?C:y;y=Math.floor((C+R)/2),c.removeChild(u)}if(m=u.nextSibling,-1==f&&m&&d(m)){var E;if(s.setEndPoint(n?"EndToStart":"EndToEnd",e),/[\r\n]/.test(m.data)){var S=s.duplicate(),T=S.text.replace(/\r\n/g,"\r").length;for(E=S.moveStart("character",T);-1==(f=S.compareEndPoints("StartToEnd",S));)E++,S.moveStart("character",1)}else E=s.text.length;g=new a(m,E)}else h=(r||!n)&&u.previousSibling,p=(r||n)&&u.nextSibling,g=p&&d(p)?new a(p,0):h&&d(h)?new a(h,h.data.length):new a(c,o.getNodeIndex(u));return o.removeNode(u),{boundaryPosition:g,nodeInfo:{nodeIndex:y,containerElement:c}}},f=function(e,t){var n,r,i,a,s=e.offset,l=o.getDocument(e.node),u=c(l).createTextRange(),f=d(e.node);return f?(n=e.node,r=n.parentNode):(a=e.node.childNodes,n=s<a.length?a[s]:null,r=e.node),(i=l.createElement("span")).innerHTML="&#feff;",n?r.insertBefore(i,n):r.appendChild(i),u.moveToElementText(i),u.collapse(!t),r.removeChild(i),f&&u[t?"moveStart":"moveEnd"]("character",s),u};(r=function(e){this.textRange=e,this.refresh()}).prototype=new s(document),r.prototype.refresh=function(){var e,t,n,r=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var r=n.parentElement();(n=e.duplicate()).collapse(!1);var i=n.parentElement(),a=r==i?r:o.getCommonAncestor(r,i);return a==t?a:o.getCommonAncestor(t,a)}(this.textRange);!function(e){return 0==e.compareEndPoints("StartToEnd",e)}(this.textRange)?(n=u(this.textRange,r,!0,!1),e=n.boundaryPosition,t=u(this.textRange,r,!1,!1,n.nodeInfo).boundaryPosition):t=e=u(this.textRange,r,!0,!0).boundaryPosition,this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},r.prototype.getName=function(){return"WrappedTextRange"},s.copyComparisonConstants(r);var h=function(e){if(e.collapsed)return f(new a(e.startContainer,e.startOffset),!0);var t=f(new a(e.startContainer,e.startOffset),!0),n=f(new a(e.endContainer,e.endOffset),!1),r=c(s.getRangeDocument(e)).createTextRange();return r.setEndPoint("StartToStart",t),r.setEndPoint("EndToEnd",n),r};if(r.rangeToTextRange=h,r.prototype.toTextRange=function(){return h(this)},e.WrappedTextRange=r,!e.features.implementsDomRange||e.config.preferTextRange){var p=function(e){return e("return this;")()}(Function);void 0===p.Range&&(p.Range=r),e.createNativeRange=function(e){return e=l(e,t,"createNativeRange"),c(e).createTextRange()},e.WrappedRange=r}}e.createRange=function(n){return n=l(n,t,"createRange"),new e.WrappedRange(e.createNativeRange(n))},e.createRangyRange=function(e){return e=l(e,t,"createRangyRange"),new s(e)},i.createAliasForDeprecatedMethod(e,"createIframeRange","createRange"),i.createAliasForDeprecatedMethod(e,"createIframeRangyRange","createRangyRange"),e.addShimListener(function(t){var n=t.document;void 0===n.createRange&&(n.createRange=function(){return e.createRange(n)}),n=t=null})}),y.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(e,t){e.config.checkSelectionRanges=!0;var n,r,o=e.dom,i=e.util,a=i.isHostMethod,s=e.DomRange,c=e.WrappedRange,l=e.DOMException,d=o.DomPosition,u=e.features,f=o.getDocument,h=o.getBody,p=s.rangesEqual;function g(e){return"string"==typeof e?/^backward(s)?$/i.test(e):!!e}function m(e,n){if(e){if(o.isWindow(e))return e;if(e instanceof V)return e.win;var r=o.getContentDocument(e,t,n);return o.getWindow(r)}return window}function v(e){return m(e,"getDocSelection").document.selection}function C(e){var t=!1;return e.anchorNode&&(t=1==o.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t}var N=a(window,"getSelection"),R=i.isHostObject(document,"selection");u.implementsWinGetSelection=N,u.implementsDocSelection=R;var y=R&&(!N||e.config.preferTextRange);if(y)n=v,e.isSelectionValid=function(e){var t=m(e,"isSelectionValid").document,n=t.selection;return"None"!=n.type||f(n.createRange().parentElement())==t};else{if(!N)return t.fail("Neither document.selection or window.getSelection() detected."),!1;n=function(e){return m(e,"getWinSelection").getSelection()},e.isSelectionValid=function(){return!0}}e.getNativeSelection=n;var E=n();if(!E)return t.fail("Native selection was null (possibly issue 138?)"),!1;var S=e.createNativeRange(document),T=h(document),w=i.areHostProperties(E,["anchorNode","focusNode","anchorOffset","focusOffset"]);u.selectionHasAnchorAndFocus=w;var O=a(E,"extend");u.selectionHasExtend=O;var x="number"==typeof E.rangeCount;u.selectionHasRangeCount=x;var b=!1,A=!0,P=O?function(t,n){var r=s.getRangeDocument(n),o=e.createRange(r);o.collapseToPoint(n.endContainer,n.endOffset),t.addRange(k(o)),t.extend(n.startContainer,n.startOffset)}:null;i.areHostMethods(E,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof E.rangeCount&&u.implementsDomRange&&function(){var t=window.getSelection();if(t){for(var n=t.rangeCount,r=n>1,i=[],a=C(t),s=0;s<n;++s)i[s]=t.getRangeAt(s);var c=o.createTestElement(document,"",!1),l=c.appendChild(document.createTextNode("")),d=document.createRange();if(d.setStart(l,1),d.collapse(!0),t.removeAllRanges(),t.addRange(d),A=1==t.rangeCount,t.removeAllRanges(),!r){var u=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(u&&parseInt(u[1])>=36)b=!1;else{var f=d.cloneRange();d.setStart(l,0),f.setEnd(l,3),f.setStart(l,2),t.addRange(d),t.addRange(f),b=2==t.rangeCount}}for(o.removeNode(c),t.removeAllRanges(),s=0;s<n;++s)0==s&&a?P?P(t,i[s]):(e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(i[s])):t.addRange(i[s])}}(),u.selectionSupportsMultipleRanges=b,u.collapsedNonEditableSelectionsSupported=A;var _,D,I=!1;function B(e,t,n){var r=n?"end":"start",o=n?"start":"end";e.anchorNode=t[r+"Container"],e.anchorOffset=t[r+"Offset"],e.focusNode=t[o+"Container"],e.focusOffset=t[o+"Offset"]}function L(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function k(t){var n;return t instanceof s?((n=e.createNativeRange(t.getDocument())).setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset)):t instanceof c?n=t.nativeRange:u.implementsDomRange&&t instanceof o.getWindow(t.startContainer).Range&&(n=t),n}function W(e){var n=e.getNodes();if(!function(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;t<n;++t)if(!o.isAncestorOf(e[0],e[t]))return!1;return!0}(n))throw t.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return n[0]}function M(e){return!!e&&void 0!==e.text}function H(e,t){var n=new c(t);e._ranges=[n],B(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function F(t){if(t._ranges.length=0,"None"==t.docSelection.type)L(t);else{var n=t.docSelection.createRange();if(M(n))H(t,n);else{t.rangeCount=n.length;for(var r,o=f(n.item(0)),i=0;i<t.rangeCount;++i)(r=e.createRange(o)).selectNode(n.item(i)),t._ranges.push(r);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,B(t,t._ranges[t.rangeCount-1],!1)}}}function j(e,n){for(var r=e.docSelection.createRange(),o=W(n),i=f(r.item(0)),a=h(i).createControlRange(),s=0,c=r.length;s<c;++s)a.add(r.item(s));try{a.add(o)}catch(e){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}a.select(),F(e)}function V(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function U(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0}T&&a(T,"createControlRange")&&(_=T.createControlRange(),i.areHostProperties(_,["item","add"])&&(I=!0)),u.implementsControlRange=I,r=w?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return!!e.rangeCount&&e.getRangeAt(e.rangeCount-1).collapsed},a(E,"getRangeAt")?D=function(e,t){try{return e.getRangeAt(t)}catch(e){return null}}:w&&(D=function(t){var n=f(t.anchorNode),r=e.createRange(n);return r.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),r.collapsed!==this.isCollapsed&&r.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),r}),V.prototype=e.selectionPrototype;var z=[];function $(e,t){for(var n,r,o=z.length;o--;)if(n=z[o],r=n.selection,"deleteAll"==t)U(r);else if(n.win==e)return"delete"==t?(z.splice(o,1),!0):r;return"deleteAll"==t&&(z.length=0),null}var q=function(e){if(e&&e instanceof V)return e.refresh(),e;var t=$(e=m(e,"getNativeSelection")),r=n(e),o=R?v(e):null;return t?(t.nativeSelection=r,t.docSelection=o,t.refresh()):(t=new V(r,o,e),z.push({win:e,selection:t})),t};e.getSelection=q,i.createAliasForDeprecatedMethod(e,"getIframeSelection","getSelection");var G,Y=V.prototype;function Q(e,n){for(var r,o=f(n[0].startContainer),i=h(o).createControlRange(),a=0,s=n.length;a<s;++a){r=W(n[a]);try{i.add(r)}catch(e){throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}i.select(),F(e)}if(!y&&w&&i.areHostMethods(E,["removeAllRanges","addRange"])){Y.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),L(this)};var K=function(e,t){P(e.nativeSelection,t),e.refresh()};Y.addRange=x?function(t,n){if(I&&R&&"Control"==this.docSelection.type)j(this,t);else if(g(n)&&O)K(this,t);else{var o;b?o=this.rangeCount:(this.removeAllRanges(),o=0);var i=k(t).cloneRange();try{this.nativeSelection.addRange(i)}catch(e){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==o+1){if(e.config.checkSelectionRanges){var a=D(this.nativeSelection,this.rangeCount-1);a&&!p(a,t)&&(t=new c(a))}this._ranges[this.rangeCount-1]=t,B(this,t,X(this.nativeSelection)),this.isCollapsed=r(this)}else this.refresh()}}:function(e,t){g(t)&&O?K(this,e):(this.nativeSelection.addRange(k(e)),this.refresh())},Y.setRanges=function(e){if(I&&R&&e.length>1)Q(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(a(E,"empty")&&a(S,"select")&&I&&y))return t.fail("No means of selecting a Range or TextRange was found"),!1;Y.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=f(this.anchorNode);else if("Control"==this.docSelection.type){var t=this.docSelection.createRange();t.length&&(e=f(t.item(0)))}if(e){var n=h(e).createTextRange();n.select(),this.docSelection.empty()}}}catch(e){}L(this)},Y.addRange=function(t){"Control"==this.docSelection.type?j(this,t):(e.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,B(this,t,!1))},Y.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?Q(this,e):t&&this.addRange(e[0])}}if(Y.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new l("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()},y)G=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=h(t.win.document).createTextRange()).collapse(!0),"Control"==t.docSelection.type?F(t):M(n)?H(t,n):L(t)};else if(a(E,"getRangeAt")&&"number"==typeof E.rangeCount)G=function(t){if(I&&R&&"Control"==t.docSelection.type)F(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var n=0,o=t.rangeCount;n<o;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));B(t,t._ranges[t.rangeCount-1],X(t.nativeSelection)),t.isCollapsed=r(t)}else L(t)};else{if(!w||"boolean"!=typeof E.isCollapsed||"boolean"!=typeof S.collapsed||!u.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;G=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=D(n,0),e._ranges=[t],e.rangeCount=1,function(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}(e),e.isCollapsed=r(e)):L(e)}}Y.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,r=this.anchorOffset;if(G(this),e){var o=t.length;if(o!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=r)return!0;for(;o--;)if(!p(t[o],this._ranges[o]))return!0;return!1}};var X,Z=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var r=0,o=n.length;r<o;++r)p(t,n[r])||e.addRange(n[r]);e.rangeCount||L(e)};function J(e,t){if(e.win.document!=f(t))throw new l("WRONG_DOCUMENT_ERR")}function ee(t){return function(n,r){var o;this.rangeCount?(o=this.getRangeAt(0))["set"+(t?"Start":"End")](n,r):(o=e.createRange(this.win.document)).setStartAndEnd(n,r),this.setSingleRange(o,this.isBackward())}}function te(e){var t=[],n=new d(e.anchorNode,e.anchorOffset),r=new d(e.focusNode,e.focusOffset),o="function"==typeof e.getName?e.getName():"Selection";if(void 0!==e.rangeCount)for(var i=0,a=e.rangeCount;i<a;++i)t[i]=s.inspect(e.getRangeAt(i));return"["+o+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+r.inspect()+"]"}Y.removeRange=I&&R?function(e){if("Control"==this.docSelection.type){for(var t=this.docSelection.createRange(),n=W(e),r=f(t.item(0)),o=h(r).createControlRange(),i=!1,a=0,s=t.length;a<s;++a)t.item(a)!==n||i?o.add(t.item(a)):i=!0;o.select(),F(this)}else Z(this,e)}:function(e){Z(this,e)},!y&&w&&u.implementsDomRange?(X=C,Y.isBackward=function(){return X(this)}):X=Y.isBackward=function(){return!1},Y.isBackwards=Y.isBackward,Y.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},Y.collapse=function(t,n){J(this,t);var r=e.createRange(t);r.collapseToPoint(t,n),this.setSingleRange(r),this.isCollapsed=!0},Y.collapseToStart=function(){if(!this.rangeCount)throw new l("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},Y.collapseToEnd=function(){if(!this.rangeCount)throw new l("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},Y.selectAllChildren=function(t){J(this,t);var n=e.createRange(t);n.selectNodeContents(t),this.setSingleRange(n)},Y.deleteFromDocument=function(){if(I&&R&&"Control"==this.docSelection.type){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),o.removeNode(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var r=0,i=n.length;r<i;++r)n[r].deleteContents();this.addRange(n[i-1])}}},Y.eachRange=function(e,t){for(var n=0,r=this._ranges.length;n<r;++n)if(e(this.getRangeAt(n)))return t},Y.getAllRanges=function(){var e=[];return this.eachRange(function(t){e.push(t)}),e},Y.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},Y.callMethodOnEachRange=function(e,t){var n=[];return this.eachRange(function(r){n.push(r[e].apply(r,t||[]))}),n},Y.setStart=ee(!0),Y.setEnd=ee(!1),e.rangePrototype.select=function(e){q(this.getDocument()).setSingleRange(this,e)},Y.changeEachRange=function(e){var t=[],n=this.isBackward();this.eachRange(function(n){e(n),t.push(n)}),this.removeAllRanges(),n&&1==t.length?this.addRange(t[0],"backward"):this.setRanges(t)},Y.containsNode=function(e,t){return this.eachRange(function(n){return n.containsNode(e,t)},!0)||!1},Y.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},Y.moveToBookmark=function(t){for(var n,r,o=[],i=0;n=t.rangeBookmarks[i++];)(r=e.createRange(this.win)).moveToBookmark(n),o.push(r);t.backward?this.setSingleRange(o[0],"backward"):this.setRanges(o)},Y.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},Y.restoreRanges=function(e){this.removeAllRanges();for(var t,n=0;t=e.ranges[n];++n)this.addRange(t,e.backward&&0==n)},Y.toHtml=function(){var e=[];return this.eachRange(function(t){e.push(s.toHtml(t))}),e.join("")},u.implementsTextRange&&(Y.getNativeTextRange=function(){var n;if(n=this.docSelection){var r=n.createRange();if(M(r))return r;throw t.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return e.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw t.createError("getNativeTextRange: selection contains no range")}),Y.getName=function(){return"WrappedSelection"},Y.inspect=function(){return te(this)},Y.detach=function(){$(this.win,"delete"),U(this)},V.detachAll=function(){$(null,"deleteAll")},V.inspect=te,V.isDirectionBackward=g,e.Selection=V,e.selectionPrototype=Y,e.addShimListener(function(e){void 0===e.getSelection&&(e.getSelection=function(){return q(e)}),e=null})});var B=!1,L=function(e){B||(B=!0,!y.initialized&&y.config.autoInitialize&&x())};return N&&("complete"==document.readyState?L():(s(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",L,!1),v(window,"load",L))),y})?r.call(t,n,t,e):r)||(e.exports=o)}}]);